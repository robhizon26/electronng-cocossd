function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)})(e)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(a,n.prototype),a}).apply(null,arguments)}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function asyncGeneratorStep(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){asyncGeneratorStep(i,r,a,o,s,"next",e)}function s(e){asyncGeneratorStep(i,r,a,o,s,"throw",e)}o(void 0)}))}}/*! For license information please see main-es2015.e7ef95470b001ccff0a8.js.LICENSE.txt */(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+hG3":function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"isMobile",(function(){return p})),n.d(r,"isBrowser",(function(){return m}));var a={};n.r(a),n.d(a,"copyModel",(function(){return se})),n.d(a,"listModels",(function(){return re})),n.d(a,"moveModel",(function(){return ce})),n.d(a,"removeModel",(function(){return ie})),n.d(a,"browserFiles",(function(){return we})),n.d(a,"browserHTTPRequest",(function(){return De})),n.d(a,"concatenateArrayBuffers",(function(){return I})),n.d(a,"decodeWeights",(function(){return C})),n.d(a,"encodeWeights",(function(){return w})),n.d(a,"fromMemory",(function(){return Me})),n.d(a,"getLoadHandlers",(function(){return M})),n.d(a,"getModelArtifactsInfoForJSON",(function(){return N})),n.d(a,"getSaveHandlers",(function(){return F})),n.d(a,"http",(function(){return Re})),n.d(a,"isHTTPScheme",(function(){return Ne})),n.d(a,"loadWeights",(function(){return Se})),n.d(a,"registerLoadRouter",(function(){return j})),n.d(a,"registerSaveRouter",(function(){return D})),n.d(a,"weightsLoaderFactory",(function(){return Ie})),n.d(a,"withSaveHandler",(function(){return Pe}));var i={};n.r(i),n.d(i,"confusionMatrix",(function(){return He}));var o={};n.r(o),n.d(o,"toPixels",(function(){return Xe})),n.d(o,"fromPixels",(function(){return Ye}));var s={};n.r(s),n.d(s,"prepareAndValidate",(function(){return Qe}));var u={};n.r(u),n.d(u,"assertParamsValid",(function(){return $e})),n.d(u,"maskToAxes",(function(){return et})),n.d(u,"computeOutShape",(function(){return tt})),n.d(u,"stridesWithElidedDims",(function(){return nt})),n.d(u,"getNormalizedAxes",(function(){return it})),n.d(u,"startIndicesWithElidedDims",(function(){return ot})),n.d(u,"stopIndicesWithElidedDims",(function(){return st})),n.d(u,"stridesForAxis",(function(){return ut})),n.d(u,"startForAxis",(function(){return ct})),n.d(u,"stopForAxis",(function(){return lt})),n.d(u,"isSliceContinous",(function(){return ht})),n.d(u,"computeFlatOffset",(function(){return dt})),n.d(u,"parseSliceParams",(function(){return ft})),n.d(u,"sliceInfo",(function(){return pt}));var c={};n.r(c),n.d(c,"Serializable",(function(){return mt})),n.d(c,"SerializationMap",(function(){return vt})),n.d(c,"registerClass",(function(){return gt}));var l={};n.r(l),n.d(l,"segOpComputeOptimalWindowSize",(function(){return An})),n.d(l,"computeOutShape",(function(){return Rn})),n.d(l,"collectGatherOpShapeInfo",(function(){return Dn}));var h={};n.r(h),n.d(h,"slice_util",(function(){return u})),n.d(h,"upcastType",(function(){return Ut.c})),n.d(h,"prepareAndValidate",(function(){return Qe})),n.d(h,"validateUpdateShape",(function(){return Je.validateUpdateShape})),n.d(h,"validateInput",(function(){return Je.validateInput})),n.d(h,"calculateShapes",(function(){return Je.calculateShapes})),n.d(h,"segment_util",(function(){return l})),n.d(h,"castTensor",(function(){return jn})),n.d(h,"reshapeTensor",(function(){return Fn})),n.d(h,"fromUint8ToStringArray",(function(){return Mn})),n.d(h,"fromStringArrayToUint8",(function(){return Pn})),n.d(h,"axesAreInnerMostDims",(function(){return Qt.b})),n.d(h,"combineLocations",(function(){return Qt.c})),n.d(h,"computeOutAndReduceShapes",(function(){return Qt.d})),n.d(h,"expandShapeToKeepDim",(function(){return Qt.e})),n.d(h,"assertAxesAreInnerMostDims",(function(){return Qt.a})),n.d(h,"getAxesPermutation",(function(){return Qt.f})),n.d(h,"getUndoAxesPermutation",(function(){return Qt.h})),n.d(h,"getInnerMostAxes",(function(){return Qt.g})),n.d(h,"getBroadcastDims",(function(){return Jt.b})),n.d(h,"getReductionAxes",(function(){return Jt.c})),n.d(h,"assertAndGetBroadcastShape",(function(){return Jt.a})),n.d(h,"assertParamsConsistent",(function(){return $t})),n.d(h,"computeOutShape",(function(){return en})),n.d(h,"computeDilation2DInfo",(function(){return tn.d})),n.d(h,"computePool2DInfo",(function(){return tn.e})),n.d(h,"computePool3DInfo",(function(){return tn.f})),n.d(h,"computeConv2DInfo",(function(){return tn.a})),n.d(h,"computeConv3DInfo",(function(){return tn.b})),n.d(h,"computeDefaultPad",(function(){return tn.c})),n.d(h,"tupleValuesAreOne",(function(){return tn.i})),n.d(h,"eitherStridesOrDilationsAreOne",(function(){return tn.h})),n.d(h,"convertConv2DDataFormat",(function(){return tn.g})),n.d(h,"getFusedDyActivation",(function(){return nn.c})),n.d(h,"getFusedBiasGradient",(function(){return nn.b})),n.d(h,"applyActivation",(function(){return nn.a})),n.d(h,"shouldFuse",(function(){return nn.d})),n.d(h,"PARALLELIZE_THRESHOLD",(function(){return rn})),n.d(h,"computeOptimalWindowSize",(function(){return an})),n.d(h,"getImageCenter",(function(){return on})),n.d(h,"getReshaped",(function(){return sn})),n.d(h,"getPermuted",(function(){return un})),n.d(h,"getReshapedPermuted",(function(){return cn})),n.d(h,"getSliceBeginCoords",(function(){return ln})),n.d(h,"getSliceSize",(function(){return hn})),n.d(h,"SELU_SCALEALPHA",(function(){return dn})),n.d(h,"SELU_SCALE",(function(){return fn})),n.d(h,"ERF_P",(function(){return pn})),n.d(h,"ERF_A1",(function(){return mn})),n.d(h,"ERF_A2",(function(){return vn})),n.d(h,"ERF_A3",(function(){return gn})),n.d(h,"ERF_A4",(function(){return yn})),n.d(h,"ERF_A5",(function(){return bn})),n.d(h,"warn",(function(){return kn})),n.d(h,"log",(function(){return _n})),n.d(h,"mergeRealAndImagArrays",(function(){return wn})),n.d(h,"splitRealAndImagArrays",(function(){return xn})),n.d(h,"complexWithEvenIndex",(function(){return Cn})),n.d(h,"complexWithOddIndex",(function(){return On})),n.d(h,"getComplexWithIndex",(function(){return Sn})),n.d(h,"assignToTypedArray",(function(){return Tn})),n.d(h,"exponents",(function(){return In})),n.d(h,"exponent",(function(){return En})),n.d(h,"prepareSplitSize",(function(){return Nn}));var d={};n.r(d),n.d(d,"nonMaxSuppressionV3Impl",(function(){return Ln.a})),n.d(d,"nonMaxSuppressionV4Impl",(function(){return Ln.b})),n.d(d,"nonMaxSuppressionV5Impl",(function(){return Ln.c})),n.d(d,"whereImpl",(function(){return zn.a}));var f=n("auKK");function p(){if("undefined"!=typeof navigator&&null!=navigator){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function m(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var v=n("szMd"),g=Object(v.c)();g.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),g.registerFlag("IS_BROWSER",(function(){return m()})),g.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),g.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),g.registerFlag("PROD",(function(){return!1})),g.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return g.getBool("DEBUG")})),g.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),g.registerFlag("IS_TEST",(function(){return!1})),g.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0}));var y=n("B3db"),b=n("NX3e"),k=n("atXS"),_={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function w(e,t){return x.apply(this,arguments)}function x(){return(x=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=function(e){var o=i[e],s=Array.isArray(t)?t[e].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));var u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var c=new Promise(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)u=n[o],c=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(c,i),i+=4,a.set(u,i),i+=u.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());a.push(c)}else a.push(s.data());null!=n&&(u.group=n),r.push(u)},s=0;s<i.length;++s)o(s);return e.t0=O,e.next=6,Promise.all(a);case 6:return e.t1=e.sent,e.t2=(0,e.t0)(e.t1),e.t3=r,e.abrupt("return",{data:e.t2,specs:e.t3});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){var n,r,a={},i=0,o=_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.name,c=s.dtype,l=s.shape,h=Object(k.N)(l),d=void 0;if("quantization"in s){var f=s.quantization;if("uint8"===f.dtype||"uint16"===f.dtype){if(!("min"in f&&"scale"in f))throw new Error("Weight ".concat(s.name," with quantization ").concat(f.dtype," doesn't have corresponding metadata min and scale."))}else{if("float16"!==f.dtype)throw new Error("Weight ".concat(s.name," has unknown quantization dtype ").concat(f.dtype,". Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'."));if("float32"!==c)throw new Error("Weight ".concat(s.name," is quantized with ").concat(f.dtype," which only supports weights of type float32 not ").concat(c,"."))}var p=_[f.dtype],m=e.slice(i,i+h*p),v="uint8"===f.dtype?new Uint8Array(m):new Uint16Array(m);if("float32"===c)if("uint8"===f.dtype||"uint16"===f.dtype){d=new Float32Array(v.length);for(var g=0;g<v.length;g++)d[g]=v[g]*f.scale+f.min}else{if("float16"!==f.dtype)throw new Error("Unsupported quantization type ".concat(f.dtype," for weight type float32."));void 0===n&&(n=A()),d=n(v)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));if("uint8"!==f.dtype&&"uint16"!==f.dtype)throw new Error("Unsupported quantization type ".concat(f.dtype," for weight type int32."));d=new Int32Array(v.length);for(var w=0;w<v.length;w++)d[w]=Math.round(v[w]*f.scale+f.min)}i+=h*p}else if("string"===c){var x=Object(k.N)(s.shape);d=[];for(var C=0;C<x;C++){var O=new Uint32Array(e.slice(i,i+4))[0];i+=4;var S=new Uint8Array(e.slice(i,i+O));d.push(S),i+=O}}else{var T=_[c],I=e.slice(i,i+h*T);if("float32"===c)d=new Float32Array(I);else if("int32"===c)d=new Int32Array(I);else if("bool"===c)d=new Uint8Array(I);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));d=new Float32Array(I);for(var E=new Float32Array(d.length/2),N=new Float32Array(d.length/2),R=0;R<E.length;R++)E[R]=d[2*R],N[R]=d[2*R+1];var D=Object(b.a)(E,l,"float32"),j=Object(b.a)(N,l,"float32");a[u]=Object(y.a)(D,j),D.dispose(),j.dispose()}i+=h*T}"complex64"!==c&&(a[u]=Object(b.a)(d,l,c))}}catch(F){o.e(F)}finally{o.f()}return a}function O(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var S="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function T(e){return S?Buffer.byteLength(e):new Blob([e]).size}function I(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function E(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function N(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:T(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:T(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function A(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0==(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|(n+=947912704)},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o];i[o]=e[n[s>>10]+(1023&s)]+t[s>>10]}return new Float32Array(a)}}var R=function(){function e(){_classCallCheck(this,e),this.saveRouters=[],this.loadRouters=[]}return _createClass(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),D=function(e){return R.registerSaveRouter(e)},j=function(e){return R.registerLoadRouter(e)},F=function(e){return R.getSaveHandlers(e)},M=function(e,t){return R.getLoadHandlers(e,t)};function P(){if(!Object(v.c)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function L(e){var t=e.result;t.createObjectStore("models_store",{keyPath:"modelPath"}),t.createObjectStore("model_info_store",{keyPath:"modelPath"})}var z=function(){function e(t){if(_classCallCheck(this,e),this.indexedDB=P(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}var t,n;return _createClass(e,[{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return L(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction("models_store","readonly"),s=o.objectStore("models_store").get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' in IndexedDB.")));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=N(t),l=i.transaction("model_info_store","readwrite"),h=l.objectStore("model_info_store"),d=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});d.onsuccess=function(){var a=(u=i.transaction("models_store","readwrite")).objectStore("models_store").put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(h=l.objectStore("model_info_store")).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},d.onerror=function(e){return i.close(),r(d.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();z.URL_SCHEME="indexeddb://";var B=function(e){return Object(v.c)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(z.URL_SCHEME)?(t=e.slice(z.URL_SCHEME.length),new z(t)):null;var t};R.registerSaveRouter(B),R.registerLoadRouter(B);var V=function(){function e(){_classCallCheck(this,e),this.indexedDB=P()}var t,n;return _createClass(e,[{key:"listModels",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return L(r)},r.onsuccess=function(){var t=r.result,a=t.transaction("model_info_store","readonly"),i=a.objectStore("model_info_store").getAll();i.onsuccess=function(){var t,n={},r=_createForOfIteratorHelper(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"removeModel",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t=(n=t).startsWith(z.URL_SCHEME)?n.slice(z.URL_SCHEME.length):n,new Promise((function(e,n){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return L(a)},a.onsuccess=function(){var r,i=a.result,o=i.transaction("model_info_store","readwrite"),s=o.objectStore("model_info_store"),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),n(new Error("Cannot find model with path '".concat(t,"' in IndexedDB.")));var a=s.delete(t),o=function(){var a=(r=i.transaction("models_store","readwrite")).objectStore("models_store").delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return n(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),n(u.error)}},u.onerror=function(e){return i.close(),n(u.error)},o.oncomplete=function(){null==r?i.close():r.oncomplete=function(){return i.close()}}},a.onerror=function(e){return n(a.error)}}))));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),W="tensorflowjs_models",U="info",H="model_topology",G="weight_specs",K="weight_data",q="model_metadata";function X(e){return{info:[W,e,U].join("/"),topology:[W,e,H].join("/"),weightSpecs:[W,e,G].join("/"),weightData:[W,e,K].join("/"),modelMetadata:[W,e,q].join("/")}}function Z(e){var t=e.split("/");if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join("/")}var Y=function(){function e(t){if(_classCallCheck(this,e),!Object(v.c)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=X(this.modelPath)}var t,n;return _createClass(e,[{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=N(t),e.prev=3,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(S)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy},e.abrupt("return",(null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}));case 9:throw e.prev=9,e.t0=e.catch(3),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=").concat(a.modelTopologyBytes,", weightSpecsBytes=").concat(a.weightSpecsBytes,", weightDataBytes=").concat(a.weightDataBytes,"."));case 12:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(e){return n.apply(this,arguments)})},{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=8;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' is missing."));case 8:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=12;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' are missing."));case 12:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=18;break}throw new Error("In local storage, the binary weight values of model '".concat(this.modelPath,"' are missing."));case 18:return e.abrupt("return",(n.weightData=function(e){if(S){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),n));case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();Y.URL_SCHEME="localstorage://";var Q=function(e){return Object(v.c)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Y.URL_SCHEME)?(t=e.slice(Y.URL_SCHEME.length),new Y(t)):null;var t};R.registerSaveRouter(Q),R.registerLoadRouter(Q);var J=function(){function e(){_classCallCheck(this,e),Object(k.b)(Object(v.c)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Object(k.b)("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}var t,n;return _createClass(e,[{key:"listModels",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=W+"/",r="/"+U,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(t[Z(i)]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"removeModel",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=X(t=(n=t).startsWith(Y.URL_SCHEME)?n.slice(Y.URL_SCHEME.length):n),null!=this.LS.getItem(r.info)){e.next=3;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 3:return a=JSON.parse(this.LS.getItem(r.info)),e.abrupt("return",(this.LS.removeItem(r.info),this.LS.removeItem(r.topology),this.LS.removeItem(r.weightSpecs),this.LS.removeItem(r.weightData),a));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),$=function(){function e(){_classCallCheck(this,e),this.managers={}}return _createClass(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){Object(k.b)(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith("://")&&(t=t.slice(0,t.indexOf("://"))),Object(k.b)(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Object(k.b)(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function ee(e){if(-1===e.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+$.getSchemes().join(","));return{scheme:e.split("://")[0],path:e.split("://")[1]}}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>2&&void 0!==f[2]&&f[2],Object(k.b)(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),a=R.getLoadHandlers(t),Object(k.b)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),Object(k.b)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") load handlers for source URL ").concat(t,".")})),i=a[0],o=R.getSaveHandlers(n),Object(k.b)(o.length>0,(function(){return"Copying failed because no save handler is found for destination URL ".concat(n,".")})),Object(k.b)(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") save handlers for destination URL ").concat(n,".")})),s=o[0],u=ee(t).scheme,c=ee(t).path,l=u===ee(t).scheme,e.next=12,i.load();case 12:if(h=e.sent,e.t0=r&&l,!e.t0){e.next=17;break}return e.next=17,$.getManager(u).removeModel(c);case 17:return e.next=19,s.save(h);case 19:if(d=e.sent,e.t1=r&&!l,!e.t1){e.next=24;break}return e.next=24,$.getManager(u).removeModel(c);case 24:return e.abrupt("return",d.modelArtifactsInfo);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(){return ae.apply(this,arguments)}function ae(){return(ae=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=$.getSchemes(),n={},r=_createForOfIteratorHelper(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=12;break}return i=a.value,e.next=8,$.getManager(i).listModels();case 8:for(s in o=e.sent)n[i+"://"+s]=o[s];case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})))).apply(this,arguments)}function ie(e){return oe.apply(this,arguments)}function oe(){return(oe=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ee(t),e.abrupt("return",$.getManager(n.scheme).removeModel(n.path));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e,t){return ue.apply(this,arguments)}function ue(){return(ue=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,n,!1));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e,t){return le.apply(this,arguments)}function le(){return(le=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",te(t,n,!0));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var he,de=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(Object(v.c)().get("IS_BROWSER")){Object(v.c)().setPlatform("browser",new de);try{$.registerManager(Y.URL_SCHEME,new J)}catch($o){}try{$.registerManager(z.URL_SCHEME,new V)}catch($o){}}Object(v.c)().get("IS_NODE")&&Object(v.c)().setPlatform("node",new(function(){function e(){_classCallCheck(this,e),this.util=n(2)}return _createClass(e,[{key:"fetch",value:function(e,t){return null!=Object(v.c)().global.fetch?Object(v.c)().global.fetch(e,t):(null==he&&(he=n(1)),he(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder=new this.util.TextEncoder,this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),e}()));var fe=n("BD40"),pe=n("3rNm"),me=n("8Km0"),ve=n("dWjR"),ge=n("NNfn");Object(f.b)();var ye={buffer:fe.a,cast:pe.a,clone:me.a,print:ve.a};function be(e){return new Promise((function(e){return setTimeout(e)})).then(e)}Object(ge.e)(ye);var ke=function(){function e(t){if(_classCallCheck(this,e),!Object(v.c)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}var t;return _createClass(e,[{key:"save",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=5;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 5:return r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]},null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,e.next=12,be((function(){return i.dispatchEvent(new MouseEvent("click"))}));case 12:if(null==t.weightData){e.next=18;break}return(o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=n,e.next=18,be((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 18:return e.abrupt("return",{modelArtifactsInfo:N(t)});case 19:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();ke.URL_SCHEME="downloads://";var _e=function(){function e(t){if(_classCallCheck(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}var t;return _createClass(e,[{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.files[0],n=this.files.slice(1),e.abrupt("return",new Promise((function(e,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===n.length&&e({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=r.checkManifestAndWeightFiles(u,n)}catch($o){return void a($o)}var l=[],h=[],d=[];u.forEach((function(e){e.paths.forEach((function(e){h.push(e),d.push(null)})),l.push.apply(l,_toConsumableArray(e.weights))})),u.forEach((function(t){t.paths.forEach((function(t){var n=new FileReader;n.onload=function(n){var r=n.target.result,a=h.indexOf(t);if(d[a]=r,-1===d.indexOf(null)){var i={modelTopology:s,weightSpecs:l,weightData:I(d),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy};null!=o.signature&&(i.signature=o.signature),null!=o.userDefinedMetadata&&(i.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(i.modelInitializer=o.modelInitializer),e(i)}},n.onerror=function(e){return a("Failed to weights data from file of path '".concat(t,"'."))},n.readAsArrayBuffer(c[t])}))}))}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON from file '".concat(t.name,"'. BrowserFiles supports loading Keras-style tf.Model artifacts only."))},i.readAsText(t)})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"checkManifestAndWeightFiles",value:function(e,t){var n,r=[],a=t.map((function(e){return E(e.name)})),i={},o=_createForOfIteratorHelper(e);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(e){var n=E(e);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: '".concat(n,"'"));if(r.push(n),-1===a.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));i[e]=t[a.indexOf(n)]}))}}catch($o){o.e($o)}finally{o.f()}if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest (".concat(r.length,") and the number of weight files provided (").concat(t.length,")."));return i}}]),e}();function we(e){return new _e(e)}function xe(e,t,n,r){!function(e){Object(k.b)(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Object(k.b)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e})),Object(k.b)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t})),Object(k.b)(t>=e,(function(){return"startFraction must be no more than endFraction, but got startFraction ".concat(e," and endFraction ")+t}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function Ce(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?Object(v.c)().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),null!=n.onProgress){e.next=9;break}return e.next=6,Promise.all(a);case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,xe(a,n.onProgress,0,.5);case 11:e.t0=e.sent;case 12:if(i=e.t0.map((function(e){return e.arrayBuffer()})),null!=n.onProgress){e.next=19;break}return e.next=16,Promise.all(i);case 16:e.t1=e.sent,e.next=22;break;case 19:return e.next=21,xe(i,n.onProgress,.5,1);case 21:e.t1=e.sent;case 22:return e.abrupt("return",e.t1);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e){return Te.apply(this,arguments)}function Te(){return(Te=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"",r=i.length>2?i[2]:void 0,a=i.length>3?i[3]:void 0,e.abrupt("return",Ie((function(e){return Ce(e,{requestInit:a})}))(t,n,r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){return function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(n){var r,a,i,o,s,u,c,l,h,d,f,p,m=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=m.length>1&&void 0!==m[1]?m[1]:"",a=m.length>2?m[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r=_["quantization"in e?e.quantization.dtype:e.dtype]*k.N(e.shape),c=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:r})};null!=a?a.forEach((function(t,n){t===e.name&&(c(),s[n]=!0)})):c(),u.push(e.name),n+=r}))})),s.every((function(e){return e}))){t.next=6;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+u.join(", ")+".");case 6:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),h=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;h.push(t)}))})),t.next=10,e(h);case 10:return d=t.sent,f={},p=0,t.abrupt("return",(l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=d[p+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<t;c++){var l=new Uint8Array(d[p+c]);s.set(l,u),u+=l.byteLength}o[e].forEach((function(e){var t=C(i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)f[n]=t[n]})),p+=t})),f));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}R.registerSaveRouter((function(e){return Object(v.c)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ke.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new ke(e)}(e.slice(ke.URL_SCHEME.length)):null}));var Ee=function(){function e(t,n){if(_classCallCheck(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(Object(k.b)("function"==typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=Object(v.c)().platform.fetch,Object(k.b)(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&Object(k.b)(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}var t,n,r;return _createClass(e,[{key:"save",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]},null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=8,this.fetch(this.path,n);case 8:if(!(a=e.sent).ok){e.next=11;break}return e.abrupt("return",{modelArtifactsInfo:N(t),responses:[a]});case 11:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".");case 12:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"load",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s,u,c,l,h,d,f,p,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+t.status+". Please verify this URL points to the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 15:if(a=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,c=n.signature,l=n.userDefinedMetadata,null!=a||null!=i){e.next=18;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model topology or manifest for weights."));case 18:if(null==i){e.next=25;break}return e.next=21,this.loadWeights(i);case 21:f=e.sent,p=_slicedToArray(f,2),h=p[0],d=p[1];case 25:return m={modelTopology:a,weightSpecs:h,weightData:d,generatedBy:o,convertedBy:s,format:u},null!=c&&(m.signature=c),null!=l&&(m.userDefinedMetadata=l),v=n.modelInitializer,e.abrupt("return",(v&&(m.modelInitializer=v),m));case 29:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(){return n.apply(this,arguments)})},{key:"loadWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,_=void 0,w=void 0,_=(k=n).lastIndexOf("/"),w=k.lastIndexOf("?"),r=[k.substring(0,_)+"/",w>_?k.substring(w):""],a=_slicedToArray(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=[],c=_createForOfIteratorHelper(t);try{for(c.s();!(l=c.n()).done;)h=l.value,u.push.apply(u,_toConsumableArray(h.weights))}catch($o){c.e($o)}finally{c.f()}d=[],f=[],p=_createForOfIteratorHelper(t);try{for(p.s();!(m=p.n()).done;){v=m.value,g=_createForOfIteratorHelper(v.paths);try{for(g.s();!(y=g.n()).done;)b=y.value,null!=this.weightUrlConverter?f.push(this.weightUrlConverter(b)):d.push(s+b+o)}catch($o){g.e($o)}finally{g.f()}}}catch($o){p.e($o)}finally{p.f()}if(e.t0=this.weightUrlConverter,!e.t0){e.next=16;break}return e.t1=d.push,e.t2=d,e.t3=_toConsumableArray,e.next=13,Promise.all(f);case 13:e.t4=e.sent,e.t5=(0,e.t3)(e.t4),e.t1.apply.call(e.t1,e.t2,e.t5);case 16:return e.t6=u,e.t7=I,e.next=20,Ce(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 20:return e.t8=e.sent,e.t9=(0,e.t7)(e.t8),e.abrupt("return",[e.t6,e.t9]);case 23:case"end":return e.stop()}var k,_,w}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function Ne(e){return null!=e.match(Ee.URL_SCHEME_REGEX)}Ee.URL_SCHEME_REGEX=/^https?:\/\//;var Ae=function(e,t){if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return Ne(e)})):Ne(e))?Re(e,t):null};function Re(e,t){return new Ee(e,t)}function De(e,t){return Re(e,t)}R.registerSaveRouter(Ae),R.registerLoadRouter(Ae);var je=function(){function e(t){_classCallCheck(this,e),this.modelArtifacts=t}var t;return _createClass(e,[{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modelArtifacts);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Fe=function(){function e(t){_classCallCheck(this,e),this.saveHandler=t}var t;return _createClass(e,[{key:"save",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveHandler(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function Me(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new je(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new je({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new je({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function Pe(e){return new Fe(e)}var Le,ze=n("o/e8"),Be=n("SHv8"),Ve=n("4iwy"),We=n("VO80"),Ue=n("yRKQ"),He=Object(We.b)({confusionMatrix_:function(e,t,n){var r=Object(ze.a)(e,"labels","confusionMatrix"),a=Object(ze.a)(t,"predictions","confusionMatrix");k.b(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),k.b(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),k.b(1===a.rank,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),k.b(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: ".concat(r.shape[0]," vs. ").concat(a.shape[0],". Labels and predictions should have the same number of elements.")})),k.b(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=Object(Ve.a)(Object(pe.a)(r,"int32"),n),o=Object(Ve.a)(Object(pe.a)(a,"int32"),n),s=Object(Ue.a)(i),u=Object(Be.a)(s,o);return Object(pe.a)(u,"int32")}}),Ge=n("wFtI"),Ke=n("c7gn"),qe=n("BbuY");function Xe(e,t){return Ze.apply(this,arguments)}function Ze(){return(Ze=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(ze.a)(t,"img","toPixels"),t instanceof ge.a||(a=r,r=Object(pe.a)(a,"int32"),a.dispose()),2===r.rank||3===r.rank){e.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(i=r.shape.slice(0,2),o=_slicedToArray(i,2),s=o[0],u=o[1],!((c=2===r.rank?1:r.shape[2])>4||2===c)){e.next=7;break}throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+c);case 7:if("float32"===r.dtype||"int32"===r.dtype){e.next=9;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,". Please use float32 or int32 tensors."));case 9:return e.next=11,r.data();case 11:l=e.sent,h="float32"===r.dtype?255:1,d=new Uint8ClampedArray(u*s*4),f=0;case 15:if(!(f<s*u)){e.next=36;break}p=[0,0,0,255],m=0;case 18:if(!(m<c)){e.next=31;break}if(v=l[f*c+m],"float32"!==r.dtype){e.next=25;break}if(!(v<0||v>1)){e.next=23;break}throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ".concat(v,"."));case 23:e.next=27;break;case 25:if("int32"!==r.dtype||!(v<0||v>255)){e.next=27;break}throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ".concat(v,"."));case 27:1===c?(p[0]=v*h,p[1]=v*h,p[2]=v*h):p[m]=v*h;case 28:m++,e.next=18;break;case 31:d[(g=4*f)+0]=Math.round(p[0]),d[g+1]=Math.round(p[1]),d[g+2]=Math.round(p[2]),d[g+3]=Math.round(p[3]);case 33:++f,e.next=15;break;case 36:return null!=n&&(n.width=u,n.height=s,y=n.getContext("2d"),b=new ImageData(d,u,s),y.putImageData(b,0,0)),e.abrupt("return",(r!==t&&r.dispose(),d));case 38:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ye=Object(We.b)({fromPixels_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);s=!0}if(a){var u=2;if(a&&e.readyState<u)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=Object(Ke.c)(Ge.hb,f.a.backendName))return f.a.runKernel(Ge.hb,{pixels:e},{numChannels:t});var c,l,h=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],d=_slicedToArray(h,2),p=d[0],m=d[1];if(o?c=e.getContext("2d").getImageData(0,0,p,m).data:r||n?c=e.data:(i||a||s)&&(null==Le&&(Le=document.createElement("canvas").getContext("2d")),Le.canvas.width=p,Le.canvas.height=m,Le.drawImage(e,0,0,p,m),c=Le.getImageData(0,0,p,m).data),4===t)l=new Int32Array(c);else{var v=p*m;l=new Int32Array(v*t);for(var g=0;g<v;g++)for(var y=0;y<t;++y)l[g*t+y]=c[4*g+y]}var b=[m,p,t];return Object(qe.a)(l,b,"int32")}});function Qe(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: ".concat(t.shape[r-1]," vs. ").concat(n));if(0===Object(k.N)(e.shape))throw new Error("Requested more than 0 entries, but input is empty. Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,c=a.slice();c.pop();for(var l=1,h=i;h<n;++h)l*=u[h],c.push(u[h]);var d=[].concat(_toConsumableArray(Object(k.j)(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,d]}var Je=n("o0+U");function $e(e,t,n){var r=e.shape.length;k.b(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must match the rank of the array (").concat(r,").")})),k.b(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must match the rank of the array (").concat(r,").")}));for(var a=function(a){k.b(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] (").concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function et(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function tt(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function nt(e,t,n,r){for(var a=_toConsumableArray(e),i=a.length;i<r.length;i++)a.push(1);for(var o=0;o<n;o++)0===o?a[t]=1:(a.splice(t,0,1),a.pop());return a}function rt(e,t,n){return n<=e?n:n-(t-1)}function at(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function it(e,t,n,r,a,i,o,s,u){var c=e.length,l=new Array(c),h=new Array(c),d=new Array(c);if(t.length&&n>0){var f=t[0],p=n+1;l=ot(o,f,p,r,e),h=st(s,f,p,a,e),d=nt(i,f,p,e)}else for(var m=0;m<c;m++)l[m]=ct(o,r,i,e,m,u),h[m]=lt(s,a,i,e,m,u),d[m]=ut(i,m,u);return{begin:l,end:h,strides:d}}function ot(e,t,n,r,a){for(var i=_toConsumableArray(a),o=at(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{var u=rt(t,n,s),c=r[u];e&1<<u&&(c=0),i[s]=c}return i}function st(e,t,n,r,a){for(var i=_toConsumableArray(a),o=at(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{var u=rt(t,n,s),c=r[u];e&1<<u&&(c=Number.MAX_SAFE_INTEGER),i[s]=c}for(var l=0;l<i.length;l++){var h=a[l];i[l]<0&&(i[l]+=h),i[l]=k.i(0,i[l],a[l])}return i}function ut(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function ct(e,t,n,r,a,i){var o=t[a];(e&1<<a||i&1<<a||null==o)&&(o=(n[a]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return o<0&&(o+=s),o=k.i(0,o,s-1)}function lt(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=s>0?k.i(0,o,u):k.i(-1,o,u-1)}function ht(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function dt(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function ft(e,t,n){var r,a,i=e.shape.length;return(r="number"==typeof t?[t].concat(_toConsumableArray(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){k.b(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"==typeof n?[n].concat(_toConsumableArray(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(k.b(-1===t,(function(){return"Negative size values should be exactly -1 but got ".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function pt(e,t,n,r,a,i,o,s,u){var c=t.slice(),l=n.slice(),h=r;null==r&&(h=new Array(c.length));var d=et(o);if(d.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==s)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==u)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var f=e.length-c.length,p=et(s),m=e.slice();p.forEach((function(e){c[e]=0,l[e]=1,m.splice(e,0,1)}));var v=it(m,d,f,c,l,h,a,i,o),g=v.begin,y=v.end,b=v.strides;c=g,l=y,h=b;var k=et(u);k.forEach((function(e){l[e]=c[e]+1,h[e]=1}));var _=tt(c,l,h),w=_.filter((function(e,t){return-1===k.indexOf(t)}));return{nonStrided:h.every((function(e){return 1===e})),$begin:c,$end:l,$strides:h,size:_,newShape:m,outShape:w}}var mt=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),vt=function(){function e(){_classCallCheck(this,e),this.classNameMap={}}return _createClass(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function gt(e){Object(k.b)(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),Object(k.b)("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),Object(k.b)(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),vt.register(e)}var yt=n("dsKV"),bt=n("1WXW"),kt=n("6366"),_t=n("wE5H"),wt=n("kRdc"),xt=n("x3y4"),Ct=n("parS"),Ot=n("Fjpt"),St=n("k7Jv"),Tt=n("oJu+"),It=n("U45G"),Et=n("AV8V"),Nt=function(e){_inherits(o,e);var t,n,r,a,i=_createSuper(o);function o(){return _classCallCheck(this,o),i.apply(this,arguments)}return _createClass(o,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return Object(_t.d)(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return Object(It.f)(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&Object(_t.d)(this.iterations_)}},{key:"saveIterations",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Object(Et.a)(this.iterations_,"int32")}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getWeights",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"setWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"extractIterations",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),o}(mt);Object.defineProperty(Nt,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var At=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return _classCallCheck(this,a),(n=r.call(this)).learningRate=e,n.rho=t,n.epsilon=i,n.accumulatedGrads=[],n.accumulatedUpdates=[],null==i&&(n.epsilon=f.a.backend.epsilon()),n}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:Object(_t.t)((function(){return Object(Tt.a)(a).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:Object(_t.t)((function(){return Object(Tt.a)(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Object(_t.t)((function(){var e=Object(wt.a)(Object(Ct.a)(o,t.rho),Object(Ct.a)(Object(St.a)(i),1-t.rho)),n=Object(Ct.a)(Object(xt.a)(Object(Ot.a)(Object(wt.a)(s,t.epsilon)),Object(Ot.a)(Object(wt.a)(o,t.epsilon))),i),r=Object(wt.a)(Object(Ct.a)(s,t.rho),Object(Ct.a)(Object(St.a)(n),1-t.rho));o.assign(e),s.assign(r);var u=Object(wt.a)(Object(Ct.a)(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(Object(_t.d)(this.accumulatedGrads.map((function(e){return e.variable}))),Object(_t.d)(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(_toConsumableArray(this.accumulatedGrads),_toConsumableArray(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:e.t0=(t=e.sent).length,n=e.t0/2,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),a}(Nt);At.className="Adadelta",gt(At);var Rt=n("RrjA"),Dt=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return _classCallCheck(this,a),(t=r.call(this)).learningRate=e,t.initialAccumulatorValue=n,t.accumulatedGrads=[],t}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:Object(_t.t)((function(){return Object(Rt.a)(a.shape,t.initialAccumulatorValue).variable(!1)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Object(_t.t)((function(){var e=Object(wt.a)(o,Object(St.a)(i));o.assign(e);var n=Object(wt.a)(Object(Ct.a)(Object(xt.a)(i,Object(Ot.a)(Object(wt.a)(e,f.a.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&Object(_t.d)(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),a}(Nt);Dt.className="Adagrad",gt(Dt);var jt=n("yfHJ"),Ft=n("oAkI"),Mt=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,a),(i=r.call(this)).learningRate=e,i.beta1=t,i.beta2=n,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Object(_t.t)((function(){i.accBeta1=Object(Et.a)(t).variable(),i.accBeta2=Object(Et.a)(n).variable()})),null==o&&(i.epsilon=f.a.backend.epsilon()),i}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Object(_t.t)((function(){var r=Object(Ft.a)(1,t.accBeta1),a=Object(Ft.a)(1,t.accBeta2);n.forEach((function(n,i){var o=f.a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Object(_t.t)((function(){return Object(Tt.a)(o).variable(!1)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:Object(_t.t)((function(){return Object(Tt.a)(o).variable(!1)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=Object(wt.a)(Object(Ct.a)(u,t.beta1),Object(Ct.a)(s,1-t.beta1)),h=Object(wt.a)(Object(Ct.a)(c,t.beta2),Object(Ct.a)(Object(St.a)(s),1-t.beta2)),d=Object(xt.a)(l,r),p=Object(xt.a)(h,a);u.assign(l),c.assign(h);var m=Object(wt.a)(Object(Ct.a)(Object(xt.a)(d,Object(wt.a)(Object(Ot.a)(p),t.epsilon)),-t.learningRate),o);o.assign(m)}})),t.accBeta1.assign(Object(Ct.a)(t.accBeta1,t.beta1)),t.accBeta2.assign(Object(Ct.a)(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Object(_t.d)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&Object(_t.d)(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(_toConsumableArray(this.accumulatedFirstMoment),_toConsumableArray(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,Object(_t.t)((function(){r.accBeta1.assign(Object(jt.a)(r.beta1,r.iterations_+1)),r.accBeta2.assign(Object(jt.a)(r.beta2,r.iterations_+1))})),n=t.length/2,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),a}(Nt);Mt.className="Adam",gt(Mt);var Pt=n("iuCH"),Lt=n("CfTU"),zt=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return _classCallCheck(this,a),(i=r.call(this)).learningRate=e,i.beta1=t,i.beta2=n,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],Object(_t.t)((function(){i.iteration=Object(Et.a)(0).variable(),i.accBeta1=Object(Et.a)(t).variable()})),null==o&&(i.epsilon=f.a.backend.epsilon()),i}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Object(_t.t)((function(){var r=Object(Ft.a)(1,t.accBeta1),a=Object(xt.a)(-t.learningRate,Object(wt.a)(Object(Ct.a)(t.iteration,t.decay),1));n.forEach((function(n,i){var o=f.a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Object(Tt.a)(o).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:Object(Tt.a)(o).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=Object(wt.a)(Object(Ct.a)(u,t.beta1),Object(Ct.a)(s,1-t.beta1)),h=Object(Ct.a)(c,t.beta2),d=Object(Pt.a)(s),p=Object(Lt.a)(h,d);u.assign(l),c.assign(p);var m=Object(wt.a)(Object(Ct.a)(Object(xt.a)(a,r),Object(xt.a)(l,Object(wt.a)(p,t.epsilon))),o);o.assign(m)}})),t.iteration.assign(Object(wt.a)(t.iteration,1)),t.accBeta1.assign(Object(Ct.a)(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Object(_t.d)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&Object(_t.d)(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),a}(Nt);zt.className="Adamax",gt(zt);var Bt=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t;return _classCallCheck(this,a),(t=r.call(this)).learningRate=e,t.setLearningRate(e),t}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=f.a.registeredVariables[n];Object(_t.t)((function(){var e=Object(wt.a)(Object(Ct.a)(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Object(_t.l)(Object(Et.a)(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(e.t0=(t=e.sent).length,0===e.t0){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),a}(Nt);Bt.className="SGD",gt(Bt);var Vt=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _classCallCheck(this,a),(n=r.call(this,e)).learningRate=e,n.momentum=t,n.useNesterov=i,n.accumulations=[],n.m=Object(Et.a)(n.momentum),n}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:n+"/momentum",variable:Object(_t.t)((function(){return Object(Tt.a)(a).variable(!1)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Object(_t.t)((function(){var e,n=Object(wt.a)(Object(Ct.a)(t.m,i),o);e=t.useNesterov?Object(wt.a)(Object(Ct.a)(t.c,Object(wt.a)(o,Object(Ct.a)(n,t.m))),a):Object(wt.a)(Object(Ct.a)(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&Object(_t.d)(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),a}(Bt);Vt.className="Momentum",gt(Vt);var Wt=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,a),(t=r.call(this)).learningRate=e,t.decay=n,t.momentum=i,t.epsilon=o,t.accumulatedMeanSquares=[],t.accumulatedMoments=[],t.accumulatedMeanGrads=[],t.centered=s,null==o&&(t.epsilon=f.a.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return _possibleConstructorReturn(t)}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=f.a.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:Object(_t.t)((function(){return Object(Tt.a)(a).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:Object(_t.t)((function(){return Object(Tt.a)(a).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:Object(_t.t)((function(){return Object(Tt.a)(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;Object(_t.t)((function(){var e=Object(wt.a)(Object(Ct.a)(o,t.decay),Object(Ct.a)(Object(St.a)(i),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=Object(wt.a)(Object(Ct.a)(n,t.decay),Object(Ct.a)(i,1-t.decay)),c=Object(xt.a)(Object(Ct.a)(i,t.learningRate),Object(Ot.a)(Object(Ft.a)(e,Object(wt.a)(Object(St.a)(u),t.epsilon)))),l=Object(wt.a)(Object(Ct.a)(s,t.momentum),c);o.assign(e),n.assign(u),s.assign(l);var h=Object(Ft.a)(a,l);a.assign(h)}else{var d=Object(wt.a)(Object(Ct.a)(o,t.decay),Object(Ct.a)(Object(St.a)(i),1-t.decay)),f=Object(wt.a)(Object(Ct.a)(s,t.momentum),Object(xt.a)(Object(Ct.a)(i,t.learningRate),Object(Ot.a)(Object(wt.a)(d,t.epsilon))));o.assign(d),s.assign(f);var p=Object(Ft.a)(a,f);a.assign(p)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&Object(_t.d)(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Object(_t.d)(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&Object(_t.d)(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(_toConsumableArray(this.accumulatedMeanSquares),_toConsumableArray(this.accumulatedMoments)),this.centered&&t.push.apply(t,_toConsumableArray(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),a}(Nt);Wt.className="RMSProp",gt(Wt);var Ut=n("I79q"),Ht=n("EysY"),Gt=n("V+B2"),Kt=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"sgd",value:function(e){return new Bt(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Vt(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Wt(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Mt(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new At(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new zt(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new Dt(e,t)}}]),e}(),qt={sgd:Kt.sgd,momentum:Kt.momentum,adadelta:Kt.adadelta,adagrad:Kt.adagrad,rmsprop:Kt.rmsprop,adamax:Kt.adamax,adam:Kt.adam},Xt="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(e){return e()};function Zt(){return new Promise((function(e){return Xt((function(){return e()}))}))}var Yt=n("Wiw4"),Qt=n("NuWS"),Jt=n("Um8L");function $t(e,t){var n=e[0].length;e.forEach((function(e,t){k.b(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same as the rank of the rest (").concat(n,")")}))})),k.b(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)k.b(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") does not match the shape of the rest (").concat(r,") along the non-concatenated axis ").concat(a,".")}))}))}function en(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}var tn=n("uBja"),nn=n("R0ls"),rn=30;function an(e){return e<=rn?e:Object(k.G)(e,Math.floor(Math.sqrt(e)))}function on(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}function sn(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function un(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],s=1;s<e;++s)s>=2*t+1||s%2==1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function cn(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];a.push(r?e[0]/n:e[0]*n);for(var i=1;i<e.length;++i)a.push(i<=t.length?r?t[i-1]*e[i]:e[i]/t[i-1]:e[i]);return a}function ln(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function hn(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var dn=1.7580993408473768,fn=1.0507009873554805,pn=.3275911,mn=.254829592,vn=-.284496736,gn=1.421413741,yn=-1.453152027,bn=1.061405429;function kn(){var e;Object(v.c)().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function _n(){var e;Object(v.c)().getBool("IS_TEST")||(e=console).log.apply(e,arguments)}function wn(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function xn(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function Cn(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function On(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function Sn(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Tn(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function In(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function En(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function Nn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"==typeof t)Object(k.b)(e.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);Object(k.b)(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}Object(k.b)(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function An(e,t){var n,r=!1;for(e<=rn?(n=e,r=!0):n=Object(k.G)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Object(k.G)(e,n+1);return n}function Rn(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)r.push(i!==t?e[i]:n);return r}function Dn(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],c=1,l=1,h=1,d=0;d<r;++d)u.push(e.shape[d]),c*=e.shape[d];for(var f=r;f<n;f++)u.push(e.shape[f]),l*=e.shape[f];for(var p=r;p<a;p++)u.push(t.shape[p]);for(var m=n+1;m<i;m++)u.push(e.shape[m]),h*=e.shape[m];return{batchSize:c,sliceSize:h,outerSize:l,dimSize:s,outputShape:u}}function jn(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=Object(Yt.a)(e.shape),a=Object(pe.a)(e,"float32"),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!Object(k.p)(e.dtype,t))return f.a.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var o=n.real(e),s=Object(pe.a)(o,t);return o.dispose(),s}if("int32"===t)return n.int(e);if("bool"===t){var u=Object(Et.a)(0,e.dtype),c=n.notEqual(e,u);return u.dispose(),c}throw new Error("Error in Cast: failed to cast ".concat(e.dtype," to ").concat(t))}function Fn(e,t){return f.a.makeTensorFromDataId(e.dataId,t,e.dtype)}function Mn(e){try{return e.map((function(e){return Object(kt.decodeString)(e)}))}catch($o){throw new Error("Failed to decode encoded string bytes into utf-8, error: "+$o)}}function Pn(e){return e.map((function(e){return Object(kt.encodeString)(e)}))}var Ln=n("g4m1"),zn=n("AoCb"),Bn=n("i4e/"),Vn=n("L7Hl"),Wn={kernelName:Ge.a,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(e,Object(Vn.a)(Object(pe.a)(n,"float32"),-1))}}}},Un=n("O7f5"),Hn={kernelName:Ge.b,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){var t=Object(St.a)(Object(pe.a)(n,"float32")),r=Object(Ot.a)(Object(Ft.a)(Object(Et.a)(1),t));return Object(Un.a)(Object(xt.a)(e,r))}}}},Gn={kernelName:Ge.c,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){var t=Object(Ot.a)(Object(Ft.a)(Object(St.a)(Object(pe.a)(n,"float32")),1));return Object(xt.a)(e,t)}}}},Kn=n("NclT"),qn=n("4FMF"),Xn={kernelName:Ge.d,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Jt.a(r.shape,a.shape);return{a:function(){var t=e,n=Jt.c(r.shape,i);return n.length>0&&(t=Object(qn.a)(t,n)),Object(Kn.a)(t,r.shape)},b:function(){var t=e,n=Jt.c(a.shape,i);return n.length>0&&(t=Object(qn.a)(t,n)),Object(Kn.a)(t,a.shape)}}}},Zn={kernelName:Ge.e,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},Yn={kernelName:Ge.h,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Tt.a)(n)}}}},Qn={kernelName:Ge.i,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Tt.a)(n)}}}},Jn={kernelName:Ge.j,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(Ot.a)(Object(Ft.a)(Object(Et.a)(1),Object(St.a)(Object(pe.a)(n,"float32")))))}}}},$n={kernelName:Ge.k,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){var t=Object(Ot.a)(Object(wt.a)(Object(Et.a)(1),Object(St.a)(Object(pe.a)(n,"float32"))));return Object(xt.a)(e,t)}}}},er={kernelName:Ge.m,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Object(Jt.a)(r.shape,a.shape);return{a:function(){var t=Object(wt.a)(Object(St.a)(r),Object(St.a)(a)),n=Object(Ct.a)(e,Object(xt.a)(a,t)),o=Object(Jt.c)(r.shape,i);return o.length>0&&(n=Object(qn.a)(n,o)),Object(Kn.a)(n,r.shape)},b:function(){var t=Object(wt.a)(Object(St.a)(r),Object(St.a)(a)),n=Object(Un.a)(Object(Ct.a)(e,Object(xt.a)(r,t))),o=Object(Jt.c)(a.shape,i);return o.length>0&&(n=Object(qn.a)(n,o)),Object(Kn.a)(n,a.shape)}}}},tr={kernelName:Ge.l,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(wt.a)(Object(St.a)(Object(pe.a)(n,"float32")),1))}}}},nr={kernelName:Ge.n,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(Ft.a)(Object(Et.a)(1),Object(St.a)(Object(pe.a)(n,"float32"))))}}}},rr=Object(We.b)({avgPool3dGrad_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1],i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=Object(ze.a)(e,"dy","avgPool3dGrad"),u=Object(ze.a)(t,"input","avgPool3dGrad"),c=s,l=u,h=!1;4===u.rank&&(h=!0,c=Object(Kn.a)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),l=Object(Kn.a)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),k.b(5===c.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+c.rank+"."})),k.b(5===l.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+l.rank+"."})),k.b(tn.h(r,a),(function(){return"Error in avgPool3dGrad: Either strides or dilations must be 1. Got strides ".concat(r," and dilations '").concat(a,"'")})),null!=o&&k.b(k.v(i),(function(){return"Error in avgPool3dGrad: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var d=f.a.runKernel(Ge.q,{dy:c,input:l},{filterSize:n,strides:r,dilations:a,pad:i,dimRoundingMode:o});return h?Object(Kn.a)(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),ar={kernelName:Ge.p,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.filterSize,i=n.strides,o=n.dilations,s=n.pad,u=n.dimRoundingMode,c=null==o?[1,1,1]:o;return{x:function(){return rr(e,r,a,i,c,s,u)}}}},ir=Object(We.b)({avgPoolGrad_:function(e,t,n,r,a){var i=Object(ze.a)(e,"dy","avgPoolGrad"),o=Object(ze.a)(t,"input","avgPoolGrad");k.b(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var s=o,u=i,c=!1;3===o.rank&&(c=!0,s=Object(Kn.a)(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=Object(Kn.a)(i,[1,i.shape[0],i.shape[1],i.shape[2]])),k.b(4===u.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+u.rank+"."})),k.b(4===s.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+s.rank+"."}));var l=f.a.runKernel(Ge.r,{dy:u,input:s},{filterSize:n,strides:r,pad:a});return c?Object(Kn.a)(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),or={kernelName:Ge.o,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return ir(e,r,a,i,o)}}}},sr={kernelName:Ge.s,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return Object(Be.a)(e,i,!1,!1)},b:function(){return Object(Be.a)(e,a,!0,!1)}}:o&&!s?{a:function(){return Object(Be.a)(i,e,!1,!0)},b:function(){return Object(Be.a)(a,e,!1,!1)}}:{a:function(){return Object(Be.a)(i,e,!0,!0)},b:function(){return Object(Be.a)(e,a,!0,!0)}}:{a:function(){return Object(Be.a)(e,i,!1,!0)},b:function(){return Object(Be.a)(a,e,!0,!1)}}}},ur=n("dYAU"),cr={kernelName:Ge.t,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return Object(ur.a)(e,r,a)}}}},lr={kernelName:Ge.v,gradFunc:function(e,t,n){for(var r=n.inputShape,a=n.shape,i=Array.from(a),o=r.length-1;o>=0;o--)if(r[o]===a[o])i[o]=1;else if(1!==r[o])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(a,"]."));for(var s=[],u=0;u<i.length;u++)i[u]>1&&s.push(u);return{x:function(){return Object(qn.a)(e,s,!0)}}}},hr={kernelName:Ge.w,gradFunc:function(e){return{x:function(){return e.clone()}}}},dr={kernelName:Ge.x,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},fr=n("uy0A"),pr=n("shz4"),mr=n("4zPZ"),vr=n("Z5Ez"),gr={kernelName:Ge.y,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return Object(vr.a)(Object(mr.a)(Object(fr.a)(r,a),Object(pr.a)(r,i)),e,Object(Tt.a)(e))}}}},yr={kernelName:Ge.A,inputsToSave:["x"],gradFunc:Wn.gradFunc},br=n("RbuM"),kr={kernelName:Ge.B,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=n.axis,i=Object(k.I)(a,t[0].shape)[0],o=r.map((function(e){return e[i]}));return Object(br.a)(e,o,i).map((function(e){return function(){return e}}))}},_r=n("D2/b"),wr=n("c9N1"),xr={kernelName:Ge.C,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.dilations,s=n.strides,u=n.pad,c=n.dataFormat;return k.b(tn.i(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return Object(wr.a)(a.shape,e,i,s,u,c)},filter:function(){return Object(_r.a)(a,e,i.shape,s,u,c)}}}},Cr=n("3X4V"),Or={kernelName:Ge.E,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.strides,s=n.pad,u=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return Object(Cr.a)(e,i,o,s,u,1,c)},filter:function(){return Object(_r.a)(e,a,i.shape,o,s,u,c)}}}},Sr=Object(We.b)({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=Object(Kn.a)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;return 4===o.rank&&(o=Object(Kn.a)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),k.b(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),k.b(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),k.b(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),k.b(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must match input depth in filter (").concat(n[3],".")})),k.b(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must match output depth for filter (").concat(n[4],").")})),f.a.runKernel(Ge.G,{x:i,dy:o},{strides:r,pad:a,filterShape:n})}}),Tr=n("mdDO"),Ir={kernelName:Ge.F,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;k.b(Object(tn.i)(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=_slicedToArray(t,2),s=o[0],u=o[1];return{x:function(){return Object(Tr.a)(s.shape,e,u,a,i)},filter:function(){return Sr(s,e,u.shape,a,i)}}}},Er=n("aTLu"),Nr={kernelName:Ge.I,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(Object(Un.a)(Object(Er.a)(Object(pe.a)(n,"float32"))),e)}}}},Ar=n("XcSs"),Rr={kernelName:Ge.J,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(Object(Ar.a)(Object(pe.a)(n,"float32")),e)}}}},Dr=n("HmhO"),jr={kernelName:Ge.L,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=Object(Qt.f)([a],r.rank),n=Object(Dr.a)(e,a,i,!o);return null!=t&&(n=Object(Ue.a)(n,t)),n}}}},Fr=n("aSZd"),Mr=n("jLCh"),Pr={kernelName:Ge.O,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;k.b(tn.i(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '".concat(s,"'")}));var u=_slicedToArray(t,2),c=u[0],l=u[1];return k.b(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ".concat(c.rank,".")})),k.b(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ".concat(l.rank,".")})),k.b(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input channels (".concat(c.shape[3],") must match the inChannels dimension in filter ").concat(l.shape[2],".")})),k.b(tn.h(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ".concat(a," and dilations '").concat(s,"'.")})),null!=o&&k.b(k.v(i),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")})),{x:function(){return Object(Mr.a)(c.shape,e,l,a,i,r,o)},filter:function(){return Object(Fr.a)(c,e,l.shape,a,i,r,o)}}}},Lr={kernelName:Ge.S,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o={x:a,filter:i,dy:e},s={x:a,filter:i,dy:e};return{x:function(){return f.a.runKernel(Ge.U,o,n)},filter:function(){return f.a.runKernel(Ge.T,s,n)}}}},zr={kernelName:Ge.V,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:_slicedToArray(t,1)[0]};return{x:function(){return f.a.runKernel(Ge.W,n)}}}},Br=n("TyAZ"),Vr={kernelName:Ge.Y,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0],r=Object(Ct.a)(Object(Br.a)(Object(Un.a)(Object(St.a)(n))),2/Math.sqrt(Math.PI));return{x:function(){return Object(Ct.a)(e,r)}}}},Wr={kernelName:Ge.Z,outputsToSave:[!0],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(e,n)}}}},Ur={kernelName:Ge.ab,inputsToSave:["input"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{input:function(){return Object(Kn.a)(e,n.shape)}}}},Hr={kernelName:Ge.bb,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(e,Object(Br.a)(n))}}}},Gr={kernelName:Ge.fb,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},Kr={kernelName:Ge.gb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Object(Jt.a)(r.shape,a.shape);return{a:function(){var t=Object(xt.a)(e,Object(pe.a)(a,"float32")),n=Object(Jt.c)(r.shape,i);return n.length>0?Object(Kn.a)(Object(qn.a)(t,n),r.shape):t},b:function(){var t=Object(Ct.a)(e,Object(pe.a)(r,"float32")),n=Object(Jt.c)(a.shape,i);n.length>0&&(t=Object(Kn.a)(Object(qn.a)(t,n),a.shape));var o=Object(St.a)(a);return Object(Un.a)(Object(xt.a)(t,Object(pe.a)(o,"float32")))}}}},qr=n("Xyqe"),Xr=n("jXH2"),Zr={kernelName:Ge.ib,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=_slicedToArray(t,4),i=a[0],o=a[1],s=a[2],u=a[3],c=null==u?Object(Et.a)(1):u,l=Object(Jt.c)(o.shape,i.shape),h=[];if(1===o.rank){for(var d=0;d<i.shape.length-1;++d)h.push(i.shape[d]);h.push(1)}var f=Object(Ft.a)(i,o),p=Object(Ct.a)(e,c),m=Object(qr.a)(Object(wt.a)(s,Object(Et.a)(r))),v=Object(Ct.a)(Object(Ct.a)(Object(Ct.a)(m,m),m),Object(Et.a)(-.5));return{x:function(){return 1===o.rank?Object(Kn.a)(Object(Ct.a)(Object(Ct.a)(e,Object(Xr.a)(Object(Kn.a)(m,[1,1,1,o.shape[0]]),h)),c),i.shape):Object(Kn.a)(Object(Ct.a)(Object(Ct.a)(e,m),c),i.shape)},mean:function(){var e=Object(Ct.a)(Object(Ct.a)(m,Object(Et.a)(-1)),p);return 1===o.rank&&(e=Object(qn.a)(e,l)),Object(Kn.a)(e,o.shape)},variance:function(){var e=Object(Ct.a)(Object(Ct.a)(v,f),p);return 1===o.rank&&(e=Object(qn.a)(e,l)),Object(Kn.a)(e,o.shape)},scale:function(){var t=Object(Ct.a)(f,m),n=Object(Ct.a)(e,t);return 1===o.rank&&(n=Object(qn.a)(n,l)),Object(Kn.a)(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=Object(qn.a)(t,l)),Object(Kn.a)(t,o.shape)}}}},Yr=n("U/Lz"),Qr={kernelName:Ge.mb,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.axis,s=Object(k.I)(o,a.shape)[0];return{x:function(){var t=a.shape,n=i.size,r=t.slice(0,s),u=r.length,c=t.slice(o,t.length).slice(1),l=c.length,h=Jr(0,u),d=Jr(u+1,u+1+l),f=$r([r,[n],c]),p=Object(Kn.a)(e,f),m=Object(Kn.a)(i,[n]),v=$r([[u],h,d]),g=Object(Ue.a)(p,v),y=Object(Yr.a)(g,m,a.shape[s]),b=Object(Qt.h)(v);return y=Object(Ue.a)(y,b)},indices:function(){return i}}}};function Jr(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function $r(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var ea={kernelName:Ge.ob,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1];return{a:function(){return Object(Tt.a)(r)},b:function(){return Object(Tt.a)(a)}}}},ta={kernelName:Ge.qb,gradFunc:function(e){return{x:function(){return Object(pe.a)(e,"float32")}}}},na={kernelName:Ge.sb,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},ra={kernelName:Ge.tb,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},aa={kernelName:Ge.ub,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},ia=n("zvA9"),oa={kernelName:Ge.xb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.alpha,i=Object(ia.a)(r,0);return{x:function(){return Object(vr.a)(i,e,Object(Ct.a)(e,a))}}}},sa={kernelName:Ge.Cb,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(wt.a)(n,1))}}}},ua={kernelName:Ge.Bb,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(pe.a)(n,"float32"))}}}},ca={kernelName:Ge.Db,inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.axis;return{logits:function(){var t=Object(Br.a)(r);return Object(Ft.a)(e,Object(Ct.a)(Object(qn.a)(e,a,!0),t))}}}},la=Object(We.b)({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5;return f.a.runKernel(Ge.wb,{x:e,y:t,dy:n},{depthRadius:r,bias:a,alpha:i,beta:o})}}),ha={kernelName:Ge.vb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,c=n.beta;return{x:function(){return la(a,i,e,o,s,u,c)}}}},da=n("ubnP");function fa(e,t,n,r){return t.rank<n.rank&&(t=Object(Kn.a)(t,Qt.e(t.shape,r))),e.rank<n.rank&&(e=Object(Kn.a)(e,Qt.e(e.shape,r))),{x:function(){return Object(Ct.a)(e,Object(pe.a)(Object(da.a)(n,t),e.dtype))}}}for(var pa={kernelName:Ge.Hb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=fa(e,t[1],a,k.I(r,a.shape));return{x:function(){return i.x()}}}},ma=n("4f3O"),va={kernelName:Ge.Nb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1];return{a:function(){return Object(Ct.a)(e,Object(pe.a)(Object(fr.a)(r,a),"float32"))},b:function(){return Object(Ct.a)(e,Object(pe.a)(Object(ma.a)(r,a),"float32"))}}}},ga=Object(We.b)({maxPool3dGrad_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=Object(ze.a)(e,"dy","maxPool3dGrad"),c=Object(ze.a)(t,"input","maxPool3dGrad"),l=Object(ze.a)(n,"output","maxPool3dGrad"),h=u,d=c,p=l,m=!1;4===c.rank&&(m=!0,h=Object(Kn.a)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),d=Object(Kn.a)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),p=Object(Kn.a)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),k.b(5===h.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+h.rank+"."})),k.b(5===d.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+d.rank+"."})),k.b(5===p.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+p.rank+"."})),k.b(tn.h(a,i),(function(){return"Error in maxPool3dGrad: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '").concat(i,"'")})),null!=s&&k.b(k.v(o),(function(){return"Error in maxPool3dGrad: pad must be an integer when using, dimRoundingMode ".concat(s," but got pad ").concat(o,".")}));var v=f.a.runKernel(Ge.Kb,{dy:h,input:d,output:p},{filterSize:r,strides:a,dilations:i,pad:o,dimRoundingMode:s});return m?Object(Kn.a)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}}),ya={kernelName:Ge.Jb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.dilations,c=n.pad,l=n.dimRoundingMode,h=null==u?[1,1,1]:u;return{x:function(){return ga(e,a,i,o,s,h,c,l)}}}},ba=Object(We.b)({maxPoolGrad_:function(e,t,n,r,a,i,o){var s=Object(ze.a)(e,"dy","maxPoolGrad"),u=Object(ze.a)(t,"input","maxPoolGrad"),c=Object(ze.a)(n,"output","maxPoolGrad");return k.b(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy (").concat(s.rank,")")})),k.b(4===s.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+s.rank+"."})),k.b(4===u.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+u.rank+"."})),null!=o&&k.b(k.v(i),(function(){return"Error in maxPoolGrad: pad must be an integer when using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")})),f.a.runKernel(Ge.Lb,{dy:s,input:u,output:c},{filterSize:r,strides:a,pad:i,dimRoundingMode:o})}}),ka={kernelName:Ge.Ib,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return ba(e,a,i,o,s,u)}}}},_a=n("wion"),wa={kernelName:Ge.Ob,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.axis,i=k.I(a,r.shape),o=Object(Qt.d)(r.shape,i),s=k.N(o[1]);return{x:function(){var t=r.shape.slice();i.forEach((function(e){t[e]=1}));var n=Object(Kn.a)(e,t);return Object(xt.a)(Object(Ct.a)(n,Object(_a.a)(r.shape,"float32")),s)}}}},xa={kernelName:Ge.Pb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=_slicedToArray(t,2),i=a[0],o=fa(e,a[1],i,k.I(r,i.shape));return{x:function(){return o.x()}}}},Ca={kernelName:Ge.Qb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1];return{a:function(){return Object(Ct.a)(e,Object(pe.a)(Object(pr.a)(r,a),"float32"))},b:function(){return Object(Ct.a)(e,Object(pe.a)(Object(ia.a)(r,a),"float32"))}}}},Oa=n("bTzI"),Sa={kernelName:Ge.Rb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Object(Oa.a)(e,a,r.shape)}}}},Ta=n("02mo"),Ia={kernelName:Ge.Sb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Object(Jt.a)(r.shape,a.shape);return{a:function(){var t=Object(Jt.c)(r.shape,i);return t.length>0?Object(Kn.a)(Object(qn.a)(e,t),r.shape):e},b:function(){var t=Object(Ct.a)(e,Object(Un.a)(Object(Ta.a)(Object(xt.a)(r,a)))),n=Object(Jt.c)(a.shape,i);return n.length>0?Object(Kn.a)(Object(qn.a)(t,n),a.shape):t}}}},Ea={kernelName:Ge.Ub,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Object(Jt.a)(r.shape,a.shape);return{a:function(){var t=Object(Ct.a)(e,Object(pe.a)(a,"float32")),n=Object(Jt.c)(r.shape,i);return n.length>0?Object(Kn.a)(Object(qn.a)(t,n),r.shape):t},b:function(){var t=Object(Ct.a)(e,Object(pe.a)(r,"float32")),n=Object(Jt.c)(a.shape,i);return n.length>0?Object(Kn.a)(Object(qn.a)(t,n),a.shape):t}}}},Na={kernelName:Ge.Vb,gradFunc:function(e){return{x:function(){return Object(Un.a)(e)}}}},Aa={kernelName:Ge.ac,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Object(Yt.a)(n.shape,"float32")}}}},Ra={kernelName:Ge.bc,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},Da=n("OkRW"),ja={kernelName:Ge.cc,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return Object(Da.a)(e,r).map((function(e){return function(){return e}}))}},Fa={kernelName:Ge.dc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Object(Oa.a)(e,a,r.shape)}}}},Ma=n("E1lT"),Pa={kernelName:Ge.fc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=_slicedToArray(t,3),r=n[0],a=n[1],i=n[2],o=r,s=a,u=Jt.a(o.shape,s.shape);return{a:function(){var t=Object(pe.a)(s,"float32"),n=Object(Ct.a)(e,Object(Ct.a)(t,Object(jt.a)(o,Object(Ft.a)(t,Object(Et.a)(1))))),r=Jt.c(o.shape,u);return r.length>0&&(n=Object(qn.a)(n,r)),Object(Kn.a)(n,o.shape)},b:function(){var t=Object(ia.a)(o,0),n=Object(vr.a)(t,Object(Ma.a)(o),Object(Tt.a)(o)),r=Object(Ct.a)(e,Object(Ct.a)(i,n)),a=Jt.c(s.shape,u);return a.length>0&&(r=Object(qn.a)(r,a)),Object(Kn.a)(r,s.shape)}}}},La={kernelName:Ge.gc,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Object(ia.a)(r,0);return{x:function(){return Object(vr.a)(i,e,Object(Ct.a)(e,a))},alpha:function(){var t=Object(vr.a)(i,Object(Tt.a)(e),Object(Ct.a)(e,r)),n=Object(Jt.c)(a.shape,e.shape);return n.length>0&&(t=Object(qn.a)(t,n)),Object(Kn.a)(t,a.shape)}}}},za={kernelName:Ge.kc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Jt.a(r.shape,a.shape);return{a:function(){var t=Object(xt.a)(e,Object(pe.a)(a,"float32")),n=Jt.c(r.shape,i);return n.length>0?Object(Kn.a)(Object(qn.a)(t,n),r.shape):t},b:function(){var t=Object(Ct.a)(e,Object(pe.a)(r,"float32")),n=Jt.c(a.shape,i);n.length>0&&(t=Object(Kn.a)(Object(qn.a)(t,n),a.shape));var o=Object(St.a)(a);return Object(Un.a)(Object(xt.a)(t,Object(pe.a)(o,"float32")))}}}},Ba={kernelName:Ge.lc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(Un.a)(Object(St.a)(n)))}}}},Va={kernelName:Ge.nc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0],r=Object(Ct.a)(Object(pr.a)(n,6),Object(Vn.a)(n));return{x:function(){return Object(Ct.a)(e,Object(pe.a)(r,"float32"))}}}},Wa={kernelName:Ge.mc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(e,Object(pe.a)(Object(Vn.a)(n),"float32"))}}}},Ua={kernelName:Ge.oc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Kn.a)(e,n.shape)}}}},Ha={kernelName:Ge.pc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:_slicedToArray(t,1)[0]};return{images:function(){return f.a.runKernel(Ge.qc,r,n)}}}},Ga={kernelName:Ge.rc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:_slicedToArray(t,1)[0]};return{images:function(){return f.a.runKernel(Ge.sc,r,n)}}}},Ka=n("0I63"),qa={kernelName:Ge.tc,gradFunc:function(e,t,n){var r=n.dims,a=Object(k.I)(r,e.shape);return{x:function(){return Object(Ka.a)(e,a)}}}},Xa={kernelName:Ge.vc,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},Za={kernelName:Ge.wc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Un.a)(Object(xt.a)(e,Object(Ct.a)(Object(jt.a)(n,1.5),2)))}}}},Ya=n("7wDt"),Qa={kernelName:Ge.yc,inputsToSave:["condition"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{condition:function(){return Object(pe.a)(Object(Tt.a)(n),"float32")},t:function(){return Object(Ct.a)(e,Object(pe.a)(n,e.dtype))},e:function(){return Object(Ct.a)(e,Object(pe.a)(Object(Ya.a)(n),e.dtype))}}}},Ja={kernelName:Ge.zc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){var t=Object(ia.a)(n,Object(Et.a)(0)),r=Object(Et.a)(dn),a=Object(Et.a)(fn),i=Object(Ct.a)(e,a),o=Object(Ct.a)(Object(Ct.a)(e,r),Object(Br.a)(Object(pe.a)(n,"float32")));return Object(vr.a)(t,i,o)}}}},$a={kernelName:Ge.Ac,outputsToSave:[!0],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(e,Object(Ct.a)(n,Object(Ft.a)(Object(Et.a)(1),n)))}}}},ei={kernelName:Ge.Bc,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},ti=n("7/dO"),ni={kernelName:Ge.Cc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(Object(ti.a)(Object(pe.a)(n,"float32")),e)}}}},ri=n("waK1"),ai={kernelName:Ge.Dc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(Object(ri.a)(Object(pe.a)(n,"float32")),e)}}}},ii=n("DrVt"),oi={kernelName:Ge.Ec,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=_slicedToArray(t,1)[0],a=n.begin,i=n.size,o=r.shape,s=_slicedToArray(ft(r,a,i),2),u=s[0],c=s[1],l=[],h=0;h<e.rank;h++)l.push([u[h],o[h]-u[h]-c[h]]);return{x:function(){return Object(ii.a)(e,l)}}}},si={kernelName:Ge.Fc,outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.dim,i=Object(Ct.a)(e,r);return{logits:function(){return Object(Ft.a)(i,Object(Ct.a)(Object(qn.a)(i,[a],!0),r))}}}},ui=n("/7N0"),ci={kernelName:Ge.Gc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(e,Object(ui.a)(n))}}}},li=n("OygE"),hi={kernelName:Ge.Hc,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return Object(li.a)(e,r,a)}}}},di=n("ZJ6U"),fi={kernelName:Ge.Jc,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return Object(di.a)(e,r)}}}},pi={kernelName:Ge.Kc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(Ct.a)(Object(Ot.a)(Object(pe.a)(n,"float32")),2))}}}},mi={kernelName:Ge.Lc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(e,Object(Ct.a)(Object(pe.a)(n,"float32"),2))}}}},vi={kernelName:Ge.Mc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Object(Et.a)(2);return{a:function(){return Object(Ct.a)(e,Object(Ct.a)(i,Object(Ft.a)(r,a)))},b:function(){return Object(Ct.a)(e,Object(Ct.a)(i,Object(Ft.a)(a,r)))}}}},gi={kernelName:Ge.Nc,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}},yi={kernelName:Ge.Pc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=Jt.a(r.shape,a.shape);return{a:function(){var t=e,n=Jt.c(r.shape,i);return n.length>0&&(t=Object(qn.a)(t,n)),Object(Kn.a)(t,r.shape)},b:function(){var t=e,n=Jt.c(a.shape,i);return n.length>0&&(t=Object(qn.a)(t,n)),Object(Kn.a)(Object(Un.a)(t),a.shape)}}}},bi={kernelName:Ge.Qc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=r.shape.slice(),i=n.axis;Object(k.I)(i,r.shape).forEach((function(e){a[e]=1}));var o=Object(Kn.a)(e,a),s=Object(Ct.a)(o,Object(_a.a)(r.shape,"float32"));return{x:function(){return s}}}},ki={kernelName:Ge.Rc,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(xt.a)(e,Object(St.a)(Object(ti.a)(n)))}}}},_i={kernelName:Ge.Sc,outputsToSave:[!0],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Object(Ct.a)(Object(Ft.a)(Object(Et.a)(1),Object(St.a)(n)),e)}}}},wi={kernelName:Ge.Tc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.reps;return{x:function(){var t=Object(Tt.a)(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Object(wt.a)(t,Object(Oa.a)(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=Object(wt.a)(t,Object(Oa.a)(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var c=0;c<a[2];++c)t=Object(wt.a)(t,Object(Oa.a)(e,[s*r.shape[0],u*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(var l=0;l<a[0];++l)for(var h=0;h<a[1];++h)for(var d=0;d<a[2];++d)for(var f=0;f<a[3];++f)t=Object(wt.a)(t,Object(Oa.a)(e,[l*r.shape[0],h*r.shape[1],d*r.shape[2],f*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},xi={kernelName:Ge.Vc,gradFunc:function(e,t,n){var r=n.perm,a=Qt.h(r);return{x:function(){return Object(Ue.a)(e,a)}}}},Ci=n("1U0N"),Oi={kernelName:Ge.Xc,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return Object(Ci.a)(e,r)}}}},Si=n("2ugP"),Ti=n("kaMP"),Ii=0,Ei=[Wn,Hn,Gn,Xn,Zn,Yn,Qn,Jn,$n,er,tr,nr,ar,or,sr,cr,lr,hr,dr,gr,yr,kr,Or,xr,Ir,Nr,Rr,jr,Pr,Lr,za,zr,Vr,Wr,Ur,Hr,Kr,Gr,Zr,Qr,ea,ta,na,ra,aa,oa,sa,ua,ca,ha,pa,pa,va,ya,ka,wa,xa,Ca,Sa,Ia,Ea,Na,Aa,Ra,ja,Fa,Fa,Pa,La,Ba,Va,Wa,Ua,Ha,Ga,qa,Xa,Za,Qa,Ja,$a,ei,ni,ai,oi,si,ci,hi,hi,fi,fi,pi,vi,mi,gi,yi,bi,ki,_i,wi,xi,Oi,{kernelName:Ge.Yc,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return function(e,t){for(var n=Object(Lt.a)(t,Object(Tt.a)(t)),r=Object(Ti.a)(e,n),a=Object(fr.a)(t,Object(Et.a)(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Object(Si.a)(a,o+1);a=Object(mr.a)(a,Object(_a.a)(r.shape,"bool"));var s=Object(Tt.a)(r);return Object(vr.a)(a,r,s)}(e,n)}}}},{kernelName:Ge.Zc,gradFunc:function(e){return{x:function(){return Object(Tt.a)(e)}}}}];Ii<Ei.length;Ii++){var Ni=Ei[Ii];Object(Ke.e)(Ni)}ge.a.prototype.abs=function(){return this.throwIfDisposed(),Object(Pt.a)(this)};var Ai=n("o3Rt");ge.a.prototype.acos=function(){return this.throwIfDisposed(),Object(Ai.a)(this)};var Ri=n("RhVc");ge.a.prototype.acosh=function(){return this.throwIfDisposed(),Object(Ri.a)(this)};var Di=n("zLES");ge.a.prototype.addStrict=function(e){return this.throwIfDisposed(),Object(Di.a)(this,e)},ge.a.prototype.add=function(e){return this.throwIfDisposed(),Object(wt.a)(this,e)};var ji=n("34HJ");ge.a.prototype.all=function(e,t){return this.throwIfDisposed(),Object(ji.a)(this,e,t)};var Fi=n("RRa9");ge.a.prototype.any=function(e,t){return this.throwIfDisposed(),Object(Fi.a)(this,e,t)};var Mi=n("6J+n");ge.a.prototype.argMax=function(e){return this.throwIfDisposed(),Object(Mi.a)(this,e)};var Pi=n("20lx");ge.a.prototype.argMin=function(e){return this.throwIfDisposed(),Object(Pi.a)(this,e)},ge.a.prototype.asScalar=function(){return this.throwIfDisposed(),Object(k.b)(1===this.size,(function(){return"The array must have only 1 element."})),Object(Kn.a)(this,[])},ge.a.prototype.asType=function(e){return this.throwIfDisposed(),Object(pe.a)(this,e)},ge.a.prototype.as1D=function(){return this.throwIfDisposed(),Object(Kn.a)(this,[this.size])},ge.a.prototype.as2D=function(e,t){return this.throwIfDisposed(),Object(Kn.a)(this,[e,t])},ge.a.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Object(Kn.a)(this,[e,t,n])},ge.a.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),Object(Kn.a)(this,[e,t,n,r])},ge.a.prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Kn.a)(this,[e,t,n,r,a])};var Li=n("Ig+c");ge.a.prototype.asin=function(){return this.throwIfDisposed(),Object(Li.a)(this)};var zi=n("3FnS");ge.a.prototype.asinh=function(){return this.throwIfDisposed(),Object(zi.a)(this)};var Bi=n("fjZN");ge.a.prototype.atan=function(){return this.throwIfDisposed(),Object(Bi.a)(this)};var Vi=n("YAKK");ge.a.prototype.atan2=function(e){return this.throwIfDisposed(),Object(Vi.a)(this,e)};var Wi=n("0ahe");ge.a.prototype.atanh=function(){return this.throwIfDisposed(),Object(Wi.a)(this)};var Ui=n("l0gX");ge.a.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Object(Ui.a)(this,e,t,n,r)},ge.a.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Object(li.a)(this,e,t)};var Hi=n("cdtJ");ge.a.prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Hi.a)(this,e,t,n,r,a)};var Gi=n("SNsm");ge.a.prototype.broadcastTo=function(e){return this.throwIfDisposed(),Object(Gi.a)(this,e)},ge.a.prototype.cast=function(e){return this.throwIfDisposed(),Object(pe.a)(this,e)};var Ki=n("WWBm");ge.a.prototype.ceil=function(){return this.throwIfDisposed(),Object(Ki.a)(this)};var qi=n("wI/y");ge.a.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Object(qi.a)(this,e,t)},ge.a.prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof ge.a&&(e=[e]),Object(di.a)([this].concat(_toConsumableArray(e)),t)};var Xi=n("dnXz");ge.a.prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(Xi.a)(this,e,t,n,r,a,i)};var Zi=n("zR+/");ge.a.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Zi.a)(this,e,t,n,r,a)},ge.a.prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(Cr.a)(this,e,t,n,r,a,i)},ge.a.prototype.cos=function(){return this.throwIfDisposed(),Object(ti.a)(this)},ge.a.prototype.cosh=function(){return this.throwIfDisposed(),Object(ri.a)(this)},ge.a.prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Object(Dr.a)(this,e,t,n)};var Yi=n("Nk7E");ge.a.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Object(Yi.a)(this,e,t)};var Qi=n("g4+C");ge.a.prototype.depthwiseConv2D=function(e,t,n,r,a,i){return Object(_t.b)("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),Object(Qi.a)(this,e,t,n,r,a,i)},ge.a.prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(Qi.a)(this,e,t,n,r,a,i)};var Ji=n("wXC5");ge.a.prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Ji.a)(this,e,t,n,r,a)};var $i=n("ARu+");ge.a.prototype.divNoNan=function(e){return this.throwIfDisposed(),Object($i.a)(this,e)},ge.a.prototype.divStrict=function(e){return this.throwIfDisposed(),Object(Di.b)(this,e)},ge.a.prototype.div=function(e){return this.throwIfDisposed(),Object(xt.a)(this,e)};var eo=n("Kfzt");ge.a.prototype.dot=function(e){return this.throwIfDisposed(),Object(eo.a)(this,e)};var to=n("njhW");ge.a.prototype.elu=function(){return this.throwIfDisposed(),Object(to.a)(this)};var no=n("8bUJ");ge.a.prototype.equalStrict=function(e){return this.throwIfDisposed(),Object(no.a)(this,e)},ge.a.prototype.equal=function(e){return this.throwIfDisposed(),Object(da.a)(this,e)};var ro=n("jgXy");ge.a.prototype.erf=function(){return this.throwIfDisposed(),Object(ro.a)(this)},ge.a.prototype.exp=function(){return this.throwIfDisposed(),Object(Br.a)(this)},ge.a.prototype.expandDims=function(e){return this.throwIfDisposed(),Object(Si.a)(this,e)};var ao=n("G6IW");ge.a.prototype.expm1=function(){return this.throwIfDisposed(),Object(ao.a)(this)};var io=n("Grcp");ge.a.prototype.fft=function(){return this.throwIfDisposed(),Object(io.a)(this)},ge.a.prototype.flatten=function(){return this.throwIfDisposed(),Object(Kn.a)(this,[this.size])},ge.a.prototype.floor=function(){return this.throwIfDisposed(),Object(Ta.a)(this)};var oo=n("UI8N");ge.a.prototype.floorDiv=function(e){return this.throwIfDisposed(),Object(oo.a)(this,e)},ge.a.prototype.gather=function(e,t){return this.throwIfDisposed(),Object(Ti.a)(this,e,t)},ge.a.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),Object(no.b)(this,e)},ge.a.prototype.greaterEqual=function(e){return this.throwIfDisposed(),Object(fr.a)(this,e)},ge.a.prototype.greaterStrict=function(e){return this.throwIfDisposed(),Object(no.c)(this,e)},ge.a.prototype.greater=function(e){return this.throwIfDisposed(),Object(ia.a)(this,e)};var so=n("THqV");ge.a.prototype.ifft=function(){return this.throwIfDisposed(),Object(so.a)(this)};var uo=n("adw1");ge.a.prototype.irfft=function(){return this.throwIfDisposed(),Object(uo.a)(this)};var co=n("/AvP");ge.a.prototype.isFinite=function(){return this.throwIfDisposed(),Object(co.a)(this)};var lo=n("WYAb");ge.a.prototype.isInf=function(){return this.throwIfDisposed(),Object(lo.a)(this)};var ho=n("b++O");ge.a.prototype.isNaN=function(){return this.throwIfDisposed(),Object(ho.a)(this)};var fo=n("bzdD");ge.a.prototype.leakyRelu=function(e){return this.throwIfDisposed(),Object(fo.a)(this,e)},ge.a.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),Object(no.d)(this,e)},ge.a.prototype.lessEqual=function(e){return this.throwIfDisposed(),Object(pr.a)(this,e)},ge.a.prototype.lessStrict=function(e){return this.throwIfDisposed(),Object(no.e)(this,e)},ge.a.prototype.less=function(e){return this.throwIfDisposed(),Object(ma.a)(this,e)};var po=n("4QEz");ge.a.prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),Object(po.a)(this,e,t,n,r)};var mo=n("wxQM");ge.a.prototype.logSigmoid=function(){return this.throwIfDisposed(),Object(mo.a)(this)};var vo=n("gErV");ge.a.prototype.logSoftmax=function(e){return this.throwIfDisposed(),Object(vo.a)(this,e)};var go=n("r9q9");ge.a.prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Object(go.a)(this,e,t)},ge.a.prototype.log=function(){return this.throwIfDisposed(),Object(Ma.a)(this)};var yo=n("RrGL");ge.a.prototype.log1p=function(){return this.throwIfDisposed(),Object(yo.a)(this)},ge.a.prototype.logicalAnd=function(e){return this.throwIfDisposed(),Object(mr.a)(this,e)},ge.a.prototype.logicalNot=function(){return this.throwIfDisposed(),Object(Ya.a)(this)};var bo=n("8YN0");ge.a.prototype.logicalOr=function(e){return this.throwIfDisposed(),Object(bo.a)(this,e)};var ko=n("0l+w");ge.a.prototype.logicalXor=function(e){return this.throwIfDisposed(),Object(ko.a)(this,e)},ge.a.prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Object(Be.a)(this,e,t,n)};var _o=n("n+ZZ");ge.a.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Object(_o.a)(this,e,t,n,r)};var wo=n("wCH+");ge.a.prototype.max=function(e,t){return this.throwIfDisposed(),Object(wo.a)(this,e,t)},ge.a.prototype.maximumStrict=function(e){return this.throwIfDisposed(),Object(Di.c)(this,e)},ge.a.prototype.maximum=function(e){return this.throwIfDisposed(),Object(Lt.a)(this,e)};var xo=n("Ei6o");ge.a.prototype.mean=function(e,t){return this.throwIfDisposed(),Object(xo.a)(this,e,t)};var Co=n("rm0a");ge.a.prototype.min=function(e,t){return this.throwIfDisposed(),Object(Co.a)(this,e,t)},ge.a.prototype.minimumStrict=function(e){return this.throwIfDisposed(),Object(Di.d)(this,e)};var Oo=n("8OX7");ge.a.prototype.minimum=function(e){return this.throwIfDisposed(),Object(Oo.a)(this,e)};var So=n("k9tH");ge.a.prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Object(So.a)(this,e,t)},ge.a.prototype.modStrict=function(e){return this.throwIfDisposed(),Object(Di.e)(this,e)};var To=n("RhH0");ge.a.prototype.mod=function(e){return this.throwIfDisposed(),Object(To.a)(this,e)},ge.a.prototype.mulStrict=function(e){return this.throwIfDisposed(),Object(Di.f)(this,e)},ge.a.prototype.mul=function(e){return this.throwIfDisposed(),Object(Ct.a)(this,e)},ge.a.prototype.neg=function(){return this.throwIfDisposed(),Object(Un.a)(this)};var Io=n("91d6");ge.a.prototype.norm=function(e,t,n){return this.throwIfDisposed(),Object(Io.a)(this,e,t,n)},ge.a.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),Object(no.f)(this,e)};var Eo=n("1N4k");ge.a.prototype.notEqual=function(e){return this.throwIfDisposed(),Object(Eo.a)(this,e)},ge.a.prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Object(Ve.a)(this,e,t,n)};var No=n("DbV5");ge.a.prototype.onesLike=function(){return this.throwIfDisposed(),Object(No.a)(this)},ge.a.prototype.pad=function(e,t){return this.throwIfDisposed(),Object(ii.a)(this,e,t)};var Ao=n("6vQL");ge.a.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Ao.a)(this,e,t,n,r,a)},ge.a.prototype.powStrict=function(e){return this.throwIfDisposed(),Object(Di.g)(this,e)},ge.a.prototype.pow=function(e){return this.throwIfDisposed(),Object(jt.a)(this,e)};var Ro=n("Ug8H");ge.a.prototype.prelu=function(e){return this.throwIfDisposed(),Object(Ro.a)(this,e)};var Do=n("867m");ge.a.prototype.prod=function(e,t){return this.throwIfDisposed(),Object(Do.a)(this,e,t)};var jo=n("tQDl");ge.a.prototype.reciprocal=function(){return this.throwIfDisposed(),Object(jo.a)(this)};var Fo=n("kXpR");ge.a.prototype.relu=function(){return this.throwIfDisposed(),Object(Fo.a)(this)};var Mo=n("Rqg+");ge.a.prototype.relu6=function(){return this.throwIfDisposed(),Object(Mo.a)(this)},ge.a.prototype.reshapeAs=function(e){return this.throwIfDisposed(),Object(Kn.a)(this,e.shape)},ge.a.prototype.reshape=function(e){return this.throwIfDisposed(),Object(Kn.a)(this,e)};var Po=n("c/ib");ge.a.prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),Object(Po.a)(this,e,t,n)};var Lo=n("D4ac");ge.a.prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Object(Lo.a)(this,e,t,n)},ge.a.prototype.reverse=function(e){return this.throwIfDisposed(),Object(Ka.a)(this,e)};var zo=n("th0q");ge.a.prototype.rfft=function(){return this.throwIfDisposed(),Object(zo.a)(this)};var Bo=n("CKnt");ge.a.prototype.round=function(){return this.throwIfDisposed(),Object(Bo.a)(this)},ge.a.prototype.rsqrt=function(){return this.throwIfDisposed(),Object(qr.a)(this)};var Vo=n("s57M");ge.a.prototype.selu=function(){return this.throwIfDisposed(),Object(Vo.a)(this)};var Wo=n("EWu9");ge.a.prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(Wo.a)(this,e,t,n,r,a,i)},ge.a.prototype.sigmoid=function(){return this.throwIfDisposed(),Object(ui.a)(this)};var Uo=n("Hfat");ge.a.prototype.sign=function(){return this.throwIfDisposed(),Object(Uo.a)(this)},ge.a.prototype.sin=function(){return this.throwIfDisposed(),Object(Er.a)(this)},ge.a.prototype.sinh=function(){return this.throwIfDisposed(),Object(Ar.a)(this)},ge.a.prototype.slice=function(e,t){return this.throwIfDisposed(),Object(Oa.a)(this,e,t)};var Ho=n("X4fa");ge.a.prototype.softmax=function(e){return this.throwIfDisposed(),Object(Ho.a)(this,e)};var Go=n("n/2y");ge.a.prototype.softplus=function(){return this.throwIfDisposed(),Object(Go.a)(this)},ge.a.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Object(ur.a)(this,e,t)},ge.a.prototype.split=function(e,t){return this.throwIfDisposed(),Object(br.a)(this,e,t)},ge.a.prototype.sqrt=function(){return this.throwIfDisposed(),Object(Ot.a)(this)},ge.a.prototype.square=function(){return this.throwIfDisposed(),Object(St.a)(this)};var Ko=n("QYQ3");ge.a.prototype.squaredDifference=function(e){return this.throwIfDisposed(),Object(Ko.a)(this,e)},ge.a.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),Object(Di.h)(this,e)};var qo=n("0fRV");ge.a.prototype.squeeze=function(e){return this.throwIfDisposed(),Object(qo.a)(this,e)},ge.a.prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof ge.a?[this,e]:[this].concat(_toConsumableArray(e));return Object(Ci.a)(n,t)},ge.a.prototype.step=function(e){return this.throwIfDisposed(),Object(Vn.a)(this,e)};var Xo=n("3hph");ge.a.prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),Object(Xo.a)(this,e,t,n,r,a,i,o,s)},ge.a.prototype.subStrict=function(e){return this.throwIfDisposed(),Object(Di.i)(this,e)},ge.a.prototype.sub=function(e){return this.throwIfDisposed(),Object(Ft.a)(this,e)},ge.a.prototype.sum=function(e,t){return this.throwIfDisposed(),Object(qn.a)(this,e,t)};var Zo=n("0wrZ");ge.a.prototype.tan=function(){return this.throwIfDisposed(),Object(Zo.a)(this)};var Yo=n("iIjY");ge.a.prototype.tanh=function(){return this.throwIfDisposed(),Object(Yo.a)(this)},ge.a.prototype.tile=function(e){return this.throwIfDisposed(),Object(Xr.a)(this,e)},ge.a.prototype.toBool=function(){return this.throwIfDisposed(),Object(pe.a)(this,"bool")},ge.a.prototype.toFloat=function(){return this.throwIfDisposed(),Object(pe.a)(this,"float32")},ge.a.prototype.toInt=function(){return this.throwIfDisposed(),Object(pe.a)(this,"int32")};var Qo=n("VhY8");ge.a.prototype.topk=function(e,t){return this.throwIfDisposed(),Object(Qo.a)(this,e,t)},ge.a.prototype.transpose=function(e){return this.throwIfDisposed(),Object(Ue.a)(this,e)};var Jo=n("hT5K");ge.a.prototype.unique=function(e){return this.throwIfDisposed(),Object(Jo.a)(this,e)},ge.a.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Object(Yr.a)(this,e,t)},ge.a.prototype.unstack=function(e){return this.throwIfDisposed(),Object(Da.a)(this,e)},ge.a.prototype.where=function(e,t){return this.throwIfDisposed(),Object(vr.a)(e,this,t)},ge.a.prototype.zerosLike=function(){return this.throwIfDisposed(),Object(Tt.a)(this)},n.d(t,"AdadeltaOptimizer",(function(){return At})),n.d(t,"AdagradOptimizer",(function(){return Dt})),n.d(t,"AdamOptimizer",(function(){return Mt})),n.d(t,"AdamaxOptimizer",(function(){return zt})),n.d(t,"MomentumOptimizer",(function(){return Vt})),n.d(t,"Optimizer",(function(){return Nt})),n.d(t,"RMSPropOptimizer",(function(){return Wt})),n.d(t,"SGDOptimizer",(function(){return Bt})),n.d(t,"Tensor",(function(){return ge.a})),n.d(t,"TensorBuffer",(function(){return ge.b})),n.d(t,"Variable",(function(){return ge.c})),n.d(t,"Rank",(function(){return Ut.a})),n.d(t,"sumOutType",(function(){return Ut.b})),n.d(t,"upcastType",(function(){return Ut.c})),n.d(t,"Reduction",(function(){return Gt.a})),n.d(t,"customGrad",(function(){return It.a})),n.d(t,"grad",(function(){return It.b})),n.d(t,"grads",(function(){return It.c})),n.d(t,"valueAndGrad",(function(){return It.d})),n.d(t,"valueAndGrads",(function(){return It.e})),n.d(t,"variableGrads",(function(){return It.f})),n.d(t,"Environment",(function(){return v.b})),n.d(t,"env",(function(){return v.c})),n.d(t,"ENV",(function(){return v.a})),n.d(t,"version_core",(function(){return"2.8.6"})),n.d(t,"nextFrame",(function(){return Zt})),n.d(t,"browser",(function(){return o})),n.d(t,"io",(function(){return a})),n.d(t,"math",(function(){return i})),n.d(t,"serialization",(function(){return c})),n.d(t,"test_util",(function(){return bt})),n.d(t,"util",(function(){return kt})),n.d(t,"backend_util",(function(){return h})),n.d(t,"tensor_util",(function(){return yt})),n.d(t,"slice_util",(function(){return u})),n.d(t,"gather_util",(function(){return s})),n.d(t,"scatter_util",(function(){return Je})),n.d(t,"device_util",(function(){return r})),n.d(t,"kernel_impls",(function(){return d})),n.d(t,"KernelBackend",(function(){return Bn.b})),n.d(t,"DataStorage",(function(){return Bn.a})),n.d(t,"abs",(function(){return Ht.b})),n.d(t,"acos",(function(){return Ht.c})),n.d(t,"acosh",(function(){return Ht.d})),n.d(t,"add",(function(){return Ht.e})),n.d(t,"addN",(function(){return Ht.f})),n.d(t,"all",(function(){return Ht.h})),n.d(t,"any",(function(){return Ht.i})),n.d(t,"argMax",(function(){return Ht.j})),n.d(t,"argMin",(function(){return Ht.k})),n.d(t,"asin",(function(){return Ht.l})),n.d(t,"asinh",(function(){return Ht.m})),n.d(t,"atan",(function(){return Ht.n})),n.d(t,"atan2",(function(){return Ht.o})),n.d(t,"atanh",(function(){return Ht.p})),n.d(t,"avgPool",(function(){return Ht.q})),n.d(t,"avgPool3d",(function(){return Ht.r})),n.d(t,"basicLSTMCell",(function(){return Ht.s})),n.d(t,"batchToSpaceND",(function(){return Ht.x})),n.d(t,"batchNorm",(function(){return Ht.t})),n.d(t,"batchNorm2d",(function(){return Ht.u})),n.d(t,"batchNorm3d",(function(){return Ht.v})),n.d(t,"batchNorm4d",(function(){return Ht.w})),n.d(t,"bincount",(function(){return Ht.y})),n.d(t,"broadcastTo",(function(){return Ht.A})),n.d(t,"buffer",(function(){return Ht.B})),n.d(t,"cast",(function(){return Ht.C})),n.d(t,"ceil",(function(){return Ht.D})),n.d(t,"clipByValue",(function(){return Ht.E})),n.d(t,"clone",(function(){return Ht.F})),n.d(t,"complex",(function(){return Ht.G})),n.d(t,"concat",(function(){return Ht.H})),n.d(t,"concat1d",(function(){return Ht.I})),n.d(t,"concat2d",(function(){return Ht.J})),n.d(t,"concat3d",(function(){return Ht.K})),n.d(t,"concat4d",(function(){return Ht.L})),n.d(t,"conv1d",(function(){return Ht.M})),n.d(t,"conv2d",(function(){return Ht.N})),n.d(t,"conv2dTranspose",(function(){return Ht.O})),n.d(t,"conv3d",(function(){return Ht.P})),n.d(t,"conv3dTranspose",(function(){return Ht.Q})),n.d(t,"cos",(function(){return Ht.R})),n.d(t,"cosh",(function(){return Ht.S})),n.d(t,"cumsum",(function(){return Ht.U})),n.d(t,"denseBincount",(function(){return Ht.V})),n.d(t,"depthToSpace",(function(){return Ht.W})),n.d(t,"depthwiseConv2d",(function(){return Ht.X})),n.d(t,"diag",(function(){return Ht.Y})),n.d(t,"dilation2d",(function(){return Ht.Z})),n.d(t,"div",(function(){return Ht.ab})),n.d(t,"divNoNan",(function(){return Ht.bb})),n.d(t,"dot",(function(){return Ht.db})),n.d(t,"elu",(function(){return Ht.fb})),n.d(t,"equal",(function(){return Ht.hb})),n.d(t,"erf",(function(){return Ht.jb})),n.d(t,"exp",(function(){return Ht.kb})),n.d(t,"expandDims",(function(){return Ht.lb})),n.d(t,"expm1",(function(){return Ht.mb})),n.d(t,"eye",(function(){return Ht.nb})),n.d(t,"fill",(function(){return Ht.pb})),n.d(t,"floor",(function(){return Ht.qb})),n.d(t,"floorDiv",(function(){return Ht.rb})),n.d(t,"gather",(function(){return Ht.tb})),n.d(t,"greater",(function(){return Ht.vb})),n.d(t,"greaterEqual",(function(){return Ht.wb})),n.d(t,"imag",(function(){return Ht.Ab})),n.d(t,"isFinite",(function(){return Ht.Eb})),n.d(t,"isInf",(function(){return Ht.Fb})),n.d(t,"isNaN",(function(){return Ht.Gb})),n.d(t,"leakyRelu",(function(){return Ht.Hb})),n.d(t,"less",(function(){return Ht.Ib})),n.d(t,"lessEqual",(function(){return Ht.Jb})),n.d(t,"linspace",(function(){return Ht.Nb})),n.d(t,"localResponseNormalization",(function(){return Ht.Ob})),n.d(t,"log",(function(){return Ht.Pb})),n.d(t,"log1p",(function(){return Ht.Qb})),n.d(t,"logSigmoid",(function(){return Ht.Rb})),n.d(t,"logSoftmax",(function(){return Ht.Sb})),n.d(t,"logSumExp",(function(){return Ht.Tb})),n.d(t,"logicalAnd",(function(){return Ht.Ub})),n.d(t,"logicalNot",(function(){return Ht.Vb})),n.d(t,"logicalOr",(function(){return Ht.Wb})),n.d(t,"logicalXor",(function(){return Ht.Xb})),n.d(t,"matMul",(function(){return Ht.Zb})),n.d(t,"max",(function(){return Ht.ac})),n.d(t,"maxPool",(function(){return Ht.bc})),n.d(t,"maxPool3d",(function(){return Ht.cc})),n.d(t,"maxPoolWithArgmax",(function(){return Ht.dc})),n.d(t,"maximum",(function(){return Ht.ec})),n.d(t,"mean",(function(){return Ht.gc})),n.d(t,"min",(function(){return Ht.hc})),n.d(t,"minimum",(function(){return Ht.ic})),n.d(t,"mirrorPad",(function(){return Ht.kc})),n.d(t,"mod",(function(){return Ht.lc})),n.d(t,"moments",(function(){return Ht.nc})),n.d(t,"mul",(function(){return Ht.pc})),n.d(t,"multiRNNCell",(function(){return Ht.rc})),n.d(t,"multinomial",(function(){return Ht.sc})),n.d(t,"neg",(function(){return Ht.tc})),n.d(t,"notEqual",(function(){return Ht.vc})),n.d(t,"oneHot",(function(){return Ht.xc})),n.d(t,"ones",(function(){return Ht.yc})),n.d(t,"onesLike",(function(){return Ht.zc})),n.d(t,"outerProduct",(function(){return Ht.Bc})),n.d(t,"pad",(function(){return Ht.Cc})),n.d(t,"pad1d",(function(){return Ht.Dc})),n.d(t,"pad2d",(function(){return Ht.Ec})),n.d(t,"pad3d",(function(){return Ht.Fc})),n.d(t,"pad4d",(function(){return Ht.Gc})),n.d(t,"pool",(function(){return Ht.Hc})),n.d(t,"pow",(function(){return Ht.Ic})),n.d(t,"prelu",(function(){return Ht.Kc})),n.d(t,"print",(function(){return Ht.Lc})),n.d(t,"prod",(function(){return Ht.Mc})),n.d(t,"rand",(function(){return Ht.Nc})),n.d(t,"randomGamma",(function(){return Ht.Oc})),n.d(t,"randomNormal",(function(){return Ht.Pc})),n.d(t,"randomUniform",(function(){return Ht.Qc})),n.d(t,"range",(function(){return Ht.Rc})),n.d(t,"real",(function(){return Ht.Sc})),n.d(t,"reciprocal",(function(){return Ht.Tc})),n.d(t,"relu",(function(){return Ht.Uc})),n.d(t,"relu6",(function(){return Ht.Vc})),n.d(t,"reshape",(function(){return Ht.Wc})),n.d(t,"reverse",(function(){return Ht.Xc})),n.d(t,"reverse1d",(function(){return Ht.Yc})),n.d(t,"reverse2d",(function(){return Ht.Zc})),n.d(t,"reverse3d",(function(){return Ht.ad})),n.d(t,"reverse4d",(function(){return Ht.bd})),n.d(t,"round",(function(){return Ht.dd})),n.d(t,"rsqrt",(function(){return Ht.ed})),n.d(t,"scalar",(function(){return Ht.fd})),n.d(t,"selu",(function(){return Ht.hd})),n.d(t,"separableConv2d",(function(){return Ht.id})),n.d(t,"setdiff1dAsync",(function(){return Ht.jd})),n.d(t,"sigmoid",(function(){return Ht.kd})),n.d(t,"sign",(function(){return Ht.ld})),n.d(t,"sin",(function(){return Ht.nd})),n.d(t,"sinh",(function(){return Ht.od})),n.d(t,"slice",(function(){return Ht.pd})),n.d(t,"slice1d",(function(){return Ht.qd})),n.d(t,"slice2d",(function(){return Ht.rd})),n.d(t,"slice3d",(function(){return Ht.sd})),n.d(t,"slice4d",(function(){return Ht.td})),n.d(t,"softmax",(function(){return Ht.ud})),n.d(t,"softplus",(function(){return Ht.vd})),n.d(t,"spaceToBatchND",(function(){return Ht.wd})),n.d(t,"fft",(function(){return Ht.ob})),n.d(t,"ifft",(function(){return Ht.zb})),n.d(t,"irfft",(function(){return Ht.Db})),n.d(t,"rfft",(function(){return Ht.cd})),n.d(t,"split",(function(){return Ht.zd})),n.d(t,"sqrt",(function(){return Ht.Ad})),n.d(t,"square",(function(){return Ht.Bd})),n.d(t,"squaredDifference",(function(){return Ht.Cd})),n.d(t,"squeeze",(function(){return Ht.Ed})),n.d(t,"stack",(function(){return Ht.Fd})),n.d(t,"step",(function(){return Ht.Gd})),n.d(t,"stridedSlice",(function(){return Ht.Hd})),n.d(t,"sub",(function(){return Ht.Id})),n.d(t,"sum",(function(){return Ht.Kd})),n.d(t,"tan",(function(){return Ht.Ld})),n.d(t,"tanh",(function(){return Ht.Md})),n.d(t,"tensor",(function(){return Ht.Nd})),n.d(t,"tensor1d",(function(){return Ht.Od})),n.d(t,"tensor2d",(function(){return Ht.Pd})),n.d(t,"tensor3d",(function(){return Ht.Qd})),n.d(t,"tensor4d",(function(){return Ht.Rd})),n.d(t,"tensor5d",(function(){return Ht.Sd})),n.d(t,"tensor6d",(function(){return Ht.Td})),n.d(t,"tile",(function(){return Ht.Ud})),n.d(t,"topk",(function(){return Ht.Vd})),n.d(t,"truncatedNormal",(function(){return Ht.Xd})),n.d(t,"unique",(function(){return Ht.Yd})),n.d(t,"unsortedSegmentSum",(function(){return Ht.Zd})),n.d(t,"unstack",(function(){return Ht.ae})),n.d(t,"variable",(function(){return Ht.be})),n.d(t,"where",(function(){return Ht.ce})),n.d(t,"whereAsync",(function(){return Ht.de})),n.d(t,"zeros",(function(){return Ht.ee})),n.d(t,"zerosLike",(function(){return Ht.fe})),n.d(t,"op",(function(){return Ht.Ac})),n.d(t,"OP_SCOPE_SUFFIX",(function(){return Ht.a})),n.d(t,"image",(function(){return Ht.Bb})),n.d(t,"linalg",(function(){return Ht.Mb})),n.d(t,"losses",(function(){return Ht.Yb})),n.d(t,"spectral",(function(){return Ht.yd})),n.d(t,"fused",(function(){return Ht.sb})),n.d(t,"signal",(function(){return Ht.md})),n.d(t,"train",(function(){return qt})),n.d(t,"enableProdMode",(function(){return _t.g})),n.d(t,"enableDebugMode",(function(){return _t.f})),n.d(t,"disableDeprecationWarnings",(function(){return _t.c})),n.d(t,"deprecationWarn",(function(){return _t.b})),n.d(t,"disposeVariables",(function(){return _t.e})),n.d(t,"engine",(function(){return _t.h})),n.d(t,"memory",(function(){return _t.m})),n.d(t,"profile",(function(){return _t.n})),n.d(t,"tidy",(function(){return _t.t})),n.d(t,"dispose",(function(){return _t.d})),n.d(t,"keep",(function(){return _t.l})),n.d(t,"time",(function(){return _t.u})),n.d(t,"setBackend",(function(){return _t.r})),n.d(t,"ready",(function(){return _t.o})),n.d(t,"getBackend",(function(){return _t.k})),n.d(t,"removeBackend",(function(){return _t.q})),n.d(t,"findBackend",(function(){return _t.i})),n.d(t,"findBackendFactory",(function(){return _t.j})),n.d(t,"registerBackend",(function(){return _t.p})),n.d(t,"backend",(function(){return _t.a})),n.d(t,"setPlatform",(function(){return _t.s})),n.d(t,"getKernel",(function(){return Ke.c})),n.d(t,"getGradient",(function(){return Ke.b})),n.d(t,"getKernelsForBackend",(function(){return Ke.d})),n.d(t,"registerKernel",(function(){return Ke.f})),n.d(t,"registerGradient",(function(){return Ke.e})),n.d(t,"unregisterKernel",(function(){return Ke.h})),n.d(t,"unregisterGradient",(function(){return Ke.g})),n.d(t,"copyRegisteredKernels",(function(){return Ke.a})),n.d(t,"Abs",(function(){return Ge.a})),n.d(t,"Acos",(function(){return Ge.b})),n.d(t,"Acosh",(function(){return Ge.c})),n.d(t,"Add",(function(){return Ge.d})),n.d(t,"AddN",(function(){return Ge.e})),n.d(t,"All",(function(){return Ge.f})),n.d(t,"Any",(function(){return Ge.g})),n.d(t,"ArgMax",(function(){return Ge.h})),n.d(t,"ArgMin",(function(){return Ge.i})),n.d(t,"Asin",(function(){return Ge.j})),n.d(t,"Asinh",(function(){return Ge.k})),n.d(t,"Atan",(function(){return Ge.l})),n.d(t,"Atanh",(function(){return Ge.n})),n.d(t,"Atan2",(function(){return Ge.m})),n.d(t,"AvgPool",(function(){return Ge.o})),n.d(t,"AvgPoolGrad",(function(){return Ge.r})),n.d(t,"AvgPool3D",(function(){return Ge.p})),n.d(t,"AvgPool3DGrad",(function(){return Ge.q})),n.d(t,"BatchMatMul",(function(){return Ge.s})),n.d(t,"BatchToSpaceND",(function(){return Ge.t})),n.d(t,"Bincount",(function(){return Ge.u})),n.d(t,"BroadcastTo",(function(){return Ge.v})),n.d(t,"Cast",(function(){return Ge.w})),n.d(t,"Ceil",(function(){return Ge.x})),n.d(t,"ClipByValue",(function(){return Ge.y})),n.d(t,"Complex",(function(){return Ge.z})),n.d(t,"ComplexAbs",(function(){return Ge.A})),n.d(t,"Concat",(function(){return Ge.B})),n.d(t,"Conv2D",(function(){return Ge.C})),n.d(t,"Conv2DBackpropFilter",(function(){return Ge.D})),n.d(t,"Conv2DBackpropInput",(function(){return Ge.E})),n.d(t,"Conv3D",(function(){return Ge.F})),n.d(t,"Conv3DBackpropFilterV2",(function(){return Ge.G})),n.d(t,"Conv3DBackpropInputV2",(function(){return Ge.H})),n.d(t,"Cos",(function(){return Ge.I})),n.d(t,"Cosh",(function(){return Ge.J})),n.d(t,"Cumsum",(function(){return Ge.L})),n.d(t,"CropAndResize",(function(){return Ge.K})),n.d(t,"DenseBincount",(function(){return Ge.M})),n.d(t,"DepthToSpace",(function(){return Ge.N})),n.d(t,"DepthwiseConv2dNative",(function(){return Ge.O})),n.d(t,"DepthwiseConv2dNativeBackpropFilter",(function(){return Ge.P})),n.d(t,"DepthwiseConv2dNativeBackpropInput",(function(){return Ge.Q})),n.d(t,"Diag",(function(){return Ge.R})),n.d(t,"Dilation2D",(function(){return Ge.S})),n.d(t,"Dilation2DBackpropInput",(function(){return Ge.U})),n.d(t,"Dilation2DBackpropFilter",(function(){return Ge.T})),n.d(t,"RealDiv",(function(){return Ge.kc})),n.d(t,"Elu",(function(){return Ge.V})),n.d(t,"EluGrad",(function(){return Ge.W})),n.d(t,"Erf",(function(){return Ge.Y})),n.d(t,"Equal",(function(){return Ge.X})),n.d(t,"Exp",(function(){return Ge.Z})),n.d(t,"ExpandDims",(function(){return Ge.ab})),n.d(t,"Expm1",(function(){return Ge.bb})),n.d(t,"FFT",(function(){return Ge.cb})),n.d(t,"Fill",(function(){return Ge.db})),n.d(t,"FlipLeftRight",(function(){return Ge.eb})),n.d(t,"Floor",(function(){return Ge.fb})),n.d(t,"FloorDiv",(function(){return Ge.gb})),n.d(t,"FusedBatchNorm",(function(){return Ge.ib})),n.d(t,"GatherV2",(function(){return Ge.mb})),n.d(t,"GatherNd",(function(){return Ge.lb})),n.d(t,"Greater",(function(){return Ge.nb})),n.d(t,"GreaterEqual",(function(){return Ge.ob})),n.d(t,"Identity",(function(){return Ge.qb})),n.d(t,"IFFT",(function(){return Ge.pb})),n.d(t,"Imag",(function(){return Ge.rb})),n.d(t,"IsFinite",(function(){return Ge.sb})),n.d(t,"IsInf",(function(){return Ge.tb})),n.d(t,"IsNan",(function(){return Ge.ub})),n.d(t,"LeakyRelu",(function(){return Ge.xb})),n.d(t,"Less",(function(){return Ge.yb})),n.d(t,"LessEqual",(function(){return Ge.zb})),n.d(t,"LinSpace",(function(){return Ge.Ab})),n.d(t,"Log",(function(){return Ge.Bb})),n.d(t,"Log1p",(function(){return Ge.Cb})),n.d(t,"LogicalAnd",(function(){return Ge.Eb})),n.d(t,"LogicalNot",(function(){return Ge.Fb})),n.d(t,"LogicalOr",(function(){return Ge.Gb})),n.d(t,"LogSoftmax",(function(){return Ge.Db})),n.d(t,"LRN",(function(){return Ge.vb})),n.d(t,"LRNGrad",(function(){return Ge.wb})),n.d(t,"Max",(function(){return Ge.Hb})),n.d(t,"Maximum",(function(){return Ge.Nb})),n.d(t,"MaxPool",(function(){return Ge.Ib})),n.d(t,"MaxPoolGrad",(function(){return Ge.Lb})),n.d(t,"MaxPool3D",(function(){return Ge.Jb})),n.d(t,"MaxPool3DGrad",(function(){return Ge.Kb})),n.d(t,"MaxPoolWithArgmax",(function(){return Ge.Mb})),n.d(t,"Mean",(function(){return Ge.Ob})),n.d(t,"Min",(function(){return Ge.Pb})),n.d(t,"Minimum",(function(){return Ge.Qb})),n.d(t,"MirrorPad",(function(){return Ge.Rb})),n.d(t,"Mod",(function(){return Ge.Sb})),n.d(t,"Multinomial",(function(){return Ge.Tb})),n.d(t,"Multiply",(function(){return Ge.Ub})),n.d(t,"Neg",(function(){return Ge.Vb})),n.d(t,"NotEqual",(function(){return Ge.Zb})),n.d(t,"NonMaxSuppressionV3",(function(){return Ge.Wb})),n.d(t,"NonMaxSuppressionV4",(function(){return Ge.Xb})),n.d(t,"NonMaxSuppressionV5",(function(){return Ge.Yb})),n.d(t,"OnesLike",(function(){return Ge.bc})),n.d(t,"OneHot",(function(){return Ge.ac})),n.d(t,"Pack",(function(){return Ge.cc})),n.d(t,"PadV2",(function(){return Ge.dc})),n.d(t,"Pool",(function(){return Ge.ec})),n.d(t,"Pow",(function(){return Ge.fc})),n.d(t,"Prelu",(function(){return Ge.gc})),n.d(t,"Prod",(function(){return Ge.hc})),n.d(t,"Range",(function(){return Ge.ic})),n.d(t,"Real",(function(){return Ge.jc})),n.d(t,"Reciprocal",(function(){return Ge.lc})),n.d(t,"Relu",(function(){return Ge.mc})),n.d(t,"Reshape",(function(){return Ge.oc})),n.d(t,"ResizeNearestNeighbor",(function(){return Ge.rc})),n.d(t,"ResizeNearestNeighborGrad",(function(){return Ge.sc})),n.d(t,"ResizeBilinear",(function(){return Ge.pc})),n.d(t,"ResizeBilinearGrad",(function(){return Ge.qc})),n.d(t,"Relu6",(function(){return Ge.nc})),n.d(t,"Reverse",(function(){return Ge.tc})),n.d(t,"Round",(function(){return Ge.vc})),n.d(t,"Rsqrt",(function(){return Ge.wc})),n.d(t,"ScatterNd",(function(){return Ge.xc})),n.d(t,"Select",(function(){return Ge.yc})),n.d(t,"Selu",(function(){return Ge.zc})),n.d(t,"Slice",(function(){return Ge.Ec})),n.d(t,"Sin",(function(){return Ge.Cc})),n.d(t,"Sinh",(function(){return Ge.Dc})),n.d(t,"Sign",(function(){return Ge.Bc})),n.d(t,"Sigmoid",(function(){return Ge.Ac})),n.d(t,"Softplus",(function(){return Ge.Gc})),n.d(t,"Sqrt",(function(){return Ge.Kc})),n.d(t,"Sum",(function(){return Ge.Qc})),n.d(t,"SpaceToBatchND",(function(){return Ge.Hc})),n.d(t,"SplitV",(function(){return Ge.Jc})),n.d(t,"Softmax",(function(){return Ge.Fc})),n.d(t,"SquaredDifference",(function(){return Ge.Mc})),n.d(t,"Square",(function(){return Ge.Lc})),n.d(t,"Sub",(function(){return Ge.Pc})),n.d(t,"SparseToDense",(function(){return Ge.Ic})),n.d(t,"StridedSlice",(function(){return Ge.Oc})),n.d(t,"Tan",(function(){return Ge.Rc})),n.d(t,"Tanh",(function(){return Ge.Sc})),n.d(t,"Tile",(function(){return Ge.Tc})),n.d(t,"TopK",(function(){return Ge.Uc})),n.d(t,"Transpose",(function(){return Ge.Vc})),n.d(t,"Unique",(function(){return Ge.Wc})),n.d(t,"Unpack",(function(){return Ge.Xc})),n.d(t,"UnsortedSegmentSum",(function(){return Ge.Yc})),n.d(t,"ZerosLike",(function(){return Ge.Zc})),n.d(t,"Step",(function(){return Ge.Nc})),n.d(t,"FromPixels",(function(){return Ge.hb})),n.d(t,"RotateWithOffset",(function(){return Ge.uc})),n.d(t,"_FusedMatMul",(function(){return Ge.ad})),n.d(t,"FusedConv2D",(function(){return Ge.jb})),n.d(t,"FusedDepthwiseConv2D",(function(){return Ge.kb})),n.d(t,"booleanMaskAsync",(function(){return Ht.z})),n.d(t,"equalStrict",(function(){return Ht.ib})),n.d(t,"greaterEqualStrict",(function(){return Ht.xb})),n.d(t,"greaterStrict",(function(){return Ht.yb})),n.d(t,"lessEqualStrict",(function(){return Ht.Kb})),n.d(t,"lessStrict",(function(){return Ht.Lb})),n.d(t,"notEqualStrict",(function(){return Ht.wc})),n.d(t,"addStrict",(function(){return Ht.g})),n.d(t,"divStrict",(function(){return Ht.cb})),n.d(t,"maximumStrict",(function(){return Ht.fc})),n.d(t,"minimumStrict",(function(){return Ht.jc})),n.d(t,"modStrict",(function(){return Ht.mc})),n.d(t,"mulStrict",(function(){return Ht.qc})),n.d(t,"powStrict",(function(){return Ht.Jc})),n.d(t,"squaredDifferenceStrict",(function(){return Ht.Dd})),n.d(t,"subStrict",(function(){return Ht.Jd})),n.d(t,"transpose",(function(){return Ht.Wd})),n.d(t,"norm",(function(){return Ht.uc})),n.d(t,"movingAverage",(function(){return Ht.oc})),n.d(t,"scatterND",(function(){return Ht.gd})),n.d(t,"sparseToDense",(function(){return Ht.xd})),n.d(t,"gatherND",(function(){return Ht.ub})),n.d(t,"dropout",(function(){return Ht.eb})),n.d(t,"enclosingPowerOfTwo",(function(){return Ht.gb})),n.d(t,"cosineWindow",(function(){return Ht.T})),n.d(t,"inTopKAsync",(function(){return Ht.Cb}))},"/7N0":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({sigmoid_:function(e){var t=Object(i.a)(e,"x","sigmoid");return r.a.runKernel(a.Ac,{x:t})}})},"/AvP":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({isFinite_:function(e){var t=Object(i.a)(e,"x","isFinite");return r.a.runKernel(a.sb,{x:t})}})},0:function(e,t,n){e.exports=n("zUnb")},"02mo":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({floor_:function(e){var t=Object(i.a)(e,"x","floor");return r.a.runKernel(a.fb,{x:t})}})},"0I63":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({reverse_:function(e,t){var n=Object(i.a)(e,"x","reverse");return r.a.runKernel(a.tc,{x:n},{dims:t})}})},"0ahe":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({atanh_:function(e){var t=Object(i.a)(e,"x","atanh");return r.a.runKernel(a.n,{x:t})}})},"0fRV":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("o/e8"),a=n("atXS"),i=n("VO80"),o=n("NclT"),s=Object(i.b)({squeeze_:function(e,t){var n=Object(r.a)(e,"x","squeeze");return Object(o.a)(n,Object(a.P)(n.shape,t).newShape)}})},"0l+w":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("o/e8"),a=n("Um8L"),i=n("4zPZ"),o=n("7wDt"),s=n("8YN0"),u=n("VO80"),c=Object(u.b)({logicalXor_:function(e,t){var n=Object(r.a)(e,"a","logicalXor","bool"),u=Object(r.a)(t,"b","logicalXor","bool");return Object(a.a)(n.shape,u.shape),Object(i.a)(Object(s.a)(e,t),Object(o.a)(Object(i.a)(e,t)))}})},"0wrZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({tan_:function(e){var t=Object(i.a)(e,"x","tan");return r.a.runKernel(a.Rc,{x:t})}})},1:function(e,t){},"17CO":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({real_:function(e){var t=Object(i.a)(e,"input","real");return r.a.runKernel(a.jc,{input:t})}})},"1N4k":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("VO80"),c=Object(u.b)({notEqual_:function(e,t){var n,u=Object(o.a)(e,"a","notEqual"),c=Object(o.a)(t,"b","notEqual");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],Object(s.a)(u.shape,c.shape),r.a.runKernel(a.Zb,{a:u,b:c})}})},"1OSX":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n("YSVl");n("1WXW");var a=function(){function e(t,n,a,i,o){_classCallCheck(this,e),this.mean=t,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=o||Math.random();this.random=r.alea(s.toString())}return _createClass(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),i=function(){function e(t,n,i,o){_classCallCheck(this,e),this.alpha=t,this.beta=1/n,this.dtype=i;var s=o||Math.random();this.randu=r.alea(s.toString()),this.randn=new a(0,1,i,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return _createClass(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i*=1/this.beta*this.d,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),o=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;if(_classCallCheck(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=a-n,this.dtype=i,null==o&&(o=Math.random()),"number"==typeof o&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(a," <= 1 and dtype is not float"));this.random=r.alea(o)}return _createClass(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}()},"1U0N":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.b)(e,"tensors","stack","string_or_numeric");return o.b(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&o.b(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),r.a.runKernel(a.cc,n,{axis:t})}})},"1WXW":function(e,t,n){"use strict";n.r(t),n.d(t,"TEST_EPSILON_FLOAT16",(function(){return s})),n.d(t,"expectArraysClose",(function(){return u})),n.d(t,"testEpsilon",(function(){return c})),n.d(t,"expectPromiseToFail",(function(){return h})),n.d(t,"expectArraysEqual",(function(){return d})),n.d(t,"expectNumbersClose",(function(){return f})),n.d(t,"expectValuesInRange",(function(){return m})),n.d(t,"expectArrayBuffersEqual",(function(){return v})),n.d(t,"encodeStrings",(function(){return g}));var r=n("auKK"),a=n("o/e8"),i=n("atXS"),o=n("6366"),s=.1;function u(e,t,n){return null==n&&(n=c()),l(e,t,(function(e,t){return p(e,t,n)}))}function c(){return 32===r.a.backend.floatPrecision()?.001:s}function l(e,t,n){var r=!0;if((Object(i.A)(e)||Object(i.A)(t))&&(r=!1),Object(i.A)(e)&&Object(i.A)(t)&&(r=!0),r){var o=e.constructor.name,s=t.constructor.name;if(o!==s)throw new Error("Arrays are of different type. Actual: ".concat(o,". Expected: ")+s)}if(Array.isArray(e)&&Array.isArray(t)){var u=Object(a.c)(e),c=Object(a.c)(t);if(!Object(i.a)(u,c))throw new Error("Arrays have different shapes. Actual: [".concat(u,"]. Expected: [").concat(c,"]"))}var l=Object(i.A)(e)?e:Object(i.m)(e),h=Object(i.A)(t)?t:Object(i.m)(t);if(l.length!==h.length)throw new Error("Arrays have different lengths actual: ".concat(l.length," vs expected: ").concat(h.length,".\nActual:   ").concat(l,".\nExpected: ").concat(h,"."));for(var d=0;d<h.length;++d){var f=l[d],p=h[d];if(!n(f,p))throw new Error("Arrays differ: actual[".concat(d,"] = ").concat(f,", expected[").concat(d,"] = ").concat(p,".\nActual:   ").concat(l,".\nExpected: ").concat(h,"."))}}function h(e,t){e().then((function(){return t.fail()}),(function(){return t()}))}function d(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return Object(i.z)(e)||Object(i.z)(e[0])||Object(i.z)(t)||Object(i.z)(t[0])?l(e,n,(function(e,t){return e==t})):l(e,t,(function(e,t){return p(e,t,0)}))}function f(e,t,n){if(null==n&&(n=c()),!p(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t))}function p(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function m(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:".concat(e[r]," low: ").concat(t,", high: ").concat(n))}function v(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}function g(e){for(var t=0;t<e.length;t++){var n=e[t];Array.isArray(n)?g(n):e[t]=Object(o.encodeString)(n)}return e}},2:function(e,t){},"20lx":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMin");return r.a.runKernel(a.i,{x:n},{axis:t})}})},"2ugP":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","expandDims","string_or_numeric");return o.b(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"})),r.a.runKernel(a.ab,{input:n},{dim:t})}})},3:function(e,t){},"34HJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","all","bool");return r.a.runKernel(a.f,{x:o},{axis:t,keepDims:n})}})},"3FnS":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({asinh_:function(e){var t=Object(i.a)(e,"x","asinh");return r.a.runKernel(a.k,{x:t})}})},"3X4V":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("uBja"),u=n("VO80"),c=n("NclT"),l=Object(u.b)({conv2d_:function(e,t,n,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,f=Object(i.a)(e,"x","conv2d"),p=Object(i.a)(t,"filter","conv2d"),m=f,v=!1;3===f.rank&&(v=!0,m=Object(c.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.b(4===m.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(m.rank,".")})),o.b(4===p.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+p.rank+"."})),null!=d&&o.b(o.v(u),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode ".concat(d," but got pad ").concat(u,".")}));var g="NHWC"===l?m.shape[3]:m.shape[1];o.b(g===p.shape[2],(function(){return"Error in conv2d: depth of input (".concat(g,") must match input depth for filter ").concat(p.shape[2],".")})),o.b(s.h(n,h),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(h,"'")}));var y=r.a.runKernel(a.C,{x:m,filter:p},{strides:n,pad:u,dataFormat:l,dilations:h,dimRoundingMode:d});return v?Object(c.a)(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})},"3hph":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({stridedSlice_:function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=Object(i.a)(e,"x","stridedSlice");return r.a.runKernel(a.Oc,{x:d},{begin:t,end:n,strides:o,beginMask:s,endMask:u,ellipsisMask:c,newAxisMask:l,shrinkAxisMask:h})}})},"3rNm":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({cast_:function(e,t){var n=Object(i.a)(e,"x","cast");if(!o.B(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return r.a.runKernel(a.w,{x:n},{dtype:t})}})},4:function(e,t){},"4FMF":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("3rNm"),s=n("VO80"),u=Object(s.b)({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object(i.a)(e,"x","sum");return"bool"===s.dtype&&(s=Object(o.a)(s,"int32")),r.a.runKernel(a.Qc,{x:s},{axis:t,keepDims:n})}})},"4QEz":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=Object(i.a)(e,"x","localResponseNormalization");o.b(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),o.b(o.v(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ".concat(t,".")}));var h=l,d=!1;3===l.rank&&(d=!0,h=Object(u.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var f=r.a.runKernel(a.vb,{x:h},{depthRadius:t,bias:n,alpha:s,beta:c});return d?Object(u.a)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},"4f3O":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("VO80"),c=Object(u.b)({less_:function(e,t){var n,u=Object(o.a)(e,"a","less"),c=Object(o.a)(t,"b","less");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],Object(s.a)(u.shape,c.shape),r.a.runKernel(a.yb,{a:u,b:c})}})},"4iwy":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var s=Object(i.a)(e,"indices","oneHot","int32");return r.a.runKernel(a.ac,{indices:s},{depth:t,onValue:n,offValue:o})}})},"4zPZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("Um8L"),s=n("VO80"),u=Object(s.b)({logicalAnd_:function(e,t){var n=Object(i.a)(e,"a","logicalAnd","bool"),s=Object(i.a)(t,"b","logicalAnd","bool");return Object(o.a)(n.shape,s.shape),r.a.runKernel(a.Eb,{a:n,b:s})}})},5:function(e,t){},6366:function(e,t,n){"use strict";n.r(t),n.d(t,"createScalarValue",(function(){return i})),n.d(t,"toTypedArray",(function(){return o})),n.d(t,"now",(function(){return s})),n.d(t,"fetch",(function(){return u})),n.d(t,"encodeString",(function(){return c})),n.d(t,"decodeString",(function(){return l}));var r=n("szMd"),a=n("atXS");function i(e,t){return"string"===t?c(e):o([e],t)}function o(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=a.m(e)),Object(r.c)().getBool("DEBUG")&&a.h(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),i=0;i<n.length;++i)0!==Math.round(e[i])&&(n[i]=1);return n}throw new Error("Unknown data type "+t)}function s(){return Object(r.c)().platform.now()}function u(e,t){return Object(r.c)().platform.fetch(e,t)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.c)().platform.encode(e,t)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.c)().platform.decode(e,t)}n.d(t,"shuffle",(function(){return a.M})),n.d(t,"clamp",(function(){return a.i})),n.d(t,"nearestLargerEven",(function(){return a.H})),n.d(t,"sum",(function(){return a.Q})),n.d(t,"randUniform",(function(){return a.J})),n.d(t,"distSquared",(function(){return a.l})),n.d(t,"assert",(function(){return a.b})),n.d(t,"assertShapesMatch",(function(){return a.e})),n.d(t,"assertNonNull",(function(){return a.d})),n.d(t,"flatten",(function(){return a.m})),n.d(t,"sizeFromShape",(function(){return a.N})),n.d(t,"isScalarShape",(function(){return a.y})),n.d(t,"arraysEqual",(function(){return a.a})),n.d(t,"isInt",(function(){return a.v})),n.d(t,"tanh",(function(){return a.R})),n.d(t,"sizeToSquarishShape",(function(){return a.O})),n.d(t,"createShuffledIndices",(function(){return a.k})),n.d(t,"rightPad",(function(){return a.L})),n.d(t,"repeatedTry",(function(){return a.K})),n.d(t,"inferFromImplicitShape",(function(){return a.s})),n.d(t,"parseAxisParam",(function(){return a.I})),n.d(t,"squeezeShape",(function(){return a.P})),n.d(t,"getTypedArrayFromDType",(function(){return a.o})),n.d(t,"getArrayFromDType",(function(){return a.n})),n.d(t,"checkConversionForErrors",(function(){return a.h})),n.d(t,"isValidDtype",(function(){return a.B})),n.d(t,"hasEncodingLoss",(function(){return a.p})),n.d(t,"isTypedArray",(function(){return a.A})),n.d(t,"bytesPerElement",(function(){return a.g})),n.d(t,"bytesFromStringArray",(function(){return a.f})),n.d(t,"isString",(function(){return a.z})),n.d(t,"isBoolean",(function(){return a.t})),n.d(t,"isNumber",(function(){return a.w})),n.d(t,"inferDtype",(function(){return a.r})),n.d(t,"isFunction",(function(){return a.u})),n.d(t,"nearestDivisor",(function(){return a.G})),n.d(t,"computeStrides",(function(){return a.j})),n.d(t,"toNestedArray",(function(){return a.S})),n.d(t,"makeOnesTypedArray",(function(){return a.D})),n.d(t,"makeZerosTypedArray",(function(){return a.F})),n.d(t,"makeZerosNestedTypedArray",(function(){return a.E})),n.d(t,"assertNonNegativeIntegerDimensions",(function(){return a.c})),n.d(t,"locToIndex",(function(){return a.C})),n.d(t,"indexToLoc",(function(){return a.q})),n.d(t,"isPromise",(function(){return a.x}))},"6J+n":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMax");return r.a.runKernel(a.h,{x:n},{axis:t})}})},"6vQL":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("o/e8"),a=n("atXS"),i=n("l0gX"),o=n("OygE"),s=n("uBja"),u=n("n+ZZ"),c=n("VO80"),l=n("NclT"),h=n("dYAU"),d=Object(c.b)({pool_:function(e,t,n,c,d,f){null==d&&(d=[1,1]),null==f&&(f=1),0===c&&(c="valid");var p=Object(r.a)(e,"x","maxPool"),m=p,v=!1;3===p.rank&&(v=!0,m=Object(l.a)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),a.b(s.h(f,d),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides ".concat(f," and dilations '").concat(d,"'")}));var g,y=s.e(m.shape,t,f,d,c),b=[y.dilationHeight,y.dilationWidth];g="same"===c?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([y.filterHeight,y.filterWidth],b):[[0,0],[0,0]];var k=1===b[0]&&1===b[1],_=_slicedToArray(function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]}));return[t.map((function(e,t){return[r[t],s[t]]})),t.map((function(e,t){return[0,o[t]]}))]}([y.inHeight,y.inWidth],b,g),2),w=_[0],x=_[1],C=k?c:"valid",O=k?m:Object(h.a)(m,b,w),S=("avg"===n?function(){return Object(i.a)(O,t,f,C)}:function(){return Object(u.a)(O,t,f,C)})(),T=k?S:Object(o.a)(S,b,x);return v?Object(l.a)(T,[T.shape[1],T.shape[2],T.shape[3]]):T}})},"7/dO":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({cos_:function(e){var t=Object(i.a)(e,"x","cos");return r.a.runKernel(a.I,{x:t})}})},"7wDt":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({logicalNot_:function(e){var t=Object(i.a)(e,"x","logicalNot","bool");return r.a.runKernel(a.Fb,{x:t})}})},"867m":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("3rNm"),s=n("VO80"),u=Object(s.b)({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object(i.a)(e,"x","prod");return"bool"===s.dtype&&(s=Object(o.a)(s,"int32")),r.a.runKernel(a.hc,{x:s},{axis:t,keepDims:n})}})},"8Km0":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({clone_:function(e){var t=Object(i.a)(e,"x","clone","string_or_numeric");return r.a.runKernel(a.qb,{x:t})}})},"8OX7":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("3rNm"),c=n("VO80"),l=Object(c.b)({minimum_:function(e,t){var n,c=Object(o.a)(e,"a","minimum"),l=Object(o.a)(t,"b","minimum");return c=(n=_slicedToArray(Object(i.makeTypesMatch)(c,l),2))[0],l=n[1],"bool"===c.dtype&&(c=Object(u.a)(c,"int32"),l=Object(u.a)(l,"int32")),Object(s.a)(c.shape,l.shape),r.a.runKernel(a.Qb,{a:c,b:l})}})},"8YN0":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("Um8L"),s=n("VO80"),u=Object(s.b)({logicalOr_:function(e,t){var n=Object(i.a)(e,"a","logicalOr","bool"),s=Object(i.a)(t,"b","logicalOr","bool");return Object(o.a)(n.shape,s.shape),r.a.runKernel(a.Gb,{a:n,b:s})}})},"8bUJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return y}));var r=n("wE5H"),a=n("o/e8"),i=n("atXS"),o=n("ubnP"),s=n("zvA9"),u=n("uy0A"),c=n("4f3O"),l=n("shz4"),h=n("1N4k"),d=n("VO80"),f=Object(d.b)({equalStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","equalStrict"),s=Object(a.a)(t,"b","equalStrict");return Object(i.e)(n.shape,s.shape,"Error in equalStrict: "),Object(o.a)(n,s)}}),p=Object(d.b)({greaterEqualStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","greaterEqualStrict"),o=Object(a.a)(t,"b","greaterEqualStrict");return Object(i.e)(n.shape,o.shape,"Error in greaterEqualStrict: "),Object(u.a)(n,o)}}),m=Object(d.b)({greaterStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","greaterStrict"),o=Object(a.a)(t,"b","greaterStrict");return Object(i.e)(n.shape,o.shape,"Error in greaterStrict: "),Object(s.a)(n,o)}}),v=Object(d.b)({lessEqualStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","lessEqualStrict"),o=Object(a.a)(t,"b","lessEqualStrict");return Object(i.e)(n.shape,o.shape,"Error in lessEqualStrict: "),Object(l.a)(n,o)}}),g=Object(d.b)({lessStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","lessStrict"),o=Object(a.a)(t,"b","lessStrict");return Object(i.e)(n.shape,o.shape,"Error in lessStrict: "),Object(c.a)(n,o)}}),y=Object(d.b)({notEqualStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","notEqualStrict"),o=Object(a.a)(t,"b","notEqualStrict");return Object(i.e)(n.shape,o.shape,"Error in notEqualStrict: "),Object(h.a)(n,o)}})},"90yW":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("NNfn"),a=n("o/e8"),i=n("atXS"),o=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var o,s,u,c,l,h,d,f,p,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(a.a)(t,"x","setdiff1d"),s=Object(a.a)(n,"y","setdiff1d"),i.b(o.dtype===s.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(o.dtype,") and y (").concat(s.dtype,").")})),i.b(1===o.rank,(function(){return"x should be 1D tensor, but got x (".concat(o.shape,").")})),i.b(1===s.rank,(function(){return"y should be 1D tensor, but got y (".concat(s.shape,").")})),e.next=4,o.data();case 4:return u=e.sent,e.next=7,s.data();case 7:for(c=e.sent,l=new Set(c),h=0,d=0;d<u.length;d++)l.has(u[d])||h++;for(f=new r.b([h],o.dtype),p=new r.b([h],"int32"),m=0,v=0;m<u.length;m++)l.has(u[m])||(f.values[v]=u[m],p.values[v]=m,v++);return e.abrupt("return",[f.toTensor(),p.toTensor()]);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},"91d6":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n("o/e8"),a=n("atXS"),i=n("iuCH"),o=n("NuWS"),s=n("wCH+"),u=n("rm0a"),c=n("VO80"),l=n("yfHJ"),h=n("NclT"),d=n("AV8V"),f=n("Fjpt"),p=n("k7Jv"),m=n("4FMF"),v=Object(c.b)({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],v=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return Object(i.a)(t);if(1!==t.rank&&null===r)return e(Object(h.a)(t,[-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return Object(m.a)(Object(i.a)(t),r);if(n===1/0)return Object(s.a)(Object(i.a)(t),r);if(n===-1/0)return Object(u.a)(Object(i.a)(t),r);if("euclidean"===n||2===n)return Object(f.a)(Object(m.a)(Object(l.a)(Object(i.a)(t),Object(d.a)(2,"int32")),r));throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return Object(s.a)(Object(m.a)(Object(i.a)(t),r[0]),r[1]-1);if(n===1/0)return Object(s.a)(Object(m.a)(Object(i.a)(t),r[1]),r[0]);if(n===-1/0)return Object(u.a)(Object(m.a)(Object(i.a)(t),r[1]),r[0]);if("fro"===n||"euclidean"===n)return Object(f.a)(Object(m.a)(Object(p.a)(t),r));throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=Object(r.a)(e,"x","norm"),t,n),g=v.shape;if(c){var y=Object(a.I)(n,e.shape);g=o.e(v.shape,y)}return Object(h.a)(v,g)}})},"9JAK":function(e,t,n){"use strict";var r;function a(){if(null==r){var e;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof global)e=global;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}r=e}return r}function i(e,t){var n,r=(null==(n=a())._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals);if(r.has(e))return r.get(e);var i=t();return r.set(e,i),r.get(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},"ARu+":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("dsKV"),a=n("o/e8"),i=n("x3y4"),o=n("ubnP"),s=n("VO80"),u=n("Z5Ez"),c=n("oJu+"),l=Object(s.b)({divNoNan_:function(e,t){var n=Object(a.a)(e,"a","div"),s=Object(a.a)(t,"b","div"),l=_slicedToArray(Object(r.makeTypesMatch)(n,s),2);n=l[0],s=l[1];var h=Object(i.a)(n,s),d=Object(c.a)(h),f=Object(o.a)(s,d);return Object(u.a)(f,d,h)}})},AV8V:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("atXS"),a=n("WVnj");function i(e,t){if((Object(r.A)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Object(r.A)(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Object(a.a)(e,[],[],t)}},AoCb:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("BD40");function a(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);for(var i=Object(r.a)(e,"int32"),o=Object(r.a)([n.length,e.length],"int32"),s=0;s<n.length;s++){var u=i.indexToLoc(n[s]);o.values.set(u,s*e.length)}return o.toTensor()}},B3db:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({complex_:function(e,t){var n=Object(i.a)(e,"real","complex"),s=Object(i.a)(t,"imag","complex");return o.e(n.shape,s.shape,"real and imag shapes, ".concat(n.shape," and ").concat(s.shape,", must match in call to tf.complex().")),r.a.runKernel(a.z,{real:n,imag:s})}})},B9Yq:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},BD40:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("NNfn"),a=n("atXS");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",a.c(e),new r.b(e,t,n)}},BMSg:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({bincount_:function(e,t,n){var s=Object(i.a)(e,"x","bincount"),u=Object(i.a)(t,"weights","bincount");return o.b("int32"===s.dtype,(function(){return"Error in bincount: input dtype must be int32, but got "+s.dtype})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(u.size===s.size||0===u.size,(function(){return"Error in bincount: weights must have the same size as input or0-length, but got input shape: ".concat(s.shape,", weights shape: ")+u.shape+"."})),r.a.runKernel(a.u,{x:s,weights:u},{size:n})}})},BbuY:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("o/e8"),a=n("atXS"),i=n("WVnj");function o(e,t,n){if(Object(a.d)(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var o=Object(r.c)(e,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Object(i.a)(e,t,o,n)}},CKnt:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({round_:function(e){var t=Object(i.a)(e,"x","round");return r.a.runKernel(a.vc,{x:t})}})},CfTU:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("3rNm"),c=n("VO80"),l=Object(c.b)({maximum_:function(e,t){var n,c=Object(o.a)(e,"a","maximum"),l=Object(o.a)(t,"b","maximum");return c=(n=_slicedToArray(Object(i.makeTypesMatch)(c,l),2))[0],l=n[1],"bool"===c.dtype&&(c=Object(u.a)(c,"int32"),l=Object(u.a)(l,"int32")),Object(s.a)(c.shape,l.shape),r.a.runKernel(a.Nb,{a:c,b:l})}})},CtZu:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"json",(function(){return j}));var a={};n.r(a),n.d(a,"json",(function(){return F}));var i={};n.r(i),n.d(i,"json",(function(){return M}));var o={};n.r(o),n.d(o,"json",(function(){return P}));var s={};n.r(s),n.d(s,"json",(function(){return L}));var u={};n.r(u),n.d(u,"json",(function(){return z}));var c={};n.r(c),n.d(c,"json",(function(){return B}));var l={};n.r(l),n.d(l,"json",(function(){return V}));var h={};n.r(h),n.d(h,"json",(function(){return W}));var d={};n.r(d),n.d(d,"json",(function(){return U}));var f={};n.r(f),n.d(f,"json",(function(){return H}));var p={};n.r(p),n.d(p,"json",(function(){return G}));var m={};n.r(m),n.d(m,"json",(function(){return K}));var v={};n.r(v),n.d(v,"json",(function(){return q}));var g={};n.r(g),n.d(g,"json",(function(){return X}));var y={};n.r(y),n.d(y,"json",(function(){return Z}));var b={};n.r(b),n.d(b,"json",(function(){return Y}));var k,_,w=n("+hG3");!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(k||(k={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(_||(_={}));var x={};function C(e,t){x[e]={tfOpName:e,category:"custom",inputs:[],attrs:[],customExecutor:t}}function O(e){return x[e]}function S(e){delete x[e]}function T(e,t,n,r,a){var i=t.inputParams[e];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,s=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd;if("tensor"===i.type)return I(t.inputNames[i.inputIndexStart],n,r,a);if("tensors"===i.type)return t.inputNames.slice(o,s).map((function(e){return I(e,n,r,a)}));var u=I(t.inputNames.slice(o)[0],n,r,a),c=u.dataSync();return"number"===i.type?c[0]:w.util.toNestedArray(u.shape,c)}var l=t.attrParams[e];return l&&l.value}function I(e,t,n,r){var a=_slicedToArray(A(e),2),i=a[0],o=a[1];if(null!=r){var s=r.getHashTableHandleByName(i);if(null!=s)return s}var u=n.currentContextIds.find((function(e){return!!t[N(i,e)]}));return void 0!==u?t[N(i,u)][o]:void 0}function E(e,t){var n=_slicedToArray(A(e),2),r=n[0],a=n[1];return[N(r,t&&t.currentContextId),a]}function N(e,t){return t?"".concat(e,"-").concat(t):e}function A(e){var t=e.split(":");return 1===t.length?[e,0]:[t[0],Number(t[t.length-1])]}function R(e,t,n){var r=T("pad",e,t,n);if("explicit"===r){r=T("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],i=0;i<4;i++)a[i][0]=r[2*i],a[i][1]=r[2*i+1];return a}return r}function D(e){return e.kept?e:Object(w.clone)(e)}var j=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],F=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],M=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],P=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],L=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],z=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],B=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],V=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],W=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}],U=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],H=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],G=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],K=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],q=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],X=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Z=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Y=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}],Q=function(){function e(){var t;_classCallCheck(this,e);var n=(t=[]).concat.apply(t,_toConsumableArray([r,a,i,o,s,u,c,f,d,l,p,m,v,g,y,b,h].map((function(e){return e.json}))));this.opMappers=n.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return _createClass(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],a=[],i=[],o=e.node.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?r.push(e[n.name]):"Const"===n.op?a.push(e[n.name]):null!=n.input&&0!==n.input.length||i.push(e[n.name]),e}),{}),s=[],u=[],c={},l={};null!=n&&(c=this.mapSignatureEntries(n.inputs),l=this.mapSignatureEntries(n.outputs));var h=Object.keys(o);h.forEach((function(e){var t=o[e];t.inputNames.forEach((function(e){var n=_slicedToArray(E(e),1)[0];t.inputs.push(o[n]),o[n].children.push(t)}))})),0===Object.keys(l).length?h.forEach((function(e){var t=o[e];0===t.children.length&&u.push(t)})):Object.keys(l).forEach((function(e){var t=_slicedToArray(E(e),1)[0],n=o[t];null!=n&&(n.signatureKey=l[e],u.push(n))})),Object.keys(c).length>0?Object.keys(c).forEach((function(e){var t=_slicedToArray(E(e),1)[0],n=o[t];n&&(n.signatureKey=c[e],s.push(n))})):s=r;var d={};null!=e.library&&null!=e.library.function&&(d=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var f={nodes:o,inputs:s,outputs:u,weights:a,placeholders:r,signature:n,functions:d};return i.length>0&&(f.initNodes=i),f}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=O(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=$(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=$(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=ce(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ce(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=te(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=te(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=ue(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ue(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=ee(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ee(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=he(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=he(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=se(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=se(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=le(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=le(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=ae(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ae(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=ie(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ie(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=re(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=re(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&r.push(e[n.name]),e}),{}));var i=[],o=[];e.signature.inputArg.forEach((function(e){var t=_slicedToArray(E(e.name),1)[0],n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:ne(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,i.push(n),a[t]=n})),Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e){var n=_slicedToArray(E(e),1)[0];t.inputs.push(a[n]),a[n].children.push(t)}))}));var s=e.ret;e.signature.outputArg.forEach((function(e){var t=_slicedToArray(E(s[e.name]),2),n=t[0],r=t[1],i=a[n];null!=i&&(i.defaultOutput=r,o.push(i))}));var u=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:[],signature:u}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function J(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=Object(w.env)().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function $(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?J(a.s,r):n}function ee(e,t,n){var r=e[t];return r?r.b:n}function te(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function ne(e){switch("string"==typeof e&&(e=k[e]),e){case k.DT_FLOAT:return"float32";case k.DT_INT32:case k.DT_INT64:case k.DT_INT8:case k.DT_UINT8:return"int32";case k.DT_BOOL:return"bool";case k.DT_DOUBLE:return"float32";case k.DT_STRING:return"string";default:return null}}function re(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function ae(e,t,n){var r=e[t];return r&&r.type?ne(r.type):n}function ie(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return ne(e)})):n}function oe(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"==typeof e.size?e.size:parseInt(e.size,10)})):[]}function se(e,t,n){var r=e[t];return r&&r.shape?oe(r.shape):n}function ue(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"==typeof e?e:parseInt(e,10)})):n}function ce(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return J(e,r)})):n}function le(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return oe(e)})):n}function he(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var de=function(){function e(t,n,r){var a=this;_classCallCheck(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return _createClass(e,[{key:"getInput",value:function(e){return I(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return I(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return te(this.node.rawAttrs,e,t);if(null!=n.s)return $(this.node.rawAttrs,e,t);if(null!=n.b)return ee(this.node.rawAttrs,e,t);if(null!=n.shape)return se(this.node.rawAttrs,e,t);if(null!=n.type)return ae(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return ue(this.node.rawAttrs,e,t);if(null!=n.list.s)return ce(this.node.rawAttrs,e,t);if(null!=n.list.shape)return le(this.node.rawAttrs,e,t);if(null!=n.list.b)return he(this.node.rawAttrs,e,t);if(null!=n.list.type)return ie(this.node.rawAttrs,e,t)}return t}}]),e}(),fe=n("kRdc"),pe=n("SFB9"),me=n("RhH0"),ve=n("parS"),ge=n("x3y4"),ye=n("ARu+"),be=n("UI8N"),ke=n("oAkI"),_e=n("8OX7"),we=n("CfTU"),xe=n("yfHJ"),Ce=n("QYQ3"),Oe=n("iuCH"),Se=n("o3Rt"),Te=n("RhVc"),Ie=n("Ig+c"),Ee=n("3FnS"),Ne=n("fjZN"),Ae=n("YAKK"),Re=n("0ahe"),De=n("WWBm"),je=n("B3db"),Fe=n("7/dO"),Me=n("waK1"),Pe=n("njhW"),Le=n("jgXy"),ze=n("TyAZ"),Be=n("G6IW"),Ve=n("02mo"),We=n("E1lT"),Ue=n("RrGL"),He=n("JLAb"),Ge=n("O7f5"),Ke=n("tQDl"),qe=n("17CO"),Xe=n("kXpR"),Ze=n("CKnt"),Ye=n("s57M"),Qe=n("/7N0"),Je=n("aTLu"),$e=n("Hfat"),et=n("XcSs"),tt=n("n/2y"),nt=n("Fjpt"),rt=n("k7Jv"),at=n("iIjY"),it=n("0wrZ"),ot=n("wI/y"),st=n("Rqg+"),ut=n("Xyqe"),ct=n("867m"),lt=n("bzdD"),ht=n("Ug8H");function dt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";w.util.assert(function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0}(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}var ft=function(){function e(t,n,r,a,i,o,s){_classCallCheck(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=Object(w.scalar)(0),Object(w.keep)(this.idTensor)}return _createClass(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?)."));return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),dt(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,Object(w.keep)(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,because the index size: ").concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return Object(w.tensor)([],[0].concat(this.elementShape));var r=this.readMany(e);return dt(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(w.stack)(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return Object(w.tensor)([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return dt(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),Object(w.concat)(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,_toConsumableArray(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,Object(w.unstack)(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), and the TensorArray is not marked as dynamically resizeable"));var i=0===r?0:t.size/r,o=[];Object(w.tidy)((function(){t=Object(w.reshape)(t,[1,r,i]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,e[s],i];o[s]=Object(w.reshape)(Object(w.slice)(t,u,c),n.elementShape)}return o}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,o)}}]),e}(),pt=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;_classCallCheck(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));dt(n,e.shape,"TensorList shape mismatch: "),Object(w.keep)(e)})),this.idTensor=Object(w.scalar)(0),this.maxNumElements=a,Object(w.keep)(this.idTensor)}return _createClass(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e(_toConsumableArray(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));return dt(e,this.elementShape,"TensorList shape mismatch: "),Object(w.tidy)((function(){var t=n.tensors.map((function(t){return Object(w.reshape)(t,e)}));return Object(w.stack)(t,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=this.tensors.pop();return dt(n.shape,e,"TensorList shape mismatch: "),Object(w.reshape)(n,e)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(dt(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Object(w.keep)(e),this.tensors.push(e)}},{key:"resize",value:function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: "+e);if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=e}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));return dt(this.tensors[e].shape,t,"TensorList shape mismatch: "),this.tensors[e]}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));dt(this.elementShape,t.shape,"TensorList shape mismatch: "),Object(w.keep)(t),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));return dt(this.elementShape,n,"TensorList shape mismatch: "),0===(e=e.slice(0,this.size())).length?Object(w.tensor)([],[0].concat(this.elementShape)):Object(w.tidy)((function(){var t=e.map((function(e){return Object(w.reshape)(r.tensors[e],n)}));return Object(w.stack)(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));return dt(this.elementShape,t,"TensorList shape mismatch: "),0===this.size()?Object(w.tensor)([],[0].concat(this.elementShape)):Object(w.tidy)((function(){var e=n.tensors.map((function(e){return Object(w.reshape)(e,t)}));return Object(w.concat)(e,0)}))}}]),e}(),mt=n("dnXz"),vt=n("3X4V"),gt=n("EysY"),yt=n("zR+/"),bt=n("g4+C"),kt=n("FZCF"),_t=n("l0gX"),wt=n("n+ZZ"),xt=n("i8k8"),Ct=n("ulO0"),Ot=n("U/2n"),St=n("wXC5");function Tt(e,t,n){var r=_slicedToArray(T("fusedOps",e,t,n),2),a=r[0],i=r[1],o="biasadd"===a,s="prelu"===i,u="fusedbatchnorm"===a,c=T("numArgs",e,t,n);if(o){if(s&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");var l=T("strides",e,t,n),h=R(e,t,n),d=T("dataFormat",e,t,n).toUpperCase(),f=T("dilations",e,t,n),p=_slicedToArray(T("args",e,t,n),2);return{stride:l,pad:h,dataFormat:d,dilations:f,biasArg:p[0],preluArg:p[1],activationFunc:i,leakyreluAlpha:T("leakyreluAlpha",e,t,n)}}var It=n("RrjA"),Et=n("WJRb"),Nt=n("Pvz5"),At=n("4iwy"),Rt=n("wion"),Dt=n("DbV5"),jt=n("hinG"),Ft=n("hNYx"),Mt=n("fmoR"),Pt=n("Wiw4"),Lt=n("oJu+"),zt=n("3rNm"),Bt=n("p4Cv"),Vt=n("90yW");function Wt(e,t,n){return{boxes:T("boxes",e,t,n),scores:T("scores",e,t,n),maxOutputSize:T("maxOutputSize",e,t,n),iouThreshold:T("iouThreshold",e,t,n),scoreThreshold:T("scoreThreshold",e,t,n),softNmsSigma:T("softNmsSigma",e,t,n)}}var Ut=n("VhY8"),Ht=n("hT5K"),Gt=n("lg8H"),Kt=n("AV8V"),qt=function(){function e(t,n){_classCallCheck(this,e),this.keyDType=t,this.valueDType=n,this.handle=Object(w.scalar)(0),this.tensorMap=new Map,Object(w.keep)(this.handle)}var t,n;return _createClass(e,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"import",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,e.abrupt("return",(this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),Object(w.tidy)((function(){var e=Object(w.unstack)(n),t=r.length,i=e.length;w.util.assert(t===i,(function(){return"The number of elements doesn't match, keys has ".concat(t," elements, the values has ").concat(i," elements.")}));for(var o=0;o<t;o++){var s=r[o],u=e[o];Object(w.keep)(u),a.tensorMap.set(s,u)}return a.handle}))));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"find",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return r=e.sent,e.abrupt("return",Object(w.tidy)((function(){for(var e=[],t=0;t<r.length;t++){var i=a.findWithDefault(r[t],n);e.push(i)}return Object(w.stack)(e)})));case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"findWithDefault",value:function(e,t){var n=this.tensorMap.get(e);return null!=n?n:t}},{key:"checkKeyAndValueTensor",value:function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+e.dtype);if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+t.dtype)}}]),e}(),Xt=n("ubnP"),Zt=n("1N4k"),Yt=n("zvA9"),Qt=n("uy0A"),Jt=n("4f3O"),$t=n("shz4"),en=n("4zPZ"),tn=n("7wDt"),nn=n("8YN0"),rn=n("Z5Ez"),an=n("SHv8"),on=n("yRKQ"),sn=n("cdtJ"),un=n("4QEz"),cn=n("X4fa"),ln=n("gErV"),hn=n("vGLV"),dn=n("wCH+"),fn=n("Ei6o"),pn=n("rm0a"),mn=n("4FMF"),vn=n("34HJ"),gn=n("RRa9"),yn=n("6J+n"),bn=n("20lx"),kn=n("HmhO"),_n=n("BMSg"),wn=n("LyxI"),xn=n("ZJ6U"),Cn=n("kaMP"),On=n("0I63"),Sn=n("bTzI"),Tn=n("3hph"),In=n("0fRV"),En=n("NclT"),Nn=n("1U0N"),An=n("OkRW"),Rn=n("jXH2"),Dn=n("RbuM"),jn=n("i/oj"),Fn=n("ukBL"),Mn=n("Grcp"),Pn=n("THqV"),Ln=n("th0q"),zn=n("adw1"),Bn=n("2ugP"),Vn=n("k9tH"),Wn=n("DrVt"),Un=n("dYAU"),Hn=n("OygE"),Gn=n("Nk7E"),Kn=n("SNsm");function qn(e,t,n,r){var a=function(e,t,n){switch(e.category){case"arithmetic":return w.tidy((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[fe.a(T("a",e,t,n),T("b",e,t,n))];case"AddN":return[pe.a(T("tensors",e,t,n))];case"FloorMod":case"Mod":return[me.a(T("a",e,t,n),T("b",e,t,n))];case"Mul":return[ve.a(T("a",e,t,n),T("b",e,t,n))];case"RealDiv":case"Div":return[ge.a(T("a",e,t,n),T("b",e,t,n))];case"DivNoNan":return[ye.a(T("a",e,t,n),T("b",e,t,n))];case"FloorDiv":return[be.a(T("a",e,t,n),T("b",e,t,n))];case"Sub":return[ke.a(T("a",e,t,n),T("b",e,t,n))];case"Minimum":return[_e.a(T("a",e,t,n),T("b",e,t,n))];case"Maximum":return[we.a(T("a",e,t,n),T("b",e,t,n))];case"Pow":return[xe.a(T("a",e,t,n),T("b",e,t,n))];case"SquaredDifference":return[Ce.a(T("a",e,t,n),T("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"basic_math":return w.tidy((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[Oe.a(T("x",e,t,n))];case"Acos":return[Se.a(T("x",e,t,n))];case"Acosh":return[Te.a(T("x",e,t,n))];case"Asin":return[Ie.a(T("x",e,t,n))];case"Asinh":return[Ee.a(T("x",e,t,n))];case"Atan":return[Ne.a(T("x",e,t,n))];case"Atan2":return[Ae.a(T("x",e,t,n),T("y",e,t,n))];case"Atanh":return[Re.a(T("x",e,t,n))];case"Ceil":return[De.a(T("x",e,t,n))];case"Complex":return[je.a(T("real",e,t,n),T("imag",e,t,n))];case"Cos":return[Fe.a(T("x",e,t,n))];case"Cosh":return[Me.a(T("x",e,t,n))];case"Elu":return[Pe.a(T("x",e,t,n))];case"Erf":return[Le.a(T("x",e,t,n))];case"Exp":return[ze.a(T("x",e,t,n))];case"Expm1":return[Be.a(T("x",e,t,n))];case"Floor":return[Ve.a(T("x",e,t,n))];case"Log":return[We.a(T("x",e,t,n))];case"Log1p":return[Ue.a(T("x",e,t,n))];case"Imag":return[He.a(T("x",e,t,n))];case"Neg":return[Ge.a(T("x",e,t,n))];case"Reciprocal":return[Ke.a(T("x",e,t,n))];case"Real":return[qe.a(T("x",e,t,n))];case"Relu":return[Xe.a(T("x",e,t,n))];case"Round":return[Ze.a(T("x",e,t,n))];case"Selu":return[Ye.a(T("x",e,t,n))];case"Sigmoid":return[Qe.a(T("x",e,t,n))];case"Sin":return[Je.a(T("x",e,t,n))];case"Sign":return[$e.a(T("x",e,t,n))];case"Sinh":return[et.a(T("x",e,t,n))];case"Softplus":return[tt.a(T("x",e,t,n))];case"Sqrt":return[nt.a(T("x",e,t,n))];case"Square":return[rt.a(T("x",e,t,n))];case"Tanh":return[at.a(T("x",e,t,n))];case"Tan":return[it.a(T("x",e,t,n))];case"ClipByValue":return[ot.a(T("x",e,t,n),T("clipValueMin",e,t,n),T("clipValueMax",e,t,n))];case"Relu6":return[st.a(T("x",e,t,n))];case"Rsqrt":return[ut.a(I(e.inputNames[0],t,n))];case"Prod":return[ct.a(T("x",e,t,n),T("axes",e,t,n))];case"LeakyRelu":return[lt.a(T("x",e,t,n),T("alpha",e,t,n))];case"Prelu":return[ht.a(T("x",e,t,n),T("alpha",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"control":return(s=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,k,_,x,C,O,S,E,N,A,R,j,F,M,P,L,z,B,V,W,U,H,G,K,q,X,Z,Y,Q,J,$,ee,te,ne,re,ae,ie,oe,se,ue,ce,le,he,de,fe,pe,me,ve,ge,ye,be,ke,_e,we,xe,Ce,Oe,Se,Te,Ie,Ee,Ne,Ae,Re,De;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0?3:"StatelessIf"===e.t0?3:"While"===e.t0?12:"StatelessWhile"===e.t0?12:"LoopCond"===e.t0?16:"Switch"===e.t0?17:"Merge"===e.t0?28:"Enter"===e.t0?30:"Exit"===e.t0?32:"NextIteration"===e.t0?34:"TensorArrayV3"===e.t0?36:"TensorArrayWriteV3"===e.t0?38:"TensorArrayReadV3"===e.t0?40:"TensorArrayGatherV3"===e.t0?42:"TensorArrayScatterV3"===e.t0?44:"TensorArrayConcatV3"===e.t0?46:"TensorArraySplitV3"===e.t0?48:"TensorArraySizeV3"===e.t0?50:"TensorArrayCloseV3"===e.t0?52:"TensorListSetItem"===e.t0?54:"TensorListGetItem"===e.t0?56:"TensorListScatterV2"===e.t0?58:"TensorListScatter"===e.t0?58:"TensorListReserve"===e.t0?60:"EmptyTensorList"===e.t0?60:"TensorListGather"===e.t0?64:"TensorListStack"===e.t0?66:"TensorListFromTensor"===e.t0?68:"TensorListConcat"===e.t0?70:"TensorListPushBack"===e.t0?72:"TensorListPopBack"===e.t0?74:"TensorListSplit"===e.t0?76:78;break;case 3:return a=T("thenBranch",t,n,r),i=T("elseBranch",t,n,r),o=T("cond",t,n,r),s=T("args",t,n,r),e.next=6,o.data();case 6:if(!e.sent[0]){e.next=10;break}e.t1=r.functionMap[a].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap),e.next=11;break;case 10:e.t1=r.functionMap[i].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap);case 11:return e.abrupt("return",e.t1);case 12:return e.delegateYield(regeneratorRuntime.mark((function e(){var a,i,o,s,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=T("body",t,n,r),i=T("cond",t,n,r),o=T("args",t,n,r),e.next=5,r.functionMap[i].executeFunctionAsync(o,r.tensorArrayMap,r.tensorListMap);case 5:return s=e.sent,u=o.map((function(e){return e.id})),e.next=9,s[0].data();case 9:c=e.sent,s.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||e.dispose()})),l=o,h=regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l,e.next=3,r.functionMap[a].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 3:return l=e.sent,n=l.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,r.functionMap[i].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 8:return o=e.sent,e.next=11,o[0].data();case 11:c=e.sent,o.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 13:if(!c[0]){e.next=17;break}return e.delegateYield(h(),"t0",15);case 15:e.next=13;break;case 17:return e.abrupt("return",{v:l});case 18:case"end":return e.stop()}}),e)}))(),"t2",13);case 13:if("object"!=typeof(u=e.t2)){e.next=16;break}return e.abrupt("return",u.v);case 16:return e.abrupt("return",[D(T("pred",t,n,r))]);case 17:return c=T("pred",t,n,r),(l=T("data",t,n,r)).kept||(l=D(l)),e.next=22,c.data();case 22:if(!e.sent[0]){e.next=26;break}e.t3=[void 0,l],e.next=27;break;case 26:e.t3=[l,void 0];case 27:return e.abrupt("return",e.t3);case 28:return h=t.inputNames.find((function(e){return void 0!==I(e,n,r)})),e.abrupt("return",h?[D(I(h,n,r))]:void 0);case 30:return d=T("frameName",t,n,r),f=T("tensor",t,n,r),e.abrupt("return",(r.enterFrame(d),[D(f)]));case 32:return p=T("tensor",t,n,r),e.abrupt("return",(r.exitFrame(),[D(p)]));case 34:return m=T("tensor",t,n,r),e.abrupt("return",(r.nextIteration(),[D(m)]));case 36:return v=T("size",t,n,r),g=T("dtype",t,n,r),y=T("elementShape",t,n,r),b=T("dynamicSize",t,n,r),k=T("clearAfterRead",t,n,r),_=T("identicalElementShapes",t,n,r),x=T("name",t,n,r),C=new ft(x,g,v,y,_,b,k),e.abrupt("return",(r.addTensorArray(C),[C.idTensor,Object(w.scalar)(1)]));case 38:return O=T("tensorArrayId",t,n,r),S=T("index",t,n,r),E=T("tensor",t,n,r),N=r.getTensorArray(O.id),e.abrupt("return",(N.write(S,E),[N.idTensor]));case 40:return A=T("tensorArrayId",t,n,r),R=T("index",t,n,r),e.abrupt("return",[r.getTensorArray(A.id).read(R)]);case 42:return j=T("tensorArrayId",t,n,r),F=T("indices",t,n,r),M=T("dtype",t,n,r),e.abrupt("return",[r.getTensorArray(j.id).gather(F,M)]);case 44:return P=T("tensorArrayId",t,n,r),L=T("indices",t,n,r),z=T("tensor",t,n,r),B=r.getTensorArray(P.id),e.abrupt("return",(B.scatter(L,z),[B.idTensor]));case 46:return V=T("tensorArrayId",t,n,r),W=r.getTensorArray(V.id),U=T("dtype",t,n,r),e.abrupt("return",[W.concat(U)]);case 48:return H=T("tensorArrayId",t,n,r),G=T("tensor",t,n,r),K=T("lengths",t,n,r),q=r.getTensorArray(H.id),e.abrupt("return",(q.split(K,G),[q.idTensor]));case 50:return X=T("tensorArrayId",t,n,r),Z=r.getTensorArray(X.id),e.abrupt("return",[Object(w.scalar)(Z.size(),"int32")]);case 52:return Y=T("tensorArrayId",t,n,r),Q=r.getTensorArray(Y.id),e.abrupt("return",(Q.clearAndClose(),[Q.idTensor]));case 54:return J=T("tensorListId",t,n,r),$=T("index",t,n,r),ee=T("tensor",t,n,r),te=r.getTensorList(J.id),e.abrupt("return",(te.setItem($,ee),[te.idTensor]));case 56:return ne=T("tensorListId",t,n,r),re=T("index",t,n,r),ae=T("elementShape",t,n,r),ie=T("elementDType",t,n,r),e.abrupt("return",[r.getTensorList(ne.id).getItem(re,ae,ie)]);case 58:return oe=T("indices",t,n,r),se=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var a=Math.max.apply(Math,_toConsumableArray(t));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var i=new pt([],n,e.dtype,r),o=Object(w.unstack)(e,0);return t.forEach((function(e,t){i.setItem(e,o[t])})),i}(T("tensor",t,n,r),oe,T("elementShape",t,n,r),T("numElements",t,n,r)),e.abrupt("return",(r.addTensorList(se),[se.idTensor]));case 60:return ue=T("elementShape",t,n,r),ce=T("elementDType",t,n,r),le="TensorListReserve"===t.op?"numElements":"maxNumElements",he=function(e,t,n){return new pt([],e,t,n)}(ue,ce,T(le,t,n,r)),e.abrupt("return",(r.addTensorList(he),[he.idTensor]));case 64:return de=T("tensorListId",t,n,r),fe=T("indices",t,n,r),pe=T("elementShape",t,n,r),me=T("elementDType",t,n,r),e.abrupt("return",[r.getTensorList(de.id).gather(fe,me,pe)]);case 66:return ve=T("tensorListId",t,n,r),ge=T("elementShape",t,n,r),ye=T("elementDType",t,n,r),be=T("numElements",t,n,r),e.abrupt("return",[r.getTensorList(ve.id).stack(ge,ye,be)]);case 68:return ke=function(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: "+e.shape);if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));dt(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=Object(w.unstack)(e);return new pt(a,t,r)}(T("tensor",t,n,r),T("elementShape",t,n,r),T("elementDType",t,n,r)),e.abrupt("return",(r.addTensorList(ke),[ke.idTensor]));case 70:return _e=T("tensorListId",t,n,r),we=r.getTensorList(_e.id),xe=T("dtype",t,n,r),Ce=T("elementShape",t,n,r),e.abrupt("return",[we.concat(xe,Ce)]);case 72:return Oe=T("tensorListId",t,n,r),Se=T("tensor",t,n,r),Te=r.getTensorList(Oe.id),e.abrupt("return",(Te.pushBack(Se),[Te.idTensor]));case 74:return Ie=T("tensorListId",t,n,r),Ee=T("elementShape",t,n,r),Ne=T("elementDType",t,n,r),e.abrupt("return",[r.getTensorList(Ie.id).popBack(Ee,Ne)]);case 76:return Ae=T("tensor",t,n,r),Re=T("elementShape",t,n,r),De=function(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var i=0===r?0:e.size/r,o=Object(w.tidy)((function(){var o=[];e=Object(w.reshape)(e,[1,r,i]);for(var s=0;s<t.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,t[s],i];o[s]=Object(w.reshape)(Object(w.slice)(e,u,c),n)}return e.dispose(),o})),s=new pt([],n,e.dtype,t.length),u=0;u<o.length;u++)s.setItem(u,o[u]);return s}(Ae,T("lengths",t,n,r),Re),e.abrupt("return",(r.addTensorList(De),[De.idTensor]));case 78:throw TypeError("Node type ".concat(t.op," is not implemented"));case 79:case"end":return e.stop()}}),e)}))),function(e,t,n){return s.apply(this,arguments)})(e,t,n);case"convolution":return w.tidy((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=T("stride",e,t,n),a=T("pad",e,t,n),i=T("dataFormat",e,t,n).toUpperCase(),o=T("dilation",e,t,n);return[mt.a(T("x",e,t,n),T("filter",e,t,n),r,a,i,o)];case"Conv2D":var s=T("strides",e,t,n),u=R(e,t,n),c=T("dataFormat",e,t,n).toUpperCase(),l=T("dilations",e,t,n);return[vt.a(T("x",e,t,n),T("filter",e,t,n),[s[1],s[2]],u,c,[l[1],l[2]])];case"_FusedConv2D":var h=Tt(e,t,n),d=h.stride,f=h.pad,p=h.dataFormat,m=h.dilations,v=h.biasArg,g=h.preluArg,y=h.activationFunc,b=h.leakyreluAlpha;return[gt.sb.conv2d({x:T("x",e,t,n),filter:T("filter",e,t,n),strides:[d[1],d[2]],pad:f,dataFormat:p,dilations:[m[1],m[2]],bias:v,activation:y,preluActivationWeights:g,leakyreluAlpha:b})];case"FusedDepthwiseConv2dNative":var k=Tt(e,t,n),_=k.stride,w=k.pad,x=k.dataFormat,C=k.dilations,O=k.biasArg,S=k.preluArg,I=k.activationFunc,E=k.leakyreluAlpha;return[gt.sb.depthwiseConv2d({x:T("x",e,t,n),filter:T("filter",e,t,n),strides:[_[1],_[2]],pad:w,dataFormat:x,dilations:[C[1],C[2]],bias:O,activation:I,preluActivationWeights:S,leakyreluAlpha:E})];case"Conv2DBackpropInput":case"Conv2dTranspose":var N=T("outputShape",e,t,n),A=T("strides",e,t,n),D=R(e,t,n);return[yt.a(T("x",e,t,n),T("filter",e,t,n),N,[A[1],A[2]],D)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var j=T("strides",e,t,n),F=R(e,t,n),M=T("dilations",e,t,n),P=T("dataFormat",e,t,n).toUpperCase();return[bt.a(T("input",e,t,n),T("filter",e,t,n),[j[1],j[2]],F,P,[M[1],M[2]])];case"Conv3D":var L=T("strides",e,t,n),z=T("pad",e,t,n),B=T("dataFormat",e,t,n).toUpperCase(),V=T("dilations",e,t,n);return[kt.a(T("x",e,t,n),T("filter",e,t,n),[L[1],L[2],L[3]],z,B,[V[1],V[2],V[3]])];case"AvgPool":var W=T("strides",e,t,n),U=T("pad",e,t,n),H=T("kernelSize",e,t,n);return[_t.a(T("x",e,t,n),[H[1],H[2]],[W[1],W[2]],U)];case"MaxPool":var G=T("strides",e,t,n),K=T("pad",e,t,n),q=T("kernelSize",e,t,n);return[wt.a(T("x",e,t,n),[q[1],q[2]],[G[1],G[2]],K)];case"MaxPoolWithArgmax":var X=T("strides",e,t,n),Z=T("pad",e,t,n),Y=T("kernelSize",e,t,n),Q=T("includeBatchInIndex",e,t,n),J=xt.a(T("x",e,t,n),[Y[1],Y[2]],[X[1],X[2]],Z,Q);return[J.result,J.indexes];case"AvgPool3D":var $=T("strides",e,t,n),ee=T("pad",e,t,n),te=T("kernelSize",e,t,n);return[Ct.a(T("x",e,t,n),[te[1],te[2],te[3]],[$[1],$[2],$[3]],ee)];case"MaxPool3D":var ne=T("strides",e,t,n),re=T("pad",e,t,n),ae=T("kernelSize",e,t,n);return[Ot.a(T("x",e,t,n),[ae[1],ae[2],ae[3]],[ne[1],ne[2],ne[3]],re)];case"Dilation2D":var ie=T("strides",e,t,n),oe=T("pad",e,t,n),se=T("dilations",e,t,n),ue=ie[1],ce=ie[2],le=se[1],he=se[2];return[St.a(T("x",e,t,n),T("filter",e,t,n),[ue,ce],oe,[le,he],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"creation":return w.tidy((function(){return function(e,t,n){switch(e.op){case"Fill":var r=T("shape",e,t,n),a=T("dtype",e,t,n),i=T("value",e,t,n);return[It.a(r,i,a)];case"LinSpace":var o=T("start",e,t,n),s=T("stop",e,t,n),u=T("num",e,t,n);return[Et.a(o,s,u)];case"Multinomial":var c=T("logits",e,t,n),l=T("numSamples",e,t,n),h=T("seed",e,t,n);return[Nt.a(c,l,h)];case"OneHot":var d=T("indices",e,t,n),f=T("depth",e,t,n),p=T("onValue",e,t,n),m=T("offValue",e,t,n);return[At.a(d,f,p,m)];case"Ones":return[Rt.a(T("shape",e,t,n),T("dtype",e,t,n))];case"OnesLike":return[Dt.a(T("x",e,t,n))];case"RandomUniform":return[jt.a(T("shape",e,t,n),T("minval",e,t,n),T("maxval",e,t,n),T("dtype",e,t,n))];case"Range":var v=T("start",e,t,n),g=T("stop",e,t,n),y=T("step",e,t,n);return[Ft.a(v,g,y,T("dtype",e,t,n))];case"TruncatedNormal":var b=T("shape",e,t,n),k=T("mean",e,t,n),_=T("stdDev",e,t,n),w=T("seed",e,t,n);return[Mt.a(b,k,_,T("dtype",e,t,n),w)];case"Zeros":return[Pt.a(T("shape",e,t,n),T("dtype",e,t,n))];case"ZerosLike":return[Lt.a(T("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"dynamic":return(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,k,_,w,x,C,O,S,I;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?3:"NonMaxSuppressionV4"===e.t0?14:"NonMaxSuppressionV3"===e.t0?25:"NonMaxSuppressionV2"===e.t0?25:"Where"===e.t0?30:"ListDiff"===e.t0?36:37;break;case 3:return a=Wt(t,n,r),i=a.boxes,o=a.scores,s=a.maxOutputSize,u=a.iouThreshold,c=a.scoreThreshold,l=a.softNmsSigma,e.next=12,gt.Bb.nonMaxSuppressionWithScoreAsync(i,o,s,u,c,l);case 12:return h=e.sent,e.abrupt("return",[h.selectedIndices,h.selectedScores]);case 14:return d=Wt(t,n,r),f=d.boxes,p=d.scores,m=d.maxOutputSize,v=d.iouThreshold,g=d.scoreThreshold,y=T("padToMaxOutputSize",t,n,r),e.next=23,gt.Bb.nonMaxSuppressionPaddedAsync(f,p,m,v,g,y);case 23:return b=e.sent,e.abrupt("return",[b.selectedIndices,b.validOutputs]);case 25:return k=Wt(t,n,r),_=k.boxes,w=k.scores,x=k.maxOutputSize,C=k.iouThreshold,O=k.scoreThreshold,e.next=28,gt.Bb.nonMaxSuppressionAsync(_,w,x,C,O);case 28:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 30:return S=zt.a(T("condition",t,n,r),"bool"),e.next=33,Bt.a(S);case 33:return e.t2=e.sent,I=[e.t2],e.abrupt("return",(S.dispose(),I));case 36:return e.abrupt("return",Vt.a(T("x",t,n,r),T("y",t,n,r)));case 37:throw TypeError("Node type ".concat(t.op," is not implemented"));case 38:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})(e,t,n);case"evaluation":return w.tidy((function(){return function(e,t,n){switch(e.op){case"TopKV2":var r=T("x",e,t,n),a=T("k",e,t,n),i=T("sorted",e,t,n),o=Ut.a(r,a,i);return[o.values,o.indices];case"Unique":var s=T("x",e,t,n),u=Ht.a(s);return[u.values,u.indices];case"UniqueV2":var c=T("x",e,t,n),l=T("axis",e,t,n),h=Ht.a(c,l);return[h.values,h.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"image":return w.tidy((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=T("images",e,t,n),a=T("size",e,t,n),i=T("alignCorners",e,t,n),o=T("halfPixelCenters",e,t,n);return[gt.Bb.resizeBilinear(r,[a[0],a[1]],i,o)];case"ResizeNearestNeighbor":var s=T("images",e,t,n),u=T("size",e,t,n),c=T("alignCorners",e,t,n),l=T("halfPixelCenters",e,t,n);return[gt.Bb.resizeNearestNeighbor(s,[u[0],u[1]],c,l)];case"CropAndResize":var h=T("image",e,t,n),d=T("boxes",e,t,n),f=T("boxInd",e,t,n),p=T("cropSize",e,t,n),m=T("method",e,t,n),v=T("extrapolationValue",e,t,n);return[gt.Bb.cropAndResize(h,d,f,p,m,v)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"graph":return w.tidy((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=T("default",e,t,n);return[I(e.name,t,n)||r];case"Placeholder":return[I(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[D(T("x",e,t,n))];case"IdentityN":return T("x",e,t,n).map((function(e){return D(e)}));case"Snapshot":return[D(T("x",e,t,n))];case"Shape":return[Gt.a(T("x",e,t,n).shape,"int32")];case"ShapeN":return T("x",e,t,n).map((function(e){return Gt.a(e.shape)}));case"Size":return[Kt.a(T("x",e,t,n).size,"int32")];case"Rank":return[Kt.a(T("x",e,t,n).rank,"int32")];case"NoOp":return[Kt.a(1)];case"Print":var a=T("x",e,t,n),i=T("data",e,t,n),o=T("message",e,t,n),s=T("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<i.length;u++)console.log(Array.prototype.slice.call(i[u].dataSync()).slice(0,s));return[a];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"logical":return w.tidy((function(){return function(e,t,n){switch(e.op){case"Equal":return[Xt.a(T("a",e,t,n),T("b",e,t,n))];case"NotEqual":return[Zt.a(T("a",e,t,n),T("b",e,t,n))];case"Greater":return[Yt.a(T("a",e,t,n),T("b",e,t,n))];case"GreaterEqual":return[Qt.a(T("a",e,t,n),T("b",e,t,n))];case"Less":return[Jt.a(T("a",e,t,n),T("b",e,t,n))];case"LessEqual":return[$t.a(T("a",e,t,n),T("b",e,t,n))];case"LogicalAnd":return[en.a(T("a",e,t,n),T("b",e,t,n))];case"LogicalNot":return[tn.a(T("a",e,t,n))];case"LogicalOr":return[nn.a(T("a",e,t,n),T("b",e,t,n))];case"Select":case"SelectV2":return[rn.a(T("condition",e,t,n),T("a",e,t,n),T("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"matrices":return w.tidy((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[an.a(T("a",e,t,n),T("b",e,t,n),T("transposeA",e,t,n),T("transposeB",e,t,n))];case"Transpose":return[on.a(T("x",e,t,n),T("perm",e,t,n))];case"_FusedMatMul":var r=_slicedToArray(T("fusedOps",e,t,n),2),a=r[0],i=r[1],o="biasadd"===a,s="prelu"===i,u=T("numArgs",e,t,n),c=T("leakyreluAlpha",e,t,n);if(o){if(s&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=_slicedToArray(T("args",e,t,n),2),h=l[0],d=l[1];return[gt.sb.matMul({a:T("a",e,t,n),b:T("b",e,t,n),transposeA:T("transposeA",e,t,n),transposeB:T("transposeB",e,t,n),bias:h,activation:i,preluActivationWeights:d,leakyreluAlpha:c})];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"normalization":return w.tidy((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[sn.a(T("x",e,t,n),T("mean",e,t,n),T("variance",e,t,n),T("offset",e,t,n),T("scale",e,t,n),T("epsilon",e,t,n))];case"LRN":return[un.a(T("x",e,t,n),T("radius",e,t,n),T("bias",e,t,n),T("alpha",e,t,n),T("beta",e,t,n))];case"Softmax":return[cn.a(T("x",e,t,n))];case"LogSoftmax":return[ln.a(T("x",e,t,n))];case"SparseToDense":return[hn.a(T("sparseIndices",e,t,n),T("outputShape",e,t,n),T("sparseValues",e,t,n),T("defaultValue",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"reduction":return w.tidy((function(){return function(e,t,n){switch(e.op){case"Max":var r=T("axis",e,t,n),a=T("keepDims",e,t,n);return[dn.a(T("x",e,t,n),r,a)];case"Mean":var i=T("axis",e,t,n),o=T("keepDims",e,t,n);return[fn.a(T("x",e,t,n),i,o)];case"Min":var s=T("axis",e,t,n),u=T("keepDims",e,t,n);return[pn.a(T("x",e,t,n),s,u)];case"Sum":var c=T("axis",e,t,n),l=T("keepDims",e,t,n);return[mn.a(T("x",e,t,n),c,l)];case"All":var h=T("axis",e,t,n),d=T("keepDims",e,t,n);return[vn.a(T("x",e,t,n),h,d)];case"Any":var f=T("axis",e,t,n),p=T("keepDims",e,t,n);return[gn.a(T("x",e,t,n),f,p)];case"ArgMax":var m=T("axis",e,t,n);return[yn.a(T("x",e,t,n),m)];case"ArgMin":var v=T("axis",e,t,n);return[bn.a(T("x",e,t,n),v)];case"Prod":var g=T("axis",e,t,n),y=T("keepDims",e,t,n);return[ct.a(T("x",e,t,n),g,y)];case"Cumsum":var b=T("axis",e,t,n),k=T("exclusive",e,t,n),_=T("reverse",e,t,n);return[kn.a(T("x",e,t,n),b,k,_)];case"Bincount":var w=T("x",e,t,n),x=T("weights",e,t,n),C=T("size",e,t,n);return[_n.a(w,x,C)];case"DenseBincount":var O=T("x",e,t,n),S=T("weights",e,t,n),I=T("size",e,t,n),E=T("binaryOutput",e,t,n);return[wn.a(O,S,I,E)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"slice_join":return w.tidy((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=T("n",e,t,n),a=T("axis",e,t,n),i=T("tensors",e,t,n);return i=i.slice(0,r),[xn.a(i,a)];case"Gather":var o=T("x",e,t,n),s=T("indices",e,t,n);return[Cn.a(o,zt.a(s,"int32"),0)];case"GatherV2":var u=T("axis",e,t,n),c=T("batchDims",e,t,n),l=T("x",e,t,n),h=T("indices",e,t,n);return[Cn.a(l,zt.a(h,"int32"),u,c)];case"Reverse":for(var d=T("dims",e,t,n),f=[],p=0;p<d.length;p++)d[p]&&f.push(p);var m=T("x",e,t,n);return[On.a(m,f)];case"ReverseV2":var v=T("axis",e,t,n),g=T("x",e,t,n);return[On.a(g,v)];case"Slice":var y=T("begin",e,t,n),b=T("size",e,t,n);return[Sn.a(T("x",e,t,n),y,b)];case"StridedSlice":var k=T("begin",e,t,n),_=T("end",e,t,n),x=T("strides",e,t,n),C=T("beginMask",e,t,n),O=T("endMask",e,t,n),S=T("ellipsisMask",e,t,n),I=T("newAxisMask",e,t,n),E=T("shrinkAxisMask",e,t,n),N=T("x",e,t,n);return[Tn.a(N,k,_,x,C,O,S,I,E)];case"Pack":return Object(w.tidy)((function(){var r=T("axis",e,t,n),a=T("tensors",e,t,n),i=a[0].shape,o=In.a(a[0]).shape,s=a.map((function(e){var t=w.util.arraysEqual(e.shape,i);if(!t&&!w.util.arraysEqual(In.a(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:En.a(e,i)}));return[Nn.a(s,r)]}));case"Unpack":var A=T("axis",e,t,n),R=T("tensor",e,t,n);return An.a(R,A);case"Tile":var D=T("reps",e,t,n);return[Rn.a(T("x",e,t,n),D)];case"Split":case"SplitV":var j=T("axis",e,t,n),F=T("numOrSizeSplits",e,t,n),M=T("x",e,t,n);return Dn.a(M,F,j);case"ScatterNd":var P=T("indices",e,t,n),L=T("values",e,t,n),z=T("shape",e,t,n);return[jn.a(P,L,z)];case"GatherNd":var B=T("x",e,t,n),V=T("indices",e,t,n);return[Fn.a(B,V)];case"SparseToDense":var W=T("sparseIndices",e,t,n),U=T("outputShape",e,t,n),H=T("sparseValues",e,t,n),G=T("defaultValue",e,t,n);return[hn.a(W,H,U,H.dtype===G.dtype?G:zt.a(G,H.dtype))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"spectral":return w.tidy((function(){return function(e,t,n){switch(e.op){case"FFT":return[Mn.a(T("x",e,t,n))];case"IFFT":return[Pn.a(T("x",e,t,n))];case"RFFT":return[Ln.a(T("x",e,t,n))];case"IRFFT":return[zn.a(T("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"transformation":return w.tidy((function(){return function(e,t,n){switch(e.op){case"Cast":return[zt.a(T("x",e,t,n),T("dtype",e,t,n))];case"ExpandDims":var r=T("axis",e,t,n);return[Bn.a(T("x",e,t,n),r)];case"Squeeze":var a=T("axis",e,t,n);return[In.a(T("x",e,t,n),a)];case"Reshape":return[En.a(T("x",e,t,n),T("shape",e,t,n))];case"MirrorPad":return[Vn.a(T("x",e,t,n),T("padding",e,t,n),T("mode",e,t,n))];case"PadV2":case"Pad":return[Wn.a(T("x",e,t,n),T("padding",e,t,n),T("constantValue",e,t,n))];case"SpaceToBatchND":var i=T("blockShape",e,t,n),o=T("paddings",e,t,n);return[Un.a(T("x",e,t,n),i,o)];case"BatchToSpaceND":var s=T("blockShape",e,t,n),u=T("crops",e,t,n);return[Hn.a(T("x",e,t,n),s,u)];case"DepthToSpace":var c=T("blockSize",e,t,n),l=T("dataFormat",e,t,n).toUpperCase();return[Gn.a(T("x",e,t,n),c,l)];case"BroadcastTo":return[Kn.a(T("x",e,t,n),T("shape",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"hash_table":return(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a){var i,o,s,u,c,l,h,d,f,p,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="HashTable"===e.t0?3:"HashTableV2"===e.t0?3:"LookupTableImport"===e.t0?5:"LookupTableImportV2"===e.t0?5:"LookupTableFind"===e.t0?10:"LookupTableFindV2"===e.t0?10:15;break;case 3:return i=T("keyDType",t,n,r),o=T("valueDType",t,n,r),s=new qt(i,o),e.abrupt("return",(a.addHashTable(t.name,s),[s.handle]));case 5:return u=T("tableHandle",t,n,r,a),c=T("keys",t,n,r),l=T("values",t,n,r),h=a.getHashTableById(u.id),e.next=8,h.import(c,l);case 8:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 10:return d=T("tableHandle",t,n,r,a),f=T("keys",t,n,r),p=T("defaultValue",t,n,r),m=a.getHashTableById(d.id),e.next=13,m.find(f,p);case 13:return e.t2=e.sent,e.abrupt("return",[e.t2]);case 15:throw TypeError("Node type ".concat(t.op," is not implemented"));case 16:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return i.apply(this,arguments)})(e,t,n,r);case"custom":var a=O(e.op);if(a&&a.customExecutor)return a.customExecutor(new de(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()"))}var i,o,s}(e,t,n);return w.util.isPromise(a)?a.then((function(e){return[].concat(e)})):[].concat(a)}var Xn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};_classCallCheck(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return _createClass(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function Zn(e,t,n,r){var a=new Set,i=[],o=null,s=null,u=new Set,c=Object.keys(e).map((function(e){return A(e)[0]})),l=[];null!=r&&(l=r.map((function(e){return A(e.name)[0]})));for(var h=_toConsumableArray(t);h.length>0;){var d=h.pop();($n(d)||er(d)||tr(d))&&null==o&&(s=(o=d).children.map((function(e){return e.name})).filter((function(e){return a.has(e)}))),a.add(d.name),null==n[d.name]&&-1===c.indexOf(d.name)&&-1===l.indexOf(d.name)&&(0!==d.inputs.length?d.inputs.forEach((function(e){u.has(e.name)||(u.add(e.name),h.push(e))})):i.push(d.name))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}var Yn=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Qn=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],Jn=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"];function $n(e){return Yn.indexOf(e.op)>=0}function er(e){return Qn.indexOf(e.op)>=0}function tr(e){return Jn.indexOf(e.op)>=0}var nr=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}var t,n,r,a;return _createClass(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,_toConsumableArray(n)),this._weightMap=e}},{key:"resourceManager",set:function(e){this._resourceManager=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(e,t){var n=Zn(e,t,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has the dynamic op '").concat(a.op,"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [").concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs [").concat(s,"]. Missing the following inputs: [").concat(r,"]"))}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[],o=Object.keys(a).map((function(e){return A(e)[0]})).map((function(t){return e.nodes[t]})),s=e.initNodes;o.forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)})),null!=s&&s.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var u=new Set,c=[];i.length>0;){var l=i.pop();u.add(l.name),t[l.name]||c.push(l),l.children.forEach((function(e){!u.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return u.has(e.name)}))&&i.push(e)}))}return c}(this.graph,this.weightMap,n)}},{key:"execute",value:function(e,t){var n=this;e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[A(e)[0]]})),i=t.map((function(e){return A(e)[0]})),o=i.map((function(e){return n.graph.nodes[e]}));0===o.length&&(o=this._outputs);var s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);null==u&&(u=this.compile(e,o),this.compiledMap.set(s,u));var c={},l={};return Object(w.tidy)((function(){var r=new Xn(n.weightMap,c,l,n.functionExecutorMap),a=Object.assign({},n.weightMap);Object.keys(e).forEach((function(t){var n=_slicedToArray(A(t),2),r=n[0],i=[];i[n[1]]=e[t],a[r]=i}));for(var o=n.getFrozenTensorIds(a),s={},h=0;h<u.length;h++){var d=u[h];if(!a[d.name]){var f=qn(d,a,r,n._resourceManager);if(w.util.isPromise(f))throw new Error("The execution of the op '".concat(d.op,"' returned a promise. Please use model.executeAsync() instead."));a[d.name]=f,n.checkTensorForDisposal(d.name,d,a,r,o,i,s)}}return null==n.parent&&r.dispose(o),t.map((function(e){return I(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=function(e,t,n){return t[N(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))}},{key:"executeAsync",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"_executeAsync",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.length>2&&void 0!==d[2]&&d[2],a=d.length>3&&void 0!==d[3]?d[3]:{},i=d.length>4&&void 0!==d[4]?d[4]:{},r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n)),o=new Xn(this.weightMap,a,i,this.functionExecutorMap),e.next=7,this.executeWithControlFlow(t,o,n,r);case 7:return s=e.sent,u=n.map((function(e){return I(e,s,o)})),c=u.map((function(e){return e.id})),l=Object.keys(t).map((function(e){return t[e].id})),h=new Set([].concat(_toConsumableArray(c),_toConsumableArray(l),_toConsumableArray(this.weightIds))),e.abrupt("return",(Object.keys(s).forEach((function(e){s[e].forEach((function(e){!e||e.isDisposed||h.has(e.id)||e.dispose()}))})),null==this.parent&&o.dispose(h),u));case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"executeFunctionAsync",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[i.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"executeWithControlFlow",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a){var i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,k,_,w=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Object.keys(t),o=i.map((function(e){return w.graph.nodes[A(e)[0]]})),s=r.map((function(e){return A(e)[0]})),0===(u=s.map((function(e){return w.graph.nodes[e]}))).length&&(u=this._outputs),c=Zn(t,u,this.weightMap,this._initNodes),l=c.usedNodes,h=c.missingInputs,d=c.dynamicNode,f=c.syncInputs,p=[].concat(_toConsumableArray(o),_toConsumableArray(this.graph.weights),_toConsumableArray(this._initNodes||[])).map((function(e){return{node:e,contexts:n.currentContext}})),m=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=_slicedToArray(A(e),2),r=n[0],a=[];a[n[1]]=t[e],m[r]=a})),v={},g=this.getFrozenTensorIds(m),y={};case 6:if(!(p.length>0)){e.next=12;break}return b=this.processStack(o,p,n,m,y,g,s,v,l),e.next=10,Promise.all(b);case 10:e.next=6;break;case 12:if(null!=d||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((k=u.filter((function(e){return!$n(e)&&!I(e.name,m,n)})).map((function(e){return e.name}))).length>0)){e.next=17;break}throw _="",null!=d&&(_="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [".concat(f,"]")),new Error("Cannot compute the outputs [".concat(k,"] from the provided inputs [").concat(i,"]. Consider providing the following inputs: [").concat(h,"]. ").concat(_));case 17:return e.abrupt("return",m);case 18:case"end":return e.stop()}}),e,this)}))),function(e,n,r,a){return t.apply(this,arguments)})},{key:"processStack",value:function(e,t,n,r,a,i,o,s,u){for(var c=this,l=[],h=function(){var e,h=t.pop();n.currentContext=h.contexts;var d="";if("Enter"===h.node.op&&T("isConstant",h.node,r,n)&&(e=_slicedToArray(E(h.node.name,n),1),d=e[0]),null==r[h.node.name]){var f,p=qn(h.node,r,n,c._resourceManager);d||(f=_slicedToArray(E(h.node.name,n),1),d=f[0]);var m=n.currentContext;w.util.isPromise(p)?l.push(p.then((function(e){return r[d]=e,n.currentContext=m,c.checkTensorForDisposal(d,h.node,r,n,i,o,s),c.processChildNodes(h.node,t,n,r,a,u),e}))):(r[d]=p,c.checkTensorForDisposal(d,h.node,r,n,i,o,s),c.processChildNodes(h.node,t,n,r,a,u))}else c.processChildNodes(h.node,t,n,r,a,u)};t.length>0;)h();return l}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=_slicedToArray(E(e.name,n),1)[0];!a[o]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!I(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!I(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=_slicedToArray(A(n),1)[0],i=t.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){var o=i.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every((function(e,t){return-1===o[t]||o[t]===e}));w.util.assert(s,(function(){return"The shape of dict['".concat(i.name,"'] provided in model.execute(dict) must be [").concat(o,"], but was [").concat(r.shape,"]")}))}i.attrParams.dtype&&i.attrParams.dtype.value&&w.util.assert(r.dtype===i.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(i.name,"'] provided in model.execute(dict) must be ").concat(i.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(e){var t={};for(var n in e)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?t[this._signature.inputs[n].name]=e[n]:t[n]=e[n];return t}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=_slicedToArray(A(e),1)[0];return null==t.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=_slicedToArray(A(e),1)[0];if(!t.graph.nodes[n])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),rr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.hashTableNameToHandle=t,this.hashTableMap=n}return _createClass(e,[{key:"addHashTable",value:function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}},{key:"getHashTableHandleByName",value:function(e){return this.hashTableNameToHandle[e]}},{key:"getHashTableById",value:function(e){return this.hashTableMap[e]}},{key:"dispose",value:function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}]),e}(),ar=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.modelUrl=t,this.loadOptions=n,this.version="n/a",null==n&&(this.loadOptions={}),this.resourceManager=new rr}var t,n,r;return _createClass(e,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=w.io.browserHTTPRequest(e,this.loadOptions);else{var t=w.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(w.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for URL '").concat([e],"'"));this.handler=t[0]}}},{key:"load",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.findIOHandler(),null!=this.handler.load){e.next=2;break}throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 2:return e.next=4,this.handler.load();case 4:return t=e.sent,e.abrupt("return",this.loadSync(t));case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadSync",value:function(e){this.artifacts=e;var t,n=this.artifacts.modelTopology;t=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=t,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer);var r=w.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new nr(Q.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){var a=Q.Instance.transformGraph(e.modelInitializer);this.initializer=new nr(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}},{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=7;break}if(0!==(r=w.io.getSaveHandlers(t)).length){e.next=4;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 4:if(!(r.length>1)){e.next=6;break}throw new Error("Found more than one (".concat(r.length,") save handlers for URL '").concat(t,"'"));case 6:t=r[0];case 7:if(null!=t.save){e.next=9;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 9:return e.abrupt("return",t.save(this.artifacts));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"predict",value:function(e,t){return this.execute(e,this.outputNodes)}},{key:"normalizeInputs",value:function(e){if(!(e instanceof w.Tensor||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has ".concat(this.inputNodes.length," placeholders, while there are ").concat(e.length," input tensors."));return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"execute",value:function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=3,this.executor.executeAsync(t,n);case 3:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}]),e}();function ir(e){return or.apply(this,arguments)}function or(){return(or=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},null!=t){e.next=3;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 3:return null==n&&(n={}),n.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t+="model.json?tfjs-format=file"),r=new ar(t,n),e.next=7,r.load();case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.d(t,"GraphModel",(function(){return ar})),n.d(t,"loadGraphModel",(function(){return ir})),n.d(t,"deregisterOp",(function(){return S})),n.d(t,"registerOp",(function(){return C})),n.d(t,"version_converter",(function(){return"2.8.6"}))},"D2/b":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("atXS"),o=n("VO80"),s=n("NclT"),u=Object(o.b)({conv2DBackpropFilter_:function(e,t,n,o,u){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0,h=e;3===e.rank&&(h=Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var d=t;3===d.rank&&(d=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),i.b(4===h.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+h.shape+"."})),i.b(4===d.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+d.shape+"."})),i.b(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var f="NHWC"===c?h.shape[3]:h.shape[1],p="NHWC"===c?d.shape[3]:d.shape[1];return i.b(f===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(f,") must match input depth in filter (").concat(n[2],".")})),i.b(p===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(p,") must match output depth for filter (").concat(n[3],").")})),null!=l&&i.b(i.v(u),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ".concat(l," but got pad ").concat(u,".")})),r.a.runKernel(a.D,{x:h,dy:d},{strides:o,pad:u,dataFormat:c,dimRoundingMode:l,filterShape:n})}})},D4ac:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(i.a)(e,"images","resizeNearestNeighbor");o.b(3===c.rank||4===c.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ".concat(c.rank,".")})),o.b(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),o.b("float32"===c.dtype||"int32"===c.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),o.b(!1===s||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var l=c,h=!1;3===c.rank&&(h=!0,l=Object(u.a)(c,[1,c.shape[0],c.shape[1],c.shape[2]]));_toArray(t);var d=r.a.runKernel(a.rc,{images:l},{alignCorners:n,halfPixelCenters:s,size:t});return h?Object(u.a)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}})},"DP+o":function(e,t,n){!function(e,t,n){"use strict";var r={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}},a=function(){function e(t,n){_classCallCheck(this,e),this.modelPath=n||"https://storage.googleapis.com/tfjs-models/savedmodel/".concat(this.getPrefix(t),"/model.json")}var a,i,o;return _createClass(e,[{key:"getPrefix",value:function(e){return"lite_mobilenet_v2"===e?"ssd"+e:"ssd_"+e}},{key:"load",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadGraphModel(this.modelPath);case 2:return this.model=e.sent,r=n.zeros([1,300,300,3],"int32"),e.next=6,this.model.executeAsync(r);case 6:return a=e.sent,e.next=9,Promise.all(a.map((function(e){return e.data()})));case 9:a.map((function(e){return e.dispose()})),r.dispose();case 11:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"infer",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r,a){var i,o,s,u,c,l,h,d,f,p,m,v,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.tidy((function(){return t instanceof n.Tensor||(t=n.browser.fromPixels(t)),t.expandDims(0)})),o=i.shape[1],s=i.shape[2],e.next=5,this.model.executeAsync(i);case 5:return u=e.sent,c=u[0].dataSync(),l=u[1].dataSync(),i.dispose(),n.dispose(u),h=this.calculateMaxScores(c,u[0].shape[1],u[0].shape[2]),d=_slicedToArray(h,2),f=d[0],p=d[1],m=n.getBackend(),"webgl"===n.getBackend()&&n.setBackend("cpu"),v=n.tidy((function(){var e=n.tensor2d(l,[u[1].shape[1],u[1].shape[3]]);return n.image.nonMaxSuppression(e,f,r,a,a)})),g=v.dataSync(),e.abrupt("return",(v.dispose(),m!==n.getBackend()&&n.setBackend(m),this.buildDetectedObjects(s,o,l,f,g,p)));case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"buildDetectedObjects",value:function(e,t,n,a,i,o){for(var s=i.length,u=[],c=0;c<s;c++){for(var l=[],h=0;h<4;h++)l[h]=n[4*i[c]+h];var d=l[0]*t,f=l[1]*e,p=l[2]*t,m=l[3]*e;l[0]=f,l[1]=d,l[2]=m-f,l[3]=p-d,u.push({bbox:l,class:r[o[i[c]]+1].displayName,score:a[i[c]]})}return u}},{key:"calculateMaxScores",value:function(e,t,n){for(var r=[],a=[],i=0;i<t;i++){for(var o=Number.MIN_VALUE,s=-1,u=0;u<n;u++)e[i*n+u]>o&&(o=e[i*n+u],s=u);r[i]=o,a[i]=s}return[r,a]}},{key:"detect",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:20,r=a.length>2&&void 0!==a[2]?a[2]:.5,e.abrupt("return",this.infer(t,n,r));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"dispose",value:function(){null!=this.model&&this.model.dispose()}}]),e}();e.ObjectDetection=a,e.load=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r,i,o,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},null!=n){e.next=3;break}throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");case 3:if(r=t.base||"lite_mobilenet_v2",i=t.modelUrl,-1!==["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(r)){e.next=6;break}throw new Error("ObjectDetection constructed with invalid base model "+r+". Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.");case 6:return o=new a(r,i),e.next=9,o.load();case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)}))),e.version="2.2.1",Object.defineProperty(e,"__esModule",{value:!0})}(t,n("CtZu"),n("+hG3"))},DbV5:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({onesLike_:function(e){var t=Object(i.a)(e,"x","onesLike");return r.a.runKernel(a.bc,{x:t})}})},DrVt:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return r.a.runKernel(a.dc,{x:o},{paddings:t,constantValue:n})}})},E1lT:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({log_:function(e){var t=Object(i.a)(e,"x","log");return r.a.runKernel(a.Bb,{x:t})}})},EWu9:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("o/e8"),a=n("atXS"),i=n("3X4V"),o=n("g4+C"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({separableConv2d_:function(e,t,n,s,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",d=Object(r.a)(e,"x","separableConv2d"),f=Object(r.a)(t,"depthwiseFilter","separableConv2d"),p=Object(r.a)(n,"pointwiseFilter","separableConv2d"),m=d,v=!1;if(3===d.rank&&(v=!0,m=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===h)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");a.b(4===m.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank ".concat(m.rank,".")})),a.b(4===f.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank ".concat(f.rank,".")})),a.b(4===p.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank ".concat(f.rank,".")})),a.b(1===p.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ".concat(p.shape[0],".")})),a.b(1===p.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ".concat(p.shape[1],".")}));var g=f.shape[2],y=f.shape[3];a.b(p.shape[2]===g*y,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be ".concat(g*y,", but got ").concat(p.shape[2],".")}));var b=Object(o.a)(m,f,s,c,h,l),k=Object(i.a)(b,p,1,"valid",h);return v?Object(u.a)(k,[k.shape[1],k.shape[2],k.shape[3]]):k}})},EhIR:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},Ei6o:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","mean");return r.a.runKernel(a.Ob,{x:o},{axis:t,keepDims:n})}})},EysY:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"conv2d",(function(){return $n})),n.d(r,"depthwiseConv2d",(function(){return nr})),n.d(r,"matMul",(function(){return rr}));var a=n("iuCH"),i=n("o3Rt"),o=n("RhVc"),s=n("kRdc"),u=n("SFB9"),c=n("34HJ"),l=n("RRa9"),h=n("6J+n"),d=n("20lx"),f=n("Ig+c"),p=n("3FnS"),m=n("fjZN"),v=n("YAKK"),g=n("0ahe"),y=n("l0gX"),b=n("ulO0"),k=n("o/e8"),_=n("ZJ6U"),w=n("SHv8"),x=n("parS"),C=n("VO80"),O=n("/7N0"),S=n("bTzI"),T=n("iIjY"),I=Object(C.b)({basicLSTMCell_:function(e,t,n,r,a,i){var o=Object(k.a)(e,"forgetBias","basicLSTMCell"),u=Object(k.a)(t,"lstmKernel","basicLSTMCell"),c=Object(k.a)(n,"lstmBias","basicLSTMCell"),l=Object(k.a)(r,"data","basicLSTMCell"),h=Object(k.a)(a,"c","basicLSTMCell"),d=Object(k.a)(i,"h","basicLSTMCell"),f=Object(_.a)([l,d],1),p=Object(w.a)(f,u),m=Object(s.a)(p,c),v=m.shape[1]/4,g=[m.shape[0],v],y=Object(S.a)(m,[0,0],g),b=Object(S.a)(m,[0,v],g),C=Object(S.a)(m,[0,2*v],g),I=Object(S.a)(m,[0,3*v],g),E=Object(s.a)(Object(x.a)(Object(O.a)(y),Object(T.a)(b)),Object(x.a)(h,Object(O.a)(Object(s.a)(o,C))));return[E,Object(x.a)(Object(T.a)(E),Object(O.a)(I))]}}),E=n("OygE"),N=n("cdtJ"),A=n("atXS"),R=Object(C.b)({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=Object(k.a)(e,"x","batchNorm"),c=Object(k.a)(t,"mean","batchNorm"),l=Object(k.a)(n,"variance","batchNorm");return null!=a&&(o=Object(k.a)(a,"scale","batchNorm")),null!=r&&(s=Object(k.a)(r,"offset","batchNorm")),A.b(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+u.rank+"."})),A.b(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ".concat(c.rank,".")})),A.b(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ".concat(l.rank,".")})),null!=o&&A.b(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ".concat(o.rank,".")})),null!=s&&A.b(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ".concat(s.rank,".")})),Object(N.a)(u,c,l,s,o,i)}}),D=Object(C.b)({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=Object(k.a)(e,"x","batchNorm"),c=Object(k.a)(t,"mean","batchNorm"),l=Object(k.a)(n,"variance","batchNorm");return null!=a&&(o=Object(k.a)(a,"scale","batchNorm")),null!=r&&(s=Object(k.a)(r,"offset","batchNorm")),A.b(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),A.b(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ".concat(c.rank,".")})),A.b(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ".concat(l.rank,".")})),null!=o&&A.b(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ".concat(o.rank,".")})),null!=s&&A.b(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ".concat(s.rank,".")})),Object(N.a)(u,c,l,s,o,i)}}),j=Object(C.b)({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=Object(k.a)(e,"x","batchNorm"),c=Object(k.a)(t,"mean","batchNorm"),l=Object(k.a)(n,"variance","batchNorm");return null!=a&&(o=Object(k.a)(a,"scale","batchNorm")),null!=r&&(s=Object(k.a)(r,"offset","batchNorm")),A.b(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),A.b(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ".concat(c.rank,".")})),A.b(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ".concat(l.rank,".")})),null!=o&&A.b(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ".concat(o.rank,".")})),null!=s&&A.b(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ".concat(s.rank,".")})),Object(N.a)(u,c,l,s,o,i)}}),F=n("BMSg"),M=n("SNsm"),P=n("BD40"),L=n("3rNm"),z=n("WWBm"),B=n("wI/y"),V=n("8Km0"),W=n("B3db"),U=Object(C.b)({concat1d_:function(e){return Object(_.a)(e,0)}}),H=Object(C.b)({concat2d_:function(e,t){return Object(_.a)(e,t)}}),G=Object(C.b)({concat3d_:function(e,t){return Object(_.a)(e,t)}}),K=Object(C.b)({concat4d_:function(e,t){return Object(_.a)(e,t)}}),q=n("dnXz"),X=n("3X4V"),Z=n("zR+/"),Y=n("FZCF"),Q=n("mdDO"),J=Object(C.b)({conv3dTranspose_:function(e,t,n,r,a){var i=Object(k.a)(e,"x","conv3dTranspose"),o=Object(k.a)(t,"filter","conv3dTranspose");return Object(Q.a)(n,i,o,r,a)}}),$=n("7/dO"),ee=n("waK1"),te=n("HmhO"),ne=n("LyxI"),re=n("Nk7E"),ae=n("g4+C"),ie=n("auKK"),oe=n("wFtI"),se=Object(C.b)({diag_:function(e){var t=Object(k.a)(e,"x","diag");return ie.a.runKernel(oe.R,{x:t})}}),ue=n("wXC5"),ce=n("x3y4"),le=n("ARu+"),he=n("Kfzt"),de=n("njhW"),fe=n("ubnP"),pe=n("jgXy"),me=n("TyAZ"),ve=n("2ugP"),ge=n("G6IW"),ye=n("NclT"),be=n("jXH2"),ke=Object(C.b)({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=Object(P.a)([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=Object(ye.a)(a.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return Object(be.a)(Object(ve.a)(s,0),[n[0],1,1]);if(2===n.length)return Object(be.a)(Object(ve.a)(Object(ve.a)(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Object(be.a)(Object(ve.a)(Object(ve.a)(Object(ve.a)(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received ".concat(n.length,"D."))}}),_e=n("RrjA"),we=n("02mo"),xe=n("UI8N"),Ce=n("kaMP"),Oe=n("zvA9"),Se=n("uy0A"),Te=n("JLAb"),Ie=n("/AvP"),Ee=n("WYAb"),Ne=n("b++O"),Ae=n("bzdD"),Re=n("4f3O"),De=n("shz4"),je=n("WJRb"),Fe=n("4QEz"),Me=n("E1lT"),Pe=n("RrGL"),Le=n("wxQM"),ze=n("gErV"),Be=n("r9q9"),Ve=n("4zPZ"),We=n("7wDt"),Ue=n("8YN0"),He=n("0l+w"),Ge=n("wCH+"),Ke=n("n+ZZ"),qe=n("U/2n"),Xe=n("i8k8"),Ze=n("CfTU"),Ye=n("Ei6o"),Qe=n("rm0a"),Je=n("8OX7"),$e=n("k9tH"),et=n("RhH0"),tt=n("NuWS"),nt=n("k7Jv"),rt=n("oAkI"),at=Object(C.b)({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Object(k.a)(e,"x","moments");var r=Object(A.I)(t,e.shape),a=Object(Ye.a)(e,r,n),i=a.shape;n||(i=Object(tt.e)(a.shape,r));var o=Object(nt.a)(Object(rt.a)(Object(L.a)(e,"float32"),Object(ye.a)(a,i)));return{mean:a,variance:Object(Ye.a)(o,r,n)}}}),it=Object(C.b)({multiRNNCell_:function(e,t,n,r){for(var a=Object(k.a)(t,"data","multiRNNCell"),i=Object(k.b)(n,"c","multiRNNCell"),o=Object(k.b)(r,"h","multiRNNCell"),s=a,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}for(var h=[],d=[],f=0;f<u.length;f+=2)h.push(u[f]),d.push(u[f+1]);return[h,d]}}),ot=n("Pvz5"),st=n("O7f5"),ut=n("1N4k"),ct=n("4iwy"),lt=n("wion"),ht=n("DbV5"),dt=Object(C.b)({outerProduct_:function(e,t){var n=Object(k.a)(e,"v1","outerProduct"),r=Object(k.a)(t,"v2","outerProduct");A.b(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks ".concat(n.rank," and ").concat(r.rank,".")}));var a=Object(ye.a)(n,[-1,1]),i=Object(ye.a)(r,[1,-1]);return Object(w.a)(a,i)}}),ft=n("DrVt"),pt=Object(C.b)({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Object(ft.a)(e,[t],n)}}),mt=Object(C.b)({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(ft.a)(e,t,n)}}),vt=Object(C.b)({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(ft.a)(e,t,n)}}),gt=Object(C.b)({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(A.b)(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(ft.a)(e,t,n)}}),yt=n("6vQL"),bt=n("yfHJ"),kt=n("Ug8H"),_t=n("dWjR"),wt=n("867m"),xt=Object(C.b)({rand_:function(e,t,n){var r=Object(A.N)(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return ie.a.makeTensor(a,e,n)}}),Ct=n("1OSX"),Ot=Object(C.b)({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new Ct.b(t,n,r,a),o=Object(P.a)(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),St=Object(C.b)({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Ct.a(t,n,r,!1,a),o=Object(P.a)(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),Tt=n("hinG"),It=n("hNYx"),Et=n("17CO"),Nt=n("tQDl"),At=n("kXpR"),Rt=n("Rqg+"),Dt=n("0I63"),jt=Object(C.b)({reverse1d_:function(e){var t=Object(k.a)(e,"x","reverse");return A.b(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),Object(Dt.a)(t,0)}}),Ft=Object(C.b)({reverse2d_:function(e,t){var n=Object(k.a)(e,"x","reverse");return A.b(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),Object(Dt.a)(n,t)}}),Mt=Object(C.b)({reverse3d_:function(e,t){var n=Object(k.a)(e,"x","reverse");return A.b(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),Object(Dt.a)(n,t)}}),Pt=Object(C.b)({reverse4d_:function(e,t){var n=Object(k.a)(e,"x","reverse");return A.b(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),Object(Dt.a)(n,t)}}),Lt=n("CKnt"),zt=n("Xyqe"),Bt=n("AV8V"),Vt=n("s57M"),Wt=n("EWu9"),Ut=n("90yW"),Ht=n("Hfat"),Gt=n("aTLu"),Kt=n("XcSs"),qt=Object(C.b)({slice1d_:function(e,t,n){var r=Object(k.a)(e,"x","slice1d");return A.b(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,[t],[n])}}),Xt=Object(C.b)({slice2d_:function(e,t,n){var r=Object(k.a)(e,"x","slice2d");return A.b(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,t,n)}}),Zt=Object(C.b)({slice3d_:function(e,t,n){var r=Object(k.a)(e,"x","slice3d");return A.b(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,t,n)}}),Yt=Object(C.b)({slice4d_:function(e,t,n){var r=Object(k.a)(e,"x","slice4d");return A.b(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Object(S.a)(r,t,n)}}),Qt=n("X4fa"),Jt=n("n/2y"),$t=n("dYAU"),en=n("Grcp"),tn=n("THqV"),nn=n("adw1"),rn=n("th0q"),an=n("RbuM"),on=n("Fjpt"),sn=n("QYQ3"),un=n("0fRV"),cn=n("1U0N"),ln=n("L7Hl"),hn=n("3hph"),dn=n("4FMF"),fn=n("0wrZ"),pn=n("NX3e"),mn=n("lg8H"),vn=n("WVnj");function gn(e,t,n){if(Object(A.d)(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Object(k.c)(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(vn.a)(e,t,r,n)}var yn=n("BbuY");function bn(e,t,n){if(Object(A.d)(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Object(k.c)(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Object(vn.a)(e,t,r,n)}function kn(e,t,n){if(Object(A.d)(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Object(k.c)(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Object(vn.a)(e,t,r,n)}function _n(e,t,n){if(Object(A.d)(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Object(k.c)(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Object(vn.a)(e,t,r,n)}var wn=n("VhY8"),xn=n("fmoR"),Cn=n("hT5K"),On=n("U/Lz"),Sn=n("OkRW");function Tn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return ie.a.makeVariable(e,t,n,r)}var In=n("Z5Ez"),En=n("p4Cv"),Nn=n("Wiw4"),An=n("oJu+"),Rn=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=Object(k.a)(t,"tensor","boolMask"),i=Object(k.a)(n,"mask","boolMask","bool"),o=null==r?0:r,s=i.rank,u=a.shape,A.b(s>0,(function(){return"mask cannot be scalar"})),A.e(u.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=o;l<o+s;l++)c*=u[l];return h=u.slice(0,o).concat([c],u.slice(o+s)),d=Object(ye.a)(a,h),f=Object(ye.a)(i,[-1]),e.next=9,Object(En.a)(f);case 9:return p=e.sent,m=Object(un.a)(p,[1]),v=Object(Ce.a)(d,m,o),e.abrupt("return",(t!==a&&a.dispose(),n!==i&&i.dispose(),m.dispose(),d.dispose(),f.dispose(),p.dispose(),v));case 13:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Dn=n("8bUJ"),jn=n("zLES"),Fn=n("yRKQ"),Mn=n("91d6"),Pn=n("dsKV"),Ln=Object(C.b)({movingAverage_:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=Object(k.a)(e,"v","movingAverage"),o=Object(k.a)(t,"x","movingAverage"),u=Object(k.a)(n,"decay","movingAverage");Object(Pn.assertTypesMatch)(i,o),A.b(A.a(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var c=Object(Bt.a)(1),l=Object(rt.a)(c,u),h=Object(x.a)(Object(rt.a)(o,i),l);if(a){A.b(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var d=Object(k.a)(r,"step","movingAverage");h=Object(ce.a)(h,Object(rt.a)(c,Object(bt.a)(u,d)))}return Object(s.a)(i,h)}}),zn=n("i/oj"),Bn=n("vGLV"),Vn=n("ukBL"),Wn=n("NNfn"),Un=Object(C.b)({dropout_:function(e,t,n,r){var a=Object(k.a)(e,"x","dropout");if(A.b("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a ".concat(a.dtype," tensor instead.")})),A.b(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof Wn.a?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(A.a(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)n.push(null==t[r]&&null!=e.shape[r]?e.shape[r]:t[r]);return n}return t}(a,n),o=1-t,u=Object(ce.a)(Object(we.a)(Object(s.a)(Object(Tt.a)(i,0,1,"float32",r),o)),o);return Object(x.a)(a,u)}});function Hn(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Gn(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Object(mn.a)(a,"float32")}var Kn=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>2&&void 0!==y[2]?y[2]:1,a=Object(k.a)(t,"predictions","inTopK"),i=Object(k.a)(n,"targets","inTopK"),Object(A.b)(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+a.rank})),Object(A.b)(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank ".concat(a.rank," and targets rank ").concat(i.rank)})),Object(A.e)(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],Object(A.b)(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension (".concat(o,"), but got ").concat(r)})),e.next=7,a.data();case 7:return s=e.sent,e.next=10,i.data();case 10:u=e.sent,c=s.length/o,l=o,h=Object(A.o)("bool",c),d=0;case 15:if(!(d<c)){e.next=30;break}for(f=d*l,p=s.subarray(f,f+l),m=[],v=0;v<p.length;v++)m.push({value:p[v],index:v});m.sort((function(e,t){return t.value-e.value})),h[d]=0,g=0;case 20:if(!(g<r)){e.next=27;break}if(m[g].index!==u[d]){e.next=24;break}return h[d]=1,e.abrupt("break",27);case 24:g++,e.next=20;break;case 27:d++,e.next=15;break;case 30:return e.abrupt("return",(t!==a&&a.dispose(),n!==i&&i.dispose(),Object(pn.a)(h,i.shape,"bool")));case 31:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),qn=n("U45G"),Xn=n("Um8L"),Zn=n("D2/b"),Yn=n("c9N1"),Qn=n("uBja"),Jn=n("R0ls"),$n=Object(C.b)({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,u=e.dilations,c=void 0===u?[1,1]:u,l=e.dimRoundingMode,h=e.bias,d=e.activation,f=void 0===d?"linear":d,p=e.preluActivationWeights,m=e.leakyreluAlpha;if(f=f||"linear",!1===Object(Jn.d)(ie.a.state.gradientDepth,f)){var v=Object(X.a)(t,n,r,a,o,c,l);return null!=h&&(v=Object(s.a)(v,h)),Object(Jn.a)(v,f,p,m)}var g=Object(k.a)(t,"x","conv2d"),y=Object(k.a)(n,"filter","conv2d"),b=g,_=!1;3===g.rank&&(_=!0,b=Object(ye.a)(g,[1,g.shape[0],g.shape[1],g.shape[2]])),A.b(4===b.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+b.rank+"."})),A.b(4===y.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+y.rank+"."})),null!=l&&A.b(A.v(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode ".concat(l," but got pad ").concat(a,".")})),A.b(b.shape[3]===y.shape[2],(function(){return"Error in conv2d: depth of input (".concat(b.shape[3],") must match input depth for filter ").concat(y.shape[2],".")})),A.b(Qn.h(r,c),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides ".concat(r," and dilations '").concat(c,"'")})),A.b("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var w,x,C=Qn.a(b.shape,y.shape,r,c,a,l);null!=h&&(w=Object(k.a)(h,"bias","fused conv2d"),w=_slicedToArray(Object(Pn.makeTypesMatch)(w,g),1)[0],Xn.a(C.outShape,w.shape)),null!=p&&(x=Object(k.a)(p,"prelu weights","fused conv2d"));var O=function(e,t){var n=_slicedToArray(t,4),i=n[0],o=n[1],s=n[2],u=n[3],l=Object(Jn.c)(e,s,f);A.b(Qn.i(c),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '".concat(c,"'")}));var h=[Object(Yn.a)(o.shape,l,i,r,a),Object(Zn.a)(o,l,i.shape,r,a)];if(null!=u){var d=Object(Jn.b)(u,l);h.push(d)}return h},S={x:b,filter:y,bias:w,preluActivationWeights:x},T={strides:r,pad:a,dataFormat:o,dilations:c,dimRoundingMode:l,activation:f,leakyreluAlpha:m};return null==h?Object(qn.a)((function(e,t,n){var r=ie.a.runKernel(oe.jb,S,T);return n([t,e,r]),_&&(r=Object(ye.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:O}}))(b,y):Object(qn.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.jb,S,T);return r([t,e,a,n]),_&&(a=Object(ye.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:O}}))(b,y,w)}}),er=n("aSZd"),tr=n("jLCh"),nr=Object(C.b)({fusedDepthwiseConv2d_:function(e){var t,n=e.x,r=e.filter,a=e.strides,i=e.pad,o=e.dataFormat,u=void 0===o?"NHWC":o,c=e.dilations,l=void 0===c?[1,1]:c,h=e.dimRoundingMode,d=e.bias,f=e.activation,p=void 0===f?"linear":f,m=e.preluActivationWeights,v=e.leakyreluAlpha;if(!1===Object(Jn.d)(ie.a.state.gradientDepth,p)){var g=Object(ae.a)(n,r,a,i,u,l,h);return null!=d&&(g=Object(s.a)(g,d)),Object(Jn.a)(g,p,m,v)}var y=Object(k.a)(n,"x","depthwiseConv2d"),b=Object(k.a)(r,"filter","depthwiseConv2d"),_=y,w=!1;3===y.rank&&(w=!0,_=Object(ye.a)(y,[1,y.shape[0],y.shape[1],y.shape[2]])),A.b(4===_.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank ".concat(_.rank,".")})),A.b(4===b.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank ".concat(b.rank,".")})),A.b(_.shape[3]===b.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels (".concat(_.shape[3],") must match the inChannels dimension in filter ").concat(b.shape[2],".")})),null==l&&(l=[1,1]),A.b(Qn.h(a,l),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(a," and dilations '").concat(l,"'")})),null!=h&&A.b(A.v(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ".concat(h," but got pad ").concat(i,".")}));var x,C,O=Qn.a(_.shape,b.shape,a,l,i,h,!0);null!=d&&(x=Object(k.a)(d,"bias","fused conv2d"),t=_slicedToArray(Object(Pn.makeTypesMatch)(x,y),1),x=t[0],Xn.a(O.outShape,x.shape)),null!=m&&(C=Object(k.a)(m,"prelu weights","fused depthwiseConv2d"));var S=function(e,t){A.b(Qn.i(l),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '".concat(l,"'")}));var n=_slicedToArray(t,4),r=n[0],o=n[1],s=n[2],u=n[3],c=Object(Jn.c)(e,s,p),d=Object(tr.a)(o.shape,c,r,a,i,l,h),f=Object(er.a)(o,c,r.shape,a,i,l,h);return null!=u?[d,f,Object(Jn.b)(x,c)]:[d,f]},T={x:_,filter:b,bias:x,preluActivationWeights:C},I={strides:a,pad:i,dataFormat:u,dilations:l,dimRoundingMode:h,activation:p,leakyreluAlpha:v};return null==d?Object(qn.a)((function(e,t,n){var r=ie.a.runKernel(oe.kb,T,I);return n([t,e,r]),w&&(r=Object(ye.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}))(_,b):Object(qn.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.kb,T,I);return r([t,e,a,n]),w&&(a=Object(ye.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}}))(_,b,x)}}),rr=Object(C.b)({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,u=e.bias,c=e.activation,l=void 0===c?"linear":c,h=e.preluActivationWeights,d=e.leakyreluAlpha;if(!1===Object(Jn.d)(ie.a.state.gradientDepth,l)){var f=Object(w.a)(t,n,a,o);return null!=u&&(f=Object(s.a)(f,u)),Object(Jn.a)(f,l,h,d)}var p=Object(k.a)(t,"a","fused matMul"),m=Object(k.a)(n,"b","fused matMul"),v=_slicedToArray(Object(Pn.makeTypesMatch)(p,m),2);p=v[0],m=v[1];var g=a?p.shape[p.rank-2]:p.shape[p.rank-1],y=o?m.shape[m.rank-1]:m.shape[m.rank-2],b=a?p.shape[p.rank-1]:p.shape[p.rank-2],_=o?m.shape[m.rank-2]:m.shape[m.rank-1],x=p.shape.slice(0,-2),C=m.shape.slice(0,-2),O=A.N(x),S=A.N(C);A.b(p.rank>=2&&m.rank>=2&&p.rank===m.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks ".concat(p.rank," and ").concat(m.rank,".")})),A.b(A.a(x,C),(function(){return"Error in fused matMul: outer dimensions (".concat(x,") and (").concat(C,") of Tensors with shapes ").concat(p.shape," and ")+m.shape+" must match."})),A.b(g===y,(function(){return"Error in fused matMul: inner shapes (".concat(g,") and (").concat(y,") of Tensors with shapes ").concat(p.shape," and ").concat(m.shape," and transposeA=").concat(a," and transposeB=").concat(o," must match.")}));var T,I,E=p.shape.slice(0,-2).concat([b,_]),N=a?Object(ye.a)(p,[O,g,b]):Object(ye.a)(p,[O,b,g]),R=o?Object(ye.a)(m,[S,_,y]):Object(ye.a)(m,[S,y,_]);null!=u&&(T=Object(k.a)(u,"bias","fused matMul"),T=_slicedToArray(Object(Pn.makeTypesMatch)(T,p),1)[0],Xn.a(E,T.shape)),null!=h&&(I=Object(k.a)(h,"prelu weights","fused matMul"));var D=function(e,t){var n,r,i=_slicedToArray(t,4),s=i[0],c=i[1],h=i[2],d=i[3],f=Object(Jn.c)(Object(ye.a)(e,h.shape),h,l);return a||o?!a&&o?(n=Object(w.a)(f,c,!1,!1),r=Object(w.a)(f,s,!0,!1)):a&&!o?(n=Object(w.a)(c,f,!1,!0),r=Object(w.a)(s,f,!1,!1)):(n=Object(w.a)(c,f,!0,!0),r=Object(w.a)(f,s,!0,!0)):(n=Object(w.a)(f,c,!1,!0),r=Object(w.a)(s,f,!0,!1)),null!=u?[n,r,Object(Jn.b)(d,f)]:[n,r]},j={a:N,b:R,bias:T,preluActivationWeights:I},F={transposeA:a,transposeB:o,activation:l,leakyreluAlpha:d};return null==u?Object(qn.a)((function(e,t,n){var r=ie.a.runKernel(oe.ad,j,F);return n([e,t,r]),{value:Object(ye.a)(r,E),gradFunc:D}}))(N,R):Object(qn.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.ad,j,F);return r([e,t,a,n]),{value:Object(ye.a)(a,E),gradFunc:D}}))(N,R,T)}}),ar=Object(C.b)({hammingWindow_:function(e){return Gn(e,.54,.46)}}),ir=Object(C.b)({hannWindow_:function(e){return Gn(e,.5,.5)}}),or=Object(C.b)({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(Object(S.a)(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Object(_.a)([Object(S.a)(e,i,t-s),Object(_e.a)([s],a)]);o.push(u),i+=n}return 0===o.length?gn([],[0,t]):Object(ye.a)(Object(_.a)(o),[o.length,t])}}),sr=Object(C.b)({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ir;null==r&&(r=Hn(t));for(var i=or(e,t,n),o=Object(x.a)(i,a(t)),s=[],u=0;u<i.shape[0];u++)s.push(Object(rn.a)(Object(S.a)(o,[u,0],[1,t]),r));return Object(_.a)(s)}}),ur=Object(C.b)({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(k.a)(e,"image","cropAndResize"),s=Object(k.a)(t,"boxes","cropAndResize","float32"),u=Object(k.a)(n,"boxInd","cropAndResize","int32"),c=s.shape[0];return A.b(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank ".concat(o.rank,".")})),A.b(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] but had shape ").concat(s.shape,".")})),A.b(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] but had shape ").concat(s.shape,".")})),A.b(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length ".concat(r.length,".")})),A.b(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),A.b("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was "+a})),ie.a.runKernel(oe.K,{image:o,boxes:s,boxInd:u},{method:a,extrapolationValue:i,cropSize:r})}}),cr=Object(C.b)({flipLeftRight_:function(e){var t=Object(k.a)(e,"image","flipLeftRight","float32");return A.b(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,but got rank ".concat(t.rank,".")})),ie.a.runKernel(oe.eb,{image:t},{})}}),lr=Object(C.b)({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=Object(k.a)(e,"image","rotateWithOffset","float32");return A.b(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,but got rank ".concat(a.rank,".")})),ie.a.runKernel(oe.uc,{image:a},{radians:t,fillValue:n,center:r})}});function hr(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),A.b(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),A.b(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),A.b(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]})),A.b(1===t.rank,(function(){return"scores must be a 1D tensor"})),A.b(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", but was ")+t.shape[0]})),A.b(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var dr=Object(C.b)({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Object(k.a)(e,"boxes","nonMaxSuppression"),o=Object(k.a)(t,"scores","nonMaxSuppression"),s=hr(i,o,n,r,a);return ie.a.runKernel(oe.Wb,{boxes:i,scores:o},{maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold})}}),fr=n("g4m1"),pr=Object(C.b)({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(k.a)(e,"boxes","nonMaxSuppression"),s=Object(k.a)(t,"scores","nonMaxSuppression"),u=hr(o,s,n,r,a,i),c=ie.a.runKernel(oe.Yb,{boxes:o,scores:s},{maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma});return{selectedIndices:c[0],selectedScores:c[1]}}}),mr=Object(C.b)({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Object(k.a)(e,"boxes","nonMaxSuppression"),s=Object(k.a)(t,"scores","nonMaxSuppression"),u=hr(o,s,n,r,a,null),c=ie.a.runKernel(oe.Xb,{boxes:o,scores:s},{maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:i});return{selectedIndices:c[0],validOutputs:c[1]}}}),vr=n("c/ib"),gr=n("D4ac"),yr=Object(C.b)({bandPart_:function(e,t,n){Object(A.b)(t%1==0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),Object(A.b)(n%1==0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=Object(k.a)(e,"a","bandPart");Object(A.b)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=_slicedToArray(r.shape.slice(-2),2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower (".concat(t,") must not be greater than the number of rows (").concat(o,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,") must not be greater than the number of columns (").concat(s,")."));t<0&&(t=o),n<0&&(n=s);var u=Object(ye.a)(Object(It.a)(0,o,1,"int32"),[-1,1]),c=Object(It.a)(0,s,1,"int32"),l=Object(rt.a)(u,c),h=Object(Ve.a)(Object(De.a)(l,Object(Bt.a)(+t,"int32")),Object(Se.a)(l,Object(Bt.a)(-n,"int32"))),d=Object(Nn.a)([o,s],r.dtype);return Object(ye.a)(Object(cn.a)(Object(Sn.a)(Object(ye.a)(r,[-1,o,s])).map((function(e){return Object(In.a)(h,e,d)}))),a)}}),br=Object(C.b)({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,Object(A.b)(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Object(A.b)(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: (".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=Object(an.a)(e,e.shape[0],0).map((function(e){return Object(un.a)(e,[0])}))),Object(A.b)(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds number of dimensions (").concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(ie.a.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=Object(x.a)(Object(dn.a)(Object(x.a)(n[a],t)),n[a]);t=Object(rt.a)(t,i)}return Object(ce.a)(t,Object(Mn.a)(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?Object(cn.a)(n,0):n}}),kr=n("wE5H");function _r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ie.a.tidy((function(){Object(A.b)(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=ke(n),i=Object(V.a)(e),o=gn([[1]],[1,1]),s=Object(V.a)(o),u=n>=r?r:n,c=function(e){var t,u=i,c=s,l=a;t=_slicedToArray(ie.a.tidy((function(){var t=Object(S.a)(i,[e,e],[n-e,1]),u=Object(Mn.a)(t),c=Object(S.a)(i,[e,e],[1,1]),l=Object(In.a)(Object(Oe.a)(c,0),gn([[-1]]),gn([[1]])),h=Object(rt.a)(c,Object(x.a)(l,u)),d=Object(ce.a)(t,h);s=1===d.shape[0]?Object(V.a)(o):Object(_.a)([o,Object(S.a)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);var f=Object(st.a)(Object(ce.a)(Object(w.a)(l,h),u)),p=Object(S.a)(i,[e,0],[n-e,r]),m=Object(x.a)(f,s),v=Object(Fn.a)(s);if(0===e)i=Object(rt.a)(p,Object(w.a)(m,Object(w.a)(v,p)));else{var g=Object(rt.a)(p,Object(w.a)(m,Object(w.a)(v,p)));i=Object(_.a)([Object(S.a)(i,[0,0],[e,r]),g],0)}var y=Object(Fn.a)(m),b=Object(S.a)(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=Object(rt.a)(b,Object(w.a)(Object(w.a)(b,s),y));else{var k=Object(rt.a)(b,Object(w.a)(Object(w.a)(b,s),y));a=Object(_.a)([Object(S.a)(a,[0,0],[n,e]),k],1)}return[s,i,a]})),3),s=t[0],i=t[1],a=t[2],Object(kr.d)([u,c,l])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=Object(S.a)(a,[0,0],[n,r]),i=Object(S.a)(i,[0,0],[r,r])),[a,i]}))}var wr=Object(C.b)({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(A.b)(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank "+e.rank})),2===e.rank)return _r(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Object(Sn.a)(Object(ye.a)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=_slicedToArray(_r(e,t),2),r=n[0],o=n[1];a.push(r),i.push(o)})),[Object(ye.a)(Object(cn.a)(a,0),e.shape),Object(ye.a)(Object(cn.a)(i,0),e.shape)]}}),xr=n("V+B2"),Cr=Object(C.b)({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xr.a.SUM_BY_NONZERO_WEIGHTS,r=Object(k.a)(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Object(k.a)(t,"weights","computeWeightedLoss"));var i=null==a?r:Object(x.a)(r,a);if(n===xr.a.NONE)return i;if(n===xr.a.SUM)return Object(dn.a)(i);if(n===xr.a.MEAN){if(null==a)return Object(Ye.a)(i);var o=r.size/a.size,s=Object(ce.a)(Object(dn.a)(i),Object(dn.a)(a));return o>1?Object(ce.a)(s,Object(Bt.a)(o)):s}if(n===xr.a.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Object(ce.a)(Object(dn.a)(i),Object(Bt.a)(r.size));var u=Object(x.a)(a,Object(lt.a)(r.shape)),c=Object(L.a)(Object(dn.a)(Object(ut.a)(u,Object(Bt.a)(0))),"float32");return Object(ce.a)(Object(dn.a)(i),c)}throw Error("Unknown reduction: "+n)}}),Or=Object(C.b)({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(k.a)(e,"labels","absoluteDifference"),o=Object(k.a)(t,"predictions","absoluteDifference"),s=null;null!=n&&(s=Object(k.a)(n,"weights","absoluteDifference")),Object(A.e)(i.shape,o.shape,"Error in absoluteDifference: ");var u=Object(a.a)(Object(rt.a)(i,o));return Cr(u,s,r)}}),Sr=Object(C.b)({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:xr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(k.a)(e,"labels","cosineDistance"),o=Object(k.a)(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Object(k.a)(r,"weights","cosineDistance")),Object(A.e)(i.shape,o.shape,"Error in cosineDistance: ");var u=Object(Bt.a)(1),c=Object(rt.a)(u,Object(dn.a)(Object(x.a)(i,o),n,!0));return Cr(c,s,a)}}),Tr=Object(C.b)({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xr.a.SUM_BY_NONZERO_WEIGHTS,a=Object(k.a)(e,"labels","hingeLoss"),i=Object(k.a)(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Object(k.a)(n,"weights","hingeLoss")),Object(A.e)(a.shape,i.shape,"Error in hingeLoss: ");var s=Object(Bt.a)(1);a=Object(rt.a)(Object(x.a)(Object(Bt.a)(2),a),s);var u=Object(At.a)(Object(rt.a)(s,Object(x.a)(a,i)));return Cr(u,o,r)}}),Ir=Object(C.b)({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:xr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(k.a)(e,"labels","huberLoss"),u=Object(k.a)(t,"predictions","huberLoss"),c=null;null!=n&&(c=Object(k.a)(n,"weights","huberLoss")),Object(A.e)(o.shape,u.shape,"Error in huberLoss: ");var l=Object(Bt.a)(r),h=Object(a.a)(Object(rt.a)(u,o)),d=Object(Je.a)(h,l),f=Object(rt.a)(h,d),p=Object(s.a)(Object(x.a)(Object(Bt.a)(.5),Object(nt.a)(d)),Object(x.a)(l,f));return Cr(p,c,i)}}),Er=Object(C.b)({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:xr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(k.a)(e,"labels","logLoss"),o=Object(k.a)(t,"predictions","logLoss"),u=null;null!=n&&(u=Object(k.a)(n,"weights","logLoss")),Object(A.e)(i.shape,o.shape,"Error in logLoss: ");var c=Object(Bt.a)(1),l=Object(Bt.a)(r),h=Object(st.a)(Object(x.a)(i,Object(Me.a)(Object(s.a)(o,l)))),d=Object(x.a)(Object(rt.a)(c,i),Object(Me.a)(Object(s.a)(Object(rt.a)(c,o),l))),f=Object(rt.a)(h,d);return Cr(f,u,a)}}),Nr=Object(C.b)({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xr.a.SUM_BY_NONZERO_WEIGHTS,a=Object(k.a)(e,"labels","meanSquaredError"),i=Object(k.a)(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Object(k.a)(n,"weights","meanSquaredError")),Object(A.e)(a.shape,i.shape,"Error in meanSquaredError: ");var s=Object(sn.a)(a,i);return Cr(s,o,r)}}),Ar=Object(C.b)({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:xr.a.SUM_BY_NONZERO_WEIGHTS,o=Object(k.a)(e,"multiClassLabels","sigmoidCrossEntropy"),u=Object(k.a)(t,"logits","sigmoidCrossEntropy"),c=null;if(null!=n&&(c=Object(k.a)(n,"weights","sigmoidCrossEntropy")),Object(A.e)(o.shape,u.shape,"Error in sigmoidCrossEntropy: "),r>0){var l=Object(Bt.a)(r),h=Object(Bt.a)(1),d=Object(Bt.a)(.5);o=Object(s.a)(Object(x.a)(o,Object(rt.a)(h,l)),Object(x.a)(d,l))}var f=function(e,t){var n=Object(k.a)(e,"labels","sigmoidCrossEntropyWithLogits"),r=Object(k.a)(t,"logits","sigmoidCrossEntropyWithLogits");Object(A.e)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=Object(At.a)(r),o=Object(x.a)(r,n),u=Object(Pe.a)(Object(me.a)(Object(st.a)(Object(a.a)(r))));return Object(s.a)(Object(rt.a)(i,o),u)}(o,u);return Cr(f,c,i)}}),Rr=Object(C.b)({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:xr.a.SUM_BY_NONZERO_WEIGHTS,i=Object(k.a)(e,"onehotLabels","softmaxCrossEntropy"),o=Object(k.a)(t,"logits","softmaxCrossEntropy"),u=null;if(null!=n&&(u=Object(k.a)(n,"weights","softmaxCrossEntropy")),Object(A.e)(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var c=Object(Bt.a)(r),l=Object(Bt.a)(1),h=Object(Bt.a)(i.shape[1]);i=Object(s.a)(Object(x.a)(i,Object(rt.a)(l,c)),Object(ce.a)(c,h))}var d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ".concat(t.rank," and dim was ")+n);return Object(qn.a)((function(e,t,r){var a=Object(Be.a)(t,[n],!0),i=Object(rt.a)(Object(L.a)(t,"float32"),a);r([e,i]);var o=Object(st.a)(Object(x.a)(i,e));return{value:Object(dn.a)(o,[n]),gradFunc:function(e,t){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=Object(tt.e)(e.shape,[n]);return[Object(x.a)(Object(ye.a)(e,o),Object(rt.a)(Object(L.a)(a,"float32"),Object(me.a)(i))),Object(x.a)(Object(ye.a)(e,o),Object(rt.a)(Object(me.a)(i),Object(L.a)(a,"float32")))]}}}))(e,t)}(i,o);return Cr(d,u,a)}});n.d(t,"Bb",(function(){return Lr})),n.d(t,"Mb",(function(){return zr})),n.d(t,"Yb",(function(){return Br})),n.d(t,"yd",(function(){return Mr})),n.d(t,"md",(function(){return Pr})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return s.a})),n.d(t,"f",(function(){return u.a})),n.d(t,"h",(function(){return c.a})),n.d(t,"i",(function(){return l.a})),n.d(t,"j",(function(){return h.a})),n.d(t,"k",(function(){return d.a})),n.d(t,"l",(function(){return f.a})),n.d(t,"m",(function(){return p.a})),n.d(t,"n",(function(){return m.a})),n.d(t,"o",(function(){return v.a})),n.d(t,"p",(function(){return g.a})),n.d(t,"q",(function(){return y.a})),n.d(t,"r",(function(){return b.a})),n.d(t,"s",(function(){return I})),n.d(t,"x",(function(){return E.a})),n.d(t,"t",(function(){return N.a})),n.d(t,"u",(function(){return R})),n.d(t,"v",(function(){return D})),n.d(t,"w",(function(){return j})),n.d(t,"y",(function(){return F.a})),n.d(t,"A",(function(){return M.a})),n.d(t,"B",(function(){return P.a})),n.d(t,"C",(function(){return L.a})),n.d(t,"D",(function(){return z.a})),n.d(t,"E",(function(){return B.a})),n.d(t,"F",(function(){return V.a})),n.d(t,"G",(function(){return W.a})),n.d(t,"H",(function(){return _.a})),n.d(t,"I",(function(){return U})),n.d(t,"J",(function(){return H})),n.d(t,"K",(function(){return G})),n.d(t,"L",(function(){return K})),n.d(t,"M",(function(){return q.a})),n.d(t,"N",(function(){return X.a})),n.d(t,"O",(function(){return Z.a})),n.d(t,"P",(function(){return Y.a})),n.d(t,"Q",(function(){return J})),n.d(t,"R",(function(){return $.a})),n.d(t,"S",(function(){return ee.a})),n.d(t,"U",(function(){return te.a})),n.d(t,"V",(function(){return ne.a})),n.d(t,"W",(function(){return re.a})),n.d(t,"X",(function(){return ae.a})),n.d(t,"Y",(function(){return se})),n.d(t,"Z",(function(){return ue.a})),n.d(t,"ab",(function(){return ce.a})),n.d(t,"bb",(function(){return le.a})),n.d(t,"db",(function(){return he.a})),n.d(t,"fb",(function(){return de.a})),n.d(t,"hb",(function(){return fe.a})),n.d(t,"jb",(function(){return pe.a})),n.d(t,"kb",(function(){return me.a})),n.d(t,"lb",(function(){return ve.a})),n.d(t,"mb",(function(){return ge.a})),n.d(t,"nb",(function(){return ke})),n.d(t,"pb",(function(){return _e.a})),n.d(t,"qb",(function(){return we.a})),n.d(t,"rb",(function(){return xe.a})),n.d(t,"tb",(function(){return Ce.a})),n.d(t,"vb",(function(){return Oe.a})),n.d(t,"wb",(function(){return Se.a})),n.d(t,"Ab",(function(){return Te.a})),n.d(t,"Eb",(function(){return Ie.a})),n.d(t,"Fb",(function(){return Ee.a})),n.d(t,"Gb",(function(){return Ne.a})),n.d(t,"Hb",(function(){return Ae.a})),n.d(t,"Ib",(function(){return Re.a})),n.d(t,"Jb",(function(){return De.a})),n.d(t,"Nb",(function(){return je.a})),n.d(t,"Ob",(function(){return Fe.a})),n.d(t,"Pb",(function(){return Me.a})),n.d(t,"Qb",(function(){return Pe.a})),n.d(t,"Rb",(function(){return Le.a})),n.d(t,"Sb",(function(){return ze.a})),n.d(t,"Tb",(function(){return Be.a})),n.d(t,"Ub",(function(){return Ve.a})),n.d(t,"Vb",(function(){return We.a})),n.d(t,"Wb",(function(){return Ue.a})),n.d(t,"Xb",(function(){return He.a})),n.d(t,"Zb",(function(){return w.a})),n.d(t,"ac",(function(){return Ge.a})),n.d(t,"bc",(function(){return Ke.a})),n.d(t,"cc",(function(){return qe.a})),n.d(t,"dc",(function(){return Xe.a})),n.d(t,"ec",(function(){return Ze.a})),n.d(t,"gc",(function(){return Ye.a})),n.d(t,"hc",(function(){return Qe.a})),n.d(t,"ic",(function(){return Je.a})),n.d(t,"kc",(function(){return $e.a})),n.d(t,"lc",(function(){return et.a})),n.d(t,"nc",(function(){return at})),n.d(t,"pc",(function(){return x.a})),n.d(t,"rc",(function(){return it})),n.d(t,"sc",(function(){return ot.a})),n.d(t,"tc",(function(){return st.a})),n.d(t,"vc",(function(){return ut.a})),n.d(t,"xc",(function(){return ct.a})),n.d(t,"yc",(function(){return lt.a})),n.d(t,"zc",(function(){return ht.a})),n.d(t,"Bc",(function(){return dt})),n.d(t,"Cc",(function(){return ft.a})),n.d(t,"Dc",(function(){return pt})),n.d(t,"Ec",(function(){return mt})),n.d(t,"Fc",(function(){return vt})),n.d(t,"Gc",(function(){return gt})),n.d(t,"Hc",(function(){return yt.a})),n.d(t,"Ic",(function(){return bt.a})),n.d(t,"Kc",(function(){return kt.a})),n.d(t,"Lc",(function(){return _t.a})),n.d(t,"Mc",(function(){return wt.a})),n.d(t,"Nc",(function(){return xt})),n.d(t,"Oc",(function(){return Ot})),n.d(t,"Pc",(function(){return St})),n.d(t,"Qc",(function(){return Tt.a})),n.d(t,"Rc",(function(){return It.a})),n.d(t,"Sc",(function(){return Et.a})),n.d(t,"Tc",(function(){return Nt.a})),n.d(t,"Uc",(function(){return At.a})),n.d(t,"Vc",(function(){return Rt.a})),n.d(t,"Wc",(function(){return ye.a})),n.d(t,"Xc",(function(){return Dt.a})),n.d(t,"Yc",(function(){return jt})),n.d(t,"Zc",(function(){return Ft})),n.d(t,"ad",(function(){return Mt})),n.d(t,"bd",(function(){return Pt})),n.d(t,"dd",(function(){return Lt.a})),n.d(t,"ed",(function(){return zt.a})),n.d(t,"fd",(function(){return Bt.a})),n.d(t,"hd",(function(){return Vt.a})),n.d(t,"id",(function(){return Wt.a})),n.d(t,"jd",(function(){return Ut.a})),n.d(t,"kd",(function(){return O.a})),n.d(t,"ld",(function(){return Ht.a})),n.d(t,"nd",(function(){return Gt.a})),n.d(t,"od",(function(){return Kt.a})),n.d(t,"pd",(function(){return S.a})),n.d(t,"qd",(function(){return qt})),n.d(t,"rd",(function(){return Xt})),n.d(t,"sd",(function(){return Zt})),n.d(t,"td",(function(){return Yt})),n.d(t,"ud",(function(){return Qt.a})),n.d(t,"vd",(function(){return Jt.a})),n.d(t,"wd",(function(){return $t.a})),n.d(t,"ob",(function(){return en.a})),n.d(t,"zb",(function(){return tn.a})),n.d(t,"Db",(function(){return nn.a})),n.d(t,"cd",(function(){return rn.a})),n.d(t,"zd",(function(){return an.a})),n.d(t,"Ad",(function(){return on.a})),n.d(t,"Bd",(function(){return nt.a})),n.d(t,"Cd",(function(){return sn.a})),n.d(t,"Ed",(function(){return un.a})),n.d(t,"Fd",(function(){return cn.a})),n.d(t,"Gd",(function(){return ln.a})),n.d(t,"Hd",(function(){return hn.a})),n.d(t,"Id",(function(){return rt.a})),n.d(t,"Kd",(function(){return dn.a})),n.d(t,"Ld",(function(){return fn.a})),n.d(t,"Md",(function(){return T.a})),n.d(t,"Nd",(function(){return pn.a})),n.d(t,"Od",(function(){return mn.a})),n.d(t,"Pd",(function(){return gn})),n.d(t,"Qd",(function(){return yn.a})),n.d(t,"Rd",(function(){return bn})),n.d(t,"Sd",(function(){return kn})),n.d(t,"Td",(function(){return _n})),n.d(t,"Ud",(function(){return be.a})),n.d(t,"Vd",(function(){return wn.a})),n.d(t,"Xd",(function(){return xn.a})),n.d(t,"Yd",(function(){return Cn.a})),n.d(t,"Zd",(function(){return On.a})),n.d(t,"ae",(function(){return Sn.a})),n.d(t,"be",(function(){return Tn})),n.d(t,"ce",(function(){return In.a})),n.d(t,"de",(function(){return En.a})),n.d(t,"ee",(function(){return Nn.a})),n.d(t,"fe",(function(){return An.a})),n.d(t,"z",(function(){return Rn})),n.d(t,"ib",(function(){return Dn.a})),n.d(t,"xb",(function(){return Dn.b})),n.d(t,"yb",(function(){return Dn.c})),n.d(t,"Kb",(function(){return Dn.d})),n.d(t,"Lb",(function(){return Dn.e})),n.d(t,"wc",(function(){return Dn.f})),n.d(t,"g",(function(){return jn.a})),n.d(t,"cb",(function(){return jn.b})),n.d(t,"fc",(function(){return jn.c})),n.d(t,"jc",(function(){return jn.d})),n.d(t,"mc",(function(){return jn.e})),n.d(t,"qc",(function(){return jn.f})),n.d(t,"Jc",(function(){return jn.g})),n.d(t,"Dd",(function(){return jn.h})),n.d(t,"Jd",(function(){return jn.i})),n.d(t,"Wd",(function(){return Fn.a})),n.d(t,"uc",(function(){return Mn.a})),n.d(t,"oc",(function(){return Ln})),n.d(t,"gd",(function(){return zn.a})),n.d(t,"xd",(function(){return Bn.a})),n.d(t,"ub",(function(){return Vn.a})),n.d(t,"eb",(function(){return Un})),n.d(t,"gb",(function(){return Hn})),n.d(t,"T",(function(){return Gn})),n.d(t,"Cb",(function(){return Kn})),n.d(t,"Ac",(function(){return C.b})),n.d(t,"a",(function(){return C.a})),n.d(t,"sb",(function(){return r}));var Dr,jr,Fr,Mr={fft:en.a,ifft:tn.a,rfft:rn.a,irfft:nn.a},Pr={hammingWindow:ar,hannWindow:ir,frame:or,stft:sr},Lr={flipLeftRight:cr,resizeNearestNeighbor:gr.a,resizeBilinear:vr.a,rotateWithOffset:lr,cropAndResize:ur,nonMaxSuppression:dr,nonMaxSuppressionAsync:(Fr=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>3&&void 0!==p[3]?p[3]:.5,i=p.length>4&&void 0!==p[4]?p[4]:Number.NEGATIVE_INFINITY,o=Object(k.a)(t,"boxes","nonMaxSuppressionAsync"),s=Object(k.a)(n,"scores","nonMaxSuppressionAsync"),u=hr(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=6,Promise.all([o.data(),s.data()]);case 6:return c=e.sent,l=c[0],h=c[1],d=Object(fr.a)(l,h,r,a,i),f=d.selectedIndices,e.abrupt("return",(o!==t&&o.dispose(),s!==n&&s.dispose(),Object(mn.a)(f,"int32")));case 12:case"end":return e.stop()}}),e)}))),function(e,t,n){return Fr.apply(this,arguments)}),nonMaxSuppressionWithScore:pr,nonMaxSuppressionWithScoreAsync:(jr=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.length>3&&void 0!==v[3]?v[3]:.5,i=v.length>4&&void 0!==v[4]?v[4]:Number.NEGATIVE_INFINITY,o=v.length>5&&void 0!==v[5]?v[5]:0,s=Object(k.a)(t,"boxes","nonMaxSuppressionAsync"),u=Object(k.a)(n,"scores","nonMaxSuppressionAsync"),c=hr(s,u,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=7,Promise.all([s.data(),u.data()]);case 7:return l=e.sent,h=l[0],d=l[1],f=Object(fr.c)(h,d,r,a,i,o),p=f.selectedIndices,m=f.selectedScores,e.abrupt("return",(s!==t&&s.dispose(),u!==n&&u.dispose(),{selectedIndices:Object(mn.a)(p,"int32"),selectedScores:Object(mn.a)(m)}));case 14:case"end":return e.stop()}}),e)}))),function(e,t,n){return jr.apply(this,arguments)}),nonMaxSuppressionPadded:mr,nonMaxSuppressionPaddedAsync:(Dr=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,_=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.length>3&&void 0!==_[3]?_[3]:.5,i=_.length>4&&void 0!==_[4]?_[4]:Number.NEGATIVE_INFINITY,o=_.length>5&&void 0!==_[5]&&_[5],s=Object(k.a)(t,"boxes","nonMaxSuppressionAsync"),u=Object(k.a)(n,"scores","nonMaxSuppressionAsync"),c=hr(s,u,r,a,i,null),l=c.maxOutputSize,h=c.iouThreshold,d=c.scoreThreshold,e.next=11,Promise.all([s.data(),u.data()]);case 11:return f=e.sent,p=_slicedToArray(f,2),m=p[0],v=p[1],g=Object(fr.b)(m,v,l,h,d,o),y=g.selectedIndices,b=g.validOutputs,e.abrupt("return",(s!==t&&s.dispose(),u!==n&&u.dispose(),{selectedIndices:Object(mn.a)(y,"int32"),validOutputs:Object(Bt.a)(b,"int32")}));case 19:case"end":return e.stop()}}),e)}))),function(e,t,n){return Dr.apply(this,arguments)})},zr={bandPart:yr,gramSchmidt:br,qr:wr},Br={absoluteDifference:Or,computeWeightedLoss:Cr,cosineDistance:Sr,hingeLoss:Tr,huberLoss:Ir,logLoss:Er,meanSquaredError:Nr,sigmoidCrossEntropy:Ar,softmaxCrossEntropy:Rr}},FZCF:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("uBja"),u=n("VO80"),c=n("NclT"),l=Object(u.b)({conv3d_:function(e,t,n,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],d=Object(i.a)(e,"x","conv3d"),f=Object(i.a)(t,"filter","conv3d"),p=d,m=!1;4===d.rank&&(m=!0,p=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),o.b(5===p.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(p.rank,".")})),o.b(5===f.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+f.rank+"."})),o.b(p.shape[4]===f.shape[3],(function(){return"Error in conv3d: depth of input (".concat(p.shape[4],") must match input depth for filter ").concat(f.shape[3],".")})),o.b(Object(s.h)(n,h),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(h,"'")})),o.b("NDHWC"===l,(function(){return"Error in conv3d: got dataFormat of ".concat(l," but only NDHWC is currently supported.")}));var v=r.a.runKernel(a.F,{x:p,filter:f},{strides:n,pad:u,dataFormat:l,dilations:h});return m?Object(c.a)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}})},Fjpt:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({sqrt_:function(e){var t=Object(i.a)(e,"x","sqrt");return r.a.runKernel(a.Kc,{x:t})}})},G6IW:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({expm1_:function(e){var t=Object(i.a)(e,"x","expm1");return r.a.runKernel(a.bb,{x:t})}})},Grcp:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("atXS"),o=n("VO80"),s=Object(o.b)({fft_:function(e){return Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got ".concat(e.dtype,".")})),r.a.runKernel(a.cb,{input:e})}})},Hfat:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({sign_:function(e){var t=Object(i.a)(e,"x","sign");return r.a.runKernel(a.Bc,{x:t})}})},HmhO:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Object(i.a)(e,"x","cumsum");return r.a.runKernel(a.L,{x:s},{axis:t,exclusive:n,reverse:o})}})},I79q:function(e,t,n){"use strict";var r,a,i,o,s;n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(a||(a={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(i||(i={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(o||(o={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(s||(s={}));var u={float32:o,int32:a,bool:i,complex64:s};function c(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return u[e][t]}function l(e){return c(e,"int32")}},"Ig+c":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({asin_:function(e){var t=Object(i.a)(e,"x","asin");return r.a.runKernel(a.j,{x:t})}})},JLAb:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({imag_:function(e){var t=Object(i.a)(e,"input","imag");return r.a.runKernel(a.rb,{input:t})}})},Kfzt:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("o/e8"),a=n("atXS"),i=n("SHv8"),o=n("VO80"),s=n("NclT"),u=Object(o.b)({dot_:function(e,t){var n=Object(r.a)(e,"t1","dot"),o=Object(r.a)(t,"t2","dot");a.b(!(1!==n.rank&&2!==n.rank||1!==o.rank&&2!==o.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks ".concat(n.rank," and ").concat(o.rank,".")}));var u=1===n.rank?n.size:n.shape[1],c=1===o.rank?o.size:o.shape[0];if(a.b(u===c,(function(){return"Error in dot: inner dimensions of inputs must match, but got ".concat(u," and ").concat(c,".")})),1===n.rank&&1===o.rank){var l=Object(s.a)(n,[1,-1]),h=Object(s.a)(o,[-1,1]),d=Object(i.a)(l,h);return Object(s.a)(d,[])}if(1===n.rank&&2===o.rank){var f=Object(s.a)(n,[1,-1]),p=Object(s.a)(o,[o.shape[0],o.shape[1]]),m=Object(i.a)(f,p);return Object(s.a)(m,[m.size])}if(2===n.rank&&1===o.rank){var v=Object(s.a)(o,[-1,1]),g=Object(i.a)(n,v);return Object(s.a)(g,[g.size])}var y=Object(s.a)(o,[o.shape[0],o.shape[1]]);return Object(i.a)(n,y)}})},L7Hl:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","step");return r.a.runKernel(a.Nc,{x:n},{alpha:t})}})},LyxI:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({denseBincount_:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(i.a)(e,"x","denseBincount"),c=Object(i.a)(t,"weights","denseBincount");return o.b("int32"===u.dtype,(function(){return"Error in denseBincount: input dtype must be int32, but got "+u.dtype})),o.b(u.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got rank ".concat(u.rank,".")})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(c.size===u.size||0===c.size,(function(){return"Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ".concat(u.shape,", weights shape: ")+c.shape+"."})),r.a.runKernel(a.M,{x:u,weights:c},{size:n,binaryOutput:s})}})},NNfn:function(e,t,n){"use strict";var r=n("atXS");function a(e,t,n){var a;return a=Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":Object(r.z)(e)?"'".concat(e,"'"):"bool"===n?i(e):parseFloat(e.toFixed(7)).toString(),Object(r.L)(a,t)}function i(e){return 0===e?"false":"true"}function o(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var s=n("6366");n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m}));var u=function(){function e(t,n,a){var i=this;if(_classCallCheck(this,e),this.dtype=n,this.shape=t.slice(),this.size=r.N(t),null!=a){var o=a.length;r.b(o===this.size,(function(){return"Length of values '".concat(o,"' does not match the size inferred by the shape '").concat(i.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=a||r.n(n,this.size),this.strides=Object(r.j)(t)}return _createClass(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];0===a.length&&(a=[0]),r.b(a.length===this.rank,(function(){return"The number of provided coordinates (".concat(a.length,") must match the rank (").concat(t.rank,")")}));var o=this.locToIndex(a);this.values[o]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r])throw new Error("Requested out of range element at ".concat(t,".   Buffer shape=")+this.shape);r++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return c().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),c=null,l=null;function h(e){c=e}function d(e){l=e}function f(e){e}var p=function(){function e(t,n,a,i){_classCallCheck(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=r.N(t),this.strides=Object(r.j)(t),this.dataId=a,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}var t,n,u,h;return _createClass(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:(h=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",l.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"bufferSync",value:function(){return l.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Object(r.S)(this.shape,t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"arraySync",value:function(){return Object(r.S)(this.shape,this.dataSync())}},{key:"data",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=c().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return s.decodeString(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])}))),function(){return n.apply(this,arguments)})},{key:"dataSync",value:function(){this.throwIfDisposed();var e=c().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return s.decodeString(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,c().read(this.dataId);case 3:return t=e.sent,e.abrupt("return","string"===this.dtype?t:new Uint8Array(t.buffer));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"dispose",value:function(){this.isDisposed||(c().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return l.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),l.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n,s){var u=Object(r.j)(t),c=function(e,t,n,i){var s=Object(r.N)(t),u=i[i.length-1],c=new Array(u).fill(0),l=t.length,h="complex64"===n?o(e):e;if(l>1)for(var d=0;d<s/u;d++)for(var f=d*u,p=0;p<u;p++)c[p]=Math.max(c[p],a(h[f+p],0,n).length);return c}(e,t,n,u),l=t.length,h=function e(t,n,r,s,u){var c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l="complex64"===r?2:1,h=n[0],d=n.length;if(0===d)return"complex64"===r?[a(o(t)[0],0,r)]:"bool"===r?[i(t[0])]:[t[0].toString()];if(1===d){if(h>20){var f=Array.from(t.slice(0,3*l)),p=Array.from(t.slice((h-3)*l,h*l));return"complex64"===r&&(f=o(f),p=o(p)),["["+f.map((function(e,t){return a(e,u[t],r)})).join(", ")+", ..., "+p.map((function(e,t){return a(e,u[h-3+t],r)})).join(", ")+"]"]}return["["+("complex64"===r?o(t):Array.from(t)).map((function(e,t){return a(e,u[t],r)})).join(", ")+"]"]}var m=n.slice(1),v=s.slice(1),g=s[0]*l,y=[];if(h>20){for(var b=0;b<3;b++){var k=b*g;y.push.apply(y,_toConsumableArray(e(t.slice(k,k+g),m,r,v,u,!1)))}y.push("...");for(var _=h-3;_<h;_++){var w=_*g;y.push.apply(y,_toConsumableArray(e(t.slice(w,w+g),m,r,v,u,_===h-1)))}}else for(var x=0;x<h;x++){var C=x*g;y.push.apply(y,_toConsumableArray(e(t.slice(C,C+g),m,r,v,u,x===h-1)))}var O=2===d?",":"";y[0]="["+y[0]+O;for(var S=1;S<y.length-1;S++)y[S]=" "+y[S]+O;for(var T=",\n",I=2;I<d;I++)T+="\n";return y[y.length-1]=" "+y[y.length-1]+"]"+(c?"":T),y}(e,t,n,u,c),d=["Tensor"];return s&&(d.push("  dtype: "+n),d.push("  rank: "+l),d.push("  shape: [".concat(t,"]")),d.push("  values:")),d.push(h.map((function(e){return"    "+e})).join("\n")),d.join("\n")}(this.dataSync(),this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),l.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),c().makeVariable(this,e,t,n)}}]),e}();Object.defineProperty(p,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}});var m=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return _createClass(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and previous value (").concat(this.dtype,") must match"));if(!r.a(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and previous value (").concat(this.shape,") must match"));c().disposeTensor(this),this.dataId=e.dataId,c().incRef(this,null)}},{key:"dispose",value:function(){c().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(p);Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return e instanceof p&&null!=e.assign&&e.assign instanceof Function}})},NX3e:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("o/e8"),a=n("WVnj");function i(e,t,n){var i=Object(r.c)(e,n);return Object(a.a)(e,t,i,n)}},NclT:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({reshape_:function(e,t){var n=Object(i.a)(e,"x","reshape","string_or_numeric");return r.a.runKernel(a.oc,{x:n},{shape:t})}})},Nk7E:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",s=Object(i.a)(e,"x","depthToSpace"),u="NHWC"===n?s.shape[1]:s.shape[2],c="NHWC"===n?s.shape[2]:s.shape[3],l="NHWC"===n?s.shape[3]:s.shape[1];return o.b(u*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(u," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(s.shape)})),o.b(c*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(t," for depthToSpace with input shape\n        ").concat(s.shape)})),o.b(l%(t*t)==0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(l," for depthToSpace with input shape ").concat(s.shape)})),r.a.runKernel(a.N,{x:s},{blockSize:t,dataFormat:n})}})},NuWS:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return h}));var r=n("atXS");function a(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function o(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function s(e,t){return i(e,t.map((function(e){return 1})),t)}function u(e,t,n){r.b(a(t,n),(function(){return e+" supports only inner-most axes for now. "+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function c(e,t){if(a(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function l(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function h(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}},O7f5:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({neg_:function(e){var t=Object(i.a)(e,"x","neg");return r.a.runKernel(a.Vb,{x:t})}})},OkRW:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","unstack","string_or_numeric");return o.b(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")})),r.a.runKernel(a.Xc,{value:n},{axis:t})}})},OygE:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({batchToSpaceND_:function(e,t,n){var s=Object(i.a)(e,"x","batchToSpaceND"),u=t.reduce((function(e,t){return e*t}));return o.b(s.rank>=1+t.length,(function(){return"input rank is ".concat(s.rank," but should be > than blockShape.length ").concat(t.length)})),o.b(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),o.b(s.shape[0]%u==0,(function(){return"input tensor batch is ".concat(s.shape[0]," but is not divisible by the product of the elements of blockShape ").concat(t.join(" * ")," === ").concat(u)})),r.a.runKernel(a.t,{x:s},{blockShape:t,crops:n})}})},PDX0:function(e,t){(function(t){e.exports=t}).call(this,{})},Pvz5:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=n("NclT"),u=Object(o.b)({multinomial_:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(i.a)(e,"logits","multinomial"),c=u.size,l=u.rank;if(c<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+c+".");if(l>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+l);n=n||Math.random();var h=1===l?Object(s.a)(u,[1,-1]):u,d=r.a.runKernel(a.Tb,{logits:h},{numSamples:t,seed:n,normalized:o});return 1===l?Object(s.a)(d,[d.size]):d}})},QYQ3:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("VO80"),c=Object(u.b)({squaredDifference_:function(e,t){var n,u=Object(o.a)(e,"a","squaredDifference"),c=Object(o.a)(t,"b","squaredDifference");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],Object(s.a)(u.shape,c.shape),r.a.runKernel(a.Mc,{a:u,b:c},{})}})},R0ls:function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return v}));var r=n("Um8L"),a=n("njhW"),i=n("bzdD"),o=n("parS"),s=n("Ug8H"),u=n("kXpR"),c=n("Rqg+"),l=n("NclT"),h=n("L7Hl"),d=n("4FMF");function f(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Object(o.a)(e,Object(h.a)(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function p(e,t){var n=t,a=r.c(e.shape,t.shape);return a.length>0&&(n=Object(d.a)(n,a)),Object(l.a)(n,e.shape)}function m(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Object(u.a)(e);if("elu"===t)return Object(a.a)(e);if("relu6"===t)return Object(c.a)(e);if("prelu"===t)return Object(s.a)(e,n);if("leakyrelu"===t)return Object(i.a)(e,r);throw new Error("Unknown fused activation ".concat(t,"."))}var v=function(e,t){return!(e>0)||"linear"===t}},RRa9:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","any","bool");return r.a.runKernel(a.g,{x:o},{axis:t,keepDims:n})}})},RbuM:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","split");return r.a.runKernel(a.Jc,{x:o},{numOrSizeSplits:t,axis:n})}})},RhH0:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({mod_:function(e,t){var n,s=Object(o.a)(e,"a","mod"),u=Object(o.a)(t,"b","mod");return s=(n=_slicedToArray(Object(i.makeTypesMatch)(s,u),2))[0],u=n[1],r.a.runKernel(a.Sb,{a:s,b:u})}})},RhVc:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({acosh_:function(e){var t=Object(i.a)(e,"x","acosh");return r.a.runKernel(a.c,{x:t})}})},"Rqg+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({relu6_:function(e){var t=Object(i.a)(e,"x","relu6");return r.a.runKernel(a.nc,{x:t})}})},RrGL:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({log1p_:function(e){var t=Object(i.a)(e,"x","log1p");return r.a.runKernel(a.Cb,{x:t})}})},RrjA:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("auKK"),a=n("wFtI");function i(e,t,n){return r.a.runKernel(a.db,{},{shape:e,value:t,dtype:n})}},SFB9:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({addN_:function(e){o.b(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),o.b(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return Object(i.a)(e,"tensors"+t,"addN")})),n=t[0];return t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!o.a(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),r.a.runKernel(a.e,t)}})},SHv8:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({matMul_:function(e,t){var n,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(o.a)(e,"a","matMul"),l=Object(o.a)(t,"b","matMul");return c=(n=_slicedToArray(Object(i.makeTypesMatch)(c,l),2))[0],l=n[1],r.a.runKernel(a.s,{a:c,b:l},{transposeA:s,transposeB:u})}})},SNsm:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("8Km0"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({broadcastTo_:function(e,t){var n=Object(i.a)(e,"broadcastTo","x"),s=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var c=n.shape.slice();c.length<t.length;)c.unshift(1);n=Object(u.a)(n,c)}for(var l=n.shape,h=Array.from(t),d=t.length-1;d>=0;d--)if(l[d]===t[d])h[d]=1;else if(1!==n.shape[d])throw new Error("broadcastTo(): [".concat(s,"] cannot be broadcast to [").concat(t,"]."));return 0===h.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length?Object(o.a)(n):r.a.runKernel(a.Tc,{x:n},{reps:h})}})},THqV:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("atXS"),o=n("VO80"),s=Object(o.b)({ifft_:function(e){return Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got ".concat(e.dtype,".")})),r.a.runKernel(a.pb,{input:e})}})},TyAZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({exp_:function(e){var t=Object(i.a)(e,"x","exp");return r.a.runKernel(a.Z,{x:t})}})},"U/2n":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("auKK"),a=n("wE5H"),i=n("wFtI"),o=n("o/e8"),s=n("atXS"),u=n("uBja"),c=n("VO80"),l=n("NclT"),h=Object(c.b)({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",f=arguments.length>6?arguments[6]:void 0;null==f?f=[1,1,1]:Object(a.b)("dilations is deprecated, this field will be gone in v3.0.0.");var p=Object(o.a)(e,"x","maxPool3d"),m=p,v=!1;4===p.rank&&(v=!0,m=Object(l.a)(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]])),s.b(5===m.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(m.rank,".")})),s.b("NDHWC"===d,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+d})),s.b(u.h(n,f),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(f,"'")})),null!=h&&s.b(s.v(c),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode ".concat(h," but got pad ").concat(c,".")}));var g=r.a.runKernel(i.Jb,{x:m},{filterSize:t,strides:n,pad:c,dimRoundingMode:h,dataFormat:d,dilations:f});return v?Object(l.a)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},"U/Lz":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({unsortedSegmentSum_:function(e,t,n){var s=Object(i.a)(e,"x","unsortedSegmentSum"),u=Object(i.a)(t,"segmentIds","unsortedSegmentSum","int32");return Object(o.b)(Object(o.v)(n),(function(){return"numSegments must be of dtype int"})),r.a.runKernel(a.Yc,{x:s,segmentIds:u},{numSegments:n})}})},U45G:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));var r=n("auKK"),a=n("NNfn"),i=n("o/e8"),o=n("atXS");function s(e){return o.b(o.u(e),(function(){return"The f passed in grad(f) must be a function"})),function(t,n){var a=Object(i.a)(t,"x","tf.grad","string_or_numeric"),s=null!=n?Object(i.a)(n,"dy","tf.grad"):null;return r.a.tidy((function(){var t=r.a.gradients((function(){return e(a)}),[a],s),n=t.value,i=t.grads;return null!=s&&o.e(n.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),f(i),i[0]}))}}function u(e){return o.b(o.u(e),(function(){return"The f passed in grads(f) must be a function"})),function(t,n){o.b(Array.isArray(t),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var a=Object(i.b)(t,"args","tf.grads","string_or_numeric"),s=null!=n?Object(i.a)(n,"dy","tf.grads"):null;return r.a.tidy((function(){var t=r.a.gradients((function(){return e.apply(void 0,_toConsumableArray(a))}),a,s),n=t.value,i=t.grads;return null!=s&&o.e(n.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(i),i}))}}function c(e){return o.b(o.u(e),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(t,n){o.b(t instanceof a.a,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),o.b(null==n||n instanceof a.a,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var i=r.a.gradients((function(){return e(t)}),[t],n),s=i.grads,u=i.value;return f(s),{grad:s[0],value:u}}}function l(e){return o.b(o.u(e),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(t,n){o.b(Array.isArray(t)&&t.every((function(e){return e instanceof a.a})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),o.b(null==n||n instanceof a.a,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var i=r.a.gradients((function(){return e.apply(void 0,_toConsumableArray(t))}),t,n);return null!=n&&o.e(i.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),f(i.grads),i}}function h(e,t){o.b(o.u(e),(function(){return"The f passed in variableGrads(f) must be a function"})),o.b(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof a.c})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var i in t=[],r.a.registeredVariables)t.push(r.a.registeredVariables[i]);var s=n?t.filter((function(e){return!e.trainable})):null,u=t.length;t=t.filter((function(e){return e.trainable})),o.b(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the ".concat(u," variables is trainable.")}));var c=r.a.gradients(e,t,null,!0),l=c.value,h=c.grads;o.b(h.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),o.b(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-".concat(l.rank," tensor")}));var d={};return t.forEach((function(e,t){null!=h[t]&&(d[e.name]=h[t])})),null!=s&&s.forEach((function(e){return d[e.name]=null})),{value:l,grads:d}}function d(e){return r.a.customGrad(e)}function f(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},UI8N:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({floorDiv_:function(e,t){var n,s=Object(o.a)(e,"a","floorDiv"),u=Object(o.a)(t,"b","floorDiv");return s=(n=_slicedToArray(Object(i.makeTypesMatch)(s,u),2))[0],u=n[1],r.a.runKernel(a.gb,{a:s,b:u})}})},Ug8H:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({prelu_:function(e,t){var n=Object(i.a)(e,"x","prelu"),o=Object(i.a)(t,"alpha","prelu");return r.a.runKernel(a.gc,{x:n,alpha:o})}})},Um8L:function(e,t,n){"use strict";function r(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes ".concat(e," and ").concat(t,"."));n.unshift(i)}}return n}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},"V+B2":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},VO80:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("auKK"),a=n("atXS"),i="__op";function o(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],o=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;var s=function(){r.a.startScope(n);try{var e=o.apply(void 0,arguments);return Object(a.x)(e)&&console.error("Cannot return a Promise inside of tidy."),r.a.endScope(e),e}catch(t){throw r.a.endScope(null),t}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},VhY8:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=Object(i.a)(e,"x","topk");if(0===o.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var s=o.shape[o.shape.length-1];if(t>s)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(s,") but got ")+t);var u={x:o},c={k:t,sorted:n},l=r.a.runKernel(a.Uc,u,c),h=_slicedToArray(l,2),d=h[0],f=h[1];return{values:d,indices:f}}})},WJRb:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("auKK"),a=n("wFtI");function i(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return r.a.runKernel(a.Ab,{},{start:e,stop:t,num:n})}},WVnj:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("auKK"),a=n("atXS"),i=n("6366");function o(e,t,n,o){if(null==o&&(o=Object(a.r)(e)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(a.A)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Object(a.c)(t);var s=Object(a.N)(t),u=Object(a.N)(n);Object(a.b)(s===u,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ").concat(s," values but has ").concat(u)}));for(var c=0;c<n.length;++c){var l=n[c],h=c!==n.length-1||l!==Object(a.N)(t.slice(c));Object(a.b)(n[c]===t[c]||!h,(function(){return"Error creating a new Tensor. Inferred shape (".concat(n,") does not match the provided shape (").concat(t,"). ")}))}}return Object(a.A)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==o?Object(i.toTypedArray)(e,o):Object(a.m)(e,[],!0),r.a.makeTensor(e,t,o)}},WWBm:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({ceil_:function(e){var t=Object(i.a)(e,"x","ceil");return r.a.runKernel(a.x,{x:t})}})},WYAb:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({isInf_:function(e){var t=Object(i.a)(e,"x","isInf");return r.a.runKernel(a.tb,{x:t})}})},Wiw4:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("auKK"),a=n("atXS"),i=n("B3db");function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=o(e,"float32"),s=o(e,"float32");return Object(i.a)(n,s)}var u=Object(a.F)(Object(a.N)(e),t);return r.a.makeTensor(u,e,t)}},X4fa:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(i.a)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and dim was ").concat(t));return r.a.runKernel(a.Fc,{logits:n},{dim:t})}})},XcSs:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({sinh_:function(e){var t=Object(i.a)(e,"x","sinh");return r.a.runKernel(a.Dc,{x:t})}})},Xyqe:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({rsqrt_:function(e){var t=Object(i.a)(e,"x","rsqrt");return r.a.runKernel(a.wc,{x:t})}})},YAKK:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({atan2_:function(e,t){var n,s=Object(o.a)(e,"a","atan2"),u=Object(o.a)(t,"b","atan2");return s=(n=_slicedToArray(Object(i.makeTypesMatch)(s,u),2))[0],u=n[1],r.a.runKernel(a.m,{a:s,b:u})}})},YSVl:function(e,t,n){var r=n("EhIR"),a=n("uDiL"),i=n("pJ6O"),o=n("yuCN"),s=n("euyF"),u=n("ie1u"),c=n("pJ3+");c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},YuTi:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},Z5Ez:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("SNsm"),u=n("Um8L"),c=n("VO80"),l=Object(c.b)({where_:function(e,t,n){var c=Object(i.a)(t,"a","where"),l=Object(i.a)(n,"b","where"),h=Object(i.a)(e,"condition","where","bool"),d=Object(u.a)(c.shape,l.shape),f=Object(s.a)(c,d),p=Object(s.a)(l,d);return 1===h.rank&&Object(o.b)(h.shape[0]===c.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})),1!==h.rank&&Object(o.e)(h.shape,p.shape,"Error in where: "),r.a.runKernel(a.yc,{condition:h,t:f,e:p})}})},ZJ6U:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("8Km0"),u=n("VO80"),c=Object(u.b)({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(o.b)(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Object(i.b)(e,"tensors","concat","string_or_numeric");return"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length?Object(s.a)(n[0]):r.a.runKernel(a.B,n,{axis:t})}})},aSZd:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("VO80"),o=n("NclT"),s=Object(i.b)({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,i,s){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=e;3===e.rank&&(l=Object(o.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var h=t;return 3===h.rank&&(h=Object(o.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),r.a.runKernel(a.P,{x:l,dy:h},{strides:i,pad:s,dimRoundingMode:c,dilations:u,filterShape:n})}})},aTLu:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({sin_:function(e){var t=Object(i.a)(e,"x","sin");return r.a.runKernel(a.Cc,{x:t})}})},adw1:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("B3db"),a=n("ZJ6U"),i=n("JLAb"),o=n("parS"),s=n("VO80"),u=n("17CO"),c=n("NclT"),l=n("0I63"),h=n("AV8V"),d=n("bTzI"),f=n("THqV"),p=Object(s.b)({irfft_:function(e){var t,n=e.shape[e.shape.length-1],s=e.size/n;if(n<=2){var p=Object(c.a)(e,[s,n]);t=Object(f.a)(p)}else{var m=[s,2*(n-1)],v=Object(c.a)(Object(u.a)(e),[s,n]),g=Object(c.a)(Object(i.a)(e),[s,n]),y=Object(l.a)(Object(d.a)(v,[0,1],[s,n-2]),1),b=Object(o.a)(Object(l.a)(Object(d.a)(g,[0,1],[s,n-2]),1),Object(h.a)(-1)),k=Object(a.a)([v,y],1),_=Object(a.a)([g,b],1),w=Object(c.a)(Object(r.a)(k,_),[m[0],m[1]]);t=Object(f.a)(w)}if(t=Object(u.a)(t),3===e.rank&&0!==e.shape[0]){var x=t,C=e.shape[0];t=Object(c.a)(t,[C,t.shape[0]/C,t.shape[1]]),x.dispose()}return t}})},atXS:function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function a(e,t,n){return Math.max(e,Math.min(t,n))}function i(e){return e%2==0?e:e+1}function o(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function s(e,t){var n=Math.random();return t*n+(1-n)*e}function u(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function c(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";c(m(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function h(e){c(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||N(e)&&!n)for(var r=0;r<e.length;++r)d(e[r],t,n);else t.push(e);return t}function f(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function p(e){return 0===e.length}function m(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function v(e){return e%1==0}function g(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function y(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function b(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return r(t),t}function k(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function w(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when there are 0 elements"));if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function x(e,t){var n=t.length;return c((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but got axis ")+e})),c(e.every((function(e){return v(e)})),(function(){return"All values in axis param must be integers but got axis "+e})),e.map((function(e){return e<0?n+e:e}))}function C(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:x(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function O(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function S(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function T(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function I(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function E(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function N(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function A(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function R(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function D(e){return"string"==typeof e||e instanceof String}function j(e){return"boolean"==typeof e}function F(e){return"number"==typeof e}function M(e){return Array.isArray(e)?M(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":F(e)?"float32":D(e)?"string":j(e)?"bool":"float32"}function P(e){return!!(e&&e.constructor&&e.call&&e.apply)}function L(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function z(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function B(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length,"."));return function e(t,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[t+o];else for(var s=n[0],u=n.slice(1),c=u.reduce((function(e,t){return e*t})),l=0;l<s;l++)a[l]=e(t+l*c,u,r);return a}(0,e,t)}function V(e,t){for(var n=W(e,t),r=0;r<n.length;r++)n[r]=1;return n}function W(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function U(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return B(e,new Float32Array(n));if("int32"===t)return B(e,new Int32Array(n));if("bool"===t)return B(e,new Uint8Array(n));throw new Error("Unknown data type "+t)}function H(e){e.forEach((function(t){c(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape [".concat(e,"].")}))}))}function G(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function K(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function q(e){return e&&e.then&&"function"==typeof e.then}n.d(t,"M",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"H",(function(){return i})),n.d(t,"Q",(function(){return o})),n.d(t,"J",(function(){return s})),n.d(t,"l",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return h})),n.d(t,"m",(function(){return d})),n.d(t,"N",(function(){return f})),n.d(t,"y",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"v",(function(){return v})),n.d(t,"R",(function(){return g})),n.d(t,"O",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"L",(function(){return k})),n.d(t,"K",(function(){return _})),n.d(t,"s",(function(){return w})),n.d(t,"I",(function(){return x})),n.d(t,"P",(function(){return C})),n.d(t,"o",(function(){return O})),n.d(t,"n",(function(){return S})),n.d(t,"h",(function(){return T})),n.d(t,"B",(function(){return I})),n.d(t,"p",(function(){return E})),n.d(t,"A",(function(){return N})),n.d(t,"g",(function(){return A})),n.d(t,"f",(function(){return R})),n.d(t,"z",(function(){return D})),n.d(t,"t",(function(){return j})),n.d(t,"w",(function(){return F})),n.d(t,"r",(function(){return M})),n.d(t,"u",(function(){return P})),n.d(t,"G",(function(){return L})),n.d(t,"j",(function(){return z})),n.d(t,"S",(function(){return B})),n.d(t,"D",(function(){return V})),n.d(t,"F",(function(){return W})),n.d(t,"E",(function(){return U})),n.d(t,"c",(function(){return H})),n.d(t,"C",(function(){return G})),n.d(t,"q",(function(){return K})),n.d(t,"x",(function(){return q}))},auKK:function(e,t,n){"use strict";var r=n("i4e/"),a=n("szMd"),i=n("9JAK"),o=n("wFtI"),s=n("c7gn"),u=n("atXS"),c=function(){function e(t,n){_classCallCheck(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new l)}return _createClass(e,[{key:"profileKernel",value:function(e,t,n){var r,i=this.backendTimer.time((function(){r=n()}));if(Object(a.c)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var o=function(t){var n=r[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},s=0;s<r.length;s++)o(s);return{kernelName:e,outputs:r,inputs:t,timeMs:i.then((function(e){return e.kernelMs})),extraInfo:i.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var l=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"==typeof r?u.L(r+"ms",9):r.error,s=u.L(e,25),c=t.rank,l=t.size,h=u.L(t.shape.toString(),14),d="";for(var f in a){var p=a[f];if(null!=p){var m=p.shape||t.shape,v=m.length;d+="".concat(f,": ").concat(v,"D ").concat(v>0?m:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(c,"D ").concat(h,"\t%c").concat(l,"\t%c").concat(d,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}(),h=n("NNfn"),d=n("dsKV"),f=n("6366");n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return g}));var p=function(){function e(){_classCallCheck(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return _createClass(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),m=function(){function e(t){_classCallCheck(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new p}var t,n,a,i;return _createClass(e,[{key:"ready",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=17;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=14;break}return e.next=13,this.setBackend(r);case 13:return e.abrupt("return",void e.sent);case 14:n++,e.next=6;break;case 17:throw new Error("Could not initialize any backends, all backend initializations failed.");case 18:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods"));this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=14;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=11;break}return e.next=8,r;case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=r;case 12:if(e.t0){e.next=14;break}return e.abrupt("return",!1);case 14:return e.abrupt("return",(this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new c(this.backendInstance),!0));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"setupRegisteredKernels",value:function(){var e=this;Object(s.d)(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;Object(s.d)(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var a=n.factory();if(!a||a instanceof r.b||"function"!=typeof a.then)return this.registry[e]=a,{success:!0,asyncInit:!1};var i=++this.pendingBackendInitId,o=a.then((function(n){return!(i<t.pendingBackendInitId||(t.registry[e]=n,t.pendingBackendInit=null,0))})).catch((function(n){return i<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}catch(s){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype);return this.addTapeNode(this.state.activeScope.name,{x:e},[t],(function(e){return{x:function(){return g.runKernelFunc((function(t){return t.cast(e,"float32")}),{x:e},null,o.w,{dtype:"float32"})}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=r-t-a-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak (").concat(i," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e,t,n,r,a,i,o){var u,c=this,l=[],h=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var d,f=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var m,v,g=Object(s.c)(r,this.backendName);if(null!=g)d=function(){var e=c.backend.numDataIds();m=g.kernelFunc({inputs:t,attrs:a,backend:c.backend});var n=Array.isArray(m)?m:[m];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){if(null!=e.rank)return e;var t=e.dataId,n=e.shape,r=e.dtype;return c.makeTensorFromDataId(t,n,r)}));if(h){var u=c.getTensorsForGradient(r,t,s);if(null==u){null==o&&(o=[]);var d=s.filter((function(e,t){return o[t]}));u=(i||[]).slice().concat(d)}l=c.saveTensorsForBackwardMode(u)}return s};else{if(null==e)throw new Error("Error running ".concat(r,": Neither modular kernel nor forward func passed"));var y=function(e){h&&(l=e.map((function(e){return c.keep(c.clone(e))})))};d=function(){var t=c.backend.numDataIds();m=c.tidy((function(){return e(c.backend,y)}));var n=Array.isArray(m)?m:[m];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(r,t,n),n}}return this.scopedRun((function(){return c.state.kernelDepth++}),(function(){return c.state.kernelDepth--}),(function(){c.ENV.getBool("DEBUG")||c.state.profiling?(v=c.profiler.profileKernel(r,t,(function(){return d()})),c.ENV.getBool("DEBUG")&&c.profiler.logKernelProfile(v),u=v.outputs):u=d()})),h&&this.addTapeNode(r,t,u,n,l,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-f,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return null!=t[e]?t[e].shape:null})),outputShapes:u.map((function(e){return e.shape})),kernelTimeMs:v.timeMs,extraInfo:v.extraInfo}),Array.isArray(m)?u:u[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Object(s.b)(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(u.b(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var c=n.filter((function(e,t){return o[t]}));return a.concat(c)}return null}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");r=r||this.backend;var a=e;"string"===(n=n||"float32")&&u.z(e[0])&&(a=e.map((function(e){return f.encodeString(e)})));var i=r.write(a,t,n),o=new h.a(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),c=Object(u.f)(a);this.state.numBytes+=c-s.bytes,s.bytes=c}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a=new h.a(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new h.c(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"incRef",value:function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*u.g(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof h.c||this.track(e)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):(t.backend.decComplexRef(e.dataId),this.state.tensorInfo.get(e.dataId).refCount--)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[e])}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=5,t();case 5:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,_toConsumableArray(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=_createForOfIteratorHelper(this.state.activeProfile.kernels),e.prev=11,a.s();case 13:if((i=a.n()).done){e.next=23;break}return o=i.value,e.next=17,o.kernelTimeMs;case 17:return o.kernelTimeMs=e.sent,e.next=20,o.extraInfo;case 20:o.extraInfo=e.sent;case 21:e.next=13;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(11),a.e(e.t0);case 28:return e.prev=28,a.f(),e.finish(28);case 31:return e.abrupt("return",this.state.activeProfile);case 32:case"end":return e.stop()}}),e,this,[[11,25,28,31]])}))),function(e){return n.apply(this,arguments)})},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,c={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},l=Object(s.b)(e);null!=l&&(r=l.gradFunc),null!=r&&(c.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=u.F(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(c)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=Object(d.getTensorsInContainer)(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(u.b(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));u.b(i instanceof h.a,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],h=!1,d=0;d<t.length;d++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),h=!0,a[s.id]=!0;break}if(h)break}}var f={};f[n.id]=!0;for(var p={},m=e.length-1;m>=0;m--)for(var v=e[m],g=v.inputs,y=0;y<v.outputs.length;y++)if(f[v.outputs[y].id]){for(var b in g)f[g[b].id]=!0,p[v.id]=!0;break}for(var k=[],_=0;_<e.length;_++){var w=e[_];if(a[w.id]&&p[w.id]){var x={};for(var C in w.inputs){var O=w.inputs[C];r[O.id]&&(x[C]=O)}var S=Object.assign({},w);S.inputs=x,S.outputs=w.outputs,k.push(S)}}return k}(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,a,s={};s[i.id]=null==n?(e=i.shape,a=Object(u.D)(Object(u.N)(e),"float32"),g.makeTensor(a,e,"float32")):n,function(e,t,n,a){for(var i=function(n){var i=t[n],o=[];if(i.outputs.forEach((function(t){var n=e[t.id];o.push(null!=n?n:null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for ".concat(i.kernelName,"."));var s=i.gradient(o),c=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". Available gradients found: ").concat(Object.keys(s),"."));var n=function(e){return r.tidy(e)}((function(){return s[t]()}));if("float32"!==n.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ").concat(t," must have 'float32' dtype, but has '").concat(n.dtype,"'"));var o=i.inputs[t];if(!u.a(n.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input '").concat(t,"' has shape '").concat(n.shape,"', which does not match the shape of the input '").concat(o.shape,"'"));if(null==e[o.id])e[o.id]=n;else{var c=e[o.id];e[o.id]=a(c,n),c.dispose()}};for(var l in i.inputs)c(l)},o=t.length-1;o>=0;o--)i(o)}(s,o,0,y);var c=t.map((function(e){return s[e.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=_createForOfIteratorHelper(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:c}}))}},{key:"customGrad",value:function(e){var t=this;return u.b(u.u(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;u.b(r.every((function(e){return e instanceof h.a})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(e,t){o[t]=e})),t.runKernelFunc((function(t,n){return i=e.apply(void 0,r.concat([n])),u.b(i.value instanceof h.a,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),u.b(u.u(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value}),o,(function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];u.b(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),u.b(a.every((function(e){return e instanceof h.a})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o}))}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(f.now)(),e.next=3,this.backend.time(t);case 3:return r=e.sent,e.abrupt("return",(r.wallMs=Object(f.now)()-n,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new p,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function v(){var e=Object(i.b)();if(null==e._tfengine){var t=new a.b(e);e._tfengine=new m(t)}return Object(a.d)(e._tfengine.ENV),Object(h.f)((function(){return e._tfengine})),e._tfengine}m.nextTensorId=0,m.nextVariableId=0;var g=v();function y(e,t){return g.runKernel(o.d,{a:e,b:t})}},"b++O":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({isNaN_:function(e){var t=Object(i.a)(e,"x","isNaN");return r.a.runKernel(a.ub,{x:t})}})},bTzI:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({slice_:function(e,t,n){var o=Object(i.a)(e,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");return r.a.runKernel(a.Ec,{x:o},{begin:t,size:n})}})},bzdD:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Object(i.a)(e,"x","leakyRelu");return r.a.runKernel(a.xb,{x:n},{alpha:t})}})},"c/ib":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(i.a)(e,"images","resizeBilinear");o.b(3===c.rank||4===c.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank ".concat(c.rank,".")})),o.b(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."})),o.b(!1===s||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var l=c,h=!1;3===c.rank&&(h=!0,l=Object(u.a)(c,[1,c.shape[0],c.shape[1],c.shape[2]]));_toArray(t);var d=r.a.runKernel(a.pc,{images:l},{alignCorners:n,halfPixelCenters:s,size:t});return h?Object(u.a)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}})},c7gn:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return h})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n("szMd"),a=n("9JAK"),i=Object(a.a)("kernelRegistry",(function(){return new Map})),o=Object(a.a)("gradRegistry",(function(){return new Map}));function s(e,t){var n=m(e,t);return i.get(n)}function u(e){return o.get(e)}function c(e){for(var t=i.entries(),n=[];;){var r=t.next(),a=r.done,o=r.value;if(a)break;var s=_slicedToArray(o,2),u=s[0],c=s[1];_slicedToArray(u.split("_"),1)[0]===e&&n.push(c)}return n}function l(e){var t=e.kernelName,n=e.backendName,r=m(t,n);i.has(r)&&console.warn("The kernel '".concat(t,"' for backend '").concat(n,"' is already registered")),i.set(r,e)}function h(e){var t=e.kernelName;o.has(t)&&Object(r.c)().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(t,"'")),o.set(t,e)}function d(e,t){var n=m(e,t);if(!i.has(n))throw new Error("The kernel '".concat(e,"' for backend '").concat(t,"' is not registered"));i.delete(n)}function f(e){if(!o.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));o.delete(e)}function p(e,t){c(e).forEach((function(e){l(Object.assign({},e,{backendName:t}))}))}function m(e,t){return"".concat(t,"_").concat(e)}},c9N1:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("atXS"),o=n("VO80"),s=n("NclT"),u=Object(o.b)({conv2DBackpropInput_:function(e,t,n,o,u){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0;i.b(e.length===t.rank,(function(){return"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var h=e,d=t,f=!1;3===t.rank&&(f=!0,d=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),h=[1,e[0],e[1],e[2]]),i.b(4===h.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+h.length+"."})),i.b(4===d.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+d.rank})),i.b(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var p="NHWC"===c?h[3]:h[1],m="NHWC"===c?d.shape[3]:d.shape[1];i.b(p===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(p,") must match input depth for filter ").concat(n.shape[2],".")})),i.b(m===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(m,") must match output depth for filter ").concat(n.shape[3],".")})),null!=l&&i.b(i.v(u),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var v=r.a.runKernel(a.E,{dy:d,filter:n},{strides:o,pad:u,dataFormat:c,dimRoundingMode:l,inputShape:h});return f?Object(s.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},cdtJ:function(e,t,n){"use strict";var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("NclT"),u=n("VO80");n.d(t,"a",(function(){return c}));var c=Object(u.b)({batchNorm_:function(e,t,n,u,c,l){null==l&&(l=.001);var h,d,f=Object(i.a)(e,"x","batchNorm"),p=Object(i.a)(t,"mean","batchNorm"),m=Object(i.a)(n,"variance","batchNorm");null!=c&&(h=Object(i.a)(c,"scale","batchNorm")),null!=u&&(d=Object(i.a)(u,"offset","batchNorm")),o.b(p.rank===m.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.b(null==d||p.rank===d.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.b(null==h||p.rank===h.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var v=function(e){return 0===e.rank||1===e.rank?Object(s.a)(e,[1,1,1,e.size]):2===e.rank?Object(s.a)(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(f),g=r.a.runKernel(a.ib,{x:v,scale:h,offset:d,mean:p,variance:m},{varianceEpsilon:l});return Object(s.a)(g,f.shape)}})},dWjR:function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}n.d(t,"a",(function(){return r}))},dYAU:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({spaceToBatchND_:function(e,t,n){var s=Object(i.a)(e,"x","spaceToBatchND");return o.b(s.rank>=1+t.length,(function(){return"input rank ".concat(s.rank," should be > than [blockShape] ").concat(t.length)})),o.b(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),o.b(s.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e}),!0),(function(){return"input spatial dimensions ".concat(s.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())})),r.a.runKernel(a.Hc,{x:s},{blockShape:t,paddings:n})}})},dnXz:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("o/e8"),a=n("atXS"),i=n("3X4V"),o=n("uBja"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({conv1d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,h=arguments.length>6?arguments[6]:void 0,d=Object(r.a)(e,"x","conv1d"),f=Object(r.a)(t,"filter","conv1d"),p=d,m=!1;2===d.rank&&(m=!0,p=Object(u.a)(d,[1,d.shape[0],d.shape[1]])),a.b(3===p.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(p.rank,".")})),a.b(3===f.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+f.rank+"."})),null!=h&&a.b(a.v(s),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode ".concat(h," but got pad ").concat(s,".")})),a.b(p.shape[2]===f.shape[1],(function(){return"Error in conv1d: depth of input (".concat(p.shape[2],") must match input depth for filter ").concat(f.shape[1],".")})),a.b(o.h(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride ".concat(n," and dilation '").concat(l,"'")})),a.b("NWC"===c,(function(){return"Error in conv1d: got dataFormat of ".concat(c," but only NWC is currently supported.")}));var v=Object(u.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),g=Object(u.a)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),y=[1,n],b=[1,l],k=Object(i.a)(g,v,y,s,"NHWC",b,h);return m?Object(u.a)(k,[k.shape[2],k.shape[3]]):Object(u.a)(k,[k.shape[0],k.shape[2],k.shape[3]])}})},dsKV:function(e,t,n){"use strict";n.r(t),n.d(t,"makeTypesMatch",(function(){return o})),n.d(t,"assertTypesMatch",(function(){return s})),n.d(t,"isTensorInList",(function(){return u})),n.d(t,"getTensorsInContainer",(function(){return c}));var r=n("NNfn"),a=n("I79q"),i=n("atXS");function o(e,t){if(e.dtype===t.dtype)return[e,t];var n=Object(a.c)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function s(e,t){Object(i.b)(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and second(").concat(t.dtype,") input must match")}))}function u(e,t){return t.some((function(t){return t.id===e.id}))}function c(e){var t=[];return function e(t,n,a){if(null!=t)if(t instanceof r.a)n.push(t);else if(i=t,Array.isArray(i)||"object"==typeof i){var i,o=t;for(var s in o){var u=o[s];a.has(u)||(a.add(u),e(u,n,a))}}}(e,t,new Set),t}},euyF:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n=a[i]=(n^=n>>>15)^(e^=e>>>12),t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=0==(n=s[127&i]^=r+(o=o+1640531527|0))?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,s[a]=(r^=r>>>15)^(n^=n>>>12);e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},fjZN:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({atan_:function(e){var t=Object(i.a)(e,"x","atan");return r.a.runKernel(a.l,{x:t})}})},fmoR:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("BD40"),a=n("VO80"),i=n("1OSX"),o=Object(a.b)({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");for(var s=new i.a(t,n,a,!0,o),u=Object(r.a)(e,a),c=0;c<u.values.length;c++)u.values[c]=s.nextValue();return u.toTensor()}})},"g4+C":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({depthwiseConv2d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],h=arguments.length>6?arguments[6]:void 0,d=Object(i.a)(e,"x","depthwiseConv2d"),f=Object(i.a)(t,"filter","depthwiseConv2d"),p=d,m=!1;3===d.rank&&(m=!0,p=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===p.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank ".concat(p.rank,".")})),o.b(4===f.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+f.rank+"."})),o.b(p.shape[3]===f.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels (".concat(p.shape[3],") must match the inChannels dimension in filter ").concat(f.shape[2],".")})),null!=h&&o.b(o.v(s),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ".concat(h," but got pad ").concat(s,".")}));var v=r.a.runKernel(a.O,{x:p,filter:f},{strides:n,pad:s,dataFormat:c,dilations:l,dimRoundingMode:h});return m?Object(u.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},g4m1:function(e,t,n){"use strict";function r(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,a=e.length,i=0,o=!1;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||a)}(e,t,n);e.splice(r<0?-(r+1):r,0,t)}function a(e,t){return e>t?1:e<t?-1:0}function i(e,t,n,r,a){return u(e,t,n,r,a,0)}function o(e,t,n,r,a,i){return u(e,t,n,r,a,0,!1,i,!0)}function s(e,t,n,r,a,i){return u(e,t,n,r,a,i,!0)}function u(e,t,n,a,i,o){for(var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],d=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=[],p=0;p<t.length;p++)t[p]>i&&f.push({score:t[p],boxIndex:p,suppressBeginIndex:0});f.sort(h);for(var m=o>0?-.5/o:0,v=[],g=[];v.length<n&&f.length>0;){var y=f.pop(),b=y.score,k=y.boxIndex,_=y.suppressBeginIndex;if(b<i)break;for(var w=!1,x=v.length-1;x>=_;--x){var C=c(e,k,v[x]);if(C>=a){w=!0;break}if(y.score=y.score*l(a,m,C),y.score<=i)break}y.suppressBeginIndex=v.length,w||(y.score===b?(v.push(k),g.push(y.score)):y.score>i&&r(f,y,h))}var O=v.length,S=n-O;u&&S>0&&(v.push.apply(v,_toConsumableArray(new Array(S).fill(0))),g.push.apply(g,_toConsumableArray(new Array(S).fill(0))));var T={selectedIndices:v};return s&&(T.selectedScores=g),d&&(T.validOutputs=O),T}function c(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),f=(s-i)*(u-o),p=(h-c)*(d-l);if(f<=0||p<=0)return 0;var m=Math.max(i,c),v=Math.max(o,l),g=Math.min(s,h),y=Math.min(u,d),b=Math.max(g-m,0)*Math.max(y-v,0);return b/(f+p-b)}function l(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function h(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}))},gErV:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("U45G"),a=n("o/e8"),i=n("3rNm"),o=n("TyAZ"),s=n("E1lT"),u=n("wCH+"),c=n("parS"),l=n("VO80"),h=n("oAkI"),d=n("4FMF"),f=Object(l.b)({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(a.a)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(n.rank," and axis was ").concat(t));return Object(r.a)((function(e,n){var r=Object(u.a)(e,t,!0),a=Object(h.a)(e,r),l=Object(h.a)(Object(i.a)(a,"float32"),Object(s.a)(Object(d.a)(Object(o.a)(a),t,!0)));return n([l]),{value:l,gradFunc:function(e,n){var r=_slicedToArray(n,1)[0],a=Object(o.a)(r);return Object(h.a)(e,Object(c.a)(Object(d.a)(e,t,!0),a))}}}))(n)}})},hNYx:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("auKK"),a=n("wFtI");function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");return r.a.runKernel(a.ic,{},{start:e,stop:t,step:n,dtype:i})}},hT5K:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","unique","string_or_numeric");Object(o.b)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var s={x:n},u={axis:t},c=r.a.runKernel(a.Wc,s,u),l=_slicedToArray(c,2),h=l[0],d=l[1];return{values:h,indices:d}}})},hinG:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("BD40"),a=n("VO80"),i=n("1OSX"),o=Object(a.b)({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",o=arguments.length>4?arguments[4]:void 0,s=Object(r.a)(e,a),u=new i.c(t,n,null,o),c=0;c<s.values.length;c++)s.values[c]=u.nextValue();return s.toTensor()}})},"i/oj":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=n("o0+U"),u=Object(o.b)({scatterND_:function(e,t,n){var o=Object(i.a)(e,"indices","scatterND","int32"),u=Object(i.a)(t,"updates","scatterND");return s.validateInput(u,o,n),r.a.runKernel(a.xc,{indices:o,updates:u},{shape:n})}})},"i4e/":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=function(){function e(t,n){_classCallCheck(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return _createClass(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),a=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"decComplexRef",value:function(e){}},{key:"time",value:function(e){return i("time")}},{key:"read",value:function(e){return i("read")}},{key:"readSync",value:function(e){return i("readSync")}},{key:"numDataIds",value:function(){return i("numDataIds")}},{key:"disposeData",value:function(e){return i("disposeData")}},{key:"write",value:function(e,t,n){return i("write")}},{key:"move",value:function(e,t,n,r){return i("move")}},{key:"memory",value:function(){return i("memory")}},{key:"floatPrecision",value:function(){return i("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"batchMatMul",value:function(e,t,n,r){return i("batchMatMul")}},{key:"fusedBatchMatMul",value:function(e){return _objectDestructuringEmpty(e),i("fusedBatchMatMul")}},{key:"slice",value:function(e,t,n){return i("slice")}},{key:"stridedSlice",value:function(e,t,n,r){return i("stridedSlice")}},{key:"unstack",value:function(e,t){return i("unstack")}},{key:"reverse",value:function(e,t){return i("reverse")}},{key:"concat",value:function(e,t){return i("concat")}},{key:"neg",value:function(e){return i("neg")}},{key:"add",value:function(e,t){return i("add")}},{key:"addN",value:function(e){return i("addN")}},{key:"subtract",value:function(e,t){return i("subtract")}},{key:"multiply",value:function(e,t){return i("multiply")}},{key:"realDivide",value:function(e,t){return i("realDivide")}},{key:"floorDiv",value:function(e,t){return i("floorDiv")}},{key:"sum",value:function(e,t){return i("sum")}},{key:"prod",value:function(e,t){return i("prod")}},{key:"unsortedSegmentSum",value:function(e,t,n){return i("unsortedSegmentSum")}},{key:"argMin",value:function(e,t){return i("argMin")}},{key:"argMax",value:function(e,t){return i("argMax")}},{key:"equal",value:function(e,t){return i("equal")}},{key:"notEqual",value:function(e,t){return i("notEqual")}},{key:"less",value:function(e,t){return i("less")}},{key:"lessEqual",value:function(e,t){return i("lessEqual")}},{key:"greater",value:function(e,t){return i("greater")}},{key:"greaterEqual",value:function(e,t){return i("greaterEqual")}},{key:"logicalNot",value:function(e){return i("logicalNot")}},{key:"logicalAnd",value:function(e,t){return i("logicalAnd")}},{key:"logicalOr",value:function(e,t){return i("logicalOr")}},{key:"where",value:function(e){return i("where")}},{key:"select",value:function(e,t,n){return i("select")}},{key:"topk",value:function(e,t,n){return i("topk")}},{key:"min",value:function(e,t){return i("min")}},{key:"minimum",value:function(e,t){return i("minimum")}},{key:"mod",value:function(e,t){return i("mod")}},{key:"max",value:function(e,t){return i("max")}},{key:"maximum",value:function(e,t){return i("maximum")}},{key:"all",value:function(e,t){return i("all")}},{key:"any",value:function(e,t){return i("any")}},{key:"squaredDifference",value:function(e,t){return i("squaredDifference")}},{key:"ceil",value:function(e){return i("ceil")}},{key:"floor",value:function(e){return i("floor")}},{key:"round",value:function(e){return i("round")}},{key:"sign",value:function(e){return i("sign")}},{key:"isNaN",value:function(e){return i("isNaN")}},{key:"isInf",value:function(e){return i("isInf")}},{key:"isFinite",value:function(e){return i("isFinite")}},{key:"pow",value:function(e,t){return i("pow")}},{key:"exp",value:function(e){return i("exp")}},{key:"expm1",value:function(e){return i("expm1")}},{key:"softmax",value:function(e,t){return i("softmax")}},{key:"log",value:function(e){return i("log")}},{key:"log1p",value:function(e){return i("log1p")}},{key:"sqrt",value:function(e){return i("sqrt")}},{key:"rsqrt",value:function(e){return i("rsqrt")}},{key:"square",value:function(e){return i("square")}},{key:"reciprocal",value:function(e){return i("reciprocal")}},{key:"relu",value:function(e){return i("relu")}},{key:"relu6",value:function(e){return i("relu6")}},{key:"prelu",value:function(e,t){return i("prelu")}},{key:"elu",value:function(e){return i("elu")}},{key:"eluDer",value:function(e,t){return i("eluDer")}},{key:"selu",value:function(e){return i("selu")}},{key:"int",value:function(e){return i("int")}},{key:"clip",value:function(e,t,n){return i("clip")}},{key:"abs",value:function(e){return i("abs")}},{key:"complexAbs",value:function(e){return i("complexAbs")}},{key:"sigmoid",value:function(e){return i("sigmoid")}},{key:"softplus",value:function(e){return i("softplus")}},{key:"sin",value:function(e){return i("sin")}},{key:"cos",value:function(e){return i("cos")}},{key:"tan",value:function(e){return i("tan")}},{key:"asin",value:function(e){return i("asin")}},{key:"acos",value:function(e){return i("acos")}},{key:"atan",value:function(e){return i("atan")}},{key:"atan2",value:function(e,t){return i("atan2")}},{key:"sinh",value:function(e){return i("sinh")}},{key:"cosh",value:function(e){return i("cosh")}},{key:"tanh",value:function(e){return i("tanh")}},{key:"asinh",value:function(e){return i("asinh")}},{key:"acosh",value:function(e){return i("acosh")}},{key:"atanh",value:function(e){return i("atanh")}},{key:"erf",value:function(e){return i("erf")}},{key:"step",value:function(e,t){return i("step")}},{key:"fusedConv2d",value:function(e){return _objectDestructuringEmpty(e),i("fusedConv2d")}},{key:"conv2d",value:function(e,t,n){return i("conv2d")}},{key:"conv2dDerInput",value:function(e,t,n){return i("conv2dDerInput")}},{key:"conv2dDerFilter",value:function(e,t,n){return i("conv2dDerFilter")}},{key:"fusedDepthwiseConv2D",value:function(e){return _objectDestructuringEmpty(e),i("fusedDepthwiseConv2D")}},{key:"depthwiseConv2D",value:function(e,t,n){return i("depthwiseConv2D")}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){return i("depthwiseConv2DDerInput")}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){return i("depthwiseConv2DDerFilter")}},{key:"conv3d",value:function(e,t,n){return i("conv3d")}},{key:"conv3dDerInput",value:function(e,t,n){return i("conv3dDerInput")}},{key:"conv3dDerFilter",value:function(e,t,n){return i("conv3dDerFilter")}},{key:"maxPool",value:function(e,t){return i("maxPool")}},{key:"maxPoolBackprop",value:function(e,t,n,r){return i("maxPoolBackprop")}},{key:"avgPool",value:function(e,t){return i("avgPool")}},{key:"avgPoolBackprop",value:function(e,t,n){return i("avgPoolBackprop")}},{key:"avgPool3d",value:function(e,t){return i("avgPool3d")}},{key:"avgPool3dBackprop",value:function(e,t,n){return i("avgPool3dBackprop")}},{key:"maxPool3d",value:function(e,t){return i("maxPool3d")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){return i("maxPool3dBackprop")}},{key:"reshape",value:function(e,t){return i("reshape")}},{key:"cast",value:function(e,t){return i("cast")}},{key:"tile",value:function(e,t){return i("tile")}},{key:"pad",value:function(e,t,n){return i("pad")}},{key:"transpose",value:function(e,t){return i("transpose")}},{key:"gather",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return i("gather")}},{key:"gatherND",value:function(e,t){return i("gatherND")}},{key:"scatterND",value:function(e,t,n){return i("scatterND")}},{key:"batchToSpaceND",value:function(e,t,n){return i("batchToSpaceND")}},{key:"spaceToBatchND",value:function(e,t,n){return i("spaceToBatchND")}},{key:"resizeBilinear",value:function(e,t,n,r,a){return i("resizeBilinear")}},{key:"resizeBilinearBackprop",value:function(e,t,n){return i("resizeBilinearBackprop")}},{key:"resizeNearestNeighbor",value:function(e,t,n,r,a){return i("resizeNearestNeighbor")}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){return i("resizeNearestNeighborBackprop")}},{key:"batchNorm",value:function(e,t,n,r,a,o){return i("batchNorm")}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){return i("localResponseNormalization4D")}},{key:"LRNGrad",value:function(e,t,n,r,a,o,s){return i("LRNGrad")}},{key:"multinomial",value:function(e,t,n,r){return i("multinomial")}},{key:"oneHot",value:function(e,t,n,r){return i("oneHot")}},{key:"cumsum",value:function(e,t,n,r){return i("cumsum")}},{key:"nonMaxSuppression",value:function(e,t,n,r,a){return i("nonMaxSuppression")}},{key:"fft",value:function(e){return i("fft")}},{key:"ifft",value:function(e){return i("ifft")}},{key:"complex",value:function(e,t){return i("complex")}},{key:"real",value:function(e){return i("real")}},{key:"imag",value:function(e){return i("imag")}},{key:"cropAndResize",value:function(e,t,n,r,a,o){return i("cropAndResize")}},{key:"depthToSpace",value:function(e,t,n){return i("depthToSpace")}},{key:"split",value:function(e,t,n){return i("split")}},{key:"sparseToDense",value:function(e,t,n,r){return i("sparseToDense")}},{key:"diag",value:function(e){return i("diag")}},{key:"fill",value:function(e,t,n){return i("fill")}},{key:"onesLike",value:function(e){return i("onesLike")}},{key:"zerosLike",value:function(e){return i("zerosLike")}},{key:"linspace",value:function(e,t,n){return i("linspace")}},{key:"dispose",value:function(){return i("dispose")}}]),e}();function i(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen"))}},i8k8:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({maxPoolWithArgmax_:function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=Object(i.a)(e,"x","maxPoolWithArgmax"),c=r.a.runKernel(a.Mb,{x:u},{filterSize:t,strides:n,pad:o,includeBatchInIndex:s});return{result:c[0],indexes:c[1]}}})},iIjY:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({tanh_:function(e){var t=Object(i.a)(e,"x","tanh");return r.a.runKernel(a.Sc,{x:t})}})},ie1u:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},iuCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({abs_:function(e){var t=Object(i.a)(e,"x","abs");return r.a.runKernel("complex64"===t.dtype?a.A:a.a,{x:t})}})},jLCh:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("VO80"),o=n("NclT"),s=Object(i.b)({depthwiseConv2dNativeBackpropInput_:function(e,t,n,i,s){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=t,h=!1;3===t.rank&&(h=!0,l=Object(o.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d=r.a.runKernel(a.Q,{dy:l,filter:n},{strides:i,pad:s,dimRoundingMode:c,dilations:u,inputShape:e});return h?Object(o.a)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}})},jXH2:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({tile_:function(e,t){var n=Object(i.a)(e,"x","tile","string_or_numeric");return o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," must match length of reps ").concat(t,".")})),r.a.runKernel(a.Tc,{x:n},{reps:t})}})},jgXy:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("3rNm"),u=n("VO80"),c=Object(u.b)({erf_:function(e){var t=Object(i.a)(e,"x","erf");return o.b("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Object(s.a)(t,"float32")),r.a.runKernel(a.Y,{x:t})}})},k7Jv:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("auKK"),a=n("o/e8"),i=n("VO80"),o=Object(i.b)({square_:function(e){var t=Object(a.a)(e,"x","square");return r.a.runKernel("Square",{x:t},{})}})},k9tH:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({mirrorPad_:function(e,t,n){o.b("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. Got ".concat(n,".")}));var s=Object(i.a)(e,"x","mirrorPad");if(0===s.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.b(t.length===s.rank,(function(){return"Padding doesn't match input. Must be ".concat(s.rank,". Got ").concat(t.length,".")}));for(var u="reflect"===n?1:0,c=function(e){o.b(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),o.b(t[e][0]>=0&&t[e][0]<=s.shape[e]-u&&t[e][1]>=0&&t[e][1]<=s.shape[e]-u,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal to ").concat(s.shape[e]-u," or less than 0 for input of shape ")+s.shape}))},l=0;l<s.rank;l++)c(l);return r.a.runKernel(a.Rb,{x:s},{paddings:t,mode:n})}})},kRdc:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({add_:function(e,t){var n,s=Object(o.a)(e,"a","add"),u=Object(o.a)(t,"b","add");return s=(n=_slicedToArray(Object(i.makeTypesMatch)(s,u),2))[0],u=n[1],r.a.runKernel(a.d,{a:s,b:u})}})},kXpR:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({relu_:function(e){var t=Object(i.a)(e,"x","relu");return r.a.runKernel(a.mc,{x:t})}})},kaMP:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=Object(i.a)(e,"x","gather"),u=Object(i.a)(t,"indices","gather","int32");return r.a.runKernel(a.mb,{x:s,indices:u},{axis:n,batchDims:o})}})},l0gX:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("3rNm"),u=n("uBja"),c=n("VO80"),l=n("NclT"),h=Object(c.b)({avgPool_:function(e,t,n,c,h){var d=Object(i.a)(e,"x","avgPool","float32");o.b(u.h(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '1'")}));var f=d,p=!1;3===d.rank&&(p=!0,f=Object(l.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===f.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(f.rank,".")})),null!=h&&o.b(o.v(c),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode ".concat(h," but got pad ").concat(c,".")}));var m=r.a.runKernel(a.o,{x:f},{filterSize:t,strides:n,pad:c,dimRoundingMode:h});return m=Object(s.a)(m,d.dtype),p?Object(l.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},lg8H:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("o/e8"),a=n("atXS"),i=n("WVnj");function o(e,t){Object(a.d)(e);var n=Object(r.c)(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Object(i.a)(e,null,n,t)}},mdDO:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("atXS"),o=n("VO80"),s=n("NclT"),u=Object(o.b)({conv3DBackpropInput_:function(e,t,n,o,u){i.b(e.length===t.rank,(function(){return"Length of inShape (".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var c=e,l=t,h=!1;4===t.rank&&(h=!0,l=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),c=[1,e[0],e[1],e[2],e[3]]);var d=c[4],f=l.shape[4];i.b(5===c.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+c.length+"."})),i.b(5===l.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+l.rank})),i.b(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),i.b(d===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(d,") must match input depth for filter ").concat(n.shape[3],".")})),i.b(f===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(f,") must match output depth for filter ").concat(n.shape[4],".")}));var p=r.a.runKernel(a.H,{dy:l,filter:n},{pad:u,strides:o,inputShape:c});return h?Object(s.a)(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}})},"n+ZZ":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("uBja"),u=n("VO80"),c=n("NclT"),l=Object(u.b)({maxPool_:function(e,t,n,u,l){var h=Object(i.a)(e,"x","maxPool"),d=h,f=!1;3===h.rank&&(f=!0,d=Object(c.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.b(4===d.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,".")})),o.b(s.h(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '1'")})),null!=l&&o.b(o.v(u),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var p=r.a.runKernel(a.Ib,{x:d},{filterSize:t,strides:n,pad:u,dimRoundingMode:l});return f?Object(c.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},"n/2y":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({softplus_:function(e){var t=Object(i.a)(e,"x","softplus");return r.a.runKernel(a.Gc,{x:t})}})},njhW:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({elu_:function(e){var t=Object(i.a)(e,"x","elu");return r.a.runKernel(a.V,{x:t})}})},"o/e8":function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return h}));var r=n("auKK"),a=n("szMd"),i=n("NNfn"),o=n("atXS"),s=n("6366");function u(e,t){var n=e;if(Object(o.A)(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Object(o.A)(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&Object(a.c)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||Object(o.A)(t)){Object(o.b)(n.length>0,(function(){return"Element arr[".concat(r.join("]["),"] should be a primitive, but is an array of ").concat(t.length," elements")})),Object(o.b)(t.length===n[0],(function(){return"Element arr[".concat(r.join("]["),"] should have ").concat(n[0]," elements, but has ").concat(t.length," elements")}));for(var a=n.slice(1),i=0;i<t.length;++i)e(t[i],a,r.concat(i))}else Object(o.b)(0===n.length,(function(){return"Element arr[".concat(r.join("]["),"] is a primitive, but should be an array/TypedArray of ").concat(n[0]," elements")}))}(e,r,[]),r}function c(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must be ").concat(e," tensor, but got ").concat(t," tensor"))}}function l(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof i.a)return c(a,e.dtype,t,n),e;var l=Object(o.r)(e);if("string"!==l&&["bool","int32","float32"].indexOf(a)>=0&&(l=a),c(a,l,t,n),null==e||!Object(o.A)(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a Tensor or TensorLike, but got '").concat(null==e?"null":e.constructor.name,"'"));var h=u(e,l);Object(o.A)(e)||Array.isArray(e)||(e=[e]);var d="string"!==l?Object(s.toTypedArray)(e,l):Object(o.m)(e,[],!0);return r.a.makeTensor(d,h,l)}function h(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a `Tensor[]` or `TensorLike[]`"));return e.map((function(e,a){return l(e,"".concat(t,"[").concat(a,"]"),n,r)}))}},"o0+U":function(e,t,n){"use strict";n.r(t),n.d(t,"validateUpdateShape",(function(){return a})),n.d(t,"validateInput",(function(){return i})),n.d(t,"calculateShapes",(function(){return o}));var r=n("atXS");function a(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != "+(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}function i(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}a(n,t,e)}function o(e,t,n){for(var a=t.shape.length,i=a>1?t.shape[a-1]:1,o=n.length,s=1,u=i;u<o;++u)s*=n[u];var c=i<1?1:i;return{sliceRank:i,numUpdates:Object(r.N)(t.shape)/c,sliceSize:s,strides:[].concat(_toConsumableArray(Object(r.j)(n.slice(0,i))),[1]),outputSize:Object(r.N)(n)}}},o3Rt:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({acos_:function(e){var t=Object(i.a)(e,"x","acos");return r.a.runKernel(a.b,{x:t})}})},oAkI:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({sub_:function(e,t){var n,s=Object(o.a)(e,"a","sub"),u=Object(o.a)(t,"b","sub");return s=(n=_slicedToArray(Object(i.makeTypesMatch)(s,u),2))[0],u=n[1],r.a.runKernel(a.Pc,{a:s,b:u})}})},"oJu+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({zerosLike_:function(e){var t=Object(i.a)(e,"x","zerosLike");return r.a.runKernel(a.Zc,{x:t})}})},p4Cv:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("AoCb"),a=n("o/e8"),i=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(a.a)(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return i=e.sent,o=Object(r.a)(n.shape,i),e.abrupt("return",(t!==n&&n.dispose(),o));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},"pJ3+":function(e,t,n){var r;!function(a,i){var o,s=this,u=i.pow(256,6),c=i.pow(2,52),l=2*c;function h(e,t,n){var r=[],h=p(function e(t,n){var r,a=[],i=typeof t;if(n&&"object"==i)for(r in t)try{a.push(e(t[r],n-1))}catch(o){}return a.length?a:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,m(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(256):(e=new Uint8Array(256),(s.crypto||s.msCrypto).getRandomValues(e)),m(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,m(a)]}}():e,3),r),v=new d(r),g=function(){for(var e=v.g(6),t=u,n=0;e<c;)e=256*(e+n),t*=256,n=v.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return g.int32=function(){return 0|v.g(4)},g.quick=function(){return v.g(4)/4294967296},g.double=g,p(m(v.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&f(r,v),e.state=function(){return f(v,{})}),n?(i.random=e,t):e})(g,h,"global"in t?t.global:this==i,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<256;)o[a]=a++;for(a=0;a<256;a++)o[a]=o[i=255&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=255&a+1],n=256*n+o[255&(o[a]=o[i=255&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(256)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){for(var n,r=e+"",a=0;a<r.length;)t[255&a]=255&(n^=19*t[255&a])+r.charCodeAt(a++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=h,p(i.random(),a),e.exports){e.exports=h;try{o=n(3)}catch(v){}}else void 0===(r=(function(){return h}).call(t,n,t,e))||(e.exports=r)}([],Math)},pJ6O:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},parS:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({mul_:function(e,t){var n,s=Object(o.a)(e,"a","mul"),u=Object(o.a)(t,"b","mul");return s=(n=_slicedToArray(Object(i.makeTypesMatch)(s,u),2))[0],u=n[1],r.a.runKernel(a.Ub,{a:s,b:u})}})},r9q9:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("o/e8"),a=n("atXS"),i=n("kRdc"),o=n("NuWS"),s=n("TyAZ"),u=n("E1lT"),c=n("wCH+"),l=n("VO80"),h=n("NclT"),d=n("oAkI"),f=n("4FMF"),p=Object(l.b)({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=Object(r.a)(e,"x","logSumExp"),p=Object(a.I)(t,l.shape),m=Object(c.a)(l,p,!0),v=Object(d.a)(l,m),g=Object(s.a)(v),y=Object(f.a)(g,p),b=Object(u.a)(y),k=Object(i.a)(Object(h.a)(m,b.shape),b);if(n){var _=Object(o.e)(k.shape,p);return Object(h.a)(k,_)}return k}})},rm0a:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","min");return r.a.runKernel(a.Pb,{x:o},{axis:t,keepDims:n})}})},s57M:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({selu_:function(e){var t=Object(i.a)(e,"x","selu");return r.a.runKernel(a.zc,{x:t})}})},shz4:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("VO80"),c=Object(u.b)({lessEqual_:function(e,t){var n,u=Object(o.a)(e,"a","lessEqual"),c=Object(o.a)(t,"b","lessEqual");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],Object(s.a)(u.shape,c.shape),r.a.runKernel(a.zb,{a:u,b:c})}})},szMd:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s}));var r=n("atXS"),a=function(){function e(t){_classCallCheck(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}var t;return _createClass(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. Overwriting the platform with ").concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t in this.flags,e.t0){e.next=5;break}return e.next=4,this.evaluateFlag(t);case 4:this.flags[t]=e.sent;case 5:return e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Object(r.x)(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. Please use getAsync() instead."));return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(n,r[0],r[1]),r.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=_slicedToArray(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(r,a)}))}}}]),e}();function i(){return o}var o=null;function s(e){o=e}},tQDl:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({reciprocal_:function(e){var t=Object(i.a)(e,"x","reciprocal");return r.a.runKernel(a.lc,{x:t})}})},th0q:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("atXS"),a=n("B3db"),i=n("ZJ6U"),o=n("JLAb"),s=n("VO80"),u=n("17CO"),c=n("NclT"),l=n("bTzI"),h=n("RbuM"),d=n("Wiw4"),f=n("oJu+"),p=n("Grcp"),m=Object(s.b)({rfft_:function(e,t){Object(r.b)("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got "+e.dtype}));var n,s=e.shape[e.shape.length-1],m=e.size/s;if(null!=t&&t<s){var v=e.shape.map((function(e){return 0})),g=e.shape.map((function(e){return e}));g[e.shape.length-1]=t,n=Object(l.a)(e,v,g),s=t}else if(null!=t&&t>s){var y=e.shape.map((function(e){return e}));y[e.shape.length-1]=t-s,n=Object(i.a)([e,Object(d.a)(y)],e.shape.length-1),s=t}else n=e;var b=Object(f.a)(n),k=Object(c.a)(Object(a.a)(n,b),[m,s]),_=Object(p.a)(k),w=Math.floor(s/2)+1,x=Object(u.a)(_),C=Object(o.a)(_),O=Object(h.a)(x,[w,s-w],x.shape.length-1),S=Object(h.a)(C,[w,s-w],C.shape.length-1),T=n.shape.slice();return T[n.shape.length-1]=w,Object(c.a)(Object(a.a)(O[0],S[0]),T)}})},uBja:function(e,t,n){"use strict";function r(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0;return o(e,[].concat(_toConsumableArray(t),[e[3]]),n,i,r,null,null,m(a))}function a(e,t,n,r,a,i){var s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=c(t),h=_slicedToArray(l,2),d=h[0],f=h[1];if("channelsLast"===u)s=[d,f,e[3],e[3]];else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat "+u);s=[d,f,e[1],e[1]]}return o(e,s,n,r,a,i,!1,u)}function i(e,t,n,r,a,i){var o,u,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",h=l(t),d=_slicedToArray(h,3),f=d[0],p=d[1],m=d[2];if("NDHWC"===c)u="channelsLast",o=[f,p,m,e[4],e[4]];else{if("NCDHW"!==c)throw new Error("Unknown dataFormat "+c);u="channelsFirst",o=[f,p,m,e[1],e[1]]}return s(e,o,n,r,a,!1,u,i)}function o(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",l=-1,f=-1,p=-1,m=-1;if("channelsLast"===s){var v=_slicedToArray(e,4);l=v[0],f=v[1],p=v[2],m=v[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);var g=_slicedToArray(e,4);l=g[0],m=g[1],f=g[2],p=g[3]}var y,b=_slicedToArray(t,4),k=b[0],_=b[1],w=b[3],x=c(n),C=_slicedToArray(x,2),O=C[0],S=C[1],T=c(r),I=_slicedToArray(T,2),E=I[0],N=I[1],A=h(k,E),R=h(_,N),D=function(e,t,n,r,a,i,o,s,c){var l,h,f;if("number"==typeof e){l={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var p=function(e,t,n,r,a){null==r&&(r=u(e,t,n));var i=e[1];return[d((e[0]-t+2*r)/n+1,a),d((i-t+2*r)/n+1,a)]}([t,n],i,r,e,s);h=p[0],f=p[1]}else if("same"===e){h=Math.ceil(t/r),f=Math.ceil(n/a);var m=Math.max(0,(h-1)*r+i-t),v=Math.max(0,(f-1)*a+o-n),g=Math.floor(m/2),y=m-g,b=Math.floor(v/2);l={top:g,bottom:y,left:b,right:v-b,type:"SAME"}}else if("valid"===e)l={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((t-i+1)/r),f=Math.ceil((n-o+1)/a);else{if("object"!=typeof e)throw Error("Unknown padding parameter: "+e);var k="channelsLast"===c?e[1][0]:e[2][0],_="channelsLast"===c?e[1][1]:e[2][1],w="channelsLast"===c?e[2][0]:e[3][0],x="channelsLast"===c?e[2][1]:e[3][1];l={top:k,bottom:_,left:w,right:x,type:0===k&&0===_&&0===w&&0===x?"VALID":"EXPLICIT"},h=d((t-i+k+_)/r+1,s),f=d((n-o+w+x)/a+1,s)}return{padInfo:l,outHeight:h,outWidth:f}}(a,f,p,O,S,A,R,i,s),j=D.padInfo,F=D.outHeight,M=D.outWidth,P=o?w*m:w;return"channelsFirst"===s?y=[l,P,F,M]:"channelsLast"===s&&(y=[l,F,M,P]),{batchSize:l,dataFormat:s,inHeight:f,inWidth:p,inChannels:m,outHeight:F,outWidth:M,outChannels:P,padInfo:j,strideHeight:O,strideWidth:S,filterHeight:k,filterWidth:_,effectiveFilterHeight:A,effectiveFilterWidth:R,dilationHeight:E,dilationWidth:N,inShape:e,outShape:y,filterShape:t}}function s(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,c=-1,f=-1,p=-1,m=-1,v=-1;if("channelsLast"===o){var g=_slicedToArray(e,5);c=g[0],f=g[1],p=g[2],m=g[3],v=g[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);var y=_slicedToArray(e,5);c=y[0],v=y[1],f=y[2],p=y[3],m=y[4]}var b,k=_slicedToArray(t,5),_=k[0],w=k[1],x=k[2],C=k[4],O=l(n),S=_slicedToArray(O,3),T=S[0],I=S[1],E=S[2],N=l(r),A=_slicedToArray(N,3),R=A[0],D=A[1],j=A[2],F=h(_,R),M=h(w,D),P=h(x,j),L=function(e,t,n,r,a,i,o,s,c,l,h){var f,p,m,v;if("number"==typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var g=function(e,t,n,r,a,i){null==a&&(a=u(e,t,r));var o=e[1],s=e[2];return[d((e[0]-t+2*a)/r+1,i),d((o-t+2*a)/r+1,i),d((s-t+2*a)/r+1,i),1]}([t,n,r,1],s,0,a,e,h);p=g[0],m=g[1],v=g[2]}else if("same"===e){var y=((p=Math.ceil(t/a))-1)*a+s-t,b=((m=Math.ceil(n/i))-1)*i+c-n,k=((v=Math.ceil(r/o))-1)*o+l-r,_=Math.floor(y/2),w=y-_,x=Math.floor(b/2),C=b-x,O=Math.floor(k/2);f={top:x,bottom:C,left:O,right:k-O,front:_,back:w,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((t-s+1)/a),m=Math.ceil((n-c+1)/i),v=Math.ceil((r-l+1)/o)}return{padInfo:f,outDepth:p,outHeight:m,outWidth:v}}(a,f,p,m,T,I,E,F,M,P,s),z=L.padInfo,B=L.outDepth,V=L.outHeight,W=L.outWidth,U=i?C*v:C;return"channelsFirst"===o?b=[c,U,B,V,W]:"channelsLast"===o&&(b=[c,B,V,W,U]),{batchSize:c,dataFormat:o,inDepth:f,inHeight:p,inWidth:m,inChannels:v,outDepth:B,outHeight:V,outWidth:W,outChannels:U,padInfo:z,strideDepth:T,strideHeight:I,strideWidth:E,filterDepth:_,filterHeight:w,filterWidth:x,effectiveFilterDepth:F,effectiveFilterHeight:M,effectiveFilterWidth:P,dilationDepth:R,dilationHeight:D,dilationWidth:j,inShape:e,outShape:b,filterShape:t}}function u(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=h(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function c(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function l(e){return"number"==typeof e?[e,e,e]:e}function h(e,t){return t<=1?e:e+(e-1)*(t-1)}function d(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function f(e){var t=_slicedToArray(c(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function p(e,t){return f(e)||f(t)}function m(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"i",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return m}))},uDiL:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},ubnP:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("VO80"),c=Object(u.b)({equal_:function(e,t){var n,u=Object(o.a)(e,"a","equal"),c=Object(o.a)(t,"b","equal");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],Object(s.a)(u.shape,c.shape),r.a.runKernel(a.X,{a:u,b:c})}})},ukBL:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({gatherND_:function(e,t){var n=Object(i.a)(t,"indices","gatherND","int32"),o=Object(i.a)(e,"x","gatherND");return r.a.runKernel(a.lb,{params:o,indices:n})}})},ulO0:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("auKK"),a=n("wE5H"),i=n("wFtI"),o=n("o/e8"),s=n("atXS"),u=n("3rNm"),c=n("uBja"),l=n("VO80"),h=n("NclT"),d=Object(l.b)({avgPool3d_:function(e,t,n,l,d){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",p=arguments.length>6?arguments[6]:void 0;null==p?p=[1,1,1]:Object(a.b)("dilations is deprecated, this field will be gone in v3.0.0.");var m=Object(o.a)(e,"x","avgPool3d","float32"),v=m,g=!1;4===m.rank&&(g=!0,v=Object(h.a)(m,[1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]])),s.b(5===v.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(v.rank,".")})),s.b("NDHWC"===f,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+f})),s.b(c.h(n,p),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides ".concat(n," and dilations '").concat(p,"'")})),null!=d&&s.b(s.v(l),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode ".concat(d," but got pad ").concat(l,".")}));var y=r.a.runKernel(i.p,{x:v},{filterSize:t,strides:n,pad:l,dimRoundingMode:d,dataFormat:f,dilations:p});return y=Object(u.a)(y,v.dtype),g?Object(h.a)(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}})},uy0A:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("VO80"),c=Object(u.b)({greaterEqual_:function(e,t){var n,u=Object(o.a)(e,"a","greaterEqual"),c=Object(o.a)(t,"b","greaterEqual");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],Object(s.a)(u.shape,c.shape),r.a.runKernel(a.ob,{a:u,b:c})}})},vGLV:function(e,t,n){"use strict";var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80");n.d(t,"a",(function(){return s}));var s=Object(o.b)({sparseToDense_:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=Object(i.a)(e,"sparseIndices","sparseToDense","int32"),u=Object(i.a)(t,"sparseValues","sparseToDense"),c=Object(i.a)(o,"defaultValue","sparseToDense",u.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, ".concat(n.length,", should be: ").concat(i,"."));if(0!==t.rank&&(1!==t.rank||t.size!==a))throw new Error("sparseValues has incorrect shape ".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(s,u,n,c),r.a.runKernel(a.Ic,{sparseIndices:s,sparseValues:u,defaultValue:c},{outputShape:n})}})},"wCH+":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","max");return r.a.runKernel(a.Hb,{x:o},{reductionIndices:t,keepDims:n})}})},wE5H:function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return h})),n.d(t,"h",(function(){return d})),n.d(t,"m",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"t",(function(){return m})),n.d(t,"d",(function(){return v})),n.d(t,"l",(function(){return g})),n.d(t,"u",(function(){return y})),n.d(t,"r",(function(){return b})),n.d(t,"o",(function(){return k})),n.d(t,"k",(function(){return _})),n.d(t,"q",(function(){return w})),n.d(t,"i",(function(){return x})),n.d(t,"j",(function(){return C})),n.d(t,"p",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"s",(function(){return T}));var r=n("auKK"),a=n("szMd"),i=n("NNfn"),o=n("dsKV");function s(){Object(a.c)().set("PROD",!0)}function u(){Object(a.c)().set("DEBUG",!0)}function c(){Object(a.c)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(e){Object(a.c)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function h(){r.a.disposeVariables()}function d(){return r.a}function f(){return r.a.memory()}function p(e){return r.a.profile(e)}function m(e,t){return r.a.tidy(e,t)}function v(e){Object(o.getTensorsInContainer)(e).forEach((function(e){return e.dispose()}))}function g(e){return r.a.keep(e)}function y(e){return r.a.time(e)}function b(e){return r.a.setBackend(e)}function k(){return r.a.ready()}function _(){return r.a.backendName}function w(e){r.a.removeBackend(e)}function x(e){return r.a.findBackend(e)}function C(e){return r.a.findBackendFactory(e)}function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.a.registerBackend(e,t,n)}function S(){return r.a.backend}function T(e,t){Object(a.c)().setPlatform(e,t)}Object(i.d)(l)},wFtI:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"m",(function(){return v})),n.d(t,"o",(function(){return g})),n.d(t,"r",(function(){return y})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return k})),n.d(t,"s",(function(){return _})),n.d(t,"t",(function(){return w})),n.d(t,"u",(function(){return x})),n.d(t,"v",(function(){return C})),n.d(t,"w",(function(){return O})),n.d(t,"x",(function(){return S})),n.d(t,"y",(function(){return T})),n.d(t,"z",(function(){return I})),n.d(t,"A",(function(){return E})),n.d(t,"B",(function(){return N})),n.d(t,"C",(function(){return A})),n.d(t,"D",(function(){return R})),n.d(t,"E",(function(){return D})),n.d(t,"F",(function(){return j})),n.d(t,"G",(function(){return F})),n.d(t,"H",(function(){return M})),n.d(t,"I",(function(){return P})),n.d(t,"J",(function(){return L})),n.d(t,"L",(function(){return z})),n.d(t,"K",(function(){return B})),n.d(t,"M",(function(){return V})),n.d(t,"N",(function(){return W})),n.d(t,"O",(function(){return U})),n.d(t,"P",(function(){return H})),n.d(t,"Q",(function(){return G})),n.d(t,"R",(function(){return K})),n.d(t,"S",(function(){return q})),n.d(t,"U",(function(){return X})),n.d(t,"T",(function(){return Z})),n.d(t,"kc",(function(){return Y})),n.d(t,"V",(function(){return Q})),n.d(t,"W",(function(){return J})),n.d(t,"Y",(function(){return $})),n.d(t,"X",(function(){return ee})),n.d(t,"Z",(function(){return te})),n.d(t,"ab",(function(){return ne})),n.d(t,"bb",(function(){return re})),n.d(t,"cb",(function(){return ae})),n.d(t,"db",(function(){return ie})),n.d(t,"eb",(function(){return oe})),n.d(t,"fb",(function(){return se})),n.d(t,"gb",(function(){return ue})),n.d(t,"ib",(function(){return ce})),n.d(t,"mb",(function(){return le})),n.d(t,"lb",(function(){return he})),n.d(t,"nb",(function(){return de})),n.d(t,"ob",(function(){return fe})),n.d(t,"qb",(function(){return pe})),n.d(t,"pb",(function(){return me})),n.d(t,"rb",(function(){return ve})),n.d(t,"sb",(function(){return ge})),n.d(t,"tb",(function(){return ye})),n.d(t,"ub",(function(){return be})),n.d(t,"xb",(function(){return ke})),n.d(t,"yb",(function(){return _e})),n.d(t,"zb",(function(){return we})),n.d(t,"Ab",(function(){return xe})),n.d(t,"Bb",(function(){return Ce})),n.d(t,"Cb",(function(){return Oe})),n.d(t,"Eb",(function(){return Se})),n.d(t,"Fb",(function(){return Te})),n.d(t,"Gb",(function(){return Ie})),n.d(t,"Db",(function(){return Ee})),n.d(t,"vb",(function(){return Ne})),n.d(t,"wb",(function(){return Ae})),n.d(t,"Hb",(function(){return Re})),n.d(t,"Nb",(function(){return De})),n.d(t,"Ib",(function(){return je})),n.d(t,"Lb",(function(){return Fe})),n.d(t,"Jb",(function(){return Me})),n.d(t,"Kb",(function(){return Pe})),n.d(t,"Mb",(function(){return Le})),n.d(t,"Ob",(function(){return ze})),n.d(t,"Pb",(function(){return Be})),n.d(t,"Qb",(function(){return Ve})),n.d(t,"Rb",(function(){return We})),n.d(t,"Sb",(function(){return Ue})),n.d(t,"Tb",(function(){return He})),n.d(t,"Ub",(function(){return Ge})),n.d(t,"Vb",(function(){return Ke})),n.d(t,"Zb",(function(){return qe})),n.d(t,"Wb",(function(){return Xe})),n.d(t,"Xb",(function(){return Ze})),n.d(t,"Yb",(function(){return Ye})),n.d(t,"bc",(function(){return Qe})),n.d(t,"ac",(function(){return Je})),n.d(t,"cc",(function(){return $e})),n.d(t,"dc",(function(){return et})),n.d(t,"ec",(function(){return tt})),n.d(t,"fc",(function(){return nt})),n.d(t,"gc",(function(){return rt})),n.d(t,"hc",(function(){return at})),n.d(t,"ic",(function(){return it})),n.d(t,"jc",(function(){return ot})),n.d(t,"lc",(function(){return st})),n.d(t,"mc",(function(){return ut})),n.d(t,"oc",(function(){return ct})),n.d(t,"rc",(function(){return lt})),n.d(t,"sc",(function(){return ht})),n.d(t,"pc",(function(){return dt})),n.d(t,"qc",(function(){return ft})),n.d(t,"nc",(function(){return pt})),n.d(t,"tc",(function(){return mt})),n.d(t,"vc",(function(){return vt})),n.d(t,"wc",(function(){return gt})),n.d(t,"xc",(function(){return yt})),n.d(t,"yc",(function(){return bt})),n.d(t,"zc",(function(){return kt})),n.d(t,"Ec",(function(){return _t})),n.d(t,"Cc",(function(){return wt})),n.d(t,"Dc",(function(){return xt})),n.d(t,"Bc",(function(){return Ct})),n.d(t,"Ac",(function(){return Ot})),n.d(t,"Gc",(function(){return St})),n.d(t,"Kc",(function(){return Tt})),n.d(t,"Qc",(function(){return It})),n.d(t,"Hc",(function(){return Et})),n.d(t,"Jc",(function(){return Nt})),n.d(t,"Fc",(function(){return At})),n.d(t,"Mc",(function(){return Rt})),n.d(t,"Lc",(function(){return Dt})),n.d(t,"Pc",(function(){return jt})),n.d(t,"Ic",(function(){return Ft})),n.d(t,"Oc",(function(){return Mt})),n.d(t,"Rc",(function(){return Pt})),n.d(t,"Sc",(function(){return Lt})),n.d(t,"Tc",(function(){return zt})),n.d(t,"Uc",(function(){return Bt})),n.d(t,"Vc",(function(){return Vt})),n.d(t,"Wc",(function(){return Wt})),n.d(t,"Xc",(function(){return Ut})),n.d(t,"Yc",(function(){return Ht})),n.d(t,"Zc",(function(){return Gt})),n.d(t,"Nc",(function(){return Kt})),n.d(t,"hb",(function(){return qt})),n.d(t,"uc",(function(){return Xt})),n.d(t,"ad",(function(){return Zt})),n.d(t,"jb",(function(){return Yt})),n.d(t,"kb",(function(){return Qt}));var r="Abs",a="Acos",i="Acosh",o="Add",s="AddN",u="All",c="Any",l="ArgMax",h="ArgMin",d="Asin",f="Asinh",p="Atan",m="Atanh",v="Atan2",g="AvgPool",y="AvgPoolGrad",b="AvgPool3D",k="AvgPool3DGrad",_="BatchMatMul",w="BatchToSpaceND",x="Bincount",C="BroadcastTo",O="Cast",S="Ceil",T="ClipByValue",I="Complex",E="ComplexAbs",N="Concat",A="Conv2D",R="Conv2DBackpropFilter",D="Conv2DBackpropInput",j="Conv3D",F="Conv3DBackpropFilterV2",M="Conv3DBackpropInputV2",P="Cos",L="Cosh",z="Cumsum",B="CropAndResize",V="DenseBincount",W="DepthToSpace",U="DepthwiseConv2dNative",H="DepthwiseConv2dNativeBackpropFilter",G="DepthwiseConv2dNativeBackpropInput",K="Diag",q="Dilation2D",X="Dilation2DBackpropInput",Z="Dilation2DBackpropFilter",Y="RealDiv",Q="Elu",J="EluGrad",$="Erf",ee="Equal",te="Exp",ne="ExpandDims",re="Expm1",ae="FFT",ie="Fill",oe="FlipLeftRight",se="Floor",ue="FloorDiv",ce="FusedBatchNorm",le="GatherV2",he="GatherNd",de="Greater",fe="GreaterEqual",pe="Identity",me="IFFT",ve="Imag",ge="IsFinite",ye="IsInf",be="IsNan",ke="LeakyRelu",_e="Less",we="LessEqual",xe="LinSpace",Ce="Log",Oe="Log1p",Se="LogicalAnd",Te="LogicalNot",Ie="LogicalOr",Ee="LogSoftmax",Ne="LRN",Ae="LRNGrad",Re="Max",De="Maximum",je="MaxPool",Fe="MaxPoolGrad",Me="MaxPool3D",Pe="MaxPool3DGrad",Le="MaxPoolWithArgmax",ze="Mean",Be="Min",Ve="Minimum",We="MirrorPad",Ue="Mod",He="Multinomial",Ge="Multiply",Ke="Neg",qe="NotEqual",Xe="NonMaxSuppressionV3",Ze="NonMaxSuppressionV4",Ye="NonMaxSuppressionV5",Qe="OnesLike",Je="OneHot",$e="Pack",et="PadV2",tt="Pool",nt="Pow",rt="Prelu",at="Prod",it="Range",ot="Real",st="Reciprocal",ut="Relu",ct="Reshape",lt="ResizeNearestNeighbor",ht="ResizeNearestNeighborGrad",dt="ResizeBilinear",ft="ResizeBilinearGrad",pt="Relu6",mt="Reverse",vt="Round",gt="Rsqrt",yt="ScatterNd",bt="Select",kt="Selu",_t="Slice",wt="Sin",xt="Sinh",Ct="Sign",Ot="Sigmoid",St="Softplus",Tt="Sqrt",It="Sum",Et="SpaceToBatchND",Nt="SplitV",At="Softmax",Rt="SquaredDifference",Dt="Square",jt="Sub",Ft="SparseToDense",Mt="StridedSlice",Pt="Tan",Lt="Tanh",zt="Tile",Bt="TopK",Vt="Transpose",Wt="Unique",Ut="Unpack",Ht="UnsortedSegmentSum",Gt="ZerosLike",Kt="Step",qt="FromPixels",Xt="RotateWithOffset",Zt="_FusedMatMul",Yt="FusedConv2D",Qt="FusedDepthwiseConv2D"},"wI/y":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({clipByValue_:function(e,t,n){var s=Object(i.a)(e,"x","clipByValue");return o.b(t<=n,(function(){return"Error in clip: min (".concat(t,") must be less than or equal to max (").concat(n,").")})),r.a.runKernel(a.y,{x:s},{clipValueMin:t,clipValueMax:n})}})},wXC5:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=n("NclT"),c=Object(s.b)({dilation2d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",h=Object(i.a)(e,"x","dilation2d"),d=Object(i.a)(t,"filter","dilation2d");o.b(3===h.rank||4===h.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+h.rank+"."})),o.b(3===d.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+d.rank+"."})),o.b("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of "+l}));var f=h,p=!1;3===h.rank&&(f=Object(u.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),p=!0);var m=r.a.runKernel(a.S,{x:f,filter:d},{strides:n,pad:s,dilations:c});return p?Object(u.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},waK1:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("VO80"),s=Object(o.b)({cosh_:function(e){var t=Object(i.a)(e,"x","cosh");return r.a.runKernel(a.J,{x:t})}})},wion:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("auKK"),a=n("atXS"),i=n("B3db"),o=n("Wiw4");function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=s(e,"float32"),u=Object(o.a)(e,"float32");return Object(i.a)(n,u)}var c=Object(a.D)(Object(a.N)(e),t);return r.a.makeTensor(c,e,t)}},wxQM:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("U45G"),a=n("o/e8"),i=n("parS"),o=n("O7f5"),s=n("VO80"),u=n("/7N0"),c=n("n/2y"),l=Object(s.b)({logSigmoid_:function(e){var t=Object(a.a)(e,"x","logSigmoid");return Object(r.a)((function(e){return{value:Object(o.a)(Object(c.a)(Object(o.a)(e))),gradFunc:function(t){return Object(i.a)(t,Object(u.a)(Object(o.a)(e)))}}}))(t)}})},x3y4:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("UI8N"),u=n("VO80"),c=Object(u.b)({div_:function(e,t){var n,u=Object(o.a)(e,"a","div"),c=Object(o.a)(t,"b","div");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],"int32"===u.dtype&&"int32"===c.dtype?Object(s.a)(u,c):r.a.runKernel(a.kc,{a:u,b:c},{})}})},yLV6:function(e,t,n){var r;!function(a,i,o,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=i.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,n){return setTimeout(_(e,n),t)}function m(e,t,n){return!!Array.isArray(e)&&(v(e,n[t],n),!0)}function v(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(void 0!==e.length)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function g(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=a.console&&(a.console.warn||a.console.log);return i&&i.call(a.console,r,n),e.apply(this,arguments)}}u="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var a in r)r.hasOwnProperty(a)&&(t[a]=r[a])}return t}:Object.assign;var y=g((function(e,t,n){for(var r=Object.keys(t),a=0;a<r.length;)(!n||n&&void 0===e[r[a]])&&(e[r[a]]=t[r[a]]),a++;return e}),"extend","Use `assign`."),b=g((function(e,t){return y(e,t,!0)}),"merge","Use `assign`.");function k(e,t,n){var r,a=t.prototype;(r=e.prototype=Object.create(a)).constructor=e,r._super=a,n&&u(r,n)}function _(e,t){return function(){return e.apply(t,arguments)}}function w(e,t){return"function"==typeof e?e.apply(t&&t[0]||void 0,t):e}function x(e,t){return void 0===e?t:e}function C(e,t,n){v(I(t),(function(t){e.addEventListener(t,n,!1)}))}function O(e,t,n){v(I(t),(function(t){e.removeEventListener(t,n,!1)}))}function S(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function I(e){return e.trim().split(/\s+/g)}function E(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function N(e){return Array.prototype.slice.call(e,0)}function A(e,t,n){for(var r=[],a=[],i=0;i<e.length;){var o=t?e[i][t]:e[i];E(a,o)<0&&r.push(e[i]),a[i]=o,i++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function R(e,t){for(var n,r,a=t[0].toUpperCase()+t.slice(1),i=0;i<c.length;){if((r=(n=c[i])?n+a:t)in e)return r;i++}}var D=1;function j(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||a}var F="ontouchstart"in a,M=void 0!==R(a,"PointerEvent"),P=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),L=["x","y"],z=["clientX","clientY"];function B(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&n.handler(t)},this.init()}function V(e,t,n){var r=n.pointers.length,a=n.changedPointers.length,i=1&t&&r-a==0,o=12&t&&r-a==0;n.isFirst=!!i,n.isFinal=!!o,i&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,r=t.pointers,a=r.length;n.firstInput||(n.firstInput=W(t)),a>1&&!n.firstMultiple?n.firstMultiple=W(t):1===a&&(n.firstMultiple=!1);var i=n.firstInput,o=n.firstMultiple,s=o?o.center:i.center,u=t.center=U(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-i.timeStamp,t.angle=q(s,u),t.distance=K(s,u),function(e,t){var n=t.center,r=e.offsetDelta||{},a=e.prevDelta||{},i=e.prevInput||{};1!==t.eventType&&4!==i.eventType||(a=e.prevDelta={x:i.deltaX||0,y:i.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=a.x+(n.x-r.x),t.deltaY=a.y+(n.y-r.y)}(n,t),t.offsetDirection=G(t.deltaX,t.deltaY);var c,l,h=H(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=d(h.x)>d(h.y)?h.x:h.y,t.scale=o?(c=o.pointers,K((l=r)[0],l[1],z)/K(c[0],c[1],z)):1,t.rotation=o?function(e,t){return q(t[1],t[0],z)+q(e[1],e[0],z)}(o.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,a,i,o=e.lastInterval||t,s=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(s>25||void 0===o.velocity)){var u=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,l=H(s,u,c);r=l.x,a=l.y,n=d(l.x)>d(l.y)?l.x:l.y,i=G(u,c),e.lastInterval=t}else n=o.velocity,r=o.velocityX,a=o.velocityY,i=o.direction;t.velocity=n,t.velocityX=r,t.velocityY=a,t.direction=i}(n,t);var p=e.element;S(t.srcEvent.target,p)&&(p=t.srcEvent.target),t.target=p}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function W(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:U(t),deltaX:e.deltaX,deltaY:e.deltaY}}function U(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,r=0,a=0;a<t;)n+=e[a].clientX,r+=e[a].clientY,a++;return{x:h(n/t),y:h(r/t)}}function H(e,t,n){return{x:t/e||0,y:n/e||0}}function G(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function K(e,t,n){n||(n=L);var r=t[n[0]]-e[n[0]],a=t[n[1]]-e[n[1]];return Math.sqrt(r*r+a*a)}function q(e,t,n){return n||(n=L),180*Math.atan2(t[n[1]]-e[n[1]],t[n[0]]-e[n[0]])/Math.PI}B.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(j(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(j(this.element),this.evWin,this.domHandler)}};var X={mousedown:1,mousemove:2,mouseup:4};function Z(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,B.apply(this,arguments)}k(Z,B,{handler:function(e){var t=X[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var Y={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Q={2:"touch",3:"pen",4:"mouse",5:"kinect"},J="pointerdown",$="pointermove pointerup pointercancel";function ee(){this.evEl=J,this.evWin=$,B.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}a.MSPointerEvent&&!a.PointerEvent&&(J="MSPointerDown",$="MSPointerMove MSPointerUp MSPointerCancel"),k(ee,B,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),a=Y[r],i=Q[e.pointerType]||e.pointerType,o="touch"==i,s=E(t,e.pointerId,"pointerId");1&a&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):12&a&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,a,{pointers:t,changedPointers:[e],pointerType:i,srcEvent:e}),n&&t.splice(s,1))}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ne(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,B.apply(this,arguments)}function re(e,t){var n=N(e.touches),r=N(e.changedTouches);return 12&t&&(n=A(n.concat(r),"identifier",!0)),[n,r]}k(ne,B,{handler:function(e){var t=te[e.type];if(1===t&&(this.started=!0),this.started){var n=re.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var ae={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ie(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},B.apply(this,arguments)}function oe(e,t){var n=N(e.touches),r=this.targetIds;if(3&t&&1===n.length)return r[n[0].identifier]=!0,[n,n];var a,i,o=N(e.changedTouches),s=[],u=this.target;if(i=n.filter((function(e){return S(e.target,u)})),1===t)for(a=0;a<i.length;)r[i[a].identifier]=!0,a++;for(a=0;a<o.length;)r[o[a].identifier]&&s.push(o[a]),12&t&&delete r[o[a].identifier],a++;return s.length?[A(i.concat(s),"identifier",!0),s]:void 0}function se(){B.apply(this,arguments);var e=_(this.handler,this);this.touch=new ie(this.manager,e),this.mouse=new Z(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ue(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ce.call(this,t)):12&e&&ce.call(this,t)}function ce(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)}),2500)}}function le(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var a=this.lastTouches[r],i=Math.abs(t-a.x),o=Math.abs(n-a.y);if(i<=25&&o<=25)return!0}return!1}k(ie,B,{handler:function(e){var t=ae[e.type],n=oe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}),k(se,B,{handler:function(e,t,n){var r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if("touch"==n.pointerType)ue.call(this,t,n);else if(r&&le.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var he=R(l.style,"touchAction"),de=void 0!==he,fe=function(){if(!de)return!1;var e={},t=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||a.CSS.supports("touch-action",n)})),e}();function pe(e,t){this.manager=e,this.set(t)}function me(e){this.options=u({},this.defaults,e||{}),this.id=D++,this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ve(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ge(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function ye(e,t){var n=t.manager;return n?n.get(e):e}function be(){me.apply(this,arguments)}function ke(){be.apply(this,arguments),this.pX=null,this.pY=null}function _e(){be.apply(this,arguments)}function we(){me.apply(this,arguments),this._timer=null,this._input=null}function xe(){be.apply(this,arguments)}function Ce(){be.apply(this,arguments)}function Oe(){me.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Se(e,t){return(t=t||{}).recognizers=x(t.recognizers,Se.defaults.preset),new Te(e,t)}function Te(e,t){var n;this.options=u({},Se.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(M?ee:P?ie:F?se:Z))(n,V),this.touchAction=new pe(this,this.options.touchAction),Ie(this,!0),v(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Ie(e,t){var n,r=e.element;r.style&&(v(e.options.cssProps,(function(a,i){n=R(r.style,i),t?(e.oldCssProps[n]=r.style[n],r.style[n]=a):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}pe.prototype={set:function(e){"compute"==e&&(e=this.compute()),de&&this.manager.element.style&&fe[e]&&(this.manager.element.style[he]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,(function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(T(e,"none"))return"none";var t=T(e,"pan-x"),n=T(e,"pan-y");return t&&n?"none":t||n?t?"pan-x":"pan-y":T(e,"manipulation")?"manipulation":"auto"}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,a=T(r,"none")&&!fe.none,i=T(r,"pan-y")&&!fe["pan-y"],o=T(r,"pan-x")&&!fe["pan-x"];if(a&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!o||!i)return a||i&&6&n||o&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},me.prototype={defaults:{},set:function(e){return u(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(m(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=ye(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return m(e,"dropRecognizeWith",this)||(e=ye(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(m(e,"requireFailure",this))return this;var t=this.requireFail;return-1===E(t,e=ye(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(m(e,"dropRequireFailure",this))return this;e=ye(e,this);var t=E(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<8&&r(t.options.event+ve(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=8&&r(t.options.event+ve(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=u({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},k(be,me,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=6&t,a=this.attrTest(e);return r&&(8&n||!a)?16|t:r||a?4&n?8|t:2&t?4|t:2:32}}),k(ke,be,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push("pan-y"),24&e&&t.push("pan-x"),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,a=e.direction,i=e.deltaX,o=e.deltaY;return a&t.direction||(6&t.direction?(a=0===i?1:i<0?2:4,n=i!=this.pX,r=Math.abs(e.deltaX)):(a=0===o?1:o<0?8:16,n=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=a,n&&r>t.threshold&&a&t.direction},attrTest:function(e){return be.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ge(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),k(_e,be,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),this._super.emit.call(this,e)}}),k(we,me,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,a=e.deltaTime>t.time;if(this._input=e,!r||!n||12&e.eventType&&!a)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),k(xe,be,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),k(Ce,be,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ke.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ge(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),k(Oe,me,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,a=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&a&&n){if(4!=e.eventType)return this.failTimeout();var i=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||K(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&i?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=p((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Se.VERSION="2.0.7",Se.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[xe,{enable:!1}],[_e,{enable:!1},["rotate"]],[Ce,{direction:6}],[ke,{direction:6},["swipe"]],[Oe],[Oe,{event:"doubletap",taps:2},["tap"]],[we]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Te.prototype={set:function(e){return u(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,a=t.curRecognizer;(!a||a&&8&a.state)&&(a=t.curRecognizer=null);for(var i=0;i<r.length;)n=r[i],2===t.stopped||a&&n!=a&&!n.canRecognizeWith(a)?n.reset():n.recognize(e),!a&&14&n.state&&(a=t.curRecognizer=n),i++}},get:function(e){if(e instanceof me)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(m(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(m(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=E(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(void 0!==e&&void 0!==t){var n=this.handlers;return v(I(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(void 0!==e){var n=this.handlers;return v(I(e),(function(e){t?n[e]&&n[e].splice(E(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=i.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},destroy:function(){this.element&&Ie(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Se,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Te,Input:B,TouchAction:pe,TouchInput:ie,MouseInput:Z,PointerEventInput:ee,TouchMouseInput:se,SingleTouchInput:ne,Recognizer:me,AttrRecognizer:be,Tap:Oe,Pan:ke,Swipe:Ce,Pinch:_e,Rotate:xe,Press:we,on:C,off:O,each:v,merge:b,extend:y,assign:u,inherit:k,bindFn:_,prefixed:R}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=Se,void 0===(r=(function(){return Se}).call(t,n,t,e))||(e.exports=r)}(window,document)},yRKQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("o/e8"),o=n("atXS"),s=n("VO80"),u=Object(s.b)({transpose_:function(e,t){var n=Object(i.a)(e,"x","transpose");return null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," must match length of perm ").concat(t,".")})),t.forEach((function(e){o.b(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t}))})),n.rank<=1?n.clone():r.a.runKernel(a.Vc,{x:n},{perm:t})}})},yfHJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("VO80"),u=Object(s.b)({pow_:function(e,t){var n,s=Object(o.a)(e,"base","pow"),u=Object(o.a)(t,"exp","pow");return s=(n=_slicedToArray(Object(i.makeTypesMatch)(s,u),2))[0],u=n[1],r.a.runKernel(a.fc,{a:s,b:u})}})},yuCN:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],r[a]=n^=(e^=e<<13)^e<<9,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},zLES:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return k})),n.d(t,"f",(function(){return _})),n.d(t,"g",(function(){return w})),n.d(t,"h",(function(){return x})),n.d(t,"i",(function(){return C}));var r=n("wE5H"),a=n("o/e8"),i=n("atXS"),o=n("kRdc"),s=n("x3y4"),u=n("CfTU"),c=n("8OX7"),l=n("RhH0"),h=n("parS"),d=n("VO80"),f=n("yfHJ"),p=n("QYQ3"),m=n("oAkI"),v=Object(d.b)({addStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","addStrict"),s=Object(a.a)(t,"b","addStrict");return i.e(n.shape,s.shape,"Error in addStrict: "),Object(o.a)(n,s)}}),g=Object(d.b)({divStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","div"),o=Object(a.a)(t,"b","div");return i.e(n.shape,o.shape,"Error in divideStrict: "),Object(s.a)(n,o)}}),y=Object(d.b)({maximumStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","maximumStrict"),o=Object(a.a)(t,"b","maximumStrict");return i.e(n.shape,o.shape,"Error in maximumStrict: "),Object(u.a)(n,o)}}),b=Object(d.b)({minimumStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","minimumStrict"),o=Object(a.a)(t,"b","minimumStrict");return i.e(n.shape,o.shape,"Error in minimumStrict: "),Object(c.a)(n,o)}}),k=Object(d.b)({modStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","modStrict"),o=Object(a.a)(t,"b","modStrict");return i.e(n.shape,o.shape,"Error in modStrict: "),Object(l.a)(n,o)}}),_=Object(d.b)({mulStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","mul"),o=Object(a.a)(t,"b","mul");return i.e(n.shape,o.shape,"Error in multiplyStrict: "),Object(h.a)(n,o)}}),w=Object(d.b)({powStrict_:function(e,t){return Object(r.b)("strict variants of ops have been deprecated and will be removed in future"),i.e(e.shape,t.shape,"Error in powStrict: "),Object(f.a)(e,t)}}),x=Object(d.b)({squaredDifferenceStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","squaredDifferenceStrict"),o=Object(a.a)(t,"b","squaredDifferenceStrict");return i.e(n.shape,o.shape,"Error in squaredDifferenceStrict: "),Object(p.a)(n,o)}}),C=Object(d.b)({subStrict_:function(e,t){Object(r.b)("strict variants of ops have been deprecated and will be removed in future");var n=Object(a.a)(e,"a","subStrict"),o=Object(a.a)(t,"b","subStrict");return i.e(n.shape,o.shape,"Error in subStrict: "),Object(m.a)(n,o)}})},"zR+/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("o/e8"),a=n("c9N1"),i=n("VO80"),o=Object(i.b)({conv2dTranspose_:function(e,t,n,i,o,s){var u=Object(r.a)(e,"x","conv2dTranspose"),c=Object(r.a)(t,"filter","conv2dTranspose");return Object(a.a)(n,u,c,i,o,"NHWC",s)}})},zUnb:function(e,t,n){"use strict";n.r(t);var r={};function a(e){return"function"==typeof e}n.r(r),n.d(r,"simpleAbsImpl",(function(){return Cw})),n.d(r,"addImpl",(function(){return mw})),n.d(r,"bincountImpl",(function(){return sx})),n.d(r,"bincountReduceImpl",(function(){return ux})),n.d(r,"ceilImpl",(function(){return hx})),n.d(r,"concatImpl",(function(){return gx})),n.d(r,"expImpl",(function(){return rC})),n.d(r,"expm1Impl",(function(){return uC})),n.d(r,"floorImpl",(function(){return IC})),n.d(r,"gatherV2Impl",(function(){return PC})),n.d(r,"greaterImpl",(function(){return zC})),n.d(r,"lessImpl",(function(){return JC})),n.d(r,"linSpaceImpl",(function(){return aO})),n.d(r,"logImpl",(function(){return oO})),n.d(r,"maxImpl",(function(){return _O})),n.d(r,"maximumImpl",(function(){return CO})),n.d(r,"minimumImpl",(function(){return MO})),n.d(r,"multiplyImpl",(function(){return hC})),n.d(r,"negImpl",(function(){return KO})),n.d(r,"notEqualImpl",(function(){return eS})),n.d(r,"prodImpl",(function(){return fS})),n.d(r,"rangeImpl",(function(){return mS})),n.d(r,"rsqrtImpl",(function(){return TS})),n.d(r,"sliceImpl",(function(){return rx})),n.d(r,"squaredDifferenceImpl",(function(){return eT})),n.d(r,"stridedSliceImpl",(function(){return iT})),n.d(r,"subImpl",(function(){return yC})),n.d(r,"tileImpl",(function(){return lT})),n.d(r,"topKImpl",(function(){return hT})),n.d(r,"transposeImpl",(function(){return Aw})),n.d(r,"uniqueImpl",(function(){return dT})),n("yLV6");var i=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=e},get useDeprecatedSynchronousErrorHandling(){return i}};function s(e){setTimeout((function(){throw e}))}var u={closed:!0,next:function(e){},error:function(e){if(o.useDeprecatedSynchronousErrorHandling)throw e;s(e)},complete:function(){}},c=Array.isArray||function(e){return e&&"number"==typeof e.length};function l(e){return null!==e&&"object"==typeof e}function h(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map((function(e,t){return"".concat(t+1,") ").concat(e.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}h.prototype=Object.create(Error.prototype);var d,f=h,p=((d=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var e,t=!1;if(!this.closed){var n=this._parent,r=this._parents,i=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,u=r?r.length:0;n;)n.remove(this),n=++s<u&&r[s]||null;if(a(i))try{i.call(this)}catch(d){t=!0,e=d instanceof f?m(d.errors):[d]}if(c(o))for(s=-1,u=o.length;++s<u;){var h=o[s];if(l(h))try{h.unsubscribe()}catch(d){t=!0,e=e||[],d instanceof f?e=e.concat(m(d.errors)):e.push(d)}}if(t)throw new f(e)}}},{key:"add",value:function(t){var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:if(!t)return e.EMPTY;throw new Error("unrecognized teardown "+t+" added to Subscription.")}if(n._addParent(this)){var a=this._subscriptions;a?a.push(n):this._subscriptions=[n]}return n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}},{key:"_addParent",value:function(e){var t=this._parent,n=this._parents;return t!==e&&(t?n?-1===n.indexOf(e)&&(n.push(e),!0):(this._parents=[e],!0):(this._parent=e,!0))}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new d),d);function m(e){return e.reduce((function(e,t){return e.concat(t instanceof f?t.errors:t)}),[])}var v="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),g=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;switch(_classCallCheck(this,n),(i=t.call(this)).syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=u;break;case 1:if(!e){i.destination=u;break}if("object"==typeof e){e instanceof n?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(_assertThisInitialized(i))):(i.syncErrorThrowable=!0,i.destination=new y(_assertThisInitialized(i),e));break}default:i.syncErrorThrowable=!0,i.destination=new y(_assertThisInitialized(i),e,r,a)}return i}return _createClass(n,[{key:v,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(n.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this}}],[{key:"create",value:function(e,t,r){var a=new n(e,t,r);return a.syncErrorThrowable=!1,a}}]),n}(p),y=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var s,c;_classCallCheck(this,n),(s=t.call(this))._parentSubscriber=e;var l=_assertThisInitialized(s);return a(r)?c=r:r&&(c=r.next,i=r.error,o=r.complete,r!==u&&(a((l=Object.create(r)).unsubscribe)&&s.add(l.unsubscribe.bind(l)),l.unsubscribe=s.unsubscribe.bind(_assertThisInitialized(s)))),s._context=l,s._next=c,s._error=i,s._complete=o,s}return _createClass(n,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=o.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):s(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;s(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;s(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return o.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(s(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),n}(g),b="function"==typeof Symbol&&Symbol.observable||"@@observable";function k(){}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return w(t)}function w(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:k}var x,C=((x=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this.operator,a=function(e,t,n){if(e){if(e instanceof g)return e;if(e[v])return e[v]()}return e||t||n?new g(e,t,n):new g(u)}(e,t,n);if(a.add(r?r.call(a,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),o.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){o.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,a=t.isStopped;if(n||a)return!1;e=r&&r instanceof g?r:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=O(t))((function(t,r){var a;a=n.subscribe((function(t){try{e(t)}catch(n){r(n),a&&a.unsubscribe()}}),r,t)}))}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:b,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:w(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=O(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))}}]),e}()).create=function(e){return new x(e)},x);function O(e){if(e||(e=o.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function S(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}S.prototype=Object.create(Error.prototype);var T,I=S,E=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).subject=e,a.subscriber=r,a.closed=!1,a}return _createClass(n,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),n}(p),N=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).destination=e,r}return n}(g),A=((T=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _createClass(n,[{key:v,value:function(){return new N(this)}},{key:"lift",value:function(e){var t=new R(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new I;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),a=0;a<n;a++)r[a].next(e)}},{key:"error",value:function(e){if(this.closed)throw new I;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),a=0;a<n;a++)r[a].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new I;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new I;return _get(_getPrototypeOf(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new I;return this.hasError?(e.error(this.thrownError),p.EMPTY):this.isStopped?(e.complete(),p.EMPTY):(this.observers.push(e),new E(this,e))}},{key:"asObservable",value:function(){var e=new C;return e.source=this,e}}]),n}(C)).create=function(e,t){return new R(e,t)},T),R=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).destination=e,a.source=r,a}return _createClass(n,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):p.EMPTY}}]),n}(A);function D(e){return e&&"function"==typeof e.schedule}var j=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this)).parent=e,i.outerValue=r,i.outerIndex=a,i.index=0,i}return _createClass(n,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),n}(g),F=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.closed||t.complete()}},M=function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,s),t}};var P="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",L=function(e){return function(t){for(var n=e[P]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t}},z=function(e){return function(t){var n=e[b]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}},B=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function V(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var W=function(e){if(e instanceof C)return function(t){return e._isScalar?(t.next(e.value),void t.complete()):e.subscribe(t)};if(e&&"function"==typeof e[b])return z(e);if(B(e))return F(e);if(V(e))return M(e);if(e&&"function"==typeof e[P])return L(e);var t=l(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(t," where a stream was expected. You can provide an Observable, Promise, Array, or Iterable."))};function U(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new j(e,n,r);if(!a.closed)return W(t)(a)}var H=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"notifyNext",value:function(e,t,n,r,a){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),n}(g);function G(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new K(e,t))}}var K=function(){function e(t,n){_classCallCheck(this,e),this.project=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new q(e,this.project,this.thisArg))}}]),e}(),q=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).project=r,i.count=0,i.thisArg=a||_assertThisInitialized(i),i}return _createClass(n,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(g);function X(e,t){return new C(t?function(n){var r=new p,a=0;return r.add(t.schedule((function(){a!==e.length?(n.next(e[a++]),n.closed||r.add(this.schedule())):n.complete()}))),r}:F(e))}function Z(e,t){if(!t)return e instanceof C?e:new C(W(e));if(null!=e){if(function(e){return e&&"function"==typeof e[b]}(e))return function(e,t){return new C(t?function(n){var r=new p;return r.add(t.schedule((function(){var a=e[b]();r.add(a.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}:z(e))}(e,t);if(V(e))return function(e,t){return new C(t?function(n){var r=new p;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}:M(e))}(e,t);if(B(e))return X(e,t);if(function(e){return e&&"function"==typeof e[P]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new C(t?function(n){var r,a=new p;return a.add((function(){r&&"function"==typeof r.return&&r.return()})),a.add(t.schedule((function(){r=e[P](),a.add(t.schedule((function(){if(!n.closed){var e,t;try{var a=r.next();e=a.value,t=a.done}catch(i){return void n.error(i)}t?n.complete():(n.next(e),this.schedule())}})))}))),a}:L(e))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function Y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(r){return r.pipe(Y((function(n,r){return Z(e(n,r)).pipe(G((function(e,a){return t(n,e,r,a)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new Q(e,n))})}var Q=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new J(e,this.project,this.concurrent))}}]),e}(),J=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,n),(a=t.call(this,e)).project=r,a.concurrent=i,a.hasCompleted=!1,a.buffer=[],a.active=0,a.index=0,a}return _createClass(n,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=new j(this,void 0,void 0);this.destination.add(r),U(this,e,t,n,r)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,n,r,a){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),n}(H);function $(e){return e}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return Y($,e)}function te(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Number.POSITIVE_INFINITY,a=null,i=t[t.length-1];return D(i)?(a=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof i&&(r=t.pop()),null===a&&1===t.length&&t[0]instanceof C?t[0]:ee(r)(X(t,a))}function ne(){return function(e){return e.lift(new re(e))}}var re=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var r=new ae(e,n),a=t.subscribe(r);return r.closed||(r.connection=n.connect()),a}}]),e}(),ae=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).connectable=r,a}return _createClass(n,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),n}(g),ie=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).source=e,a.subjectFactory=r,a._refCount=0,a._isComplete=!1,a}return _createClass(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new p).add(this.source.subscribe(new se(this.getSubject(),this))),e.closed?(this._connection=null,e=p.EMPTY):this._connection=e),e}},{key:"refCount",value:function(){return ne()(this)}}]),n}(C).prototype,oe={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:ie._subscribe},_isComplete:{value:ie._isComplete,writable:!0},getSubject:{value:ie.getSubject},connect:{value:ie.connect},refCount:{value:ie.refCount}},se=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).connectable=r,a}return _createClass(n,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),n}(N);function ue(){return new A}function ce(e,t,n){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof a)return r.apply(this,t),this;var i=_construct(a,t);return o.annotation=i,o;function o(e,t,n){for(var r=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(i),e}}return n&&(a.prototype=Object.create(n.prototype)),a.prototype.ngMetadataName=e,a.annotationCls=a,a}var le=ce("Inject",(function(e){return{token:e}})),he=ce("Optional"),de=ce("Self"),fe=ce("SkipSelf"),pe=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function me(e){for(var t in e)if(e[t]===me)return t;throw Error("Could not find renamed property on target object.")}function ve(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ge(e){var t=e[ye];return t&&t.token===e?t:null}var ye=me({ngInjectableDef:me});function be(e){if("string"==typeof e)return e;if(e instanceof Array)return"["+e.map(be).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return""+e.overriddenName;if(e.name)return""+e.name;var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}var ke=me({__forward_ref__:me});function _e(e){return e.__forward_ref__=_e,e.toString=function(){return be(this())},e}function we(e){var t=e;return"function"==typeof t&&t.hasOwnProperty(ke)&&t.__forward_ref__===_e?t():e}var xe="undefined"!=typeof globalThis&&globalThis,Ce="undefined"!=typeof window&&window,Oe="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Se="undefined"!=typeof global&&global,Te=xe||Se||Ce||Oe,Ie=function(){function e(t,n){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.ngInjectableDef=ve({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken "+this._desc}}]),e}(),Ee=new Ie("INJECTOR",-1),Ne=new Object,Ae=/\n/gm,Re=me({provide:String,useValue:me}),De=void 0;function je(e){var t=De;return De=e,t}function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe.Default;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pe.Default;if(void 0===De)throw new Error("inject() must be called from an injection context");return null===De?function(e,t,n){var r=ge(e);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&pe.Optional)return null;throw new Error("Injector: NOT_FOUND [".concat(be(e),"]"))}(e,0,t):De.get(e,t&pe.Optional?null:void 0,t)}(e,t)}var Me=Fe,Pe=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ne;if(t===Ne){var n=new Error("NullInjectorError: No provider for ".concat(be(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}();function Le(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var a=be(t);if(t instanceof Array)a=t.map(be).join(" -> ");else if("object"==typeof t){var i=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];i.push(o+":"+("string"==typeof s?JSON.stringify(s):be(s)))}a="{".concat(i.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(a,"]: ").concat(e.replace(Ae,"\n  "))}var ze=function e(){_classCallCheck(this,e)},Be=function e(){_classCallCheck(this,e)};function Ve(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function We(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}var Ue=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),He=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Te);function Ge(e){return e.ngDebugContext}function Ke(e){return e.ngOriginalError}function qe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var Xe=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e.ngErrorLogger||qe}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?Ge(e)?Ge(e):this._findContext(Ke(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=Ke(e);t&&Ke(t);)t=Ke(t);return t}}]),e}(),Ze=!0,Ye=!1;function Qe(){return Ye=!0,Ze}var Je=function(){function e(t){if(_classCallCheck(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n),this.inertBodyElement=this.inertDocument.createElement("body"),n.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(e){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return _createClass(e,[{key:"getInertBodyElement_XHR",value:function(e){e="<body><remove></remove>"+e+"</body>";try{e=encodeURI(e)}catch(r){return null}var t=new XMLHttpRequest;t.responseType="document",t.open("GET","data:text/html;charset=utf-8,"+e,!1),t.send(void 0);var n=t.response.body;return n.removeChild(n.firstChild),n}},{key:"getInertBodyElement_DOMParser",value:function(e){e="<body><remove></remove>"+e+"</body>";try{var t=(new window.DOMParser).parseFromString(e,"text/html").body;return t.removeChild(t.firstChild),t}catch(n){return null}}},{key:"getInertBodyElement_InertDocument",value:function(e){var t=this.inertDocument.createElement("template");return"content"in t?(t.innerHTML=e,t):(this.inertBodyElement.innerHTML=e,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;"xmlns:ns1"!==r&&0!==r.indexOf("ns1:")||e.removeAttribute(r)}for(var a=e.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(a),a=a.nextSibling}}]),e}(),$e=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,et=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function tt(e){return(e=String(e)).match($e)||e.match(et)?e:(Qe()&&console.warn("WARNING: sanitizing unsafe URL value ".concat(e," (see http://g.co/ng/security#xss)")),"unsafe:"+e)}function nt(e){var t,n={},r=_createForOfIteratorHelper(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(a){r.e(a)}finally{r.f()}return n}function rt(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var at,it=nt("area,br,col,hr,img,wbr"),ot=nt("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),st=nt("rp,rt"),ut=rt(st,ot),ct=rt(it,rt(ot,nt("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),rt(st,nt("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ut),lt=nt("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ht=nt("srcset"),dt=rt(lt,ht,nt("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),nt("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ft=nt("script,style,template"),pt=function(){function e(){_classCallCheck(this,e),this.sanitizedSomething=!1,this.buf=[]}return _createClass(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!ct.hasOwnProperty(t))return this.sanitizedSomething=!0,!ft.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n,r=e.attributes,a=0;a<r.length;a++){var i=r.item(a),o=i.name,s=o.toLowerCase();if(dt.hasOwnProperty(s)){var u=i.value;lt[s]&&(u=tt(u)),ht[s]&&(n=u,u=(n=String(n)).split(",").map((function(e){return tt(e.trim())})).join(", ")),this.buf.push(" ",o,'="',gt(u),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();ct.hasOwnProperty(t)&&!it.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(gt(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+e.outerHTML);return t}}]),e}(),mt=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,vt=/([^\#-~ |!])/g;function gt(e){return e.replace(/&/g,"&amp;").replace(mt,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(vt,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function yt(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var bt=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}(),kt=function e(){_classCallCheck(this,e)},_t=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),wt=/^url\(([^)]+)\)$/,xt=/([A-Z])/g;function Ct(e){try{return null!=e?e.toString().slice(0,30):e}catch(t){return"[ERROR] Exception while trying to serialize the value"}}var Ot=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return St()},e}(),St=function(){},Tt=new Ie("The presence of this token marks an injector as being the root injector."),It=function(e,t,n){return new jt(e,t,n)},Et=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?It(e,t,""):It(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Ne,e.NULL=new Pe,e.ngInjectableDef=ve({token:e,providedIn:"any",factory:function(){return Fe(Ee)}}),e.__NG_ELEMENT_ID__=-1,e}(),Nt=function(e){return e},At=[],Rt=Nt,Dt=function(){return Array.prototype.slice.call(arguments)},jt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et.NULL,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,e),this.parent=n,this.source=r;var a=this._records=new Map;a.set(Et,{token:Et,fn:Nt,deps:At,value:this,useNew:!1}),a.set(Ee,{token:Ee,fn:Nt,deps:At,value:this,useNew:!1}),function e(t,n){if(n)if((n=we(n))instanceof Array)for(var r=0;r<n.length;r++)e(t,n[r]);else{if("function"==typeof n)throw Mt("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw Mt("Unexpected provider",n);var a=we(n.provide),i=function(e){var t=function(e){var t=At,n=e.deps;if(n&&n.length){t=[];for(var r=0;r<n.length;r++){var a=6,i=we(n[r]);if(i instanceof Array)for(var o=0,s=i;o<s.length;o++){var u=s[o];u instanceof he||u==he?a|=1:u instanceof fe||u==fe?a&=-3:u instanceof de||u==de?a&=-5:i=u instanceof le?u.token:we(u)}t.push({token:i,options:a})}}else if(e.useExisting)t=[{token:we(e.useExisting),options:6}];else if(!(n||Re in e))throw Mt("'deps' required",e);return t}(e),n=Nt,r=At,a=!1,i=we(e.provide);if(Re in e)r=e.useValue;else if(e.useFactory)n=e.useFactory;else if(e.useExisting);else if(e.useClass)a=!0,n=we(e.useClass);else{if("function"!=typeof i)throw Mt("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",e);a=!0,n=i}return{deps:t,fn:n,useNew:a,value:r}}(n);if(!0===n.multi){var o=t.get(a);if(o){if(o.fn!==Dt)throw Ft(a)}else t.set(a,o={token:n.provide,deps:[],useNew:!1,fn:Dt,value:At});a=n,o.deps.push({token:a,options:6})}var s=t.get(a);if(s&&s.fn==Dt)throw Ft(a);t.set(a,i)}}(a,t)}return _createClass(e,[{key:"get",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pe.Default,r=this._records.get(e);try{return function e(t,n,r,a,i,o){try{return function(t,n,r,a,i,o){var s;if(!n||o&pe.SkipSelf)o&pe.Self||(s=a.get(t,i,pe.Default));else{if((s=n.value)==Rt)throw Error("\u0275Circular dependency");if(s===At){n.value=Rt;var u=n.useNew,c=n.fn,l=n.deps,h=At;if(l.length){h=[];for(var d=0;d<l.length;d++){var f=l[d],p=f.options,m=2&p?r.get(f.token):void 0;h.push(e(f.token,m,r,m||4&p?a:Et.NULL,1&p?null:Et.THROW_IF_NOT_FOUND,pe.Default))}}n.value=s=u?_construct(c,_toConsumableArray(h)):c.apply(void 0,h)}}return s}(t,n,r,a,i,o)}catch(s){throw s instanceof Error||(s=new Error(s)),(s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(t),n&&n.value==Rt&&(n.value=At),s}}(e,r,this._records,this.parent,t,n)}catch(a){return function(e,t,n,r){var a=e.ngTempTokenPath;throw t.__source&&a.unshift(t.__source),e.message=Le("\n"+e.message,a,"StaticInjectorError",r),e.ngTokenPath=a,e.ngTempTokenPath=null,e}(a,e,0,this.source)}}},{key:"toString",value:function(){var e=[];return this._records.forEach((function(t,n){return e.push(be(n))})),"StaticInjector[".concat(e.join(", "),"]")}}]),e}();function Ft(e){return Mt("Cannot mix multi providers and regular providers",e)}function Mt(e,t){return new Error(Le(e,t,"StaticInjectorError"))}var Pt=new Ie("AnalyzeForEntryComponents"),Lt=null;function zt(){if(!Lt){var e=Te.Symbol;if(e&&e.iterator)Lt=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(Lt=r)}}return Lt}function Bt(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function Vt(e,t){var n=Ut(e),r=Ut(t);return n&&r?function(e,t,n){for(var r=e[zt()](),a=t[zt()]();;){var i=r.next(),o=a.next();if(i.done&&o.done)return!0;if(i.done||o.done)return!1;if(!n(i.value,o.value))return!1}}(e,t,Vt):!(n||!(e&&("object"==typeof e||"function"==typeof e))||r||!(t&&("object"==typeof t||"function"==typeof t)))||Bt(e,t)}var Wt=function(){function e(t){_classCallCheck(this,e),this.wrapped=t}return _createClass(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function Ut(e){return!!Ht(e)&&(Array.isArray(e)||!(e instanceof Map)&&zt()in e)}function Ht(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Gt(e){return!!e&&"function"==typeof e.then}function Kt(e){return!!e&&"function"==typeof e.subscribe}var qt=function(){function e(t,n,r){_classCallCheck(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return _createClass(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}(),Xt=function e(){_classCallCheck(this,e)};function Zt(e){var t=Error("No component factory found for ".concat(be(e),". Did you add it to @NgModule.entryComponents?"));return t[Yt]=e,t}var Yt="ngComponent",Qt=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw Zt(e)}}]),e}(),Jt=function(){var e=function e(){_classCallCheck(this,e)};return e.NULL=new Qt,e}(),$t=function(){function e(t,n,r){_classCallCheck(this,e),this._parent=n,this._ngModule=r,this._factories=new Map;for(var a=0;a<t.length;a++){var i=t[a];this._factories.set(i.componentType,i)}}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){var t=this._factories.get(e);if(!t&&this._parent&&(t=this._parent.resolveComponentFactory(e)),!t)throw Zt(e);return new en(t,this._ngModule)}}]),e}(),en=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).factory=e,a.ngModule=r,a.selector=e.selector,a.componentType=e.componentType,a.ngContentSelectors=e.ngContentSelectors,a.inputs=e.inputs,a.outputs=e.outputs,a}return _createClass(n,[{key:"create",value:function(e,t,n,r){return this.factory.create(e,t,n,r||this.ngModule)}}]),n}(Xt);function tn(){}var nn=function(){var e=function e(t){_classCallCheck(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=function(){return rn(e)},e}(),rn=tn,an=function e(){_classCallCheck(this,e)},on=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),sn=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return un()},e}(),un=tn,cn=function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")},ln=new cn("8.2.14"),hn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return Ut(e)}},{key:"create",value:function(e){return new fn(e)}}]),e}(),dn=function(e,t){return t},fn=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||dn}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,a=null;t||n;){var i=!n||t&&t.currentIndex<gn(n,r,a)?t:n,o=gn(i,r,a),s=i.currentIndex;if(i===n)r--,n=n._nextRemoved;else if(t=t._next,null==i.previousIndex)r++;else{a||(a=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<a.length?a[l]:a[l]=0,d=h+l;c<=d&&d<u&&(a[l]=h+1)}a[i.previousIndex]=c-u}}o!==s&&e(i,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Ut(e))throw new Error("Error trying to diff '".concat(be(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,a,i=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],a=this._trackByFn(s,r),null!==i&&Bt(i.trackById,a)?(o&&(i=this._verifyReinsertion(i,r,a,s)),Bt(i.item,r)||this._addIdentityChange(i,r)):(i=this._mismatch(i,r,a,s),o=!0),i=i._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,a=e[zt()]();!(r=a.next()).done;)t(r.value)}(e,(function(e){a=t._trackByFn(n,e),null!==i&&Bt(i.trackById,a)?(o&&(i=t._verifyReinsertion(i,e,a,n)),Bt(i.item,e)||t._addIdentityChange(i,e)):(i=t._mismatch(i,e,a,n),o=!0),i=i._next,n++})),this.length=n;return this._truncate(i),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var a;return null===e?a=this._itTail:(a=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Bt(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,a,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Bt(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,a,r)):e=this._addAfter(new pn(t,n),a,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==a?e=this._reinsertAfter(a,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,a=e._nextRemoved;return null===r?this._removalsHead=a:r._nextRemoved=a,null===a?this._removalsTail=r:a._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new vn),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new vn),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),pn=function e(t,n){_classCallCheck(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},mn=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Bt(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),vn=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new mn,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function gn(e,t,n){var r=e.previousIndex;if(null===r)return r;var a=0;return n&&r<n.length&&(a=n[r]),r+t+a}var yn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||Ht(e)}},{key:"create",value:function(){return new bn}}]),e}(),bn=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Ht(e)))throw new Error("Error trying to diff '".concat(be(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var a=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,a)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,a=n._next;return r&&(r._next=a),a&&(a._prev=r),n._next=null,n._prev=null,n}var i=new kn(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Bt(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach((function(n){return t(e[n],n)}))}}]),e}(),kn=function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},_n=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,n=this.factories.find((function(t){return t.supports(e)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new fe,new he]]}}}]),e}();return e.ngInjectableDef=ve({token:e,providedIn:"root",factory:function(){return new e([new hn])}}),e}(),wn=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find((function(t){return t.supports(e)}));if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new fe,new he]]}}}]),e}();return e.ngInjectableDef=ve({token:e,providedIn:"root",factory:function(){return new e([new yn])}}),e}(),xn=[new yn],Cn=new _n([new hn]),On=new wn(xn),Sn=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Tn(e,nn)},e}(),Tn=tn,In=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return En(e,nn)},e}(),En=tn;function Nn(e,t,n,r){var a="ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '".concat(t,"'. Current value: '").concat(n,"'.");return r&&(a+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(e,t){var n=new Error(e);return An(n,t),n}(a,e)}function An(e,t){e.ngDebugContext=t,e.ngErrorLogger=t.logError.bind(t)}function Rn(e){return new Error("ViewDestroyedError: Attempt to use a destroyed view: "+e)}function Dn(e,t,n){var r=e.state,a=1792&r;return a===t?(e.state=-1793&r|n,e.initIndex=-1,!0):a===n}function jn(e,t,n){return(1792&e.state)===t&&e.initIndex<=n&&(e.initIndex=n+1,!0)}function Fn(e,t){return e.nodes[t]}function Mn(e,t){return e.nodes[t]}function Pn(e,t){return e.nodes[t]}function Ln(e,t){return e.nodes[t]}function zn(e,t){return e.nodes[t]}var Bn={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},Vn=function(){},Wn=new Map;function Un(e){var t=Wn.get(e);return t||(t=be(e)+"_"+Wn.size,Wn.set(e,t)),t}function Hn(e){return{id:"$$undefined",styles:e.styles,encapsulation:e.encapsulation,data:e.data}}var Gn=0;function Kn(e,t,n,r){return!(!(2&e.state)&&Bt(e.oldValues[t.bindingIndex+n],r))}function qn(e,t,n,r){return!!Kn(e,t,n,r)&&(e.oldValues[t.bindingIndex+n]=r,!0)}function Xn(e,t,n,r){var a=e.oldValues[t.bindingIndex+n];if(1&e.state||!Vt(a,r)){var i=t.bindings[n].name;throw Nn(Bn.createDebugContext(e,t.nodeIndex),"".concat(i,": ").concat(a),"".concat(i,": ").concat(r),0!=(1&e.state))}}function Zn(e){for(var t=e;t;)2&t.def.flags&&(t.state|=8),t=t.viewContainerParent||t.parent}function Yn(e,t){for(var n=e;n&&n!==t;)n.state|=64,n=n.viewContainerParent||n.parent}function Qn(e,t,n,r){try{return Zn(33554432&e.def.nodes[t].flags?Mn(e,t).componentView:e),Bn.handleEvent(e,t,n,r)}catch(a){e.root.errorHandler.handleError(a)}}function Jn(e){return e.parent?Mn(e.parent,e.parentNodeDef.nodeIndex):null}function $n(e){return e.parent?e.parentNodeDef.parent:null}function er(e,t){switch(201347067&t.flags){case 1:return Mn(e,t.nodeIndex).renderElement;case 2:return Fn(e,t.nodeIndex).renderText}}function tr(e){return!!e.parent&&!!(32768&e.parentNodeDef.flags)}function nr(e){return!(!e.parent||32768&e.parentNodeDef.flags)}function rr(e){return 1<<e%32}function ar(e){var t={},n=0,r={};return e&&e.forEach((function(e){var a=_slicedToArray(e,2),i=a[0],o=a[1];"number"==typeof i?(t[i]=o,n|=rr(i)):r[i]=o})),{matchedQueries:t,references:r,matchedQueryIds:n}}function ir(e,t){return e.map((function(e){var n,r,a;return Array.isArray(e)?(a=(n=_slicedToArray(e,2))[0],r=n[1]):(a=0,r=e),r&&("function"==typeof r||"object"==typeof r)&&t&&Object.defineProperty(r,"__source",{value:t,configurable:!0}),{flags:a,token:r,tokenKey:Un(r)}}))}function or(e,t,n){var r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===Ue.Native?Mn(e,n.renderParent.nodeIndex).renderElement:void 0:t}var sr=new WeakMap;function ur(e){var t=sr.get(e);return t||((t=e((function(){return Vn}))).factory=e,sr.set(e,t)),t}function cr(e,t,n,r,a){3===t&&(n=e.renderer.parentNode(er(e,e.def.lastRenderRootNode))),lr(e,t,0,e.def.nodes.length-1,n,r,a)}function lr(e,t,n,r,a,i,o){for(var s=n;s<=r;s++){var u=e.def.nodes[s];11&u.flags&&dr(e,u,t,a,i,o),s+=u.childCount}}function hr(e,t,n,r,a,i){for(var o=e;o&&!tr(o);)o=o.parent;for(var s=o.parent,u=$n(o),c=u.nodeIndex+u.childCount,l=u.nodeIndex+1;l<=c;l++){var h=s.def.nodes[l];h.ngContentIndex===t&&dr(s,h,n,r,a,i),l+=h.childCount}if(!s.parent){var d=e.root.projectableNodes[t];if(d)for(var f=0;f<d.length;f++)fr(e,d[f],n,r,a,i)}}function dr(e,t,n,r,a,i){if(8&t.flags)hr(e,t.ngContent.index,n,r,a,i);else{var o=er(e,t);if(3===n&&33554432&t.flags&&48&t.bindingFlags?(16&t.bindingFlags&&fr(e,o,n,r,a,i),32&t.bindingFlags&&fr(Mn(e,t.nodeIndex).componentView,o,n,r,a,i)):fr(e,o,n,r,a,i),16777216&t.flags)for(var s=Mn(e,t.nodeIndex).viewContainer._embeddedViews,u=0;u<s.length;u++)cr(s[u],n,r,a,i);1&t.flags&&!t.element.name&&lr(e,n,t.nodeIndex+1,t.nodeIndex+t.childCount,r,a,i)}}function fr(e,t,n,r,a,i){var o=e.renderer;switch(n){case 1:o.appendChild(r,t);break;case 2:o.insertBefore(r,t,a);break;case 3:o.removeChild(r,t);break;case 0:i.push(t)}}var pr=/^:([^:]+):(.+)$/;function mr(e){if(":"===e[0]){var t=e.match(pr);return[t[1],t[2]]}return["",e]}function vr(e){for(var t=0,n=0;n<e.length;n++)t|=e[n].flags;return t}var gr=new Object,yr=Un(Et),br=Un(Ee),kr=Un(ze);function _r(e,t,n,r){return n=we(n),{index:-1,deps:ir(r,be(t)),flags:e,token:t,value:n}}function wr(e,t){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Et.THROW_IF_NOT_FOUND,i=je(e);try{if(8&t.flags)return t.token;if(2&t.flags&&(a=null),1&t.flags)return e._parent.get(t.token,a);var o=t.tokenKey;switch(o){case yr:case br:case kr:return e}var s,u=e._def.providersByKey[o];if(u){var c=e._providers[u.index];return void 0===c&&(c=e._providers[u.index]=xr(e,u)),c===gr?void 0:c}if((s=ge(t.token))&&(n=e,null!=(r=s).providedIn&&(function(e,t){return e._def.modules.indexOf(t)>-1}(n,r.providedIn)||"root"===r.providedIn&&n._def.isRoot))){var l=e._providers.length;return e._def.providers[l]=e._def.providersByKey[t.tokenKey]={flags:5120,value:s.factory,deps:[],index:l,token:t.token},e._providers[l]=gr,e._providers[l]=xr(e,e._def.providersByKey[t.tokenKey])}return 4&t.flags?a:e._parent.get(t.token,a)}finally{je(i)}}function xr(e,t){var n;switch(201347067&t.flags){case 512:n=function(e,t,n){var r=n.length;switch(r){case 0:return new t;case 1:return new t(wr(e,n[0]));case 2:return new t(wr(e,n[0]),wr(e,n[1]));case 3:return new t(wr(e,n[0]),wr(e,n[1]),wr(e,n[2]));default:for(var a=new Array(r),i=0;i<r;i++)a[i]=wr(e,n[i]);return _construct(t,a)}}(e,t.value,t.deps);break;case 1024:n=function(e,t,n){var r=n.length;switch(r){case 0:return t();case 1:return t(wr(e,n[0]));case 2:return t(wr(e,n[0]),wr(e,n[1]));case 3:return t(wr(e,n[0]),wr(e,n[1]),wr(e,n[2]));default:for(var a=Array(r),i=0;i<r;i++)a[i]=wr(e,n[i]);return t.apply(void 0,a)}}(e,t.value,t.deps);break;case 2048:n=wr(e,t.deps[0]);break;case 256:n=t.value}return n===gr||null===n||"object"!=typeof n||131072&t.flags||"function"!=typeof n.ngOnDestroy||(t.flags|=131072),void 0===n?gr:n}function Cr(e,t){var n=e.viewContainer._embeddedViews;if((null==t||t>=n.length)&&(t=n.length-1),t<0)return null;var r=n[t];return r.viewContainerParent=null,We(n,t),Bn.dirtyParentQueries(r),Sr(r),r}function Or(e,t,n){var r=t?er(t,t.def.lastRenderRootNode):e.renderElement,a=n.renderer.parentNode(r),i=n.renderer.nextSibling(r);cr(n,2,a,i,void 0)}function Sr(e){cr(e,3,null,null,void 0)}var Tr=new Object;function Ir(e,t,n,r,a,i){return new Er(e,t,n,r,a,i)}var Er=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i,o,s){var u;return _classCallCheck(this,n),(u=t.call(this)).selector=e,u.componentType=r,u._inputs=i,u._outputs=o,u.ngContentSelectors=s,u.viewDefFactory=a,u}return _createClass(n,[{key:"inputs",get:function(){var e=[],t=this._inputs;for(var n in t)e.push({propName:n,templateName:t[n]});return e}},{key:"outputs",get:function(){var e=[];for(var t in this._outputs)e.push({propName:t,templateName:this._outputs[t]});return e}},{key:"create",value:function(e,t,n,r){if(!r)throw new Error("ngModule should be provided");var a=ur(this.viewDefFactory),i=a.nodes[0].element.componentProvider.nodeIndex,o=Bn.createRootView(e,t||[],n,a,r,Tr),s=Pn(o,i).instance;return n&&o.renderer.setAttribute(Mn(o,0).renderElement,"ng-version",ln.full),new Nr(o,new jr(o),s)}}]),n}(Xt),Nr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this))._view=e,i._viewRef=r,i._component=a,i._elDef=i._view.def.nodes[0],i.hostView=r,i.changeDetectorRef=r,i.instance=a,i}return _createClass(n,[{key:"location",get:function(){return new nn(Mn(this._view,this._elDef.nodeIndex).renderElement)}},{key:"injector",get:function(){return new Lr(this._view,this._elDef)}},{key:"componentType",get:function(){return this._component.constructor}},{key:"destroy",value:function(){this._viewRef.destroy()}},{key:"onDestroy",value:function(e){this._viewRef.onDestroy(e)}}]),n}(function(){return function e(){_classCallCheck(this,e)}}());function Ar(e,t,n){return new Rr(e,t,n)}var Rr=function(){function e(t,n,r){_classCallCheck(this,e),this._view=t,this._elDef=n,this._data=r,this._embeddedViews=[]}return _createClass(e,[{key:"element",get:function(){return new nn(this._data.renderElement)}},{key:"injector",get:function(){return new Lr(this._view,this._elDef)}},{key:"parentInjector",get:function(){for(var e=this._view,t=this._elDef.parent;!t&&e;)t=$n(e),e=e.parent;return e?new Lr(e,t):new Lr(this._view,null)}},{key:"clear",value:function(){for(var e=this._embeddedViews.length-1;e>=0;e--){var t=Cr(this._data,e);Bn.destroyView(t)}}},{key:"get",value:function(e){var t=this._embeddedViews[e];if(t){var n=new jr(t);return n.attachToViewContainerRef(this),n}return null}},{key:"length",get:function(){return this._embeddedViews.length}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,a){var i=n||this.parentInjector;a||e instanceof en||(a=i.get(ze));var o=e.create(i,r,void 0,a);return this.insert(o.hostView,t),o}},{key:"insert",value:function(e,t){if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");var n,r,a,i,o,s=e;return n=this._view,r=this._data,a=t,i=s._view,o=r.viewContainer._embeddedViews,null==a&&(a=o.length),i.viewContainerParent=n,Ve(o,a,i),function(e,t){var n=Jn(t);if(n&&n!==e&&!(16&t.state)){t.state|=16;var r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(t),function(e,t){if(!(4&t.flags)){e.nodeFlags|=4,t.flags|=4;for(var n=t.parent;n;)n.childFlags|=4,n=n.parent}}(t.parent.def,t.parentNodeDef)}}(r,i),Bn.dirtyParentQueries(i),Or(r,a>0?o[a-1]:null,i),s.attachToViewContainerRef(this),e}},{key:"move",value:function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");var n,r,a,i,o,s=this._embeddedViews.indexOf(e._view);return n=this._data,r=s,a=t,i=n.viewContainer._embeddedViews,o=i[r],We(i,r),null==a&&(a=i.length),Ve(i,a,o),Bn.dirtyParentQueries(o),Sr(o),Or(n,a>0?i[a-1]:null,o),e}},{key:"indexOf",value:function(e){return this._embeddedViews.indexOf(e._view)}},{key:"remove",value:function(e){var t=Cr(this._data,e);t&&Bn.destroyView(t)}},{key:"detach",value:function(e){var t=Cr(this._data,e);return t?new jr(t):null}}]),e}();function Dr(e){return new jr(e)}var jr=function(){function e(t){_classCallCheck(this,e),this._view=t,this._viewContainerRef=null,this._appRef=null}return _createClass(e,[{key:"rootNodes",get:function(){return cr(this._view,0,void 0,void 0,e=[]),e;var e}},{key:"context",get:function(){return this._view.context}},{key:"destroyed",get:function(){return 0!=(128&this._view.state)}},{key:"markForCheck",value:function(){Zn(this._view)}},{key:"detach",value:function(){this._view.state&=-5}},{key:"detectChanges",value:function(){var e=this._view.root.rendererFactory;e.begin&&e.begin();try{Bn.checkAndUpdateView(this._view)}finally{e.end&&e.end()}}},{key:"checkNoChanges",value:function(){Bn.checkNoChangesView(this._view)}},{key:"reattach",value:function(){this._view.state|=4}},{key:"onDestroy",value:function(e){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(e)}},{key:"destroy",value:function(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Bn.destroyView(this._view)}},{key:"detachFromAppRef",value:function(){this._appRef=null,Sr(this._view),Bn.dirtyParentQueries(this._view)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}}]),e}();function Fr(e,t){return new Mr(e,t)}var Mr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this))._parentView=e,a._def=r,a}return _createClass(n,[{key:"createEmbeddedView",value:function(e){return new jr(Bn.createEmbeddedView(this._parentView,this._def,this._def.element.template,e))}},{key:"elementRef",get:function(){return new nn(Mn(this._parentView,this._def.nodeIndex).renderElement)}}]),n}(Sn);function Pr(e,t){return new Lr(e,t)}var Lr=function(){function e(t,n){_classCallCheck(this,e),this.view=t,this.elDef=n}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et.THROW_IF_NOT_FOUND;return Bn.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:e,tokenKey:Un(e)},t)}}]),e}();function zr(e,t){var n=e.def.nodes[t];if(1&n.flags){var r=Mn(e,n.nodeIndex);return n.element.template?r.template:r.renderElement}if(2&n.flags)return Fn(e,n.nodeIndex).renderText;if(20240&n.flags)return Pn(e,n.nodeIndex).instance;throw new Error("Illegal state: read nodeValue for node index "+t)}function Br(e){return new Vr(e.renderer)}var Vr=function(){function e(t){_classCallCheck(this,e),this.delegate=t}return _createClass(e,[{key:"selectRootElement",value:function(e){return this.delegate.selectRootElement(e)}},{key:"createElement",value:function(e,t){var n=_slicedToArray(mr(t),2),r=n[0],a=n[1],i=this.delegate.createElement(a,r);return e&&this.delegate.appendChild(e,i),i}},{key:"createViewRoot",value:function(e){return e}},{key:"createTemplateAnchor",value:function(e){var t=this.delegate.createComment("");return e&&this.delegate.appendChild(e,t),t}},{key:"createText",value:function(e,t){var n=this.delegate.createText(t);return e&&this.delegate.appendChild(e,n),n}},{key:"projectNodes",value:function(e,t){for(var n=0;n<t.length;n++)this.delegate.appendChild(e,t[n])}},{key:"attachViewAfter",value:function(e,t){for(var n=this.delegate.parentNode(e),r=this.delegate.nextSibling(e),a=0;a<t.length;a++)this.delegate.insertBefore(n,t[a],r)}},{key:"detachView",value:function(e){for(var t=0;t<e.length;t++){var n=e[t],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}},{key:"destroyView",value:function(e,t){for(var n=0;n<t.length;n++)this.delegate.destroyNode(t[n])}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"listenGlobal",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"setElementProperty",value:function(e,t,n){this.delegate.setProperty(e,t,n)}},{key:"setElementAttribute",value:function(e,t,n){var r=_slicedToArray(mr(t),2),a=r[0],i=r[1];null!=n?this.delegate.setAttribute(e,i,n,a):this.delegate.removeAttribute(e,i,a)}},{key:"setBindingDebugInfo",value:function(e,t,n){}},{key:"setElementClass",value:function(e,t,n){n?this.delegate.addClass(e,t):this.delegate.removeClass(e,t)}},{key:"setElementStyle",value:function(e,t,n){null!=n?this.delegate.setStyle(e,t,n):this.delegate.removeStyle(e,t)}},{key:"invokeElementMethod",value:function(e,t,n){e[t].apply(e,n)}},{key:"setText",value:function(e,t){this.delegate.setValue(e,t)}},{key:"animate",value:function(){throw new Error("Renderer.animate is no longer supported!")}}]),e}();function Wr(e,t,n,r){return new Ur(e,t,n,r)}var Ur=function(){function e(t,n,r,a){_classCallCheck(this,e),this._moduleType=t,this._parent=n,this._bootstrapComponents=r,this._def=a,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(e){for(var t=e._def,n=e._providers=new Array(t.providers.length),r=0;r<t.providers.length;r++){var a=t.providers[r];4096&a.flags||void 0===n[r]&&(n[r]=xr(e,a))}}(this)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pe.Default,r=0;return n&pe.SkipSelf?r|=1:n&pe.Self&&(r|=4),wr(this,{token:e,tokenKey:Un(e),flags:r},t)}},{key:"instance",get:function(){return this.get(this._moduleType)}},{key:"componentFactoryResolver",get:function(){return this.get(Jt)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The ng module ".concat(be(this.instance.constructor)," has already been destroyed."));this._destroyed=!0,function(e,t){for(var n=e._def,r=new Set,a=0;a<n.providers.length;a++)if(131072&n.providers[a].flags){var i=e._providers[a];if(i&&i!==gr){var o=i.ngOnDestroy;"function"!=typeof o||r.has(i)||(o.apply(i),r.add(i))}}}(this),this._destroyListeners.forEach((function(e){return e()}))}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}}]),e}(),Hr=Un((function e(){_classCallCheck(this,e)})),Gr=Un(sn),Kr=Un(nn),qr=Un(In),Xr=Un(Sn),Zr=Un(Ot),Yr=Un(Et),Qr=Un(Ee);function Jr(e,t,n,r,a,i,o,s){var u=[];if(o)for(var c in o){var l=_slicedToArray(o[c],2),h=l[0],d=l[1];u[h]={flags:8,name:c,nonMinifiedName:d,ns:null,securityContext:null,suffix:null}}var f=[];if(s)for(var p in s)f.push({type:1,propName:p,target:null,eventName:s[p]});return ea(e,t|=16384,n,r,a,a,i,u,f)}function $r(e,t,n,r,a){return ea(-1,e,t,0,n,r,a)}function ea(e,t,n,r,a,i,o,s,u){var c=ar(n),l=c.matchedQueries,h=c.references,d=c.matchedQueryIds;u||(u=[]),s||(s=[]),i=we(i);var f=ir(o,be(a));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:l,matchedQueryIds:d,references:h,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:vr(s),outputs:u,element:null,provider:{token:a,value:i,deps:f},text:null,query:null,ngContent:null}}function ta(e,t){return ia(e,t)}function na(e,t){for(var n=e;n.parent&&!tr(n);)n=n.parent;return oa(n.parent,$n(n),!0,t.provider.value,t.provider.deps)}function ra(e,t){var n=oa(e,t.parent,(32768&t.flags)>0,t.provider.value,t.provider.deps);if(t.outputs.length)for(var r=0;r<t.outputs.length;r++){var a=t.outputs[r],i=n[a.propName];if(!Kt(i))throw new Error("@Output ".concat(a.propName," not initialized in '").concat(n.constructor.name,"'."));var o=i.subscribe(aa(e,t.parent.nodeIndex,a.eventName));e.disposables[t.outputIndex+r]=o.unsubscribe.bind(o)}return n}function aa(e,t,n){return function(r){return Qn(e,t,n,r)}}function ia(e,t){var n=(8192&t.flags)>0,r=t.provider;switch(201347067&t.flags){case 512:return oa(e,t.parent,n,r.value,r.deps);case 1024:return function(e,t,n,r,a){var i=a.length;switch(i){case 0:return r();case 1:return r(ua(e,t,n,a[0]));case 2:return r(ua(e,t,n,a[0]),ua(e,t,n,a[1]));case 3:return r(ua(e,t,n,a[0]),ua(e,t,n,a[1]),ua(e,t,n,a[2]));default:for(var o=Array(i),s=0;s<i;s++)o[s]=ua(e,t,n,a[s]);return r.apply(void 0,o)}}(e,t.parent,n,r.value,r.deps);case 2048:return ua(e,t.parent,n,r.deps[0]);case 256:return r.value}}function oa(e,t,n,r,a){var i=a.length;switch(i){case 0:return new r;case 1:return new r(ua(e,t,n,a[0]));case 2:return new r(ua(e,t,n,a[0]),ua(e,t,n,a[1]));case 3:return new r(ua(e,t,n,a[0]),ua(e,t,n,a[1]),ua(e,t,n,a[2]));default:for(var o=new Array(i),s=0;s<i;s++)o[s]=ua(e,t,n,a[s]);return _construct(r,o)}}var sa={};function ua(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Et.THROW_IF_NOT_FOUND;if(8&r.flags)return r.token;var i=e;2&r.flags&&(a=null);var o=r.tokenKey;o===Zr&&(n=!(!t||!t.element.componentView)),t&&1&r.flags&&(n=!1,t=t.parent);for(var s=e;s;){if(t)switch(o){case Hr:return Br(ca(s,t,n));case Gr:return ca(s,t,n).renderer;case Kr:return new nn(Mn(s,t.nodeIndex).renderElement);case qr:return Mn(s,t.nodeIndex).viewContainer;case Xr:if(t.element.template)return Mn(s,t.nodeIndex).template;break;case Zr:return Dr(ca(s,t,n));case Yr:case Qr:return Pr(s,t);default:var u=(n?t.element.allProviders:t.element.publicProviders)[o];if(u){var c=Pn(s,u.nodeIndex);return c||(c={instance:ia(s,u)},s.nodes[u.nodeIndex]=c),c.instance}}n=tr(s),t=$n(s),s=s.parent,4&r.flags&&(s=null)}var l=i.root.injector.get(r.token,sa);return l!==sa||a===sa?l:i.root.ngModule.injector.get(r.token,a)}function ca(e,t,n){var r;if(n)r=Mn(e,t.nodeIndex).componentView;else for(r=e;r.parent&&!tr(r);)r=r.parent;return r}function la(e,t,n,r,a,i){if(32768&n.flags){var o=Mn(e,n.parent.nodeIndex).componentView;2&o.def.flags&&(o.state|=8)}if(t.instance[n.bindings[r].name]=a,524288&n.flags){i=i||{};var s=Wt.unwrap(e.oldValues[n.bindingIndex+r]);i[n.bindings[r].nonMinifiedName]=new qt(s,a,0!=(2&e.state))}return e.oldValues[n.bindingIndex+r]=a,i}function ha(e,t){if(e.def.nodeFlags&t)for(var n=e.def.nodes,r=0,a=0;a<n.length;a++){var i=n[a],o=i.parent;for(!o&&i.flags&t&&fa(e,a,i.flags&t,r++),0==(i.childFlags&t)&&(a+=i.childCount);o&&1&o.flags&&a===o.nodeIndex+o.childCount;)o.directChildFlags&t&&(r=da(e,o,t,r)),o=o.parent}}function da(e,t,n,r){for(var a=t.nodeIndex+1;a<=t.nodeIndex+t.childCount;a++){var i=e.def.nodes[a];i.flags&n&&fa(e,a,i.flags&n,r++),a+=i.childCount}return r}function fa(e,t,n,r){var a=Pn(e,t);if(a){var i=a.instance;i&&(Bn.setCurrentNode(e,t),1048576&n&&jn(e,512,r)&&i.ngAfterContentInit(),2097152&n&&i.ngAfterContentChecked(),4194304&n&&jn(e,768,r)&&i.ngAfterViewInit(),8388608&n&&i.ngAfterViewChecked(),131072&n&&i.ngOnDestroy())}}var pa=new Ie("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return He}}),ma={},va=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}(),ga=void 0,ya=["en",[["a","p"],["AM","PM"],ga],[["AM","PM"],ga,ga],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ga,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ga,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ga,"{1} 'at' {0}",ga],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],ba=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,n),(e=t.call(this)).__isAsync=r,e}return _createClass(n,[{key:"emit",value:function(e){_get(_getPrototypeOf(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var a,i=function(e){return null},o=function(){return null};e&&"object"==typeof e?(a=this.__isAsync?function(t){setTimeout((function(){return e.next(t)}))}:function(t){e.next(t)},e.error&&(i=this.__isAsync?function(t){setTimeout((function(){return e.error(t)}))}:function(t){e.error(t)}),e.complete&&(o=this.__isAsync?function(){setTimeout((function(){return e.complete()}))}:function(){e.complete()})):(a=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)},t&&(i=this.__isAsync?function(e){setTimeout((function(){return t(e)}))}:function(e){t(e)}),r&&(o=this.__isAsync?function(){setTimeout((function(){return r()}))}:function(){r()}));var s=_get(_getPrototypeOf(n.prototype),"subscribe",this).call(this,a,i,o);return e instanceof p&&e.add(s),s}}]),n}(A);function ka(){return this._results[zt()]()}var _a=function(){function e(){_classCallCheck(this,e),this.dirty=!0,this._results=[],this.changes=new ba,this.length=0;var t=zt(),n=e.prototype;n[t]||(n[t]=ka)}return _createClass(e,[{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e){this._results=function e(t,n){void 0===n&&(n=t);for(var r=0;r<t.length;r++){var a=t[r];Array.isArray(a)?(n===t&&(n=t.slice(0,r)),e(a,n)):n!==t&&n.push(a)}return n}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),wa=new Ie("Application Initializer"),xa=function(){function e(t){var n=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var a=this.appInits[r]();Gt(a)&&t.push(a)}Promise.all(t).then((function(){n()})).catch((function(t){e.reject(t)})),0===t.length&&n(),this.initialized=!0}}}]),e}(),Ca=new Ie("AppId");function Oa(){return"".concat(Sa()).concat(Sa()).concat(Sa())}function Sa(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var Ta=new Ie("Platform Initializer"),Ia=new Ie("Platform ID"),Ea=new Ie("appBootstrapListener"),Na=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}(),Aa=new Ie("LocaleId");function Ra(){throw new Error("Runtime compiler is not loaded")}var Da,ja,Fa=Ra,Ma=Ra,Pa=Ra,La=Ra,za=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=Fa,this.compileModuleAsync=Ma,this.compileModuleAndAllComponentsSync=Pa,this.compileModuleAndAllComponentsAsync=La}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}(),Ba=function e(){_classCallCheck(this,e)};var Va,Wa=!(!(Va=Te.wtf)||(Da=Va.trace,!Da)||(ja=Da.events,0));function Ua(e,t){return null}var Ha=Wa?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return ja.createScope(e,t)}:function(e,t){return Ua},Ga=Wa?function(e,t){return Da.leaveScope(e,t),t}:function(e,t){return t},Ka=Promise.resolve(0);function qa(e){"undefined"==typeof Zone?Ka.then((function(){e&&e.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var Xa=function(){function e(t){var n,r=t.enableLongStackTrace,a=void 0!==r&&r;if(_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ba(!1),this.onMicrotaskEmpty=new ba(!1),this.onStable=new ba(!1),this.onError=new ba(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),a&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(n=this)._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(e,t,r,a,i,o){try{return Ja(n),e.invokeTask(r,a,i,o)}finally{$a(n)}},onInvoke:function(e,t,r,a,i,o,s){try{return Ja(n),e.invoke(r,a,i,o,s)}finally{$a(n)}},onHasTask:function(e,t,r,a){e.hasTask(r,a),t===r&&("microTask"==a.change?(n.hasPendingMicrotasks=a.microTask,Qa(n)):"macroTask"==a.change&&(n.hasPendingMacrotasks=a.macroTask))},onHandleError:function(e,t,r,a){return e.handleError(r,a),n.runOutsideAngular((function(){return n.onError.emit(a)})),!1}})}return _createClass(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var a=this._inner,i=a.scheduleEventTask("NgZoneEvent: "+r,e,Ya,Za,Za);try{return a.runTask(i,t,n)}finally{a.cancelTask(i)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function Za(){}var Ya={};function Qa(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular((function(){return e.onStable.emit(null)}))}finally{e.isStable=!0}}}function Ja(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function $a(e){e._nesting--,Qa(e)}var ei,ti=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ba,this.onMicrotaskEmpty=new ba,this.onStable=new ba,this.onError=new ba}return _createClass(e,[{key:"run",value:function(e){return e()}},{key:"runGuarded",value:function(e){return e()}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e){return e()}}]),e}(),ni=function(){function e(t){var n=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.subscribe({next:function(){Xa.assertNotInAngularZone(),qa((function(){e._isZoneStable=!0,e._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())qa((function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1}));else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}})):[]}},{key:"addCallback",value:function(e,t,n){var r=this,a=-1;t&&t>0&&(a=setTimeout((function(){r._callbacks=r._callbacks.filter((function(e){return e.timeoutId!==a})),e(r._didWork,r.getPendingTasks())}),t)),this._callbacks.push({doneCb:e,timeoutId:a,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}(),ri=function(){function e(){_classCallCheck(this,e),this._applications=new Map,ai.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return ai.findTestabilityInTree(this,e,t)}}]),e}(),ai=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),ii=new Ie("AllowMultipleToken"),oi=function e(t,n){_classCallCheck(this,e),this.name=t,this.token=n};function si(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: "+t,a=new Ie(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=ui();if(!i||i.injector.get(ii,!1))if(e)e(n.concat(t).concat({provide:a,useValue:!0}));else{var o=n.concat(t).concat({provide:a,useValue:!0});!function(e){if(ei&&!ei.destroyed&&!ei.injector.get(ii,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");ei=e.get(ci);var t=e.get(Ta,null);t&&t.forEach((function(e){return e()}))}(Et.create({providers:o,name:r}))}return function(e){var t=ui();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(a)}}function ui(){return ei&&!ei.destroyed?ei:null}var ci=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,r=this,a="noop"===(n=t?t.ngZone:void 0)?new ti:("zone.js"===n?void 0:n)||new Xa({enableLongStackTrace:Qe()}),i=[{provide:Xa,useValue:a}];return a.run((function(){var t=Et.create({providers:i,parent:r.injector,name:e.moduleType.name}),n=e.create(t),o=n.injector.get(Xe,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy((function(){return fi(r._modules,n)})),a.runOutsideAngular((function(){return a.onError.subscribe({next:function(e){o.handleError(e)}})})),function(e,t,a){try{var i=((o=n.injector.get(xa)).runInitializers(),o.donePromise.then((function(){return r._moduleDoBootstrap(n),n})));return Gt(i)?i.catch((function(n){throw t.runOutsideAngular((function(){return e.handleError(n)})),n})):i}catch(s){throw t.runOutsideAngular((function(){return e.handleError(s)})),s}var o}(o,a)}))}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=li({},n);return function(e,t,n){return e.get(Ba).createCompiler([t]).compileModuleAsync(n)}(this.injector,r,e).then((function(e){return t.bootstrapModuleFactory(e,r)}))}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(di);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach((function(e){return t.bootstrap(e)}));else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(be(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(e){return e.destroy()})),this._destroyListeners.forEach((function(e){return e()})),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();function li(e,t){return Array.isArray(t)?t.reduce(li,e):Object.assign({},e,t)}var hi,di=((hi=function(){function e(t,n,r,a,i,o){var s=this;_classCallCheck(this,e),this._zone=t,this._console=n,this._injector=r,this._exceptionHandler=a,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Qe(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var u=new C((function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){e.next(s._stable),e.complete()}))})),c=new C((function(e){var t;s._zone.runOutsideAngular((function(){t=s._zone.onStable.subscribe((function(){Xa.assertNotInAngularZone(),qa((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,e.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){Xa.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){e.next(!1)})))}));return function(){t.unsubscribe(),n.unsubscribe()}}));this.isStable=te(u,c.pipe((function(e){return ne()((t=ue,function(e){var n;n="function"==typeof t?t:function(){return t};var r=Object.create(e,oe);return r.source=e,r.subjectFactory=n,r})(e));var t})))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof Xt?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var a=n instanceof en?null:this._injector.get(ze),i=n.create(Et.NULL,[],t||n.selector,a);i.onDestroy((function(){r._unloadComponent(i)}));var o=i.injector.get(ni,null);return o&&i.injector.get(ri).registerApplication(i.location.nativeElement,o),this._loadComponent(i),Qe()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}},{key:"tick",value:function(){var t=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");var n=e._tickScope();try{this._runningTick=!0;var r,a=_createForOfIteratorHelper(this._views);try{for(a.s();!(r=a.n()).done;)r.value.detectChanges()}catch(s){a.e(s)}finally{a.f()}if(this._enforceNoNewChanges){var i,o=_createForOfIteratorHelper(this._views);try{for(o.s();!(i=o.n()).done;)i.value.checkNoChanges()}catch(s){o.e(s)}finally{o.f()}}}catch(u){this._zone.runOutsideAngular((function(){return t._exceptionHandler.handleError(u)}))}finally{this._runningTick=!1,Ga(n)}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;fi(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Ea,[]).concat(this._bootstrapListeners).forEach((function(t){return t(e)}))}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),fi(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(e){return e.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),e}())._tickScope=Ha("ApplicationRef#tick()"),hi);function fi(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var pi=function e(){_classCallCheck(this,e)},mi=function e(){_classCallCheck(this,e)},vi={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},gi=function(){function e(t,n){_classCallCheck(this,e),this._compiler=t,this._config=n||vi}return _createClass(e,[{key:"load",value:function(e){return this._compiler instanceof za?this.loadFactory(e):this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,r=_slicedToArray(e.split("#"),2),a=r[0],i=r[1];return void 0===i&&(i="default"),n("zn8P")(a).then((function(e){return e[i]})).then((function(e){return yi(e,a,i)})).then((function(e){return t._compiler.compileModuleAsync(e)}))}},{key:"loadFactory",value:function(e){var t=_slicedToArray(e.split("#"),2),r=t[0],a=t[1],i="NgFactory";return void 0===a&&(a="default",i=""),n("zn8P")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then((function(e){return e[a+i]})).then((function(e){return yi(e,r,a)}))}}]),e}();function yi(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var bi=function e(t,n){_classCallCheck(this,e),this.name=t,this.callback=n},ki=function(){function e(t,n,r){_classCallCheck(this,e),this.listeners=[],this.parent=null,this._debugContext=r,this.nativeNode=t,n&&n instanceof _i&&n.addChild(this)}return _createClass(e,[{key:"injector",get:function(){return this._debugContext.injector}},{key:"componentInstance",get:function(){return this._debugContext.component}},{key:"context",get:function(){return this._debugContext.context}},{key:"references",get:function(){return this._debugContext.references}},{key:"providerTokens",get:function(){return this._debugContext.providerTokens}}]),e}(),_i=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e,r,a)).properties={},i.attributes={},i.classes={},i.styles={},i.childNodes=[],i.nativeElement=e,i}return _createClass(n,[{key:"addChild",value:function(e){e&&(this.childNodes.push(e),e.parent=this)}},{key:"removeChild",value:function(e){var t=this.childNodes.indexOf(e);-1!==t&&(e.parent=null,this.childNodes.splice(t,1))}},{key:"insertChildrenAfter",value:function(e,t){var n,r=this,a=this.childNodes.indexOf(e);-1!==a&&((n=this.childNodes).splice.apply(n,[a+1,0].concat(_toConsumableArray(t))),t.forEach((function(t){t.parent&&t.parent.removeChild(t),e.parent=r})))}},{key:"insertBefore",value:function(e,t){var n=this.childNodes.indexOf(e);-1===n?this.addChild(t):(t.parent&&t.parent.removeChild(t),t.parent=this,this.childNodes.splice(n,0,t))}},{key:"query",value:function(e){return this.queryAll(e)[0]||null}},{key:"queryAll",value:function(e){var t=[];return function e(t,r,a){t.childNodes.forEach((function(t){t instanceof n&&(r(t)&&a.push(t),e(t,r,a))}))}(this,e,t),t}},{key:"queryAllNodes",value:function(e){var t=[];return function e(t,r,a){t instanceof n&&t.childNodes.forEach((function(t){r(t)&&a.push(t),t instanceof n&&e(t,r,a)}))}(this,e,t),t}},{key:"children",get:function(){return this.childNodes.filter((function(e){return e instanceof n}))}},{key:"triggerEventHandler",value:function(e,t){this.listeners.forEach((function(n){n.name==e&&n.callback(t)}))}}]),n}(ki),wi=new Map,xi=function(e){return wi.get(e)||null};function Ci(e){wi.set(e.nativeNode,e)}var Oi=si(null,"core",[{provide:Ia,useValue:"unknown"},{provide:ci,deps:[Et]},{provide:ri,deps:[]},{provide:Na,deps:[]}]);function Si(){return Cn}function Ti(){return On}function Ii(e){return e||"en-US"}function Ei(e){var t=[];return e.onStable.subscribe((function(){for(;t.length;)t.pop()()})),function(e){t.push(e)}}var Ni=function e(t){_classCallCheck(this,e)};function Ai(e,t,n,r,a,i){e|=1;var o=ar(t),s=o.matchedQueries,u=o.references;return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:e,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:s,matchedQueryIds:o.matchedQueryIds,references:u,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:i?ur(i):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:a||Vn},provider:null,text:null,query:null,ngContent:null}}function Ri(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[],u=arguments.length>7?arguments[7]:void 0,c=arguments.length>8?arguments[8]:void 0,l=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0,d=arguments.length>11?arguments[11]:void 0;l||(l=Vn);var f=ar(n),p=f.matchedQueries,m=f.references,v=f.matchedQueryIds,g=null,y=null;i&&(g=(o=_slicedToArray(mr(i),2))[0],y=o[1]),u=u||[];for(var b=new Array(u.length),k=0;k<u.length;k++){var _=_slicedToArray(u[k],3),w=_[0],x=_[1],C=_[2],O=mr(x),S=_slicedToArray(O,2),T=S[0],I=S[1],E=void 0,N=void 0;switch(15&w){case 4:N=C;break;case 1:case 8:E=C}b[k]={flags:w,ns:T,name:I,nonMinifiedName:I,securityContext:E,suffix:N}}c=c||[];for(var A=new Array(c.length),R=0;R<c.length;R++){var D=_slicedToArray(c[R],2),j=D[0],F=D[1];A[R]={type:0,target:j,eventName:F,propName:null}}var M=(s=s||[]).map((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1],a=_slicedToArray(mr(n),2);return[a[0],a[1],r]}));return d=function(e){if(e&&"$$undefined"===e.id){var t=null!=e.encapsulation&&e.encapsulation!==Ue.None||e.styles.length||Object.keys(e.data).length;e.id=t?"c"+Gn++:"$$empty"}return e&&"$$empty"===e.id&&(e=null),e||null}(d),h&&(t|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:v,references:m,ngContentIndex:r,childCount:a,bindings:b,bindingFlags:vr(b),outputs:A,element:{ns:g,name:y,attrs:M,template:null,componentProvider:null,componentView:h||null,componentRendererType:d,publicProviders:null,allProviders:null,handleEvent:l||Vn},provider:null,text:null,query:null,ngContent:null}}function Di(e,t,n){var r,a=n.element,i=e.root.selectorOrNode,o=e.renderer;if(e.parent||!i){r=a.name?o.createElement(a.name,a.ns):o.createComment("");var s=or(e,t,n);s&&o.appendChild(s,r)}else r=o.selectRootElement(i,!!a.componentRendererType&&a.componentRendererType.encapsulation===Ue.ShadowDom);if(a.attrs)for(var u=0;u<a.attrs.length;u++){var c=_slicedToArray(a.attrs[u],3),l=c[0],h=c[1],d=c[2];o.setAttribute(r,h,d,l)}return r}function ji(e,t,n,r){for(var a=0;a<n.outputs.length;a++){var i=n.outputs[a],o=Fi(e,n.nodeIndex,(h=i.eventName,(l=i.target)?"".concat(l,":").concat(h):h)),s=i.target,u=e;"component"===i.target&&(s=null,u=t);var c=u.renderer.listen(s||r,i.eventName,o);e.disposables[n.outputIndex+a]=c}var l,h}function Fi(e,t,n){return function(r){return Qn(e,t,n,r)}}function Mi(e,t,n,r){if(!qn(e,t,n,r))return!1;var a=t.bindings[n],i=Mn(e,t.nodeIndex),o=i.renderElement,s=a.name;switch(15&a.flags){case 1:!function(e,t,n,r,a,i){var o=t.securityContext,s=o?e.root.sanitizer.sanitize(o,i):i;s=null!=s?s.toString():null;var u=e.renderer;null!=i?u.setAttribute(n,a,s,r):u.removeAttribute(n,a,r)}(e,a,o,a.ns,s,r);break;case 2:!function(e,t,n,r){var a=e.renderer;r?a.addClass(t,n):a.removeClass(t,n)}(e,o,s,r);break;case 4:!function(e,t,n,r,a){var i=e.root.sanitizer.sanitize(bt.STYLE,a);if(null!=i){i=i.toString();var o=t.suffix;null!=o&&(i+=o)}else i=null;var s=e.renderer;null!=i?s.setStyle(n,r,i):s.removeStyle(n,r)}(e,a,o,s,r);break;case 8:!function(e,t,n,r,a){var i=t.securityContext,o=i?e.root.sanitizer.sanitize(i,a):a;e.renderer.setProperty(n,r,o)}(33554432&t.flags&&32&a.flags?i.componentView:e,a,o,s,r)}return!0}function Pi(e,t,n){var r=[];for(var a in n)r.push({propName:a,bindingType:n[a]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:t,filterId:rr(t),bindings:r},ngContent:null}}function Li(e){for(var t=e.def.nodeMatchedQueries;e.parent&&nr(e);){var n=e.parentNodeDef;e=e.parent;for(var r=n.nodeIndex+n.childCount,a=0;a<=r;a++){var i=e.def.nodes[a];67108864&i.flags&&536870912&i.flags&&(i.query.filterId&t)===i.query.filterId&&zn(e,a).setDirty(),!(1&i.flags&&a+i.childCount<n.nodeIndex)&&67108864&i.childFlags&&536870912&i.childFlags||(a+=i.childCount)}}if(134217728&e.def.nodeFlags)for(var o=0;o<e.def.nodes.length;o++){var s=e.def.nodes[o];134217728&s.flags&&536870912&s.flags&&zn(e,o).setDirty(),o+=s.childCount}}function zi(e,t){var n=zn(e,t.nodeIndex);if(n.dirty){var r,a=void 0;if(67108864&t.flags){var i=t.parent.parent;a=Bi(e,i.nodeIndex,i.nodeIndex+i.childCount,t.query,[]),r=Pn(e,t.parent.nodeIndex).instance}else 134217728&t.flags&&(a=Bi(e,0,e.def.nodes.length-1,t.query,[]),r=e.component);n.reset(a);for(var o=t.query.bindings,s=!1,u=0;u<o.length;u++){var c=o[u],l=void 0;switch(c.bindingType){case 0:l=n.first;break;case 1:l=n,s=!0}r[c.propName]=l}s&&n.notifyOnChanges()}}function Bi(e,t,n,r,a){for(var i=t;i<=n;i++){var o=e.def.nodes[i],s=o.matchedQueries[r.id];if(null!=s&&a.push(Vi(e,o,s)),1&o.flags&&o.element.template&&(o.element.template.nodeMatchedQueries&r.filterId)===r.filterId){var u=Mn(e,i);if((o.childMatchedQueries&r.filterId)===r.filterId&&(Bi(e,i+1,i+o.childCount,r,a),i+=o.childCount),16777216&o.flags)for(var c=u.viewContainer._embeddedViews,l=0;l<c.length;l++){var h=c[l],d=Jn(h);d&&d===u&&Bi(h,0,h.def.nodes.length-1,r,a)}var f=u.template._projectedViews;if(f)for(var p=0;p<f.length;p++){var m=f[p];Bi(m,0,m.def.nodes.length-1,r,a)}}(o.childMatchedQueries&r.filterId)!==r.filterId&&(i+=o.childCount)}return a}function Vi(e,t,n){if(null!=n)switch(n){case 1:return Mn(e,t.nodeIndex).renderElement;case 0:return new nn(Mn(e,t.nodeIndex).renderElement);case 2:return Mn(e,t.nodeIndex).template;case 3:return Mn(e,t.nodeIndex).viewContainer;case 4:return Pn(e,t.nodeIndex).instance}}function Wi(e,t){return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:8,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:e,childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:null,ngContent:{index:t}}}function Ui(e,t,n){var r=or(e,t,n);r&&hr(e,n.ngContent.index,1,r,null,void 0)}function Hi(e,t,n){for(var r=new Array(n.length),a=0;a<n.length;a++){var i=n[a];r[a]={flags:8,name:i,ns:null,nonMinifiedName:i,securityContext:null,suffix:null}}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:-1,childCount:0,bindings:r,bindingFlags:vr(r),outputs:[],element:null,provider:null,text:null,query:null,ngContent:null}}function Gi(e,t,n){for(var r=new Array(n.length-1),a=1;a<n.length;a++)r[a-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[a]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function Ki(e,t,n){var r,a=e.renderer;r=a.createText(n.text.prefix);var i=or(e,t,n);return i&&a.appendChild(i,r),{renderText:r}}function qi(e,t){return(null!=e?e.toString():"")+t.suffix}function Xi(e,t,n,r){for(var a=0,i=0,o=0,s=0,u=0,c=null,l=null,h=!1,d=!1,f=null,p=0;p<t.length;p++){var m=t[p];if(m.nodeIndex=p,m.parent=c,m.bindingIndex=a,m.outputIndex=i,m.renderParent=l,o|=m.flags,u|=m.matchedQueryIds,m.element){var v=m.element;v.publicProviders=c?c.element.publicProviders:Object.create(null),v.allProviders=v.publicProviders,h=!1,d=!1,m.element.template&&(u|=m.element.template.nodeMatchedQueries)}if(Yi(c,m,t.length),a+=m.bindings.length,i+=m.outputs.length,!l&&3&m.flags&&(f=m),20224&m.flags){h||(h=!0,c.element.publicProviders=Object.create(c.element.publicProviders),c.element.allProviders=c.element.publicProviders);var g=0!=(32768&m.flags);0==(8192&m.flags)||g?c.element.publicProviders[Un(m.provider.token)]=m:(d||(d=!0,c.element.allProviders=Object.create(c.element.publicProviders)),c.element.allProviders[Un(m.provider.token)]=m),g&&(c.element.componentProvider=m)}if(c?(c.childFlags|=m.flags,c.directChildFlags|=m.flags,c.childMatchedQueries|=m.matchedQueryIds,m.element&&m.element.template&&(c.childMatchedQueries|=m.element.template.nodeMatchedQueries)):s|=m.flags,m.childCount>0)c=m,Zi(m)||(l=m);else for(;c&&p===c.nodeIndex+c.childCount;){var y=c.parent;y&&(y.childFlags|=c.childFlags,y.childMatchedQueries|=c.childMatchedQueries),l=(c=y)&&Zi(c)?c.renderParent:c}}return{factory:null,nodeFlags:o,rootNodeFlags:s,nodeMatchedQueries:u,flags:e,nodes:t,updateDirectives:n||Vn,updateRenderer:r||Vn,handleEvent:function(e,n,r,a){return t[n].element.handleEvent(e,r,a)},bindingCount:a,outputCount:i,lastRenderRootNode:f}}function Zi(e){return 0!=(1&e.flags)&&null===e.element.name}function Yi(e,t,n){var r=t.element&&t.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error("Illegal State: Last root node of a template can't have embedded views, at index ".concat(t.nodeIndex,"!"))}if(20224&t.flags&&0==(1&(e?e.flags:0)))throw new Error("Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ".concat(t.nodeIndex,"!"));if(t.query){if(67108864&t.flags&&(!e||0==(16384&e.flags)))throw new Error("Illegal State: Content Query nodes need to be children of directives, at index ".concat(t.nodeIndex,"!"));if(134217728&t.flags&&e)throw new Error("Illegal State: View Query nodes have to be top level nodes, at index ".concat(t.nodeIndex,"!"))}if(t.childCount){var a=e?e.nodeIndex+e.childCount:n-1;if(t.nodeIndex<=a&&t.nodeIndex+t.childCount>a)throw new Error("Illegal State: childCount of node leads outside of parent, at index ".concat(t.nodeIndex,"!"))}}function Qi(e,t,n,r){var a=eo(e.root,e.renderer,e,t,n);return to(a,e.component,r),no(a),a}function Ji(e,t,n){var r=eo(e,e.renderer,null,null,t);return to(r,n,n),no(r),r}function $i(e,t,n,r){var a,i=t.element.componentRendererType;return a=i?e.root.rendererFactory.createRenderer(r,i):e.root.renderer,eo(e.root,a,e,t.element.componentProvider,n)}function eo(e,t,n,r,a){var i=new Array(a.nodes.length),o=a.outputCount?new Array(a.outputCount):null;return{def:a,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:i,state:13,root:e,renderer:t,oldValues:new Array(a.bindingCount),disposables:o,initIndex:-1}}function to(e,t,n){e.component=t,e.context=n}function no(e){var t;tr(e)&&(t=Mn(e.parent,e.parentNodeDef.parent.nodeIndex).renderElement);for(var n=e.def,r=e.nodes,a=0;a<n.nodes.length;a++){var i=n.nodes[a],o=void 0;switch(Bn.setCurrentNode(e,a),201347067&i.flags){case 1:var s=Di(e,t,i),u=void 0;if(33554432&i.flags){var c=ur(i.element.componentView);u=Bn.createComponentView(e,i,c,s)}ji(e,u,i,s),o={renderElement:s,componentView:u,viewContainer:null,template:i.element.template?Fr(e,i):void 0},16777216&i.flags&&(o.viewContainer=Ar(e,i,o));break;case 2:o=Ki(e,t,i);break;case 512:case 1024:case 2048:case 256:(o=r[a])||4096&i.flags||(o={instance:ta(e,i)});break;case 16:o={instance:na(e,i)};break;case 16384:(o=r[a])||(o={instance:ra(e,i)}),32768&i.flags&&to(Mn(e,i.parent.nodeIndex).componentView,o.instance,o.instance);break;case 32:case 64:case 128:o={value:void 0};break;case 67108864:case 134217728:o=new _a;break;case 8:Ui(e,t,i),o=void 0}r[a]=o}ho(e,lo.CreateViewNodes),vo(e,201326592,268435456,0)}function ro(e){oo(e),Bn.updateDirectives(e,1),fo(e,lo.CheckNoChanges),Bn.updateRenderer(e,1),ho(e,lo.CheckNoChanges),e.state&=-97}function ao(e){1&e.state?(e.state&=-2,e.state|=2):e.state&=-3,Dn(e,0,256),oo(e),Bn.updateDirectives(e,0),fo(e,lo.CheckAndUpdate),vo(e,67108864,536870912,0);var t=Dn(e,256,512);ha(e,2097152|(t?1048576:0)),Bn.updateRenderer(e,0),ho(e,lo.CheckAndUpdate),vo(e,134217728,536870912,0),ha(e,8388608|((t=Dn(e,512,768))?4194304:0)),2&e.def.flags&&(e.state&=-9),e.state&=-97,Dn(e,768,1024)}function io(e,t,n,r,a,i,o,s,u,c,l,h,d){return 0===n?function(e,t,n,r,a,i,o,s,u,c,l,h){switch(201347067&t.flags){case 1:return function(e,t,n,r,a,i,o,s,u,c,l,h){var d=t.bindings.length,f=!1;return d>0&&Mi(e,t,0,n)&&(f=!0),d>1&&Mi(e,t,1,r)&&(f=!0),d>2&&Mi(e,t,2,a)&&(f=!0),d>3&&Mi(e,t,3,i)&&(f=!0),d>4&&Mi(e,t,4,o)&&(f=!0),d>5&&Mi(e,t,5,s)&&(f=!0),d>6&&Mi(e,t,6,u)&&(f=!0),d>7&&Mi(e,t,7,c)&&(f=!0),d>8&&Mi(e,t,8,l)&&(f=!0),d>9&&Mi(e,t,9,h)&&(f=!0),f}(e,t,n,r,a,i,o,s,u,c,l,h);case 2:return function(e,t,n,r,a,i,o,s,u,c,l,h){var d=!1,f=t.bindings,p=f.length;if(p>0&&qn(e,t,0,n)&&(d=!0),p>1&&qn(e,t,1,r)&&(d=!0),p>2&&qn(e,t,2,a)&&(d=!0),p>3&&qn(e,t,3,i)&&(d=!0),p>4&&qn(e,t,4,o)&&(d=!0),p>5&&qn(e,t,5,s)&&(d=!0),p>6&&qn(e,t,6,u)&&(d=!0),p>7&&qn(e,t,7,c)&&(d=!0),p>8&&qn(e,t,8,l)&&(d=!0),p>9&&qn(e,t,9,h)&&(d=!0),d){var m=t.text.prefix;p>0&&(m+=qi(n,f[0])),p>1&&(m+=qi(r,f[1])),p>2&&(m+=qi(a,f[2])),p>3&&(m+=qi(i,f[3])),p>4&&(m+=qi(o,f[4])),p>5&&(m+=qi(s,f[5])),p>6&&(m+=qi(u,f[6])),p>7&&(m+=qi(c,f[7])),p>8&&(m+=qi(l,f[8])),p>9&&(m+=qi(h,f[9]));var v=Fn(e,t.nodeIndex).renderText;e.renderer.setValue(v,m)}return d}(e,t,n,r,a,i,o,s,u,c,l,h);case 16384:return function(e,t,n,r,a,i,o,s,u,c,l,h){var d=Pn(e,t.nodeIndex),f=d.instance,p=!1,m=void 0,v=t.bindings.length;return v>0&&Kn(e,t,0,n)&&(p=!0,m=la(e,d,t,0,n,m)),v>1&&Kn(e,t,1,r)&&(p=!0,m=la(e,d,t,1,r,m)),v>2&&Kn(e,t,2,a)&&(p=!0,m=la(e,d,t,2,a,m)),v>3&&Kn(e,t,3,i)&&(p=!0,m=la(e,d,t,3,i,m)),v>4&&Kn(e,t,4,o)&&(p=!0,m=la(e,d,t,4,o,m)),v>5&&Kn(e,t,5,s)&&(p=!0,m=la(e,d,t,5,s,m)),v>6&&Kn(e,t,6,u)&&(p=!0,m=la(e,d,t,6,u,m)),v>7&&Kn(e,t,7,c)&&(p=!0,m=la(e,d,t,7,c,m)),v>8&&Kn(e,t,8,l)&&(p=!0,m=la(e,d,t,8,l,m)),v>9&&Kn(e,t,9,h)&&(p=!0,m=la(e,d,t,9,h,m)),m&&f.ngOnChanges(m),65536&t.flags&&jn(e,256,t.nodeIndex)&&f.ngOnInit(),262144&t.flags&&f.ngDoCheck(),p}(e,t,n,r,a,i,o,s,u,c,l,h);case 32:case 64:case 128:return function(e,t,n,r,a,i,o,s,u,c,l,h){var d=t.bindings,f=!1,p=d.length;if(p>0&&qn(e,t,0,n)&&(f=!0),p>1&&qn(e,t,1,r)&&(f=!0),p>2&&qn(e,t,2,a)&&(f=!0),p>3&&qn(e,t,3,i)&&(f=!0),p>4&&qn(e,t,4,o)&&(f=!0),p>5&&qn(e,t,5,s)&&(f=!0),p>6&&qn(e,t,6,u)&&(f=!0),p>7&&qn(e,t,7,c)&&(f=!0),p>8&&qn(e,t,8,l)&&(f=!0),p>9&&qn(e,t,9,h)&&(f=!0),f){var m,v=Ln(e,t.nodeIndex);switch(201347067&t.flags){case 32:m=new Array(d.length),p>0&&(m[0]=n),p>1&&(m[1]=r),p>2&&(m[2]=a),p>3&&(m[3]=i),p>4&&(m[4]=o),p>5&&(m[5]=s),p>6&&(m[6]=u),p>7&&(m[7]=c),p>8&&(m[8]=l),p>9&&(m[9]=h);break;case 64:m={},p>0&&(m[d[0].name]=n),p>1&&(m[d[1].name]=r),p>2&&(m[d[2].name]=a),p>3&&(m[d[3].name]=i),p>4&&(m[d[4].name]=o),p>5&&(m[d[5].name]=s),p>6&&(m[d[6].name]=u),p>7&&(m[d[7].name]=c),p>8&&(m[d[8].name]=l),p>9&&(m[d[9].name]=h);break;case 128:var g=n;switch(p){case 1:m=g.transform(n);break;case 2:m=g.transform(r);break;case 3:m=g.transform(r,a);break;case 4:m=g.transform(r,a,i);break;case 5:m=g.transform(r,a,i,o);break;case 6:m=g.transform(r,a,i,o,s);break;case 7:m=g.transform(r,a,i,o,s,u);break;case 8:m=g.transform(r,a,i,o,s,u,c);break;case 9:m=g.transform(r,a,i,o,s,u,c,l);break;case 10:m=g.transform(r,a,i,o,s,u,c,l,h)}}v.value=m}return f}(e,t,n,r,a,i,o,s,u,c,l,h);default:throw"unreachable"}}(e,t,r,a,i,o,s,u,c,l,h,d):function(e,t,n){switch(201347067&t.flags){case 1:return function(e,t,n){for(var r=!1,a=0;a<n.length;a++)Mi(e,t,a,n[a])&&(r=!0);return r}(e,t,n);case 2:return function(e,t,n){for(var r=t.bindings,a=!1,i=0;i<n.length;i++)qn(e,t,i,n[i])&&(a=!0);if(a){for(var o="",s=0;s<n.length;s++)o+=qi(n[s],r[s]);o=t.text.prefix+o;var u=Fn(e,t.nodeIndex).renderText;e.renderer.setValue(u,o)}return a}(e,t,n);case 16384:return function(e,t,n){for(var r=Pn(e,t.nodeIndex),a=r.instance,i=!1,o=void 0,s=0;s<n.length;s++)Kn(e,t,s,n[s])&&(i=!0,o=la(e,r,t,s,n[s],o));return o&&a.ngOnChanges(o),65536&t.flags&&jn(e,256,t.nodeIndex)&&a.ngOnInit(),262144&t.flags&&a.ngDoCheck(),i}(e,t,n);case 32:case 64:case 128:return function(e,t,n){for(var r=t.bindings,a=!1,i=0;i<n.length;i++)qn(e,t,i,n[i])&&(a=!0);if(a){var o,s=Ln(e,t.nodeIndex);switch(201347067&t.flags){case 32:o=n;break;case 64:o={};for(var u=0;u<n.length;u++)o[r[u].name]=n[u];break;case 128:var c=n[0],l=n.slice(1);o=c.transform.apply(c,_toConsumableArray(l))}s.value=o}return a}(e,t,n);default:throw"unreachable"}}(e,t,r)}function oo(e){var t=e.def;if(4&t.nodeFlags)for(var n=0;n<t.nodes.length;n++){var r=t.nodes[n];if(4&r.flags){var a=Mn(e,n).template._projectedViews;if(a)for(var i=0;i<a.length;i++){var o=a[i];o.state|=32,Yn(o,e)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function so(e,t,n,r,a,i,o,s,u,c,l,h,d){return 0===n?function(e,t,n,r,a,i,o,s,u,c,l,h){var d=t.bindings.length;d>0&&Xn(e,t,0,n),d>1&&Xn(e,t,1,r),d>2&&Xn(e,t,2,a),d>3&&Xn(e,t,3,i),d>4&&Xn(e,t,4,o),d>5&&Xn(e,t,5,s),d>6&&Xn(e,t,6,u),d>7&&Xn(e,t,7,c),d>8&&Xn(e,t,8,l),d>9&&Xn(e,t,9,h)}(e,t,r,a,i,o,s,u,c,l,h,d):function(e,t,n){for(var r=0;r<n.length;r++)Xn(e,t,r,n[r])}(e,t,r),!1}function uo(e,t){if(zn(e,t.nodeIndex).dirty)throw Nn(Bn.createDebugContext(e,t.nodeIndex),"Query ".concat(t.query.id," not dirty"),"Query ".concat(t.query.id," dirty"),0!=(1&e.state))}function co(e){if(!(128&e.state)){if(fo(e,lo.Destroy),ho(e,lo.Destroy),ha(e,131072),e.disposables)for(var t=0;t<e.disposables.length;t++)e.disposables[t]();!function(e){if(16&e.state){var t=Jn(e);if(t){var n=t.template._projectedViews;n&&(We(n,n.indexOf(e)),Bn.dirtyParentQueries(e))}}}(e),e.renderer.destroyNode&&function(e){for(var t=e.def.nodes.length,n=0;n<t;n++){var r=e.def.nodes[n];1&r.flags?e.renderer.destroyNode(Mn(e,n).renderElement):2&r.flags?e.renderer.destroyNode(Fn(e,n).renderText):(67108864&r.flags||134217728&r.flags)&&zn(e,n).destroy()}}(e),tr(e)&&e.renderer.destroy(),e.state|=128}}var lo=function(){var e={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return e[e.CreateViewNodes]="CreateViewNodes",e[e.CheckNoChanges]="CheckNoChanges",e[e.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",e[e.CheckAndUpdate]="CheckAndUpdate",e[e.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",e[e.Destroy]="Destroy",e}();function ho(e,t){var n=e.def;if(33554432&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var a=n.nodes[r];33554432&a.flags?po(Mn(e,r).componentView,t):0==(33554432&a.childFlags)&&(r+=a.childCount)}}function fo(e,t){var n=e.def;if(16777216&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var a=n.nodes[r];if(16777216&a.flags)for(var i=Mn(e,r).viewContainer._embeddedViews,o=0;o<i.length;o++)po(i[o],t);else 0==(16777216&a.childFlags)&&(r+=a.childCount)}}function po(e,t){var n=e.state;switch(t){case lo.CheckNoChanges:0==(128&n)&&(12==(12&n)?ro(e):64&n&&mo(e,lo.CheckNoChangesProjectedViews));break;case lo.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?ro(e):64&n&&mo(e,t));break;case lo.CheckAndUpdate:0==(128&n)&&(12==(12&n)?ao(e):64&n&&mo(e,lo.CheckAndUpdateProjectedViews));break;case lo.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?ao(e):64&n&&mo(e,t));break;case lo.Destroy:co(e);break;case lo.CreateViewNodes:no(e)}}function mo(e,t){fo(e,t),ho(e,t)}function vo(e,t,n,r){if(e.def.nodeFlags&t&&e.def.nodeFlags&n)for(var a=e.def.nodes.length,i=0;i<a;i++){var o=e.def.nodes[i];if(o.flags&t&&o.flags&n)switch(Bn.setCurrentNode(e,o.nodeIndex),r){case 0:zi(e,o);break;case 1:uo(e,o)}o.childFlags&t&&o.childFlags&n||(i+=o.childCount)}}var go=!1;function yo(e,t,n,r,a,i){var o=a.injector.get(an);return Ji(ko(e,a,o,t,n),r,i)}function bo(e,t,n,r,a,i){var o=a.injector.get(an),s=ko(e,a,new Jo(o),t,n),u=No(r);return Yo(zo.create,Ji,null,[s,u,i])}function ko(e,t,n,r,a){var i=t.injector.get(kt),o=t.injector.get(Xe),s=n.createRenderer(null,null);return{ngModule:t,injector:e,projectableNodes:r,selectorOrNode:a,sanitizer:i,rendererFactory:n,renderer:s,errorHandler:o}}function _o(e,t,n,r){var a=No(n);return Yo(zo.create,Qi,null,[e,t,a,r])}function wo(e,t,n,r){return n=So.get(t.element.componentProvider.provider.token)||No(n),Yo(zo.create,$i,null,[e,t,n,r])}function xo(e,t,n,r){return Wr(e,t,n,function(e){var t=function(e){var t=!1,n=!1;return 0===Co.size||(e.providers.forEach((function(e){var r=Co.get(e.token);3840&e.flags&&r&&(t=!0,n=n||r.deprecatedBehavior)})),e.modules.forEach((function(e){Oo.forEach((function(r,a){ge(a).providedIn===e&&(t=!0,n=n||r.deprecatedBehavior)}))}))),{hasOverrides:t,hasDeprecatedOverrides:n}}(e),n=t.hasOverrides,r=t.hasDeprecatedOverrides;return n?(function(e){for(var t=0;t<e.providers.length;t++){var n=e.providers[t];r&&(n.flags|=4096);var a=Co.get(n.token);a&&(n.flags=-3841&n.flags|a.flags,n.deps=ir(a.deps),n.value=a.value)}if(Oo.size>0){var i=new Set(e.modules);Oo.forEach((function(t,n){if(i.has(ge(n).providedIn)){var a={token:n,flags:t.flags|(r?4096:0),deps:ir(t.deps),value:t.value,index:e.providers.length};e.providers.push(a),e.providersByKey[Un(n)]=a}}))}}(e=e.factory((function(){return Vn}))),e):e}(r))}var Co=new Map,Oo=new Map,So=new Map;function To(e){var t;Co.set(e.token,e),"function"==typeof e.token&&(t=ge(e.token))&&"function"==typeof t.providedIn&&Oo.set(e.token,e)}function Io(e,t){var n=ur(t.viewDefFactory),r=ur(n.nodes[0].element.componentView);So.set(e,r)}function Eo(){Co.clear(),Oo.clear(),So.clear()}function No(e){if(0===Co.size)return e;var t=function(e){for(var t=[],n=null,r=0;r<e.nodes.length;r++){var a=e.nodes[r];1&a.flags&&(n=a),n&&3840&a.flags&&Co.has(a.provider.token)&&(t.push(n.nodeIndex),n=null)}return t}(e);if(0===t.length)return e;e=e.factory((function(){return Vn}));for(var n=0;n<t.length;n++)r(e,t[n]);return e;function r(e,t){for(var n=t+1;n<e.nodes.length;n++){var r=e.nodes[n];if(1&r.flags)return;if(3840&r.flags){var a=r.provider,i=Co.get(a.token);i&&(r.flags=-3841&r.flags|i.flags,a.deps=ir(i.deps),a.value=i.value)}}}}function Ao(e,t,n,r,a,i,o,s,u,c,l,h,d){var f=e.def.nodes[t];return io(e,f,n,r,a,i,o,s,u,c,l,h,d),224&f.flags?Ln(e,t).value:void 0}function Ro(e,t,n,r,a,i,o,s,u,c,l,h,d){var f=e.def.nodes[t];return so(e,f,n,r,a,i,o,s,u,c,l,h,d),224&f.flags?Ln(e,t).value:void 0}function Do(e){return Yo(zo.detectChanges,ao,null,[e])}function jo(e){return Yo(zo.checkNoChanges,ro,null,[e])}function Fo(e){return Yo(zo.destroy,co,null,[e])}var Mo,Po,Lo,zo=function(){var e={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return e[e.create]="create",e[e.detectChanges]="detectChanges",e[e.checkNoChanges]="checkNoChanges",e[e.destroy]="destroy",e[e.handleEvent]="handleEvent",e}();function Bo(e,t){Po=e,Lo=t}function Vo(e,t,n,r){return Bo(e,t),Yo(zo.handleEvent,e.def.handleEvent,null,[e,t,n,r])}function Wo(e,t){if(128&e.state)throw Rn(zo[Mo]);return Bo(e,Ko(e,0)),e.def.updateDirectives((function(e,n,r){for(var a=e.def.nodes[n],i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return 0===t?Ho(e,a,r,o):Go(e,a,r,o),16384&a.flags&&Bo(e,Ko(e,n)),224&a.flags?Ln(e,a.nodeIndex).value:void 0}),e)}function Uo(e,t){if(128&e.state)throw Rn(zo[Mo]);return Bo(e,qo(e,0)),e.def.updateRenderer((function(e,n,r){for(var a=e.def.nodes[n],i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return 0===t?Ho(e,a,r,o):Go(e,a,r,o),3&a.flags&&Bo(e,qo(e,n)),224&a.flags?Ln(e,a.nodeIndex).value:void 0}),e)}function Ho(e,t,n,r){if(io.apply(void 0,[e,t,n].concat(_toConsumableArray(r)))){var a=1===n?r[0]:r;if(16384&t.flags){for(var i={},o=0;o<t.bindings.length;o++){var s=t.bindings[o],u=a[o];8&s.flags&&(i[(f=s.nonMinifiedName,"ng-reflect-"+f.replace(/[$@]/g,"_").replace(xt,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"-"+t[1].toLowerCase()})))]=Ct(u))}var c=t.parent,l=Mn(e,c.nodeIndex).renderElement;if(c.element.name)for(var h in i){var d=i[h];null!=d?e.renderer.setAttribute(l,h,d):e.renderer.removeAttribute(l,h)}else e.renderer.setValue(l,"bindings="+JSON.stringify(i,null,2))}}var f}function Go(e,t,n,r){so.apply(void 0,[e,t,n].concat(_toConsumableArray(r)))}function Ko(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(16384&r.flags&&r.bindings&&r.bindings.length)return n}return null}function qo(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(3&r.flags&&r.bindings&&r.bindings.length)return n}return null}var Xo=function(){function e(t,n){_classCallCheck(this,e),this.view=t,this.nodeIndex=n,null==n&&(this.nodeIndex=n=0),this.nodeDef=t.def.nodes[n];for(var r=this.nodeDef,a=t;r&&0==(1&r.flags);)r=r.parent;if(!r)for(;!r&&a;)r=$n(a),a=a.parent;this.elDef=r,this.elView=a}return _createClass(e,[{key:"elOrCompView",get:function(){return Mn(this.elView,this.elDef.nodeIndex).componentView||this.view}},{key:"injector",get:function(){return Pr(this.elView,this.elDef)}},{key:"component",get:function(){return this.elOrCompView.component}},{key:"context",get:function(){return this.elOrCompView.context}},{key:"providerTokens",get:function(){var e=[];if(this.elDef)for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&e.push(n.provider.token),t+=n.childCount}return e}},{key:"references",get:function(){var e={};if(this.elDef){Zo(this.elView,this.elDef,e);for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&Zo(this.elView,n,e),t+=n.childCount}}return e}},{key:"componentRenderElement",get:function(){var e=function(e){for(;e&&!tr(e);)e=e.parent;return e.parent?Mn(e.parent,$n(e).nodeIndex):null}(this.elOrCompView);return e?e.renderElement:void 0}},{key:"renderNode",get:function(){return 2&this.nodeDef.flags?er(this.view,this.nodeDef):er(this.elView,this.elDef)}},{key:"logError",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,i;2&this.nodeDef.flags?(a=this.view.def,i=this.nodeDef.nodeIndex):(a=this.elView.def,i=this.elDef.nodeIndex);var o=function(e,t){for(var n=-1,r=0;r<=t;r++)3&e.nodes[r].flags&&n++;return n}(a,i),s=-1;a.factory((function(){var t;return++s===o?(t=e.error).bind.apply(t,[e].concat(n)):Vn})),s<o&&(e.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),e.error.apply(e,n))}}]),e}();function Zo(e,t,n){for(var r in t.references)n[r]=Vi(e,t,t.references[r])}function Yo(e,t,n,r){var a,i,o=Mo,s=Po,u=Lo;try{Mo=e;var c=t.apply(n,r);return Po=s,Lo=u,Mo=o,c}catch(l){if(Ge(l)||!Po)throw l;throw a=l,i=Qo(),a instanceof Error||(a=new Error(a.toString())),An(a,i),a}}function Qo(){return Po?new Xo(Po,Lo):null}var Jo=function(){function e(t){_classCallCheck(this,e),this.delegate=t}return _createClass(e,[{key:"createRenderer",value:function(e,t){return new $o(this.delegate.createRenderer(e,t))}},{key:"begin",value:function(){this.delegate.begin&&this.delegate.begin()}},{key:"end",value:function(){this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}]),e}(),$o=function(){function e(t){_classCallCheck(this,e),this.delegate=t,this.debugContextFactory=Qo,this.data=this.delegate.data}return _createClass(e,[{key:"createDebugContext",value:function(e){return this.debugContextFactory(e)}},{key:"destroyNode",value:function(e){var t=xi(e);!function(e){wi.delete(e.nativeNode)}(t),t instanceof ki&&(t.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(e)}},{key:"destroy",value:function(){this.delegate.destroy()}},{key:"createElement",value:function(e,t){var n=this.delegate.createElement(e,t),r=this.createDebugContext(n);if(r){var a=new _i(n,null,r);a.name=e,Ci(a)}return n}},{key:"createComment",value:function(e){var t=this.delegate.createComment(e),n=this.createDebugContext(t);return n&&Ci(new ki(t,null,n)),t}},{key:"createText",value:function(e){var t=this.delegate.createText(e),n=this.createDebugContext(t);return n&&Ci(new ki(t,null,n)),t}},{key:"appendChild",value:function(e,t){var n=xi(e),r=xi(t);n&&r&&n instanceof _i&&n.addChild(r),this.delegate.appendChild(e,t)}},{key:"insertBefore",value:function(e,t,n){var r=xi(e),a=xi(t),i=xi(n);r&&a&&r instanceof _i&&r.insertBefore(i,a),this.delegate.insertBefore(e,t,n)}},{key:"removeChild",value:function(e,t){var n=xi(e),r=xi(t);n&&r&&n instanceof _i&&n.removeChild(r),this.delegate.removeChild(e,t)}},{key:"selectRootElement",value:function(e,t){var n=this.delegate.selectRootElement(e,t),r=Qo();return r&&Ci(new _i(n,null,r)),n}},{key:"setAttribute",value:function(e,t,n,r){var a=xi(e);a&&a instanceof _i&&(a.attributes[r?r+":"+t:t]=n),this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){var r=xi(e);r&&r instanceof _i&&(r.attributes[n?n+":"+t:t]=null),this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){var n=xi(e);n&&n instanceof _i&&(n.classes[t]=!0),this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){var n=xi(e);n&&n instanceof _i&&(n.classes[t]=!1),this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){var a=xi(e);a&&a instanceof _i&&(a.styles[t]=n),this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){var r=xi(e);r&&r instanceof _i&&(r.styles[t]=null),this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){var r=xi(e);r&&r instanceof _i&&(r.properties[t]=n),this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){if("string"!=typeof e){var r=xi(e);r&&r.listeners.push(new bi(t,n))}return this.delegate.listen(e,t,n)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setValue",value:function(e,t){return this.delegate.setValue(e,t)}}]),e}();var es=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this)).moduleType=e,i._bootstrapComponents=r,i._ngModuleDefFactory=a,i}return _createClass(n,[{key:"create",value:function(e){!function(){if(!go){go=!0;var e=Qe()?{setCurrentNode:Bo,createRootView:bo,createEmbeddedView:_o,createComponentView:wo,createNgModuleRef:xo,overrideProvider:To,overrideComponentView:Io,clearOverrides:Eo,checkAndUpdateView:Do,checkNoChangesView:jo,destroyView:Fo,createDebugContext:function(e,t){return new Xo(e,t)},handleEvent:Vo,updateDirectives:Wo,updateRenderer:Uo}:{setCurrentNode:function(){},createRootView:yo,createEmbeddedView:Qi,createComponentView:$i,createNgModuleRef:Wr,overrideProvider:Vn,overrideComponentView:Vn,clearOverrides:Vn,checkAndUpdateView:ao,checkNoChangesView:ro,destroyView:co,createDebugContext:function(e,t){return new Xo(e,t)},handleEvent:function(e,t,n,r){return e.def.handleEvent(e,t,n,r)},updateDirectives:function(e,t){return e.def.updateDirectives(0===t?Ao:Ro,e)},updateRenderer:function(e,t){return e.def.updateRenderer(0===t?Ao:Ro,e)}};Bn.setCurrentNode=e.setCurrentNode,Bn.createRootView=e.createRootView,Bn.createEmbeddedView=e.createEmbeddedView,Bn.createComponentView=e.createComponentView,Bn.createNgModuleRef=e.createNgModuleRef,Bn.overrideProvider=e.overrideProvider,Bn.overrideComponentView=e.overrideComponentView,Bn.clearOverrides=e.clearOverrides,Bn.checkAndUpdateView=e.checkAndUpdateView,Bn.checkNoChangesView=e.checkNoChangesView,Bn.destroyView=e.destroyView,Bn.resolveDep=ua,Bn.createDebugContext=e.createDebugContext,Bn.handleEvent=e.handleEvent,Bn.updateDirectives=e.updateDirectives,Bn.updateRenderer=e.updateRenderer,Bn.dirtyParentQueries=Li}}();var t=function(e){var t=Array.from(e.providers),n=Array.from(e.modules),r={};for(var a in e.providersByKey)r[a]=e.providersByKey[a];return{factory:e.factory,isRoot:e.isRoot,providers:t,modules:n,providersByKey:r}}(ur(this._ngModuleDefFactory));return Bn.createNgModuleRef(this.moduleType,e||Et.NULL,this._bootstrapComponents,t)}}]),n}(Be),ts=function e(){_classCallCheck(this,e)};function ns(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}var rs=n("DP+o"),as=function(){function e(t,n){_classCallCheck(this,e),this.DataSharing=t,this.notifierService=n,this.title="COCO-SSD Object Detection",this.isModelLoaded=!1}return _createClass(e,[{key:"ngOnInit",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rs.load();case 3:t=e.sent,this.isModelLoaded=!0,this.DataSharing.Model.next(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.notifierService.showNotification("Cannot load model. Please ensure that you have internet connection.","OK","error");case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}}]),e}(),is=function e(){_classCallCheck(this,e)},os=new Ie("Location Initialized"),ss=function e(){_classCallCheck(this,e)},us=new Ie("appBaseHref"),cs=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._subject=new ba,this._urlChangeListeners=[],this._platformStrategy=t;var a=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=e.stripTrailingSlash(ls(a)),this._platformStrategy.onPopState((function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})}))}return _createClass(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(t+e.normalizeQueryParams(n))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,ls(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+e.normalizeQueryParams(n)),r)}},{key:"replaceState",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+e.normalizeQueryParams(n)),r)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this.subscribe((function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach((function(n){return n(e,t)}))}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}],[{key:"normalizeQueryParams",value:function(e){return e&&"?"!==e[0]?"?"+e:e}},{key:"joinWithSlash",value:function(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}},{key:"stripTrailingSlash",value:function(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}}]),e}();function ls(e){return e.replace(/\/index.html$/,"")}var hs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this))._platformLocation=e,a._baseHref="",null!=r&&(a._baseHref=r),a}return _createClass(n,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=cs.joinWithSlash(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+cs.normalizeQueryParams(r));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(e,t,a)}},{key:"replaceState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+cs.normalizeQueryParams(r));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,a)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(ss),ds=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;if(_classCallCheck(this,n),(a=t.call(this))._platformLocation=e,null==r&&(r=a._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return a._baseHref=r,_possibleConstructorReturn(a)}return _createClass(n,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return cs.joinWithSlash(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+cs.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+cs.normalizeQueryParams(r));this._platformLocation.pushState(e,t,a)}},{key:"replaceState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+cs.normalizeQueryParams(r));this._platformLocation.replaceState(e,t,a)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(ss),fs=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),ps=new Ie("UseV4Plurals"),ms=function e(){_classCallCheck(this,e)},vs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).locale=e,a.deprecatedPluralFn=r,a}return _createClass(n,[{key:"getPluralCategory",value:function(e,t){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(t||this.locale,e):function(e){return function(e){var t=e.toLowerCase().replace(/_/g,"-"),n=ma[t];if(n)return n;var r=t.split("-")[0];if(n=ma[r])return n;if("en"===r)return ya;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}(e)[va.PluralCase]}(t||this.locale)(e)){case fs.Zero:return"zero";case fs.One:return"one";case fs.Two:return"two";case fs.Few:return"few";case fs.Many:return"many";default:return"other"}}}]),n}(ms);function gs(e,t){t=encodeURIComponent(t);var n,r=_createForOfIteratorHelper(e.split(";"));try{for(r.s();!(n=r.n()).done;){var a=n.value,i=a.indexOf("="),o=_slicedToArray(-1==i?[a,""]:[a.slice(0,i),a.slice(i+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var ys=function(){function e(t,n){_classCallCheck(this,e),this._viewContainer=t,this._context=new bs,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return _createClass(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){ks("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){ks("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}]),e}(),bs=function e(){_classCallCheck(this,e),this.$implicit=null,this.ngIf=null};function ks(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(be(t),"'."))}var _s,ws=function e(){_classCallCheck(this,e)},xs=function(){function e(t,n,r){_classCallCheck(this,e),this._ngEl=t,this._differs=n,this._renderer=r}return _createClass(e,[{key:"getValue",value:function(){return null}},{key:"setNgStyle",value:function(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}},{key:"applyChanges",value:function(){if(this._differ){var e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}},{key:"_applyChanges",value:function(e){var t=this;e.forEachRemovedItem((function(e){return t._setStyle(e.key,null)})),e.forEachAddedItem((function(e){return t._setStyle(e.key,e.currentValue)})),e.forEachChangedItem((function(e){return t._setStyle(e.key,e.currentValue)}))}},{key:"_setStyle",value:function(e,t){var n=_slicedToArray(e.split("."),2),r=n[0],a=n[1];null!=(t=null!=t&&a?"".concat(t).concat(a):t)?this._renderer.setStyle(this._ngEl.nativeElement,r,t):this._renderer.removeStyle(this._ngEl.nativeElement,r)}}]),e}(),Cs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"ngStyle",set:function(e){this._delegate.setNgStyle(e)}},{key:"ngDoCheck",value:function(){this._delegate.applyChanges()}}]),n}(function(){var e=function(){function e(t){_classCallCheck(this,e),this._delegate=t}return _createClass(e,[{key:"getValue",value:function(){return this._delegate.getValue()}}]),e}();return e.ngDirectiveDef=void 0,e}()),Os=/(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])\S*/g,Ss=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(t){if(!t)return t;if("string"!=typeof t)throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(be(e),"'"))}(e,t);return t.replace(Os,(function(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()}))}}]),e}(),Ts=function e(){_classCallCheck(this,e)},Is=new Ie("DocumentToken"),Es=((_s=function e(){_classCallCheck(this,e)}).ngInjectableDef=ve({token:_s,providedIn:"root",factory:function(){return new Ns(Fe(Is),window,Fe(Xe))}}),_s),Ns=function(){function e(t,n,r){_classCallCheck(this,e),this.document=t,this.window=n,this.errorHandler=r,this.offset=function(){return[0,0]}}return _createClass(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportScrollRestoration()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportScrollRestoration()){e=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(e):e.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var t=this.document.querySelector("#"+e);if(t)return void this.scrollToElement(t);var n=this.document.querySelector("[name='".concat(e,"']"));if(n)return void this.scrollToElement(n)}catch(r){this.errorHandler.handleError(r)}}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(n-a[0],r-a[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(e){return!1}}}]),e}(),As=new C((function(e){return e.complete()}));function Rs(e){return e?function(e){return new C((function(t){return e.schedule((function(){return t.complete()}))}))}(e):As}function Ds(e){var t=new C((function(t){t.next(e),t.complete()}));return t._isScalar=!0,t.value=e,t}function js(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[t.length-1];switch(D(r)?t.pop():r=void 0,t.length){case 0:return Rs(r);case 1:return r?X(t,r):Ds(t[0]);default:return X(t,r)}}var Fs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._value=e,r}return _createClass(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=_get(_getPrototypeOf(n.prototype),"_subscribe",this).call(this,e);return t&&!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new I;return this._value}},{key:"next",value:function(e){_get(_getPrototypeOf(n.prototype),"next",this).call(this,this._value=e)}}]),n}(A);function Ms(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}Ms.prototype=Object.create(Error.prototype);var Ps=Ms,Ls={};function zs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=null,a=null;return D(t[t.length-1])&&(a=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&c(t[0])&&(t=t[0]),X(t,a).lift(new Bs(r))}var Bs=function(){function e(t){_classCallCheck(this,e),this.resultSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Vs(e,this.resultSelector))}}]),e}(),Vs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).resultSelector=r,a.active=0,a.values=[],a.observables=[],a}return _createClass(n,[{key:"_next",value:function(e){this.values.push(Ls),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(U(this,r,r,n))}}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,n,r,a){var i=this.values,o=this.toRespond?i[n]===Ls?--this.toRespond:this.toRespond:0;i[n]=t,0===o&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(H);function Ws(e){return new C((function(t){var n;try{n=e()}catch(r){return void t.error(r)}return(n?Z(n):Rs()).subscribe(t)}))}function Us(){return ee(1)}function Hs(e,t){return function(n){return n.lift(new Gs(e,t))}}var Gs=function(){function e(t,n){_classCallCheck(this,e),this.predicate=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Ks(e,this.predicate,this.thisArg))}}]),e}(),Ks=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).predicate=r,i.thisArg=a,i.count=0,i}return _createClass(n,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),n}(g);function qs(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}qs.prototype=Object.create(Error.prototype);var Xs=qs;function Zs(e){return function(t){return 0===e?Rs():t.lift(new Ys(e))}}var Ys=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new Xs}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Qs(e,this.total))}}]),e}(),Qs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).total=r,a.ring=new Array,a.count=0,a}return _createClass(n,[{key:"_next",value:function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,a=0;a<n;a++){var i=t++%n;e.next(r[i])}e.complete()}}]),n}(g);function Js(e,t,n){return function(r){return r.lift(new $s(e,t,n))}}var $s=function(){function e(t,n,r){_classCallCheck(this,e),this.nextOrObserver=t,this.error=n,this.complete=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new eu(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),eu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var s;return _classCallCheck(this,n),(s=t.call(this,e))._tapNext=k,s._tapError=k,s._tapComplete=k,s._tapError=i||k,s._tapComplete=o||k,a(r)?(s._context=_assertThisInitialized(s),s._tapNext=r):r&&(s._context=r,s._tapNext=r.next||k,s._tapError=r.error||k,s._tapComplete=r.complete||k),s}return _createClass(n,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),n}(g),tu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nu;return Js({hasValue:!1,next:function(){this.hasValue=!0},complete:function(){if(!this.hasValue)throw e()}})};function nu(){return new Ps}function ru(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new au(e))}}var au=function(){function e(t){_classCallCheck(this,e),this.defaultValue=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new iu(e,this.defaultValue))}}]),e}(),iu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).defaultValue=r,a.isEmpty=!0,a}return _createClass(n,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),n}(g);function ou(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Hs((function(t,n){return e(t,n,r)})):$,Zs(1),n?ru(t):tu((function(){return new Ps})))}}function su(e){return function(t){var n=new uu(e),r=t.lift(n);return n.caught=r}}var uu=function(){function e(t){_classCallCheck(this,e),this.selector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new cu(e,this.selector,this.caught))}}]),e}(),cu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).selector=r,i.caught=a,i}return _createClass(n,[{key:"error",value:function(e){if(!this.isStopped){var t;try{t=this.selector(e,this.caught)}catch(a){return void _get(_getPrototypeOf(n.prototype),"error",this).call(this,a)}this._unsubscribeAndRecycle();var r=new j(this,void 0,void 0);this.add(r),U(this,t,void 0,void 0,r)}}}]),n}(H);function lu(e){return function(t){return 0===e?Rs():t.lift(new hu(e))}}var hu=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new Xs}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new du(e,this.total))}}]),e}(),du=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).total=r,a.count=0,a}return _createClass(n,[{key:"_next",value:function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}]),n}(g);function fu(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?Hs((function(t,n){return e(t,n,r)})):$,lu(1),n?ru(t):tu((function(){return new Ps})))}}var pu=function(){function e(t,n,r){_classCallCheck(this,e),this.predicate=t,this.thisArg=n,this.source=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new mu(e,this.predicate,this.thisArg,this.source))}}]),e}(),mu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e)).predicate=r,o.thisArg=a,o.source=i,o.index=0,o.thisArg=a||_assertThisInitialized(o),o}return _createClass(n,[{key:"notifyComplete",value:function(e){this.destination.next(e),this.destination.complete()}},{key:"_next",value:function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(n){return void this.destination.error(n)}t||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),n}(g);function vu(e,t){return"function"==typeof t?function(n){return n.pipe(vu((function(n,r){return Z(e(n,r)).pipe(G((function(e,a){return t(n,e,r,a)})))})))}:function(t){return t.lift(new gu(e))}}var gu=function(){function e(t){_classCallCheck(this,e),this.project=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new yu(e,this.project))}}]),e}(),yu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).project=r,a.index=0,a}return _createClass(n,[{key:"_next",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe();var a=new j(this,void 0,void 0);this.destination.add(a),this.innerSubscription=U(this,e,t,n,a)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||_get(_getPrototypeOf(n.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e,t,n,r,a){this.destination.next(t)}}]),n}(H);function bu(){return Us()(js.apply(void 0,arguments))}function ku(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=t[t.length-1];D(n)?t.pop():n=null;var r=t.length;return bu(1!==r||n?r>0?X(t,n):Rs(n):Ds(t[0]),e)}}function _u(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new wu(e,t,n))}}var wu=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.accumulator=t,this.seed=n,this.hasSeed=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new xu(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),xu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e)).accumulator=r,o._seed=a,o.hasSeed=i,o.index=0,o}return _createClass(n,[{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}},{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(r){this.destination.error(r)}this.seed=t,this.destination.next(t)}}]),n}(g);function Cu(e,t){return Y(e,t,1)}var Ou=function(){function e(t){_classCallCheck(this,e),this.callback=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Su(e,this.callback))}}]),e}(),Su=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).add(new p(r)),a}return n}(g),Tu=null;function Iu(){return Tu}var Eu,Nu={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},Au={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ru={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Du=function(){if(Te.Node)return Te.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))}}(),ju=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"parse",value:function(e){throw new Error("parse not implemented")}},{key:"hasProperty",value:function(e,t){return t in e}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"getProperty",value:function(e,t){return e[t]}},{key:"invoke",value:function(e,t,n){e[t].apply(e,_toConsumableArray(n))}},{key:"logError",value:function(e){window.console&&(console.error?console.error(e):console.log(e))}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"attrToPropMap",get:function(){return Nu}},{key:"contains",value:function(e,t){return Du.call(e,t)}},{key:"querySelector",value:function(e,t){return e.querySelector(t)}},{key:"querySelectorAll",value:function(e,t){return e.querySelectorAll(t)}},{key:"on",value:function(e,t,n){e.addEventListener(t,n,!1)}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"createMouseEvent",value:function(e){var t=this.getDefaultDocument().createEvent("MouseEvent");return t.initEvent(e,!0,!0),t}},{key:"createEvent",value:function(e){var t=this.getDefaultDocument().createEvent("Event");return t.initEvent(e,!0,!0),t}},{key:"preventDefault",value:function(e){e.preventDefault(),e.returnValue=!1}},{key:"isPrevented",value:function(e){return e.defaultPrevented||null!=e.returnValue&&!e.returnValue}},{key:"getInnerHTML",value:function(e){return e.innerHTML}},{key:"getTemplateContent",value:function(e){return"content"in e&&this.isTemplateElement(e)?e.content:null}},{key:"getOuterHTML",value:function(e){return e.outerHTML}},{key:"nodeName",value:function(e){return e.nodeName}},{key:"nodeValue",value:function(e){return e.nodeValue}},{key:"type",value:function(e){return e.type}},{key:"content",value:function(e){return this.hasProperty(e,"content")?e.content:e}},{key:"firstChild",value:function(e){return e.firstChild}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"parentElement",value:function(e){return e.parentNode}},{key:"childNodes",value:function(e){return e.childNodes}},{key:"childNodesAsList",value:function(e){for(var t=e.childNodes,n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return n}},{key:"clearNodes",value:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"removeChild",value:function(e,t){e.removeChild(t)}},{key:"replaceChild",value:function(e,t,n){e.replaceChild(t,n)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"insertBefore",value:function(e,t,n){e.insertBefore(n,t)}},{key:"insertAllBefore",value:function(e,t,n){n.forEach((function(n){return e.insertBefore(n,t)}))}},{key:"insertAfter",value:function(e,t,n){e.insertBefore(n,t.nextSibling)}},{key:"setInnerHTML",value:function(e,t){e.innerHTML=t}},{key:"getText",value:function(e){return e.textContent}},{key:"setText",value:function(e,t){e.textContent=t}},{key:"getValue",value:function(e){return e.value}},{key:"setValue",value:function(e,t){e.value=t}},{key:"getChecked",value:function(e){return e.checked}},{key:"setChecked",value:function(e,t){e.checked=t}},{key:"createComment",value:function(e){return this.getDefaultDocument().createComment(e)}},{key:"createTemplate",value:function(e){var t=this.getDefaultDocument().createElement("template");return t.innerHTML=e,t}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createElementNS",value:function(e,t,n){return(n=n||this.getDefaultDocument()).createElementNS(e,t)}},{key:"createTextNode",value:function(e,t){return(t=t||this.getDefaultDocument()).createTextNode(e)}},{key:"createScriptTag",value:function(e,t,n){var r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(e,t),r}},{key:"createStyleElement",value:function(e,t){var n=(t=t||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(e,t)),n}},{key:"createShadowRoot",value:function(e){return e.createShadowRoot()}},{key:"getShadowRoot",value:function(e){return e.shadowRoot}},{key:"getHost",value:function(e){return e.host}},{key:"clone",value:function(e){return e.cloneNode(!0)}},{key:"getElementsByClassName",value:function(e,t){return e.getElementsByClassName(t)}},{key:"getElementsByTagName",value:function(e,t){return e.getElementsByTagName(t)}},{key:"classList",value:function(e){return Array.prototype.slice.call(e.classList,0)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"hasClass",value:function(e,t){return e.classList.contains(t)}},{key:"setStyle",value:function(e,t,n){e.style[t]=n}},{key:"removeStyle",value:function(e,t){e.style[t]=""}},{key:"getStyle",value:function(e,t){return e.style[t]}},{key:"hasStyle",value:function(e,t,n){var r=this.getStyle(e,t)||"";return n?r==n:r.length>0}},{key:"tagName",value:function(e){return e.tagName}},{key:"attributeMap",value:function(e){for(var t=new Map,n=e.attributes,r=0;r<n.length;r++){var a=n.item(r);t.set(a.name,a.value)}return t}},{key:"hasAttribute",value:function(e,t){return e.hasAttribute(t)}},{key:"hasAttributeNS",value:function(e,t,n){return e.hasAttributeNS(t,n)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"getAttributeNS",value:function(e,t,n){return e.getAttributeNS(t,n)}},{key:"setAttribute",value:function(e,t,n){e.setAttribute(t,n)}},{key:"setAttributeNS",value:function(e,t,n,r){e.setAttributeNS(t,n,r)}},{key:"removeAttribute",value:function(e,t){e.removeAttribute(t)}},{key:"removeAttributeNS",value:function(e,t,n){e.removeAttributeNS(t,n)}},{key:"templateAwareRoot",value:function(e){return this.isTemplateElement(e)?this.content(e):e}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"getBoundingClientRect",value:function(e){try{return e.getBoundingClientRect()}catch(t){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}},{key:"getTitle",value:function(e){return e.title}},{key:"setTitle",value:function(e,t){e.title=t||""}},{key:"elementMatches",value:function(e,t){return!!this.isElementNode(e)&&(e.matches&&e.matches(t)||e.msMatchesSelector&&e.msMatchesSelector(t)||e.webkitMatchesSelector&&e.webkitMatchesSelector(t))}},{key:"isTemplateElement",value:function(e){return this.isElementNode(e)&&"TEMPLATE"===e.nodeName}},{key:"isTextNode",value:function(e){return e.nodeType===Node.TEXT_NODE}},{key:"isCommentNode",value:function(e){return e.nodeType===Node.COMMENT_NODE}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"hasShadowRoot",value:function(e){return null!=e.shadowRoot&&e instanceof HTMLElement}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"importIntoDoc",value:function(e){return document.importNode(this.templateAwareRoot(e),!0)}},{key:"adoptNode",value:function(e){return document.adoptNode(e)}},{key:"getHref",value:function(e){return e.getAttribute("href")}},{key:"getEventKey",value:function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Ru.hasOwnProperty(t)&&(t=Ru[t]))}return Au[t]||t}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=Fu||(Fu=document.querySelector("base"))?Fu.getAttribute("href"):null;return null==n?null:(t=n,Eu||(Eu=document.createElement("a")),Eu.setAttribute("href",t),"/"===Eu.pathname.charAt(0)?Eu.pathname:"/"+Eu.pathname)}},{key:"resetBaseElement",value:function(){Fu=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"setData",value:function(e,t,n){this.setAttribute(e,"data-"+t,n)}},{key:"getData",value:function(e,t){return this.getAttribute(e,"data-"+t)}},{key:"getComputedStyle",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return getComputedStyle(e)}))},{key:"supportsWebAnimation",value:function(){return"function"==typeof Element.prototype.animate}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return gs(document.cookie,e)}},{key:"setCookie",value:function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)}}],[{key:"makeCurrent",value:function(){var e;e=new n,Tu||(Tu=e)}}]),n}(function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n),(e=t.call(this))._animationPrefix=null,e._transitionEnd=null;try{var r=e.createElement("div",document);if(null!=e.getStyle(r,"animationName"))e._animationPrefix="";else for(var a=["Webkit","Moz","O","ms"],i=0;i<a.length;i++)if(null!=e.getStyle(r,a[i]+"AnimationName")){e._animationPrefix="-"+a[i].toLowerCase()+"-";break}var o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(o).forEach((function(t){null!=e.getStyle(r,t)&&(e._transitionEnd=o[t])}))}catch(s){e._animationPrefix=null,e._transitionEnd=null}return e}return _createClass(n,[{key:"getDistributedNodes",value:function(e){return e.getDistributedNodes()}},{key:"resolveAndSetHref",value:function(e,t,n){e.href=null==n?t:t+"/../"+n}},{key:"supportsDOMEvents",value:function(){return!0}},{key:"supportsNativeShadowDOM",value:function(){return"function"==typeof document.body.createShadowRoot}},{key:"getAnimationPrefix",value:function(){return this._animationPrefix?this._animationPrefix:""}},{key:"getTransitionEnd",value:function(){return this._transitionEnd?this._transitionEnd:""}},{key:"supportsAnimation",value:function(){return null!=this._animationPrefix&&null!=this._transitionEnd}}]),n}(function(){function e(){_classCallCheck(this,e),this.resourceLoaderType=null}return _createClass(e,[{key:"attrToPropMap",get:function(){return this._attrToPropMap},set:function(e){this._attrToPropMap=e}}]),e}())),Fu=null;function Mu(){return!!window.history.pushState}var Pu=new Ie("TRANSITION_ID"),Lu=[{provide:wa,useFactory:function(e,t,n){return function(){n.get(xa).donePromise.then((function(){var n=Iu();Array.prototype.slice.apply(n.querySelectorAll(t,"style[ng-transition]")).filter((function(t){return n.getAttribute(t,"ng-transition")===e})).forEach((function(e){return n.remove(e)}))}))}},deps:[Pu,Is,Et],multi:!0}],zu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){Te.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Te.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Te.getAllAngularRootElements=function(){return e.getAllRootElements()},Te.frameworkStabilizers||(Te.frameworkStabilizers=[]),Te.frameworkStabilizers.push((function(e){var t=Te.getAllAngularTestabilities(),n=t.length,r=!1,a=function(t){r=r||t,0==--n&&e(r)};t.forEach((function(e){e.whenStable(a)}))}))}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?Iu().isShadowRoot(t)?this.findTestabilityInTree(e,Iu().getHost(t),!0):this.findTestabilityInTree(e,Iu().parentElement(t),!0):null}}],[{key:"init",value:function(){var t;t=new e,ai=t}}]),e}();function Bu(e,t){"undefined"!=typeof COMPILED&&COMPILED||((Te.ng=Te.ng||{})[e]=t)}var Vu={ApplicationRef:di,NgZone:Xa};function Wu(e){return xi(e)}var Uu=new Ie("EventManagerPlugins"),Hu=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach((function(e){return e.manager=r})),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var a=n[r];if(a.supports(e))return this._eventNameToPlugin.set(e,a),a}throw new Error("No event manager plugin found for event "+e)}}]),e}(),Gu=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=Iu().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),Ku=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach((function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}(),qu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Set,r._styleNodes=new Set,r._hostNodes.add(e.head),r}return _createClass(n,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach((function(e){var r=n._doc.createElement("style");r.textContent=e,n._styleNodes.add(t.appendChild(r))}))}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach((function(n){return t._addStylesToHost(e,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(e){return Iu().remove(e)}))}}]),n}(Ku),Xu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Zu=/%COMP%/g;function Yu(e,t,n){for(var r=0;r<t.length;r++){var a=t[r];Array.isArray(a)?Yu(e,a,n):(a=a.replace(Zu,e),n.push(a))}return n}function Qu(e){return function(t){!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var Ju=function(){function e(t,n,r){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new $u(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ue.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new nc(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case Ue.Native:case Ue.ShadowDom:return new rc(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=Yu(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}(),$u=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(Xu[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var a=Xu[r];a?e.setAttributeNS(a,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=Xu[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&on.DashCase?e.style.setProperty(t,n,r&on.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&on.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){tc(t,"property"),e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return tc(t,"listener"),"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Qu(n)):this.eventManager.addEventListener(e,t,Qu(n))}}]),e}(),ec="@".charCodeAt(0);function tc(e,t){if(e.charCodeAt(0)===ec)throw new Error("Found the synthetic ".concat(t," ").concat(e,'. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.'))}var nc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;_classCallCheck(this,n),(o=t.call(this,e)).component=a;var s,u=Yu(i+"-"+a.id,a.styles,[]);return r.addStyles(u),o.contentAttr="_ngcontent-%COMP%".replace(Zu,i+"-"+a.id),o.hostAttr=(s=i+"-"+a.id,"_nghost-%COMP%".replace(Zu,s)),o}return _createClass(n,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=_get(_getPrototypeOf(n.prototype),"createElement",this).call(this,e,t);return _get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}($u),rc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;_classCallCheck(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=a,o.component=i,o.shadowRoot=i.encapsulation===Ue.ShadowDom?a.attachShadow({mode:"open"}):a.createShadowRoot(),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=Yu(i.id,i.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return _createClass(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return _get(_getPrototypeOf(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return _get(_getPrototypeOf(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return _get(_getPrototypeOf(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}($u),ac="undefined"!=typeof Zone&&Zone.__symbol__||function(e){return"__zone_symbol__"+e},ic=ac("addEventListener"),oc=ac("removeEventListener"),sc={},uc="__zone_symbol__propagationStopped",cc=function(){var e="undefined"!=typeof Zone&&Zone[ac("BLACK_LISTED_EVENTS")];if(e){var t={};return e.forEach((function(e){t[e]=e})),t}}(),lc=function(e){return!!cc&&cc.hasOwnProperty(e)},hc=function(e){var t=sc[e.type];if(t){var n=this[t];if(n){var r=[e];if(1===n.length){var a=n[0];return a.zone!==Zone.current?a.zone.run(a.handler,this,r):a.handler.apply(this,r)}for(var i=n.slice(),o=0;o<i.length&&!0!==e[uc];o++){var s=i[o];s.zone!==Zone.current?s.zone.run(s.handler,this,r):s.handler.apply(this,r)}}}},dc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).ngZone=r,a&&function(e){return"server"===e}(a)||i.patchEvent(),i}return _createClass(n,[{key:"patchEvent",value:function(){if("undefined"!=typeof Event&&Event&&Event.prototype&&!Event.prototype.__zone_symbol__stopImmediatePropagation){var e=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[uc]=!0),e&&e.apply(this,arguments)}}}},{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this,a=n;if(!e[ic]||Xa.isInAngularZone()&&!lc(t))e.addEventListener(t,a,!1);else{var i=sc[t];i||(i=sc[t]=ac("ANGULAR"+t+"FALSE"));var o=e[i],s=o&&o.length>0;o||(o=e[i]=[]);var u=lc(t)?Zone.root:Zone.current;if(0===o.length)o.push({zone:u,handler:a});else{for(var c=!1,l=0;l<o.length;l++)if(o[l].handler===a){c=!0;break}c||o.push({zone:u,handler:a})}s||e[ic](t,hc,!1)}return function(){return r.removeEventListener(e,t,a)}}},{key:"removeEventListener",value:function(e,t,n){var r=e[oc];if(!r)return e.removeEventListener.apply(e,[t,n,!1]);var a=sc[t],i=a&&e[a];if(!i)return e.removeEventListener.apply(e,[t,n,!1]);for(var o=!1,s=0;s<i.length;s++)if(i[s].handler===n){o=!0,i.splice(s,1);break}o?0===i.length&&r.apply(e,[t,hc,!1]):e.removeEventListener.apply(e,[t,n,!1])}}]),n}(Gu),fc={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},pc=new Ie("HammerGestureConfig"),mc=new Ie("HammerLoader"),vc=function(){function e(){_classCallCheck(this,e),this.events=[],this.overrides={}}return _createClass(e,[{key:"buildHammer",value:function(e){var t=new Hammer(e,this.options);for(var n in t.get("pinch").set({enable:!0}),t.get("rotate").set({enable:!0}),this.overrides)t.get(n).set(this.overrides[n]);return t}}]),e}(),gc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e))._config=r,o.console=a,o.loader=i,o}return _createClass(n,[{key:"supports",value:function(e){return!(!fc.hasOwnProperty(e.toLowerCase())&&!this.isCustomEvent(e)||!window.Hammer&&!this.loader&&(this.console.warn('The "'.concat(e,'" event cannot be bound because Hammer.JS is not loaded and no custom loader has been specified.')),1))}},{key:"addEventListener",value:function(e,t,n){var r=this,a=this.manager.getZone();if(t=t.toLowerCase(),!window.Hammer&&this.loader){var i=!1,o=function(){i=!0};return this.loader().then((function(){if(!window.Hammer)return r.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(o=function(){});i||(o=r.addEventListener(e,t,n))})).catch((function(){r.console.warn('The "'.concat(t,'" event cannot be bound because the custom Hammer.JS loader failed.')),o=function(){}})),function(){o()}}return a.runOutsideAngular((function(){var i=r._config.buildHammer(e),o=function(e){a.runGuarded((function(){n(e)}))};return i.on(t,o),function(){i.off(t,o),"function"==typeof i.destroy&&i.destroy()}}))}},{key:"isCustomEvent",value:function(e){return this._config.events.indexOf(e)>-1}}]),n}(Gu),yc=["alt","control","meta","shift"],bc={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},kc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var a=n.parseEventName(t),i=n.eventCallback(a.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return Iu().onAndCancel(e,a.domEventName,i)}))}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var a=n._normalizeKey(t.pop()),i="";if(yc.forEach((function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),i+=e+".")})),i+=a,0!=t.length||0===a.length)return null;var o={};return o.domEventName=r,o.fullKey=i,o}},{key:"getEventFullKey",value:function(e){var t="",n=Iu().getEventKey(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),yc.forEach((function(r){r!=n&&(0,bc[r])(e)&&(t+=r+".")})),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(a){n.getEventFullKey(a)===e&&r.runGuarded((function(){return t(a)}))}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(Gu),_c=function e(){_classCallCheck(this,e)},wc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._doc=e,r}return _createClass(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case bt.NONE:return t;case bt.HTML:return t instanceof Cc?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"HTML"),function(e,t){var n=null;try{at=at||new Je(e);var r=t?String(t):"";n=at.getInertBodyElement(r);var a=5,i=r;do{if(0===a)throw new Error("Failed to sanitize html because the input is unstable");a--,r=i,i=n.innerHTML,n=at.getInertBodyElement(r)}while(r!==i);var o=new pt,s=o.sanitizeChildren(yt(n)||n);return Qe()&&o.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n)for(var u=yt(n)||n;u.firstChild;)u.removeChild(u.firstChild)}}(this._doc,String(t)));case bt.STYLE:return t instanceof Oc?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"Style"),function(e){if(!(e=String(e).trim()))return"";var t=e.match(wt);return t&&tt(t[1])===t[1]||e.match(_t)&&function(e){for(var t=!0,n=!0,r=0;r<e.length;r++){var a=e.charAt(r);"'"===a&&n?t=!t:'"'===a&&t&&(n=!n)}return t&&n}(e)?e:(Qe()&&console.warn("WARNING: sanitizing unsafe style value ".concat(e," (see http://g.co/ng/security#xss).")),"unsafe")}(t));case bt.SCRIPT:if(t instanceof Sc)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"Script"),new Error("unsafe value used in a script context");case bt.URL:return t instanceof Ic||t instanceof Tc?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"URL"),tt(String(t)));case bt.RESOURCE_URL:if(t instanceof Ic)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see http://g.co/ng/security#xss)"))}}},{key:"checkNotSafeValue",value:function(e,t){if(e instanceof xc)throw new Error("Required a safe ".concat(t,", got a ").concat(e.getTypeName()," (see http://g.co/ng/security#xss)"))}},{key:"bypassSecurityTrustHtml",value:function(e){return new Cc(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return new Oc(e)}},{key:"bypassSecurityTrustScript",value:function(e){return new Sc(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return new Tc(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return new Ic(e)}}]),n}(_c),xc=function(){function e(t){_classCallCheck(this,e),this.changingThisBreaksApplicationSecurity=t}return _createClass(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}]),e}(),Cc=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(xc),Oc=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(xc),Sc=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(xc),Tc=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(xc),Ic=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(xc),Ec=si(Oi,"browser",[{provide:Ia,useValue:"browser"},{provide:Ta,useValue:function(){ju.makeCurrent(),zu.init()},multi:!0},{provide:is,useClass:function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._doc=e,r._init(),r}return _createClass(n,[{key:"_init",value:function(){this.location=Iu().getLocation(),this._history=Iu().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return Iu().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){Iu().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}},{key:"onHashChange",value:function(e){Iu().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){Mu()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){Mu()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}}]),n}(is),deps:[Is]},{provide:Is,useFactory:function(){return document},deps:[]}]);function Nc(){return new Xe}var Ac=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:Ca,useValue:t.appId},{provide:Pu,useExisting:Ca},Lu]}}}]),e}();"undefined"!=typeof window&&window;var Rc=function e(t,n){_classCallCheck(this,e),this.id=t,this.url=n},Dc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,n),(a=t.call(this,e,r)).navigationTrigger=i,a.restoredState=o,a}return _createClass(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(Rc),jc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e,r)).urlAfterRedirects=a,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(Rc),Fc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e,r)).reason=a,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(Rc),Mc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e,r)).error=a,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(Rc),Pc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Rc),Lc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Rc),zc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i,o){var s;return _classCallCheck(this,n),(s=t.call(this,e,r)).urlAfterRedirects=a,s.state=i,s.shouldActivate=o,s}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(Rc),Bc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Rc),Vc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(Rc),Wc=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),Uc=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),Hc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Gc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Kc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),qc=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Xc=function(){function e(t,n,r){_classCallCheck(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return _createClass(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),Zc=function e(){_classCallCheck(this,e)},Yc=function(){function e(t){_classCallCheck(this,e),this.params=t||{}}return _createClass(e,[{key:"has",value:function(e){return this.params.hasOwnProperty(e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function Qc(e){return new Yc(e)}function Jc(e){var t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function $c(e,t,n){var r=n.path.split("/");if(r.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var a={},i=0;i<r.length;i++){var o=r[i],s=e[i];if(o.startsWith(":"))a[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:a}}var el=function e(t,n){_classCallCheck(this,e),this.routes=t,this.module=n};function tl(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];nl(r,rl(t,r))}}function nl(e,t){if(!e)throw new Error("\n      Invalid configuration of route '".concat(t,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(e))throw new Error("Invalid configuration of route '".concat(t,"': Array cannot be specified"));if(!e.component&&!e.children&&!e.loadChildren&&e.outlet&&"primary"!==e.outlet)throw new Error("Invalid configuration of route '".concat(t,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(e.redirectTo&&e.children)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and children cannot be used together"));if(e.redirectTo&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and loadChildren cannot be used together"));if(e.children&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': children and loadChildren cannot be used together"));if(e.redirectTo&&e.component)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and component cannot be used together"));if(e.path&&e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': path and matcher cannot be used together"));if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===e.path&&void 0===e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': routes must have either a path or a matcher specified"));if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error("Invalid configuration of route '".concat(t,"': path cannot start with a slash"));if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(t,'", redirectTo: "').concat(e.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error("Invalid configuration of route '".concat(t,"': pathMatch can only be set to 'prefix' or 'full'"));e.children&&tl(e.children,t)}function rl(e,t){return t?e||t.path?e&&!t.path?e+"/":!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function al(e){var t=e.children&&e.children.map(al),n=t?Object.assign({},e,{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=Zc),n}function il(e,t){var n,r=Object.keys(e),a=Object.keys(t);if(!r||!a||r.length!=a.length)return!1;for(var i=0;i<r.length;i++)if(e[n=r[i]]!==t[n])return!1;return!0}function ol(e){return Array.prototype.concat.apply([],e)}function sl(e){return e.length>0?e[e.length-1]:null}function ul(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function cl(e){return Kt(e)?e:Gt(e)?Z(Promise.resolve(e)):js(e)}function ll(e,t,n){return n?function(e,t){return il(e,t)}(e.queryParams,t.queryParams)&&function e(t,n){if(!pl(t.segments,n.segments))return!1;if(t.numberOfChildren!==n.numberOfChildren)return!1;for(var r in n.children){if(!t.children[r])return!1;if(!e(t.children[r],n.children[r]))return!1}return!0}(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every((function(n){return t[n]===e[n]}))}(e.queryParams,t.queryParams)&&function e(t,n){return function t(n,r,a){if(n.segments.length>a.length)return!!pl(n.segments.slice(0,a.length),a)&&!r.hasChildren();if(n.segments.length===a.length){if(!pl(n.segments,a))return!1;for(var i in r.children){if(!n.children[i])return!1;if(!e(n.children[i],r.children[i]))return!1}return!0}var o=a.slice(0,n.segments.length),s=a.slice(n.segments.length);return!!pl(n.segments,o)&&!!n.children.primary&&t(n.children.primary,r,s)}(t,n,n.segments)}(e.root,t.root)}var hl=function(){function e(t,n,r){_classCallCheck(this,e),this.root=t,this.queryParams=n,this.fragment=r}return _createClass(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Qc(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return yl.serialize(this)}}]),e}(),dl=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.segments=t,this.children=n,this.parent=null,ul(n,(function(e,t){return e.parent=r}))}return _createClass(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return bl(this)}}]),e}(),fl=function(){function e(t,n){_classCallCheck(this,e),this.path=t,this.parameters=n}return _createClass(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=Qc(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return Ol(this)}}]),e}();function pl(e,t){return e.length===t.length&&e.every((function(e,n){return e.path===t[n].path}))}function ml(e,t){var n=[];return ul(e.children,(function(e,r){"primary"===r&&(n=n.concat(t(e,r)))})),ul(e.children,(function(e,r){"primary"!==r&&(n=n.concat(t(e,r)))})),n}var vl=function e(){_classCallCheck(this,e)},gl=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"parse",value:function(e){var t=new Nl(e);return new hl(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){return"".concat("/"+function e(t,n){if(!t.hasChildren())return bl(t);if(n){var r=t.children.primary?e(t.children.primary,!1):"",a=[];return ul(t.children,(function(t,n){"primary"!==n&&a.push("".concat(n,":").concat(e(t,!1)))})),a.length>0?"".concat(r,"(").concat(a.join("//"),")"):r}var i=ml(t,(function(n,r){return"primary"===r?[e(t.children.primary,!1)]:["".concat(r,":").concat(e(n,!1))]}));return"".concat(bl(t),"/(").concat(i.join("//"),")")}(e.root,!0)).concat((t=e.queryParams,n=Object.keys(t).map((function(e){var n=t[e];return Array.isArray(n)?n.map((function(t){return"".concat(_l(e),"=").concat(_l(t))})).join("&"):"".concat(_l(e),"=").concat(_l(n))})),n.length?"?"+n.join("&"):"")).concat("string"==typeof e.fragment?"#"+encodeURI(e.fragment):"");var t,n}}]),e}(),yl=new gl;function bl(e){return e.segments.map((function(e){return Ol(e)})).join("/")}function kl(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _l(e){return kl(e).replace(/%3B/gi,";")}function wl(e){return kl(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xl(e){return decodeURIComponent(e)}function Cl(e){return xl(e.replace(/\+/g,"%20"))}function Ol(e){return"".concat(wl(e.path)).concat((t=e.parameters,Object.keys(t).map((function(e){return";".concat(wl(e),"=").concat(wl(t[e]))})).join("")));var t}var Sl=/^[^\/()?;=#]+/;function Tl(e){var t=e.match(Sl);return t?t[0]:""}var Il=/^[^=?&#]+/,El=/^[^?&#]+/,Nl=function(){function e(t){_classCallCheck(this,e),this.url=t,this.remaining=t}return _createClass(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new dl([],{}):new dl([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n.primary=new dl(e,t)),n}},{key:"parseSegment",value:function(){var e=Tl(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new fl(xl(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=Tl(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=Tl(this.remaining);r&&(n=r,this.capture(n))}e[xl(t)]=xl(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(Il);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(El);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var a=Cl(t),i=Cl(n);if(e.hasOwnProperty(a)){var o=e[a];Array.isArray(o)||(o=[o],e[a]=o),o.push(i)}else e[a]=i}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=Tl(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var a=void 0;n.indexOf(":")>-1?(a=n.substr(0,n.indexOf(":")),this.capture(a),this.capture(":")):e&&(a="primary");var i=this.parseChildren();t[a]=1===Object.keys(i).length?i.primary:new dl([],i),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),Al=function(){function e(t){_classCallCheck(this,e),this._root=t}return _createClass(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=Rl(e,this._root);return t?t.children.map((function(e){return e.value})):[]}},{key:"firstChild",value:function(e){var t=Rl(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=Dl(e,this._root);return t.length<2?[]:t[t.length-2].children.map((function(e){return e.value})).filter((function(t){return t!==e}))}},{key:"pathFromRoot",value:function(e){return Dl(e,this._root).map((function(e){return e.value}))}}]),e}();function Rl(e,t){if(e===t.value)return t;var n,r=_createForOfIteratorHelper(t.children);try{for(r.s();!(n=r.n()).done;){var a=Rl(e,n.value);if(a)return a}}catch(i){r.e(i)}finally{r.f()}return null}function Dl(e,t){if(e===t.value)return[t];var n,r=_createForOfIteratorHelper(t.children);try{for(r.s();!(n=r.n()).done;){var a=Dl(e,n.value);if(a.length)return a.unshift(t),a}}catch(i){r.e(i)}finally{r.f()}return[]}var jl=function(){function e(t,n){_classCallCheck(this,e),this.value=t,this.children=n}return _createClass(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function Fl(e){var t={};return e&&e.children.forEach((function(e){return t[e.value.outlet]=e})),t}var Ml=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).snapshot=r,Wl(_assertThisInitialized(a),e),a}return _createClass(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(Al);function Pl(e,t){var n=function(e,t){var n=new Bl([],{},{},"",{},"primary",t,null,e.root,-1,{});return new Vl("",new jl(n,[]))}(e,t),r=new Fs([new fl("",{})]),a=new Fs({}),i=new Fs({}),o=new Fs({}),s=new Fs(""),u=new Ll(r,a,o,s,i,"primary",t,n.root);return u.snapshot=n.root,new Ml(new jl(u,[]),n)}var Ll=function(){function e(t,n,r,a,i,o,s,u){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=a,this.data=i,this.outlet=o,this.component=s,this._futureSnapshot=u}return _createClass(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(G((function(e){return Qc(e)})))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(G((function(e){return Qc(e)})))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function zl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var a=n[r],i=n[r-1];if(a.routeConfig&&""===a.routeConfig.path)r--;else{if(i.component)break;r--}}return function(e){return e.reduce((function(e,t){return{params:Object.assign({},e.params,t.params),data:Object.assign({},e.data,t.data),resolve:Object.assign({},e.resolve,t._resolvedData)}}),{params:{},data:{},resolve:{}})}(n.slice(r))}var Bl=function(){function e(t,n,r,a,i,o,s,u,c,l,h){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=a,this.data=i,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return _createClass(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=Qc(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Qc(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map((function(e){return e.toString()})).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),Vl=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,r)).url=e,Wl(_assertThisInitialized(a),r),a}return _createClass(n,[{key:"toString",value:function(){return Ul(this._root)}}]),n}(Al);function Wl(e,t){t.value._routerState=e,t.children.forEach((function(t){return Wl(e,t)}))}function Ul(e){var t=e.children.length>0?" { ".concat(e.children.map(Ul).join(", ")," } "):"";return"".concat(e.value).concat(t)}function Hl(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,il(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),il(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!il(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),il(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Gl(e,t){var n,r;return il(e.params,t.params)&&pl(n=e.url,r=t.url)&&n.every((function(e,t){return il(e.parameters,r[t].parameters)}))&&!(!e.parent!=!t.parent)&&(!e.parent||Gl(e.parent,t.parent))}function Kl(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function ql(e,t,n,r,a){var i={};return r&&ul(r,(function(e,t){i[t]=Array.isArray(e)?e.map((function(e){return""+e})):""+e})),new hl(n.root===e?t:function e(t,n,r){var a={};return ul(t.children,(function(t,i){a[i]=t===n?r:e(t,n,r)})),new dl(t.segments,a)}(n.root,e,t),i,a)}var Xl=function(){function e(t,n,r){if(_classCallCheck(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&Kl(r[0]))throw new Error("Root segment cannot have matrix parameters");var a=r.find((function(e){return"object"==typeof e&&null!=e&&e.outlets}));if(a&&a!==sl(r))throw new Error("{outlets:{}} has to be the last command")}return _createClass(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),Zl=function e(t,n,r){_classCallCheck(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r};function Yl(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets.primary:""+e}function Ql(e,t,n){if(e||(e=new dl([],{})),0===e.segments.length&&e.hasChildren())return Jl(e,t,n);var r=function(e,t,n){for(var r=0,a=t,i={match:!1,pathIndex:0,commandIndex:0};a<e.segments.length;){if(r>=n.length)return i;var o=e.segments[a],s=Yl(n[r]),u=r<n.length-1?n[r+1]:null;if(a>0&&void 0===s)break;if(s&&u&&"object"==typeof u&&void 0===u.outlets){if(!nh(s,u,o))return i;r+=2}else{if(!nh(s,{},o))return i;r++}a++}return{match:!0,pathIndex:a,commandIndex:r}}(e,t,n),a=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var i=new dl(e.segments.slice(0,r.pathIndex),{});return i.children.primary=new dl(e.segments.slice(r.pathIndex),e.children),Jl(i,0,a)}return r.match&&0===a.length?new dl(e.segments,{}):r.match&&!e.hasChildren()?$l(e,t,n):r.match?Jl(e,0,a):$l(e,t,n)}function Jl(e,t,n){if(0===n.length)return new dl(e.segments,{});var r=function(e){return"object"!=typeof e[0]||void 0===e[0].outlets?{primary:e}:e[0].outlets}(n),a={};return ul(r,(function(n,r){null!==n&&(a[r]=Ql(e.children[r],t,n))})),ul(e.children,(function(e,t){void 0===r[t]&&(a[t]=e)})),new dl(e.segments,a)}function $l(e,t,n){for(var r=e.segments.slice(0,t),a=0;a<n.length;){if("object"==typeof n[a]&&void 0!==n[a].outlets){var i=eh(n[a].outlets);return new dl(r,i)}if(0===a&&Kl(n[0]))r.push(new fl(e.segments[t].path,n[0])),a++;else{var o=Yl(n[a]),s=a<n.length-1?n[a+1]:null;o&&s&&Kl(s)?(r.push(new fl(o,th(s))),a+=2):(r.push(new fl(o,{})),a++)}}return new dl(r,{})}function eh(e){var t={};return ul(e,(function(e,n){null!==e&&(t[n]=$l(new dl([],{}),0,e))})),t}function th(e){var t={};return ul(e,(function(e,n){return t[n]=""+e})),t}function nh(e,t,n){return e==n.path&&il(t,n.parameters)}var rh=function(){function e(t,n,r,a){_classCallCheck(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=a}return _createClass(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Hl(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,a=Fl(t);e.children.forEach((function(e){var t=e.value.outlet;r.deactivateRoutes(e,a[t],n),delete a[t]})),ul(a,(function(e,t){r.deactivateRouteAndItsChildren(e,n)}))}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,a=t?t.value:null;if(r===a)if(r.component){var i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(e,t,i.children)}else this.deactivateChildRoutes(e,t,n);else a&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:a})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){var n=this,r=t.getContext(e.value.outlet);if(r){var a=Fl(e),i=e.value.component?r.children:t;ul(a,(function(e,t){return n.deactivateRouteAndItsChildren(e,i)})),r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,a=Fl(t);e.children.forEach((function(e){r.activateRoutes(e,a[e.value.outlet],n),r.forwardEvent(new qc(e.value.snapshot))})),e.children.length&&this.forwardEvent(new Gc(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,a=t?t.value:null;if(Hl(r),r===a)if(r.component){var i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,i.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),ah(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function ah(e){Hl(e.value),e.children.forEach(ah)}function ih(e){return"function"==typeof e}function oh(e){return e instanceof hl}var sh=function e(t){_classCallCheck(this,e),this.segmentGroup=t||null},uh=function e(t){_classCallCheck(this,e),this.urlTree=t};function ch(e){return new C((function(t){return t.error(new sh(e))}))}function lh(e){return new C((function(t){return t.error(new uh(e))}))}function hh(e){return new C((function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))}))}var dh=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=a,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(ze)}return _createClass(e,[{key:"apply",value:function(){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(G((function(t){return e.createUrlTree(t,e.urlTree.queryParams,e.urlTree.fragment)}))).pipe(su((function(t){if(t instanceof uh)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof sh)throw e.noMatchError(t);throw t})))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,"primary").pipe(G((function(n){return t.createUrlTree(n,e.queryParams,e.fragment)}))).pipe(su((function(e){if(e instanceof sh)throw t.noMatchError(e);throw e})))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new dl([],{primary:e}):e;return new hl(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(G((function(e){return new dl([],e)}))):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){var r=this;return function(n,a){if(0===Object.keys(n).length)return js({});var i=[],o=[],s={};return ul(n,(function(n,a){var u,c,l=(u=a,c=n,r.expandSegmentGroup(e,t,c,u)).pipe(G((function(e){return s[a]=e})));"primary"===a?i.push(l):o.push(l)})),js.apply(null,i.concat(o)).pipe(Us(),ou(),G((function(){return s})))}(n.children)}},{key:"expandSegment",value:function(e,t,n,r,a,i){var o=this;return js.apply(void 0,_toConsumableArray(n)).pipe(G((function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,a,i).pipe(su((function(e){if(e instanceof sh)return js(null);throw e})))})),Us(),fu((function(e){return!!e})),su((function(e,n){if(e instanceof Ps||"EmptyError"===e.name){if(o.noLeftoversInUrl(t,r,a))return js(new dl([],{}));throw new sh(t)}throw e})))}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,a,i,o){return vh(r)!==i?ch(t):void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,a,i):ch(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,a,i){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,i):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,a,i)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var a=this,i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?lh(i):this.lineralizeSegments(n,i).pipe(Y((function(n){var i=new dl(n,{});return a.expandSegment(e,i,t,n,r,!1)})))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,a,i){var o=this,s=fh(t,r,a),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return ch(t);var d=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?lh(d):this.lineralizeSegments(r,d).pipe(Y((function(r){return o.expandSegment(e,t,n,r.concat(a.slice(l)),i,!1)})))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r){var a=this;if("**"===n.path)return n.loadChildren?this.configLoader.load(e.injector,n).pipe(G((function(e){return n._loadedConfig=e,new dl(r,{})}))):js(new dl(r,{}));var i=fh(t,n,r),o=i.matched,s=i.consumedSegments,u=i.lastChild;if(!o)return ch(t);var c=r.slice(u);return this.getChildConfig(e,n,r).pipe(Y((function(e){var n=e.module,r=e.routes,i=function(e,t,n,r){return n.length>0&&function(e,t,n){return n.some((function(n){return mh(e,t,n)&&"primary"!==vh(n)}))}(e,n,r)?{segmentGroup:ph(new dl(t,function(e,t){var n={};n.primary=t;var r,a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;""===i.path&&"primary"!==vh(i)&&(n[vh(i)]=new dl([],{}))}}catch(o){a.e(o)}finally{a.f()}return n}(r,new dl(n,e.children)))),slicedSegments:[]}:0===n.length&&function(e,t,n){return n.some((function(n){return mh(e,t,n)}))}(e,n,r)?{segmentGroup:ph(new dl(e.segments,function(e,t,n,r){var a,i={},o=_createForOfIteratorHelper(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;mh(e,t,s)&&!r[vh(s)]&&(i[vh(s)]=new dl([],{}))}}catch(u){o.e(u)}finally{o.f()}return Object.assign({},r,i)}(e,n,r,e.children))),slicedSegments:n}:{segmentGroup:e,slicedSegments:n}}(t,s,c,r),o=i.segmentGroup,u=i.slicedSegments;return 0===u.length&&o.hasChildren()?a.expandChildren(n,r,o).pipe(G((function(e){return new dl(s,e)}))):0===r.length&&0===u.length?js(new dl(s,{})):a.expandSegment(n,o,r,u,"primary",!0).pipe(G((function(e){return new dl(s.concat(e.segments),e.children)})))})))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?js(new el(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?js(t._loadedConfig):function(e,t,n){var r,a=t.canLoad;return a&&0!==a.length?Z(a).pipe(G((function(r){var a,i=e.get(r);if(function(e){return e&&ih(e.canLoad)}(i))a=i.canLoad(t,n);else{if(!ih(i))throw new Error("Invalid CanLoad guard");a=i(t,n)}return cl(a)}))).pipe(Us(),(r=function(e){return!0===e},function(e){return e.lift(new pu(r,void 0,e))})):js(!0)}(e.injector,t,n).pipe(Y((function(n){return n?r.configLoader.load(e.injector,t).pipe(G((function(e){return t._loadedConfig=e,e}))):function(e){return new C((function(t){return t.error(Jc("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))}))}(t)}))):js(new el([],e))}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return js(n);if(r.numberOfChildren>1||!r.children.primary)return hh(e.redirectTo);r=r.children.primary}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var a=this.createSegmentGroup(e,t.root,n,r);return new hl(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return ul(e,(function(e,r){if("string"==typeof e&&e.startsWith(":")){var a=e.substring(1);n[r]=t[a]}else n[r]=e})),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var a=this,i=this.createSegments(e,t.segments,n,r),o={};return ul(t.children,(function(t,i){o[i]=a.createSegmentGroup(e,t,n,r)})),new dl(i,o)}},{key:"createSegments",value:function(e,t,n,r){var a=this;return t.map((function(t){return t.path.startsWith(":")?a.findPosParam(e,t,r):a.findOrReturn(t,n)}))}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,a=_createForOfIteratorHelper(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.path===e.path)return t.splice(r),i;r++}}catch(o){a.e(o)}finally{a.f()}return e}}]),e}();function fh(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var r=(t.matcher||$c)(n,e,t);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function ph(e){if(1===e.numberOfChildren&&e.children.primary){var t=e.children.primary;return new dl(e.segments.concat(t.segments),t.children)}return e}function mh(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function vh(e){return e.outlet||"primary"}var gh=function e(t){_classCallCheck(this,e),this.path=t,this.route=this.path[this.path.length-1]},yh=function e(t,n){_classCallCheck(this,e),this.component=t,this.route=n};function bh(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function kh(e,t,n){var r=Fl(e),a=e.value;ul(r,(function(e,r){kh(e,a.component?t?t.children.getContext(r):null:t,n)})),n.canDeactivateChecks.push(new yh(a.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,a))}var _h=Symbol("INITIAL_VALUE");function wh(){return vu((function(e){return zs.apply(void 0,_toConsumableArray(e.map((function(e){return e.pipe(lu(1),ku(_h))})))).pipe(_u((function(e,t){var n=!1;return t.reduce((function(e,r,a){if(e!==_h)return e;if(r===_h&&(n=!0),!n){if(!1===r)return r;if(a===t.length-1||oh(r))return r}return e}),e)}),_h),Hs((function(e){return e!==_h})),G((function(e){return oh(e)?e:!0===e})),lu(1))}))}function xh(e,t){return null!==e&&t&&t(new Kc(e)),js(!0)}function Ch(e,t){return null!==e&&t&&t(new Hc(e)),js(!0)}function Oh(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?js(r.map((function(r){return Ws((function(){var a,i=bh(r,t,n);if(function(e){return e&&ih(e.canActivate)}(i))a=cl(i.canActivate(t,e));else{if(!ih(i))throw new Error("Invalid CanActivate guard");a=cl(i(t,e))}return a.pipe(fu())}))}))).pipe(wh()):js(!0)}function Sh(e,t,n){var r=t[t.length-1],a=t.slice(0,t.length-1).reverse().map((function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)})).filter((function(e){return null!==e})).map((function(t){return Ws((function(){return js(t.guards.map((function(a){var i,o=bh(a,t.node,n);if(function(e){return e&&ih(e.canActivateChild)}(o))i=cl(o.canActivateChild(r,e));else{if(!ih(o))throw new Error("Invalid CanActivateChild guard");i=cl(o(r,e))}return i.pipe(fu())}))).pipe(wh())}))}));return js(a).pipe(wh())}var Th=function e(){_classCallCheck(this,e)},Ih=function(){function e(t,n,r,a,i,o){_classCallCheck(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=a,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}return _createClass(e,[{key:"recognize",value:function(){try{var e=Ah(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,"primary"),n=new Bl([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new jl(n,t),a=new Vl(this.url,r);return this.inheritParamsAndData(a._root),js(a)}catch(i){return new C((function(e){return e.error(i)}))}}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=zl(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach((function(e){return t.inheritParamsAndData(e)}))}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){var n,r=this,a=ml(t,(function(t,n){return r.processSegmentGroup(e,t,n)}));return n={},a.forEach((function(e){var t=n[e.value.outlet];if(t){var r=t.url.map((function(e){return e.toString()})).join("/"),a=e.value.url.map((function(e){return e.toString()})).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(r,"' and '").concat(a,"'."))}n[e.value.outlet]=e.value})),a.sort((function(e,t){return"primary"===e.value.outlet?-1:"primary"===t.value.outlet?1:e.value.outlet.localeCompare(t.value.outlet)})),a}},{key:"processSegment",value:function(e,t,n,r){var a,i=_createForOfIteratorHelper(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;try{return this.processSegmentAgainstRoute(o,t,n,r)}catch(s){if(!(s instanceof Th))throw s}}}catch(u){i.e(u)}finally{i.f()}if(this.noLeftoversInUrl(t,n,r))return[];throw new Th}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo)throw new Th;if((e.outlet||"primary")!==r)throw new Th;var a,i=[],o=[];if("**"===e.path){var s=n.length>0?sl(n).parameters:{};a=new Bl(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,jh(e),r,e.component,e,Eh(t),Nh(t)+n.length,Fh(e))}else{var u=function(e,t,n){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||n.length>0))throw new Th;return{consumedSegments:[],lastChild:0,parameters:{}}}var r=(t.matcher||$c)(n,e,t);if(!r)throw new Th;var a={};ul(r.posParams,(function(e,t){a[t]=e.path}));var i=r.consumed.length>0?Object.assign({},a,r.consumed[r.consumed.length-1].parameters):a;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:i}}(t,e,n);i=u.consumedSegments,o=n.slice(u.lastChild),a=new Bl(i,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,jh(e),r,e.component,e,Eh(t),Nh(t)+i.length,Fh(e))}var c=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),l=Ah(t,i,o,c,this.relativeLinkResolution),h=l.segmentGroup,d=l.slicedSegments;if(0===d.length&&h.hasChildren()){var f=this.processChildren(c,h);return[new jl(a,f)]}if(0===c.length&&0===d.length)return[new jl(a,[])];var p=this.processSegment(c,h,d,"primary");return[new jl(a,p)]}}]),e}();function Eh(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function Nh(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function Ah(e,t,n,r,a){if(n.length>0&&function(e,t,n){return n.some((function(n){return Rh(e,t,n)&&"primary"!==Dh(n)}))}(e,n,r)){var i=new dl(t,function(e,t,n,r){var a={};a.primary=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var i,o=_createForOfIteratorHelper(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(""===s.path&&"primary"!==Dh(s)){var u=new dl([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,a[Dh(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return a}(e,t,r,new dl(n,e.children)));return i._sourceSegment=e,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some((function(n){return Rh(e,t,n)}))}(e,n,r)){var o=new dl(e.segments,function(e,t,n,r,a,i){var o,s={},u=_createForOfIteratorHelper(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(Rh(e,n,c)&&!a[Dh(c)]){var l=new dl([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===i?e.segments.length:t.length,s[Dh(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign({},a,s)}(e,t,n,r,e.children,a));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new dl(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function Rh(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function Dh(e){return e.outlet||"primary"}function jh(e){return e.data||{}}function Fh(e){return e.resolve||{}}function Mh(e,t,n,r){var a=bh(e,t,r);return cl(a.resolve?a.resolve(t,n):a(t,n))}function Ph(e){return function(t){return t.pipe(vu((function(t){var n=e(t);return n?Z(n).pipe(G((function(){return t}))):Z([t])})))}}var Lh=function e(){_classCallCheck(this,e)},zh=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}(),Bh=new Ie("ROUTES"),Vh=function(){function e(t,n,r,a){_classCallCheck(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=a}return _createClass(e,[{key:"load",value:function(e,t){var n=this;return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(G((function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var a=r.create(e);return new el(ol(a.injector.get(Bh)).map(al),a)})))}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?Z(this.loader.load(e)):cl(e()).pipe(Y((function(e){return e instanceof Be?js(e):Z(t.compiler.compileModuleAsync(e))})))}}]),e}(),Wh=function e(){_classCallCheck(this,e)},Uh=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function Hh(e){throw e}function Gh(e,t,n){return t.parse("/")}function Kh(e,t){return js(null)}var qh=function(){function e(t,n,r,a,i,o,s,u){var c=this;_classCallCheck(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=a,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new A,this.errorHandler=Hh,this.malformedUriErrorHandler=Gh,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Kh,afterPreactivation:Kh},this.urlHandlingStrategy=new Uh,this.routeReuseStrategy=new zh,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(ze),this.console=i.get(Na);var l=i.get(Xa);this.isNgZoneEnabled=l instanceof Xa,this.resetConfig(u),this.currentUrlTree=new hl(new dl([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Vh(o,s,(function(e){return c.triggerEvent(new Wc(e))}),(function(e){return c.triggerEvent(new Uc(e))})),this.routerState=Pl(this.currentUrlTree,this.rootComponentType),this.transitions=new Fs({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(e,[{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(Hs((function(e){return 0!==e.id})),G((function(e){return Object.assign({},e,{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})})),vu((function(e){var r,a,i,o,s=!1,u=!1;return js(e).pipe(Js((function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign({},t.lastSuccessfulNavigation,{previousNavigation:null}):null}})),vu((function(e){var r,a,i,o,s=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||s)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return js(e).pipe(vu((function(e){var r=t.transitions.getValue();return n.next(new Dc(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?As:[e]})),vu((function(e){return Promise.resolve(e)})),(r=t.ngModule.injector,a=t.configLoader,i=t.urlSerializer,o=t.config,function(e){return e.pipe(vu((function(e){return function(e,t,n,r,a){return new dh(e,t,n,r,a).apply()}(r,a,i,e.extractedUrl,o).pipe(G((function(t){return Object.assign({},e,{urlAfterRedirects:t})})))})))}),Js((function(e){t.currentNavigation=Object.assign({},t.currentNavigation,{finalUrl:e.urlAfterRedirects})})),function(e,n,r,a,i){return function(r){return r.pipe(Y((function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new Ih(e,t,n,r,a,i).recognize()}(e,n,r.urlAfterRedirects,(o=r.urlAfterRedirects,t.serializeUrl(o)),a,i).pipe(G((function(e){return Object.assign({},r,{targetSnapshot:e})})));var o})))}}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),Js((function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),Js((function(e){var r=new Pc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)})));if(s&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var u=e.id,c=e.extractedUrl,l=e.source,h=e.restoredState,d=e.extras,f=new Dc(u,t.serializeUrl(c),l,h);n.next(f);var p=Pl(c,t.rootComponentType).snapshot;return js(Object.assign({},e,{targetSnapshot:p,urlAfterRedirects:c,extras:Object.assign({},d,{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),As})),Ph((function(e){var n=e.targetSnapshot,r=e.id,a=e.extractedUrl,i=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:a,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!u})})),Js((function(e){var n=new Lc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),G((function(e){return Object.assign({},e,{guards:(n=e.targetSnapshot,r=e.currentSnapshot,a=t.rootContexts,i=n._root,function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=Fl(n);return t.children.forEach((function(t){!function(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=t.value,s=n?n.value:null,u=r?r.getContext(t.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){var c=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!pl(e.url,t.url);case"pathParamsOrQueryParamsChange":return!pl(e.url,t.url)||!il(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Gl(e,t)||!il(e.queryParams,t.queryParams);case"paramsChange":default:return!Gl(e,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new gh(a)):(o.data=s.data,o._resolvedData=s._resolvedData),e(t,n,o.component?u?u.children:null:r,a,i),c&&i.canDeactivateChecks.push(new yh(u&&u.outlet&&u.outlet.component||null,s))}else s&&kh(n,u,i),i.canActivateChecks.push(new gh(a)),e(t,null,o.component?u?u.children:null:r,a,i)}(t,o[t.value.outlet],r,a.concat([t.value]),i),delete o[t.value.outlet]})),ul(o,(function(e,t){return kh(e,r.getContext(t),i)})),i}(i,r?r._root:null,a,[i.value]))});var n,r,a,i})),function(e,t){return function(n){return n.pipe(Y((function(n){var r=n.targetSnapshot,a=n.currentSnapshot,i=n.guards,o=i.canActivateChecks,s=i.canDeactivateChecks;return 0===s.length&&0===o.length?js(Object.assign({},n,{guardsResult:!0})):function(e,t,n,r){return Z(e).pipe(Y((function(e){return function(e,t,n,r,a){var i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?js(i.map((function(i){var o,s=bh(i,t,a);if(function(e){return e&&ih(e.canDeactivate)}(s))o=cl(s.canDeactivate(e,t,n,r));else{if(!ih(s))throw new Error("Invalid CanDeactivate guard");o=cl(s(e,t,n,r))}return o.pipe(fu())}))).pipe(wh()):js(!0)}(e.component,e.route,n,t,r)})),fu((function(e){return!0!==e}),!0))}(s,r,a,e).pipe(Y((function(n){return n&&"boolean"==typeof n?function(e,t,n,r){return Z(t).pipe(Cu((function(t){return Z([Ch(t.route.parent,r),xh(t.route,r),Sh(e,t.path,n),Oh(e,t.route,n)]).pipe(Us(),fu((function(e){return!0!==e}),!0))})),fu((function(e){return!0!==e}),!0))}(r,o,e,t):js(n)})),G((function(e){return Object.assign({},n,{guardsResult:e})})))})))}}(t.ngModule.injector,(function(e){return t.triggerEvent(e)})),Js((function(e){if(oh(e.guardsResult)){var n=Jc('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}})),Js((function(e){var n=new zc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(n)})),Hs((function(e){if(!e.guardsResult){t.resetUrlToCurrentUrlTree();var r=new Fc(e.id,t.serializeUrl(e.extractedUrl),"");return n.next(r),e.resolve(!1),!1}return!0})),Ph((function(e){if(e.guards.canActivateChecks.length)return js(e).pipe(Js((function(e){var n=new Bc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),(n=t.paramsInheritanceStrategy,r=t.ngModule.injector,function(e){return e.pipe(Y((function(e){var t=e.targetSnapshot,a=e.guards.canActivateChecks;return a.length?Z(a).pipe(Cu((function(e){return function(e,t,n,r){return function(e,t,n,r){var a=Object.keys(e);if(0===a.length)return js({});if(1===a.length){var i=a[0];return Mh(e[i],t,n,r).pipe(G((function(e){return _defineProperty({},i,e)})))}var o={};return Z(a).pipe(Y((function(a){return Mh(e[a],t,n,r).pipe(G((function(e){return o[a]=e,e})))}))).pipe(ou(),G((function(){return o})))}(e._resolve,e,t,r).pipe(G((function(t){return e._resolvedData=t,e.data=Object.assign({},e.data,zl(e,n).resolve),null})))}(e.route,t,n,r)})),function(e,t){return arguments.length>=2?function(n){return _(_u(e,t),Zs(1),ru(t))(n)}:function(t){return _(_u((function(t,n,r){return e(t,n,r+1)})),Zs(1))(t)}}((function(e,t){return e})),G((function(t){return e}))):js(e)})))}),Js((function(e){var n=new Vc(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})));var n,r})),Ph((function(e){var n=e.targetSnapshot,r=e.id,a=e.extractedUrl,i=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:a,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!u})})),G((function(e){var n=function(e,t,n){var r=function e(t,n,r){if(r&&t.shouldReuseRoute(n.value,r.value.snapshot)){var a=r.value;a._futureSnapshot=n.value;var i=function(t,n,r){return n.children.map((function(n){var a,i=_createForOfIteratorHelper(r.children);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(t.shouldReuseRoute(o.value.snapshot,n.value))return e(t,n,o)}}catch(s){i.e(s)}finally{i.f()}return e(t,n)}))}(t,n,r);return new jl(a,i)}var o=t.retrieve(n.value);if(o){var s=o.route;return function e(t,n){if(t.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=t.value;for(var r=0;r<t.children.length;++r)e(t.children[r],n.children[r])}(n,s),s}var u,c=new Ll(new Fs((u=n.value).url),new Fs(u.params),new Fs(u.queryParams),new Fs(u.fragment),new Fs(u.data),u.outlet,u.component,u),l=n.children.map((function(n){return e(t,n)}));return new jl(c,l)}(e,t._root,n?n._root:void 0);return new Ml(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign({},e,{targetRouterState:n})})),Js((function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),(a=t.rootContexts,i=t.routeReuseStrategy,o=function(e){return t.triggerEvent(e)},G((function(e){return new rh(i,e.targetRouterState,e.currentRouterState,o).activate(a),e}))),Js({next:function(){s=!0},complete:function(){s=!0}}),(r=function(){if(!s&&!u){t.resetUrlToCurrentUrlTree();var r=new Fc(e.id,t.serializeUrl(e.extractedUrl),"Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId));n.next(r),e.resolve(!1)}t.currentNavigation=null},function(e){return e.lift(new Ou(r))}),su((function(r){if(u=!0,(s=r)&&s.ngNavigationCancelingError){var a=oh(r.url);a||(t.navigated=!0,t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));var i=new Fc(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(i),e.resolve(!1),a&&t.navigateByUrl(r.url)}else{t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);var o=new Mc(e.id,t.serializeUrl(e.extractedUrl),r);n.next(o);try{e.resolve(t.errorHandler(r))}catch(c){e.reject(c)}}var s;return As})))})))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign({},this.getTransition(),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe((function(t){var n=e.parseUrl(t.url),r="popstate"===t.type?"popstate":"hashchange",a=t.state&&t.state.navigationId?t.state:null;setTimeout((function(){e.scheduleNavigation(n,r,a,{replaceUrl:!0})}),0)})))}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){tl(e),this.config=e.map(al),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,a=t.fragment,i=t.preserveQueryParams,o=t.queryParamsHandling,s=t.preserveFragment;Qe()&&i&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var u=n||this.routerState.root,c=s?this.currentUrlTree.fragment:a,l=null;if(o)switch(o){case"merge":l=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}else l=i?this.currentUrlTree.queryParams:r||null;return null!==l&&(l=this.removeEmptyProps(l)),function(e,t,n,r,a){if(0===n.length)return ql(t.root,t.root,t,r,a);var i=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Xl(!0,0,e);var t=0,n=!1,r=e.reduce((function(e,r,a){if("object"==typeof r&&null!=r){if(r.outlets){var i={};return ul(r.outlets,(function(e,t){i[t]="string"==typeof e?e.split("/"):e})),[].concat(_toConsumableArray(e),[{outlets:i}])}if(r.segmentPath)return[].concat(_toConsumableArray(e),[r.segmentPath])}return"string"!=typeof r?[].concat(_toConsumableArray(e),[r]):0===a?(r.split("/").forEach((function(r,a){0==a&&"."===r||(0==a&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))})),e):[].concat(_toConsumableArray(e),[r])}),[]);return new Xl(n,t,r)}(n);if(i.toRoot())return ql(t.root,new dl([],{}),t,r,a);var o=function(e,t,n){if(e.isAbsolute)return new Zl(t.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new Zl(n.snapshot._urlSegment,!0,0);var r=Kl(e.commands[0])?0:1;return function(e,t,n){for(var r=e,a=t,i=n;i>a;){if(i-=a,!(r=r.parent))throw new Error("Invalid number of '../'");a=r.segments.length}return new Zl(r,!1,a-i)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(i,t,e),s=o.processChildren?Jl(o.segmentGroup,o.index,i.commands):Ql(o.segmentGroup,o.index,i.commands);return ql(o.segmentGroup,s,t,r,a)}(u,this.currentUrlTree,e,l,c)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};Qe()&&this.isNgZoneEnabled&&!Xa.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var n=oh(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){if(oh(e))return ll(this.currentUrlTree,e,t);var n=this.parseUrl(e);return ll(this.currentUrlTree,n,t)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce((function(t,n){var r=e[n];return null!=r&&(t[n]=r),t}),{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe((function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.events.next(new jc(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,e.currentNavigation=null,t.resolve(!0)}),(function(t){e.console.warn("Unhandled Navigation Error: ")}))}},{key:"scheduleNavigation",value:function(e,t,n,r){var a=this.getTransition();if(a&&"imperative"!==t&&"imperative"===a.source&&a.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(a&&"hashchange"==t&&"popstate"===a.source&&a.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(a&&"popstate"==t&&"hashchange"===a.source&&a.rawUrl.toString()===e.toString())return Promise.resolve(!0);var i=null,o=null,s=new Promise((function(e,t){i=e,o=t})),u=++this.navigationId;return this.setTransition({id:u,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:i,reject:o,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch((function(e){return Promise.reject(e)}))}},{key:"setBrowserUrl",value:function(e,t,n,r){var a=this.urlSerializer.serialize(e);r=r||{},this.location.isCurrentPathEqualTo(a)||t?this.location.replaceState(a,"",Object.assign({},r,{navigationId:n})):this.location.go(a,"",Object.assign({},r,{navigationId:n}))}},{key:"resetStateAndUrl",value:function(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}]),e}(),Xh=function(){function e(t,n,r){var a=this;_classCallCheck(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.subscription=t.events.subscribe((function(e){e instanceof jc&&a.updateTargetUrlAndHref()}))}return _createClass(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"preserveQueryParams",set:function(e){Qe()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=e}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r){if(0!==e||t||n||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:Zh(this.skipLocationChange),replaceUrl:Zh(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:Zh(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:Zh(this.preserveFragment)})}}]),e}();function Zh(e){return""===e||!!e}var Yh=function e(){_classCallCheck(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new Qh,this.attachRef=null},Qh=function(){function e(){_classCallCheck(this,e),this.contexts=new Map}return _createClass(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new Yh,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),Jh=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new ba,this.deactivateEvents=new ba,this.name=a||"primary",t.onChildOutletCreated(this.name,this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,a=new $h(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,a),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}(),$h=function(){function e(t,n,r){_classCallCheck(this,e),this.route=t,this.childContexts=n,this.parent=r}return _createClass(e,[{key:"get",value:function(e,t){return e===Ll?this.route:e===Qh?this.childContexts:this.parent.get(e,t)}}]),e}(),ed=function e(){_classCallCheck(this,e)},td=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return t().pipe(su((function(){return js(null)})))}}]),e}(),nd=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return js(null)}}]),e}(),rd=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.router=t,this.injector=a,this.preloadingStrategy=i,this.loader=new Vh(n,r,(function(e){return t.triggerEvent(new Wc(e))}),(function(e){return t.triggerEvent(new Uc(e))}))}return _createClass(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(Hs((function(e){return e instanceof jc})),Cu((function(){return e.preload()}))).subscribe((function(){}))}},{key:"preload",value:function(){var e=this.injector.get(ze);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],a=_createForOfIteratorHelper(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.loadChildren&&!i.canLoad&&i._loadedConfig){var o=i._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else i.loadChildren&&!i.canLoad?r.push(this.preloadConfig(e,i)):i.children&&r.push(this.processRoutes(e,i.children))}}catch(s){a.e(s)}finally{a.f()}return Z(r).pipe(ee(),G((function(e){})))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,(function(){return n.loader.load(e.injector,t).pipe(Y((function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)})))}))}}]),e}(),ad=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return _createClass(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof Dc?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof jc&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))}))}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof Xc&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))}))}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new Xc(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}(),id=new Ie("ROUTER_CONFIGURATION"),od=new Ie("ROUTER_FORROOT_GUARD"),sd=[cs,{provide:vl,useClass:gl},{provide:qh,useFactory:pd,deps:[di,vl,Qh,cs,Et,pi,za,Bh,id,[Wh,new he],[Lh,new he]]},Qh,{provide:Ll,useFactory:md,deps:[qh]},{provide:pi,useClass:gi},rd,nd,td,{provide:id,useValue:{enableTracing:!1}}];function ud(){return new oi("Router",qh)}var cd=function(){function e(t,n){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[sd,fd(t),{provide:od,useFactory:dd,deps:[[qh,new he,new fe]]},{provide:id,useValue:n||{}},{provide:ss,useFactory:hd,deps:[is,[new le(us),new he],id]},{provide:ad,useFactory:ld,deps:[qh,Es,id]},{provide:ed,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:nd},{provide:oi,multi:!0,useFactory:ud},[vd,{provide:wa,multi:!0,useFactory:gd,deps:[vd]},{provide:bd,useFactory:yd,deps:[vd]},{provide:Ea,multi:!0,useExisting:bd}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[fd(t)]}}}]),e}();function ld(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new ad(e,t,n)}function hd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new hs(e,t):new ds(e,t)}function dd(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function fd(e){return[{provide:Pt,multi:!0,useValue:e},{provide:Bh,multi:!0,useValue:e}]}function pd(e,t,n,r,a,i,o,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:{},c=arguments.length>9?arguments[9]:void 0,l=arguments.length>10?arguments[10]:void 0,h=new qh(null,t,n,r,a,i,o,ol(s));if(c&&(h.urlHandlingStrategy=c),l&&(h.routeReuseStrategy=l),u.errorHandler&&(h.errorHandler=u.errorHandler),u.malformedUriErrorHandler&&(h.malformedUriErrorHandler=u.malformedUriErrorHandler),u.enableTracing){var d=Iu();h.events.subscribe((function(e){d.logGroup("Router Event: "+e.constructor.name),d.log(e.toString()),d.log(e),d.logGroupEnd()}))}return u.onSameUrlNavigation&&(h.onSameUrlNavigation=u.onSameUrlNavigation),u.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=u.paramsInheritanceStrategy),u.urlUpdateStrategy&&(h.urlUpdateStrategy=u.urlUpdateStrategy),u.relativeLinkResolution&&(h.relativeLinkResolution=u.relativeLinkResolution),h}function md(e){return e.routerState.root}var vd=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new A}return _createClass(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(os,Promise.resolve(null)).then((function(){var t=null,n=new Promise((function(e){return t=e})),r=e.injector.get(qh),a=e.injector.get(id);if(e.isLegacyDisabled(a)||e.isLegacyEnabled(a))t(!0);else if("disabled"===a.initialNavigation)r.setUpLocationChangeListener(),t(!0);else{if("enabled"!==a.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(a.initialNavigation,"'"));r.hooks.afterPreactivation=function(){return e.initNavigation?js(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()}return n}))}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(id),n=this.injector.get(rd),r=this.injector.get(ad),a=this.injector.get(qh),i=this.injector.get(di);e===i.components[0]&&(this.isLegacyEnabled(t)?a.initialNavigation():this.isLegacyDisabled(t)&&a.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),a.resetRootComponentType(i.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation}},{key:"isLegacyDisabled",value:function(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation}}]),e}();function gd(e){return e.appInitializer.bind(e)}function yd(e){return e.bootstrapListener.bind(e)}var bd=new Ie("Router Initializer"),kd=Hn({encapsulation:2,styles:[],data:{}});function _d(e){return Xi(0,[(e()(),Ri(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),Jr(1,212992,null,0,Jh,[Qh,In,Jt,[8,null],Ot],null,null)],(function(e,t){e(t,1,0)}),null)}var wd,xd,Cd=Ir("ng-component",Zc,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"ng-component",[],null,null,null,_d,kd)),Jr(1,49152,null,0,Zc,[],null,null)],null,null)}),{},{},[]),Od=function e(){_classCallCheck(this,e)},Sd=function e(){_classCallCheck(this,e),this.align="start"},Td=function e(){_classCallCheck(this,e)},Id=function e(t){_classCallCheck(this,e),this._animationMode=t},Ed=function e(){_classCallCheck(this,e)},Nd=new Ie("cdk-dir-doc",{providedIn:"root",factory:function(){return Me(Is)}}),Ad=((wd=function(){function e(t){if(_classCallCheck(this,e),this.value="ltr",this.change=new ba,t){var n=t.documentElement?t.documentElement.dir:null,r=(t.body?t.body.dir:null)||n;this.value="ltr"===r||"rtl"===r?r:"ltr"}}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.change.complete()}}]),e}()).ngInjectableDef=ve({factory:function(){return new wd(Fe(Nd,8))},token:wd,providedIn:"root"}),wd),Rd=function e(){_classCallCheck(this,e)},Dd=new cn("8.2.3");function jd(e){return null!=e&&""+e!="false"}function Fd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}(e)?Number(e):t}function Md(e){return Array.isArray(e)?e:[e]}function Pd(e){return null==e?"":"string"==typeof e?e:e+"px"}function Ld(e){return e instanceof nn?e.nativeElement:e}try{xd="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(cz){xd=!1}var zd,Bd,Vd=((Bd=function e(t){_classCallCheck(this,e),this._platformId=t,this.isBrowser=this._platformId?"browser"===this._platformId:"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!xd)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}).ngInjectableDef=ve({factory:function(){return new Bd(Fe(Ia,8))},token:Bd,providedIn:"root"}),Bd),Wd=function e(){_classCallCheck(this,e)};function Ud(e){return function(){if(null==zd&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){return zd=!0}}))}finally{zd=zd||!1}return zd}()?e:!!e.capture}var Hd,Gd=function(){var e={NORMAL:0,NEGATED:1,INVERTED:2};return e[e.NORMAL]="NORMAL",e[e.NEGATED]="NEGATED",e[e.INVERTED]="INVERTED",e}();function Kd(){if("object"!=typeof document||!document)return Gd.NORMAL;if(!Hd){var e=document.createElement("div"),t=e.style;e.dir="rtl",t.height="1px",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";var n=document.createElement("div"),r=n.style;r.width="2px",r.height="1px",e.appendChild(n),document.body.appendChild(e),Hd=Gd.NORMAL,0===e.scrollLeft&&(e.scrollLeft=1,Hd=0===e.scrollLeft?Gd.NEGATED:Gd.INVERTED),e.parentNode.removeChild(e)}return Hd}var qd=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e,r)).scheduler=e,a.work=r,a.pending=!1,a}return _createClass(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(a){n=!0,r=!!a&&a||new Error(a)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),n}(function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){return _classCallCheck(this,n),t.call(this)}return _createClass(n,[{key:"schedule",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),n}(p)),Xd=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;_classCallCheck(this,e),this.SchedulerAction=t,this.now=n}return _createClass(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Zd=new(function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xd.now;return _classCallCheck(this,n),(r=t.call(this,e,(function(){return n.delegate&&n.delegate!==_assertThisInitialized(r)?n.delegate.now():a()}))).actions=[],r.active=!1,r.scheduled=void 0,r}return _createClass(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return n.delegate&&n.delegate!==this?n.delegate.schedule(e,t,r):_get(_getPrototypeOf(n.prototype),"schedule",this).call(this,e,t,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(Xd))(qd);function Yd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zd;return function(n){return n.lift(new Qd(e,t))}}var Qd=function(){function e(t,n){_classCallCheck(this,e),this.dueTime=t,this.scheduler=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Jd(e,this.dueTime,this.scheduler))}}]),e}(),Jd=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).dueTime=r,i.scheduler=a,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return _createClass(n,[{key:"_next",value:function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule($d,this.dueTime,this))}},{key:"_complete",value:function(){this.debouncedNext(),this.destination.complete()}},{key:"debouncedNext",value:function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}},{key:"clearDebounce",value:function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}]),n}(g);function $d(e){e.debouncedNext()}var ef,tf=((ef=function(){function e(t){_classCallCheck(this,e),this._platform=t}return _createClass(e,[{key:"isDisabled",value:function(e){return e.hasAttribute("disabled")}},{key:"isVisible",value:function(e){return function(e){return!!(e.offsetWidth||e.offsetHeight||"function"==typeof e.getClientRects&&e.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}},{key:"isTabbable",value:function(e){if(!this._platform.isBrowser)return!1;var t,n=function(e){try{return e.frameElement}catch(cz){return null}}((t=e).ownerDocument&&t.ownerDocument.defaultView||window);if(n){var r=n&&n.nodeName.toLowerCase();if(-1===rf(n))return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&"object"===r)return!1;if((this._platform.BLINK||this._platform.WEBKIT)&&!this.isVisible(n))return!1}var a=e.nodeName.toLowerCase(),i=rf(e);if(e.hasAttribute("contenteditable"))return-1!==i;if("iframe"===a)return!1;if("audio"===a){if(!e.hasAttribute("controls"))return!1;if(this._platform.BLINK)return!0}if("video"===a){if(!e.hasAttribute("controls")&&this._platform.TRIDENT)return!1;if(this._platform.BLINK||this._platform.FIREFOX)return!0}return("object"!==a||!this._platform.BLINK&&!this._platform.WEBKIT)&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(e){var t=e.nodeName.toLowerCase(),n="input"===t&&e.type;return"text"===n||"password"===n||"select"===t||"textarea"===t}(e))&&e.tabIndex>=0}},{key:"isFocusable",value:function(e){return function(e){return!function(e){return function(e){return"input"==e.nodeName.toLowerCase()}(e)&&"hidden"==e.type}(e)&&(function(e){var t=e.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(e)||function(e){return function(e){return"a"==e.nodeName.toLowerCase()}(e)&&e.hasAttribute("href")}(e)||e.hasAttribute("contenteditable")||nf(e))}(e)&&!this.isDisabled(e)&&this.isVisible(e)}}]),e}()).ngInjectableDef=ve({factory:function(){return new ef(Fe(Vd))},token:ef,providedIn:"root"}),ef);function nf(e){if(!e.hasAttribute("tabindex")||void 0===e.tabIndex)return!1;var t=e.getAttribute("tabindex");return"-32768"!=t&&!(!t||isNaN(parseInt(t,10)))}function rf(e){if(!nf(e))return null;var t=parseInt(e.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}var af,of,sf,uf=function(){function e(t,n,r,a){var i=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,e),this._element=t,this._checker=n,this._ngZone=r,this._document=a,this._hasAttached=!1,this.startAnchorListener=function(){return i.focusLastTabbableElement()},this.endAnchorListener=function(){return i.focusFirstTabbableElement()},this._enabled=!0,o||this.attachAnchors()}return _createClass(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}},{key:"destroy",value:function(){var e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),t&&(t.removeEventListener("focus",this.endAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),this._startAnchor=this._endAnchor=null}},{key:"attachAnchors",value:function(){var e=this;return!!this._hasAttached||(this._ngZone.runOutsideAngular((function(){e._startAnchor||(e._startAnchor=e._createAnchor(),e._startAnchor.addEventListener("focus",e.startAnchorListener)),e._endAnchor||(e._endAnchor=e._createAnchor(),e._endAnchor.addEventListener("focus",e.endAnchorListener))})),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}},{key:"focusInitialElementWhenReady",value:function(){var e=this;return new Promise((function(t){e._executeOnStable((function(){return t(e.focusInitialElement())}))}))}},{key:"focusFirstTabbableElementWhenReady",value:function(){var e=this;return new Promise((function(t){e._executeOnStable((function(){return t(e.focusFirstTabbableElement())}))}))}},{key:"focusLastTabbableElementWhenReady",value:function(){var e=this;return new Promise((function(t){e._executeOnStable((function(){return t(e.focusLastTabbableElement())}))}))}},{key:"_getRegionBoundary",value:function(e){for(var t=this._element.querySelectorAll("[cdk-focus-region-".concat(e,"], [cdkFocusRegion").concat(e,"], [cdk-focus-").concat(e,"]")),n=0;n<t.length;n++)t[n].hasAttribute("cdk-focus-"+e)?console.warn("Found use of deprecated attribute 'cdk-focus-".concat(e,"', use 'cdkFocusRegion").concat(e,"' instead. The deprecated attribute will be removed in 8.0.0."),t[n]):t[n].hasAttribute("cdk-focus-region-"+e)&&console.warn("Found use of deprecated attribute 'cdk-focus-region-".concat(e,"', use 'cdkFocusRegion").concat(e,"' instead. The deprecated attribute will be removed in 8.0.0."),t[n]);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}},{key:"focusInitialElement",value:function(){var e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");return e?(e.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",e),Qe()&&!this._checker.isFocusable(e)&&console.warn("Element matching '[cdkFocusInitial]' is not focusable.",e),e.focus(),!0):this.focusFirstTabbableElement()}},{key:"focusFirstTabbableElement",value:function(){var e=this._getRegionBoundary("start");return e&&e.focus(),!!e}},{key:"focusLastTabbableElement",value:function(){var e=this._getRegionBoundary("end");return e&&e.focus(),!!e}},{key:"hasAttached",value:function(){return this._hasAttached}},{key:"_getFirstTabbableElement",value:function(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;for(var t=e.children||e.childNodes,n=0;n<t.length;n++){var r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}},{key:"_getLastTabbableElement",value:function(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;for(var t=e.children||e.childNodes,n=t.length-1;n>=0;n--){var r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}},{key:"_createAnchor",value:function(){var e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}},{key:"_toggleAnchorTabIndex",value:function(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}},{key:"_executeOnStable",value:function(e){this._ngZone.isStable?e():this._ngZone.onStable.asObservable().pipe(lu(1)).subscribe(e)}}]),e}(),cf=((af=function(){function e(t,n,r){_classCallCheck(this,e),this._checker=t,this._ngZone=n,this._document=r}return _createClass(e,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new uf(e,this._checker,this._ngZone,this._document,t)}}]),e}()).ngInjectableDef=ve({factory:function(){return new af(Fe(tf),Fe(Xa),Fe(Is))},token:af,providedIn:"root"}),af),lf=new Ie("liveAnnouncerElement",{providedIn:"root",factory:function(){return null}}),hf=new Ie("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),df=((of=function(){function e(t,n,r,a){_classCallCheck(this,e),this._ngZone=n,this._defaultOptions=a,this._document=r,this._liveElement=t||this._createLiveElement()}return _createClass(e,[{key:"announce",value:function(e){for(var t,n,r,a=this,i=this._defaultOptions,o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];return 1===s.length&&"number"==typeof s[0]?r=s[0]:(n=(t=_slicedToArray(s,2))[0],r=t[1]),this.clear(),clearTimeout(this._previousTimeout),n||(n=i&&i.politeness?i.politeness:"polite"),null==r&&i&&(r=i.duration),this._liveElement.setAttribute("aria-live",n),this._ngZone.runOutsideAngular((function(){return new Promise((function(t){clearTimeout(a._previousTimeout),a._previousTimeout=setTimeout((function(){a._liveElement.textContent=e,t(),"number"==typeof r&&(a._previousTimeout=setTimeout((function(){return a.clear()}),r))}),100)}))}))}},{key:"clear",value:function(){this._liveElement&&(this._liveElement.textContent="")}},{key:"ngOnDestroy",value:function(){clearTimeout(this._previousTimeout),this._liveElement&&this._liveElement.parentNode&&(this._liveElement.parentNode.removeChild(this._liveElement),this._liveElement=null)}},{key:"_createLiveElement",value:function(){for(var e=this._document.getElementsByClassName("cdk-live-announcer-element"),t=this._document.createElement("div"),n=0;n<e.length;n++)e[n].parentNode.removeChild(e[n]);return t.classList.add("cdk-live-announcer-element"),t.classList.add("cdk-visually-hidden"),t.setAttribute("aria-atomic","true"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),t}}]),e}()).ngInjectableDef=ve({factory:function(){return new of(Fe(lf,8),Fe(Xa),Fe(Is),Fe(hf,8))},token:of,providedIn:"root"}),of),ff=Ud({passive:!0,capture:!0}),pf=((sf=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._ngZone=t,this._platform=n,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._documentKeydownListener=function(){r._lastTouchTarget=null,r._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=function(){r._lastTouchTarget||r._setOriginForCurrentEventQueue("mouse")},this._documentTouchstartListener=function(e){null!=r._touchTimeoutId&&clearTimeout(r._touchTimeoutId),r._lastTouchTarget=e.composedPath?e.composedPath()[0]:e.target,r._touchTimeoutId=setTimeout((function(){return r._lastTouchTarget=null}),650)},this._windowFocusListener=function(){r._windowFocused=!0,r._windowFocusTimeoutId=setTimeout((function(){return r._windowFocused=!1}))}}return _createClass(e,[{key:"monitor",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._platform.isBrowser)return js(null);var r=Ld(e);if(this._elementInfo.has(r)){var a=this._elementInfo.get(r);return a.checkChildren=n,a.subject.asObservable()}var i={unlisten:function(){},checkChildren:n,subject:new A};this._elementInfo.set(r,i),this._incrementMonitoredElementCount();var o=function(e){return t._onFocus(e,r)},s=function(e){return t._onBlur(e,r)};return this._ngZone.runOutsideAngular((function(){r.addEventListener("focus",o,!0),r.addEventListener("blur",s,!0)})),i.unlisten=function(){r.removeEventListener("focus",o,!0),r.removeEventListener("blur",s,!0)},i.subject.asObservable()}},{key:"stopMonitoring",value:function(e){var t=Ld(e),n=this._elementInfo.get(t);n&&(n.unlisten(),n.subject.complete(),this._setClasses(t),this._elementInfo.delete(t),this._decrementMonitoredElementCount())}},{key:"focusVia",value:function(e,t,n){var r=Ld(e);this._setOriginForCurrentEventQueue(t),"function"==typeof r.focus&&r.focus(n)}},{key:"ngOnDestroy",value:function(){var e=this;this._elementInfo.forEach((function(t,n){return e.stopMonitoring(n)}))}},{key:"_toggleClass",value:function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}},{key:"_setClasses",value:function(e,t){this._elementInfo.get(e)&&(this._toggleClass(e,"cdk-focused",!!t),this._toggleClass(e,"cdk-touch-focused","touch"===t),this._toggleClass(e,"cdk-keyboard-focused","keyboard"===t),this._toggleClass(e,"cdk-mouse-focused","mouse"===t),this._toggleClass(e,"cdk-program-focused","program"===t))}},{key:"_setOriginForCurrentEventQueue",value:function(e){var t=this;this._ngZone.runOutsideAngular((function(){t._origin=e,t._originTimeoutId=setTimeout((function(){return t._origin=null}),1)}))}},{key:"_wasCausedByTouch",value:function(e){var t=e.target;return this._lastTouchTarget instanceof Node&&t instanceof Node&&(t===this._lastTouchTarget||t.contains(this._lastTouchTarget))}},{key:"_onFocus",value:function(e,t){var n=this._elementInfo.get(t);if(n&&(n.checkChildren||t===e.target)){var r=this._origin;r||(r=this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(e)?"touch":"program"),this._setClasses(t,r),this._emitOrigin(n.subject,r),this._lastFocusOrigin=r}}},{key:"_onBlur",value:function(e,t){var n=this._elementInfo.get(t);!n||n.checkChildren&&e.relatedTarget instanceof Node&&t.contains(e.relatedTarget)||(this._setClasses(t),this._emitOrigin(n.subject,null))}},{key:"_emitOrigin",value:function(e,t){this._ngZone.run((function(){return e.next(t)}))}},{key:"_incrementMonitoredElementCount",value:function(){var e=this;1==++this._monitoredElementCount&&this._platform.isBrowser&&this._ngZone.runOutsideAngular((function(){document.addEventListener("keydown",e._documentKeydownListener,ff),document.addEventListener("mousedown",e._documentMousedownListener,ff),document.addEventListener("touchstart",e._documentTouchstartListener,ff),window.addEventListener("focus",e._windowFocusListener)}))}},{key:"_decrementMonitoredElementCount",value:function(){--this._monitoredElementCount||(document.removeEventListener("keydown",this._documentKeydownListener,ff),document.removeEventListener("mousedown",this._documentMousedownListener,ff),document.removeEventListener("touchstart",this._documentTouchstartListener,ff),window.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId))}}]),e}()).ngInjectableDef=ve({factory:function(){return new sf(Fe(Xa),Fe(Vd))},token:sf,providedIn:"root"}),sf),mf=new cn("8.2.3"),vf=new Ie("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}}),gf=function(){function e(t,n){_classCallCheck(this,e),this._sanityChecksEnabled=t,this._hammerLoader=n,this._hasDoneGlobalChecks=!1,this._hasCheckedHammer=!1,this._document="object"==typeof document&&document?document:null,this._window="object"==typeof window&&window?window:null,this._areChecksEnabled()&&!this._hasDoneGlobalChecks&&(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}return _createClass(e,[{key:"_areChecksEnabled",value:function(){return this._sanityChecksEnabled&&Qe()&&!this._isTestEnv()}},{key:"_isTestEnv",value:function(){var e=this._window;return e&&(e.__karma__||e.jasmine)}},{key:"_checkDoctypeIsDefined",value:function(){this._document&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}},{key:"_checkThemeIsPresent",value:function(){if(this._document&&this._document.body&&"function"==typeof getComputedStyle){var e=this._document.createElement("div");e.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(e);var t=getComputedStyle(e);t&&"none"!==t.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(e)}}},{key:"_checkCdkVersionMatch",value:function(){mf.full!==Dd.full&&console.warn("The Angular Material version ("+mf.full+") does not match the Angular CDK version ("+Dd.full+").\nPlease ensure the versions of these two packages exactly match.")}},{key:"_checkHammerIsAvailable",value:function(){!this._hasCheckedHammer&&this._window&&(!this._areChecksEnabled()||this._window.Hammer||this._hammerLoader||console.warn("Could not find HammerJS. Certain Angular Material components may not work correctly."),this._hasCheckedHammer=!0)}}]),e}();function yf(e,t){return function(e){_inherits(r,e);var n=_createSuper(r);function r(){var e;_classCallCheck(this,r);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=n.call.apply(n,[this].concat(i))).color=t,e}return _createClass(r,[{key:"color",get:function(){return this._color},set:function(e){var n=e||t;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove("mat-"+this._color),n&&this._elementRef.nativeElement.classList.add("mat-"+n),this._color=n)}}]),r}(e)}function bf(e){return function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a)))._disableRipple=!1,e}return _createClass(n,[{key:"disableRipple",get:function(){return this._disableRipple},set:function(e){this._disableRipple=jd(e)}}]),n}(e)}try{"undefined"!=typeof Intl}catch(cz){!1}function kf(e,t,n){var r=e.nativeElement.classList;n?r.add(t):r.remove(t)}var _f=function e(){_classCallCheck(this,e)},wf=function(){var e={FADING_IN:0,VISIBLE:1,FADING_OUT:2,HIDDEN:3};return e[e.FADING_IN]="FADING_IN",e[e.VISIBLE]="VISIBLE",e[e.FADING_OUT]="FADING_OUT",e[e.HIDDEN]="HIDDEN",e}(),xf=function(){function e(t,n,r){_classCallCheck(this,e),this._renderer=t,this.element=n,this.config=r,this.state=wf.HIDDEN}return _createClass(e,[{key:"fadeOut",value:function(){this._renderer.fadeOutRipple(this)}}]),e}(),Cf={enterDuration:450,exitDuration:400},Of=Ud({passive:!0}),Sf=function(){function e(t,n,r,a){var i=this;_classCallCheck(this,e),this._target=t,this._ngZone=n,this._isPointerDown=!1,this._triggerEvents=new Map,this._activeRipples=new Set,this._onMousedown=function(e){var t=function(e){return 0===e.buttons}(e),n=i._lastTouchStartEvent&&Date.now()<i._lastTouchStartEvent+800;i._target.rippleDisabled||t||n||(i._isPointerDown=!0,i.fadeInRipple(e.clientX,e.clientY,i._target.rippleConfig))},this._onTouchStart=function(e){if(!i._target.rippleDisabled){i._lastTouchStartEvent=Date.now(),i._isPointerDown=!0;for(var t=e.changedTouches,n=0;n<t.length;n++)i.fadeInRipple(t[n].clientX,t[n].clientY,i._target.rippleConfig)}},this._onPointerUp=function(){i._isPointerDown&&(i._isPointerDown=!1,i._activeRipples.forEach((function(e){!e.config.persistent&&(e.state===wf.VISIBLE||e.config.terminateOnPointerUp&&e.state===wf.FADING_IN)&&e.fadeOut()})))},a.isBrowser&&(this._containerElement=Ld(r),this._triggerEvents.set("mousedown",this._onMousedown).set("mouseup",this._onPointerUp).set("mouseleave",this._onPointerUp).set("touchstart",this._onTouchStart).set("touchend",this._onPointerUp).set("touchcancel",this._onPointerUp))}return _createClass(e,[{key:"fadeInRipple",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign({},Cf,r.animation);r.centered&&(e=a.left+a.width/2,t=a.top+a.height/2);var o=r.radius||function(e,t,n){var r=Math.max(Math.abs(e-n.left),Math.abs(e-n.right)),a=Math.max(Math.abs(t-n.top),Math.abs(t-n.bottom));return Math.sqrt(r*r+a*a)}(e,t,a),s=e-a.left,u=t-a.top,c=i.enterDuration,l=document.createElement("div");l.classList.add("mat-ripple-element"),l.style.left=s-o+"px",l.style.top=u-o+"px",l.style.height=2*o+"px",l.style.width=2*o+"px",l.style.backgroundColor=r.color||null,l.style.transitionDuration=c+"ms",this._containerElement.appendChild(l),window.getComputedStyle(l).getPropertyValue("opacity"),l.style.transform="scale(1)";var h=new xf(this,l,r);return h.state=wf.FADING_IN,this._activeRipples.add(h),r.persistent||(this._mostRecentTransientRipple=h),this._runTimeoutOutsideZone((function(){var e=h===n._mostRecentTransientRipple;h.state=wf.VISIBLE,r.persistent||e&&n._isPointerDown||h.fadeOut()}),c),h}},{key:"fadeOutRipple",value:function(e){var t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),t){var n=e.element,r=Object.assign({},Cf,e.config.animation);n.style.transitionDuration=r.exitDuration+"ms",n.style.opacity="0",e.state=wf.FADING_OUT,this._runTimeoutOutsideZone((function(){e.state=wf.HIDDEN,n.parentNode.removeChild(n)}),r.exitDuration)}}},{key:"fadeOutAll",value:function(){this._activeRipples.forEach((function(e){return e.fadeOut()}))}},{key:"setupTriggerEvents",value:function(e){var t=this,n=Ld(e);n&&n!==this._triggerElement&&(this._removeTriggerEvents(),this._ngZone.runOutsideAngular((function(){t._triggerEvents.forEach((function(e,t){n.addEventListener(t,e,Of)}))})),this._triggerElement=n)}},{key:"_runTimeoutOutsideZone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._ngZone.runOutsideAngular((function(){return setTimeout(e,t)}))}},{key:"_removeTriggerEvents",value:function(){var e=this;this._triggerElement&&this._triggerEvents.forEach((function(t,n){e._triggerElement.removeEventListener(n,t,Of)}))}}]),e}(),Tf=new Ie("mat-ripple-global-options"),If=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this._elementRef=t,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=a||{},this._rippleRenderer=new Sf(this,n,t,r),"NoopAnimations"===i&&(this._globalOptions.animation={enterDuration:0,exitDuration:0})}return _createClass(e,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this._setupTriggerEventsIfEnabled()}},{key:"trigger",get:function(){return this._trigger||this._elementRef.nativeElement},set:function(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}},{key:"ngOnInit",value:function(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}},{key:"ngOnDestroy",value:function(){this._rippleRenderer._removeTriggerEvents()}},{key:"fadeOutAll",value:function(){this._rippleRenderer.fadeOutAll()}},{key:"rippleConfig",get:function(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign({},this._globalOptions.animation,this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}},{key:"rippleDisabled",get:function(){return this.disabled||!!this._globalOptions.disabled}},{key:"_setupTriggerEventsIfEnabled",value:function(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}},{key:"launch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,t,Object.assign({},this.rippleConfig,n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign({},this.rippleConfig,e))}}]),e}(),Ef=function e(){_classCallCheck(this,e)},Nf=function e(){_classCallCheck(this,e)},Af=function e(){_classCallCheck(this,e)};function Rf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function Df(e){return{type:6,styles:e,offset:null}}function jf(e){Promise.resolve(null).then(e)}var Ff=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+n}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;jf((function(){return e._onFinish()}))}},{key:"_onStart",value:function(){this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"reset",value:function(){}},{key:"setPosition",value:function(e){}},{key:"getPosition",value:function(){return 0}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}(),Mf=function(){function e(t){var n=this;_classCallCheck(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,a=0,i=0,o=this.players.length;0==o?jf((function(){return n._onFinish()})):this.players.forEach((function(e){e.onDone((function(){++r==o&&n._onFinish()})),e.onDestroy((function(){++a==o&&n._onDestroy()})),e.onStart((function(){++i==o&&n._onStart()}))})),this.totalTime=this.players.reduce((function(e,t){return Math.max(e,t.totalTime)}),0)}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach((function(e){return e.init()}))}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach((function(e){return e.play()}))}},{key:"pause",value:function(){this.players.forEach((function(e){return e.pause()}))}},{key:"restart",value:function(){this.players.forEach((function(e){return e.restart()}))}},{key:"finish",value:function(){this._onFinish(),this.players.forEach((function(e){return e.finish()}))}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach((function(e){return e.destroy()})),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach((function(e){return e.reset()})),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach((function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)}))}},{key:"getPosition",value:function(){var e=0;return this.players.forEach((function(t){var n=t.getPosition();e=Math.min(n,e)})),e}},{key:"beforeDestroy",value:function(){this.players.forEach((function(e){e.beforeDestroy&&e.beforeDestroy()}))}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}();function Pf(){return"undefined"!=typeof process}function Lf(e){switch(e.length){case 0:return new Ff;case 1:return e[0];default:return new Mf(e)}}function zf(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach((function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach((function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=a[n];break;case"*":s=i[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s})),r||s.push(l),c=l,u=n})),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function Bf(e,t,n,r){switch(t){case"start":e.onStart((function(){return r(n&&Vf(n,"start",e))}));break;case"done":e.onDone((function(){return r(n&&Vf(n,"done",e))}));break;case"destroy":e.onDestroy((function(){return r(n&&Vf(n,"destroy",e))}))}}function Vf(e,t,n){var r=n.totalTime,a=Wf(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==r?e.totalTime:r,!!n.disabled),i=e._data;return null!=i&&(a._data=i),a}function Wf(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:a,totalTime:i,disabled:!!o}}function Uf(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function Hf(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var Gf=function(e,t){return!1},Kf=function(e,t){return!1},qf=function(e,t,n){return[]},Xf=Pf();(Xf||"undefined"!=typeof Element)&&(Gf=function(e,t){return e.contains(t)},Kf=function(){if(Xf||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:Kf}(),qf=function(e,t,n){var r=[];if(n)r.push.apply(r,_toConsumableArray(e.querySelectorAll(t)));else{var a=e.querySelector(t);a&&r.push(a)}return r});var Zf=null,Yf=!1;function Qf(e){Zf||(Zf=("undefined"!=typeof document?document.body:null)||{},Yf=!!Zf.style&&"WebkitAppearance"in Zf.style);var t=!0;return Zf.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in Zf.style)&&Yf)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in Zf.style),t}var Jf=Kf,$f=Gf,ep=qf;function tp(e){var t={};return Object.keys(e).forEach((function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]})),t}var np=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return Qf(e)}},{key:"matchesElement",value:function(e,t){return Jf(e,t)}},{key:"containsElement",value:function(e,t){return $f(e,t)}},{key:"query",value:function(e,t,n){return ep(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,a){arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&arguments[6];return new Ff(n,r)}}]),e}(),rp=function(){var e=function e(){_classCallCheck(this,e)};return e.NOOP=new np,e}();function ap(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:ip(parseFloat(t[1]),t[2])}function ip(e,t){switch(t){case"s":return 1e3*e;default:return e}}function op(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,a=0,i="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=ip(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(a=ip(parseFloat(s),o[4]));var u=o[5];u&&(i=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),a<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:a,easing:i}}(e,t,n)}function sp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach((function(n){t[n]=e[n]})),t}function up(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else sp(e,n);return n}function cp(e,t,n){return n?t+":"+n+";":""}function lp(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=cp(0,r,e.style.getPropertyValue(r))}for(var a in e.style)e.style.hasOwnProperty(a)&&!a.startsWith("_")&&(t+=cp(0,a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[a]));e.setAttribute("style",t)}function hp(e,t,n){e.style&&(Object.keys(t).forEach((function(r){var a=bp(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[a]),e.style[a]=t[r]})),Pf()&&lp(e))}function dp(e,t){e.style&&(Object.keys(t).forEach((function(t){var n=bp(t);e.style[n]=""})),Pf()&&lp(e))}function fp(e){return Array.isArray(e)?1==e.length?e[0]:Rf(e):e}var pp=new RegExp("{{\\s*(.+?)\\s*}}","g");function mp(e){var t=[];if("string"==typeof e){for(var n,r=e.toString();n=pp.exec(r);)t.push(n[1]);pp.lastIndex=0}return t}function vp(e,t,n){var r=e.toString(),a=r.replace(pp,(function(e,r){var a=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param "+r),a=""),a.toString()}));return a==r?e:a}function gp(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var yp=/-+([a-z0-9])/g;function bp(e){return e.replace(yp,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()}))}function kp(e,t){return 0===e||0===t}function _p(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var a=t[0],i=[];if(r.forEach((function(e){a.hasOwnProperty(e)||i.push(e),a[e]=n[e]})),i.length)for(var o=function(){var n=t[s];i.forEach((function(t){n[t]=xp(e,t)}))},s=1;s<t.length;s++)o()}return t}function wp(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #"+t.type)}}function xp(e,t){return window.getComputedStyle(e)[t]}var Cp=new Set(["true","1"]),Op=new Set(["false","0"]);function Sp(e,t){var n=Cp.has(e)||Op.has(e),r=Cp.has(t)||Op.has(t);return function(a,i){var o="*"==e||e==a,s="*"==t||t==i;return!o&&n&&"boolean"==typeof a&&(o=a?Cp.has(e):Op.has(e)),!s&&r&&"boolean"==typeof i&&(s=i?Cp.has(t):Op.has(t)),o&&s}}var Tp=new RegExp("s*:selfs*,?","g");function Ip(e,t,n){return new Ep(e).build(t,n)}var Ep=function(){function e(t){_classCallCheck(this,e),this._driver=t}return _createClass(e,[{key:"build",value:function(e,t){var n=new Np(t);return this._resetContextStyleTimingState(n),wp(this,fp(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,a=t.depCount=0,i=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach((function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach((function(e){s.name=e,i.push(n.visitState(s,t))})),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,a+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")})),{type:7,name:e.name,states:i,transitions:o,queryCount:r,depCount:a,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var a=new Set,i=r||{};if(n.styles.forEach((function(e){if(Ap(e)){var t=e;Object.keys(t).forEach((function(e){mp(t[e]).forEach((function(e){i.hasOwnProperty(e)||a.add(e)}))}))}})),a.size){var o=gp(a.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n,r,a,i=wp(this,fp(e.animation),t);return{type:1,matchers:(n=e.expr,r=t.errors,a=[],"string"==typeof n?n.split(/\s*,\s*/).forEach((function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var a=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==a||a.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var i=a[1],o=a[2],s=a[3];t.push(Sp(i,s)),"<"!=o[0]||"*"==i&&"*"==s||t.push(Sp(s,i))}(e,a,r)})):a.push(n),a),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Rp(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map((function(e){return wp(n,e,t)})),options:Rp(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,a=0,i=e.steps.map((function(e){t.currentTime=r;var i=wp(n,e,t);return a=Math.max(a,t.currentTime),i}));return t.currentTime=a,{type:3,steps:i,options:Rp(e.options)}}},{key:"visitAnimate",value:function(e,t){var n,r=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return Dp(op(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some((function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)}))){var a=Dp(0,0,"");return a.dynamic=!0,a.strValue=r,a}return Dp((n=n||op(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=r;var a=e.styles?e.styles:Df({});if(5==a.type)n=this.visitKeyframes(a,t);else{var i=e.styles,o=!1;if(!i){o=!0;var s={};r.easing&&(s.easing=r.easing),i=Df(s)}t.currentTime+=r.duration+r.delay;var u=this.visitStyle(i,t);u.isEmptyStep=o,n=u}return t.currentAnimateTimings=null,{type:4,timings:r,style:n,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach((function(e){"string"==typeof e?"*"==e?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)})):n.push(e.styles);var r=!1,a=null;return n.forEach((function(e){if(Ap(e)){var t=e,n=t.easing;if(n&&(a=n,delete t.easing),!r)for(var i in t)if(t[i].toString().indexOf("{{")>=0){r=!0;break}}})),{type:6,styles:n,easing:a,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,a=t.currentTime,i=t.currentTime;r&&i>0&&(i-=r.duration+r.delay),e.styles.forEach((function(e){"string"!=typeof e&&Object.keys(e).forEach((function(r){if(n._driver.validateStyleProperty(r)){var o,s,u,c,l,h=t.collectedStyles[t.currentQuerySelector],d=h[r],f=!0;d&&(i!=a&&i>=d.startTime&&a<=d.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(d.startTime,'ms" and "').concat(d.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(i,'ms" and "').concat(a,'ms"')),f=!1),i=d.startTime),f&&(h[r]={startTime:i,endTime:a}),t.options&&(o=e[r],s=t.options,u=t.errors,c=s.params||{},(l=mp(o)).length&&l.forEach((function(e){c.hasOwnProperty(e)||u.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})))}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))}))}))}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var a=0,i=[],o=!1,s=!1,u=0,c=e.steps.map((function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach((function(e){if(Ap(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}}));else if(Ap(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(a++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,i.push(l),r}));s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,h=0;a>0&&a<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==a&&(h=1/(l-1));var d=l-1,f=t.currentTime,p=t.currentAnimateTimings,m=p.duration;return c.forEach((function(e,a){var o=h>0?a==d?1:h*a:i[a],s=o*m;t.currentTime=f+p.delay+s,p.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)})),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:wp(this,fp(e.animation),t),options:Rp(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:Rp(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Rp(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var a=_slicedToArray(function(e){var t=!!e.split(/\s*,\s*/).find((function(e){return":self"==e}));return t&&(e=e.replace(Tp,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,(function(e){return".ng-trigger-"+e.substr(1)})).replace(/:animating/g,".ng-animating"),t]}(e.selector),2),i=a[0],o=a[1];t.currentQuerySelector=n.length?n+" "+i:i,Uf(t.collectedStyles,t.currentQuerySelector,{});var s=wp(this,fp(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:s,originalSelector:e.selector,options:Rp(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:op(e.timings,t.errors,!0);return{type:12,animation:wp(this,fp(e.animation),t),timings:n,options:null}}}]),e}(),Np=function e(t){_classCallCheck(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null};function Ap(e){return!Array.isArray(e)&&"object"==typeof e}function Rp(e){var t;return e?(e=sp(e)).params&&(e.params=(t=e.params)?sp(t):null):e={},e}function Dp(e,t,n){return{duration:e,delay:t,easing:n}}function jp(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:a,delay:i,totalTime:a+i,easing:o,subTimeline:s}}var Fp=function(){function e(){_classCallCheck(this,e),this._map=new Map}return _createClass(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,_toConsumableArray(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),Mp=new RegExp(":enter","g"),Pp=new RegExp(":leave","g");function Lp(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new zp).buildKeyframes(e,t,n,r,a,i,o,s,u,c)}var zp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"buildKeyframes",value:function(e,t,n,r,a,i,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new Fp;var l=new Vp(e,t,u,r,a,c,[]);l.options=s,l.currentTimeline.setStyles([i],null,l.errors,s),wp(this,n,l);var h=l.timelines.filter((function(e){return e.containsAnimation()}));if(h.length&&Object.keys(o).length){var d=h[h.length-1];d.allowOnlyTimelineStyles()||d.setStyles([o],null,l.errors,s)}return h.length?h.map((function(e){return e.buildKeyframes()})):[jp(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),a=t.currentTimeline.currentTime,i=this._visitSubInstructions(n,r,r.options);a!=i&&t.transformIntoNewTimeline(i)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,a=null!=n.duration?ap(n.duration):null,i=null!=n.delay?ap(n.delay):null;return 0!==a&&e.forEach((function(e){var n=t.appendInstructionToTimeline(e,a,i);r=Math.max(r,n.duration+n.delay)})),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),wp(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,a=t,i=e.options;if(i&&(i.params||i.delay)&&((a=t.createSubContext(i)).transformIntoNewTimeline(),null!=i.delay)){6==a.previousNode.type&&(a.currentTimeline.snapshotCurrentStyles(),a.previousNode=Bp);var o=ap(i.delay);a.delayNextStep(o)}e.steps.length&&(e.steps.forEach((function(e){return wp(n,e,a)})),a.currentTimeline.applyStylesToKeyframe(),a.subContextCount>r&&a.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],a=t.currentTimeline.currentTime,i=e.options&&e.options.delay?ap(e.options.delay):0;e.steps.forEach((function(o){var s=t.createSubContext(e.options);i&&s.delayNextStep(i),wp(n,o,s),a=Math.max(a,s.currentTimeline.currentTime),r.push(s.currentTimeline)})),r.forEach((function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)})),t.transformIntoNewTimeline(a),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return op(t.params?vp(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var a=e.style;5==a.type?this.visitKeyframes(a,t):(t.incrementTime(n.duration),this.visitStyle(a,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var a=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(a):n.setStyles(e.styles,a,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,a=n.duration,i=t.createSubContext().currentTimeline;i.easing=n.easing,e.styles.forEach((function(e){i.forwardTime((e.offset||0)*a),i.setStyles(e.styles,e.easing,t.errors,t.options),i.applyStylesToKeyframe()})),t.currentTimeline.mergeTimelineCollectedStyles(i),t.transformIntoNewTimeline(r+a),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,a=e.options||{},i=a.delay?ap(a.delay):0;i&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Bp);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!a.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach((function(r,a){t.currentQueryIndex=a;var s=t.createSubContext(e.options,r);i&&s.delayNextStep(i),r===t.element&&(u=s.currentTimeline),wp(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)})),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,a=e.timings,i=Math.abs(a.duration),o=i*(t.currentQueryTotal-1),s=i*t.currentQueryIndex;switch(a.duration<0?"reverse":a.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;wp(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),Bp={},Vp=function(){function e(t,n,r,a,i,o,s,u){_classCallCheck(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=a,this._leaveClassName=i,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Bp,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new Wp(this._driver,n,0),s.push(this.currentTimeline)}return _createClass(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,a=this.options;null!=r.duration&&(a.duration=ap(r.duration)),null!=r.delay&&(a.delay=ap(r.delay));var i=r.params;if(i){var o=a.params;o||(o=this.options.params={}),Object.keys(i).forEach((function(e){t&&o.hasOwnProperty(e)||(o[e]=vp(i[e],o,n.errors))}))}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach((function(e){n[e]=t[e]}))}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,a=n||this.element,i=new e(this._driver,a,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(a,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=Bp,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},a=new Up(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(a),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,a,i){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(Mp,"."+this._enterClassName)).replace(Pp,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,_toConsumableArray(s))}return a||0!=o.length||i.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),Wp=function(){function e(t,n,r,a){_classCallCheck(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=a,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return _createClass(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach((function(e){t._backFill[e]=t._globalTimelineStyles[e]||"*",t._currentKeyframe[e]="*"})),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var a=this;t&&(this._previousKeyframe.easing=t);var i=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach((function(e){"*"===e?(n=n||Object.keys(t)).forEach((function(e){r[e]="*"})):up(e,!1,r)})),r}(e,this._globalTimelineStyles);Object.keys(o).forEach((function(e){var t=vp(o[e],i,n);a._pendingStyles[e]=t,a._localTimelineStyles.hasOwnProperty(e)||(a._backFill[e]=a._globalTimelineStyles.hasOwnProperty(e)?a._globalTimelineStyles[e]:"*"),a._updateStyle(e,t)}))}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach((function(n){e._currentKeyframe[n]=t[n]})),Object.keys(this._localTimelineStyles).forEach((function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])})))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach((function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)}))}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach((function(n){var r=t._styleSummary[n],a=e._styleSummary[n];(!r||a.time>r.time)&&t._updateStyle(n,a.value)}))}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,a=[];this._keyframes.forEach((function(i,o){var s=up(i,!0);Object.keys(s).forEach((function(e){var r=s[e];"!"==r?t.add(e):"*"==r&&n.add(e)})),r||(s.offset=o/e.duration),a.push(s)}));var i=t.size?gp(t.values()):[],o=n.size?gp(n.values()):[];if(r){var s=a[0],u=sp(s);s.offset=0,u.offset=1,a=[s,u]}return jp(this.element,a,i,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),Up=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,n),(u=t.call(this,e,r,s.delay)).element=r,u.keyframes=a,u.preStyleProps=i,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return _createClass(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,a=t.easing;if(this._stretchStartingKeyframe&&n){var i=[],o=r+n,s=n/o,u=up(e[0],!1);u.offset=0,i.push(u);var c=up(e[0],!1);c.offset=Hp(s),i.push(c);for(var l=e.length-1,h=1;h<=l;h++){var d=up(e[h],!1);d.offset=Hp((n+d.offset*r)/o),i.push(d)}r=o,n=0,a="",e=i}return jp(this.element,e,this.preStyleProps,this.postStyleProps,r,n,a,!0)}}]),n}(Wp);function Hp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var Gp=function e(){_classCallCheck(this,e)},Kp=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"normalizePropertyName",value:function(e,t){return bp(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var a="",i=n.toString().trim();if(qp[t]&&0!==n&&"0"!==n)if("number"==typeof n)a="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return i+a}}]),n}(Gp),qp=function(e){var t={};return e.forEach((function(e){return t[e]=!0})),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function Xp(e,t,n,r,a,i,o,s,u,c,l,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:a,fromState:n,fromStyles:i,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:h,errors:d}}var Zp={},Yp=function(){function e(t,n,r){_classCallCheck(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return _createClass(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,a){return e.some((function(e){return e(t,n,r,a)}))}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],a=this._stateStyles[e],i=r?r.buildStyles(t,n):{};return a?a.buildStyles(t,n):i}},{key:"build",value:function(e,t,n,r,a,i,o,s,u,c){var l=[],h=this.ast.options&&this.ast.options.params||Zp,d=this.buildStyles(n,o&&o.params||Zp,l),f=s&&s.params||Zp,p=this.buildStyles(r,f,l),m=new Set,v=new Map,g=new Map,y="void"===r,b={params:Object.assign({},h,f)},k=c?[]:Lp(e,t,this.ast.animation,a,i,d,p,b,u,l),_=0;if(k.forEach((function(e){_=Math.max(e.duration+e.delay,_)})),l.length)return Xp(t,this._triggerName,n,r,y,d,p,[],[],v,g,_,l);k.forEach((function(e){var n=e.element,r=Uf(v,n,{});e.preStyleProps.forEach((function(e){return r[e]=!0}));var a=Uf(g,n,{});e.postStyleProps.forEach((function(e){return a[e]=!0})),n!==t&&m.add(n)}));var w=gp(m.values());return Xp(t,this._triggerName,n,r,y,d,p,k,w,v,g,_)}}]),e}(),Qp=function(){function e(t,n){_classCallCheck(this,e),this.styles=t,this.defaultParams=n}return _createClass(e,[{key:"buildStyles",value:function(e,t){var n={},r=sp(this.defaultParams);return Object.keys(e).forEach((function(t){var n=e[t];null!=n&&(r[t]=n)})),this.styles.styles.forEach((function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach((function(e){var i=a[e];i.length>1&&(i=vp(i,r,t)),n[e]=i}))}})),n}}]),e}(),Jp=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.name=t,this.ast=n,this.transitionFactories=[],this.states={},n.states.forEach((function(e){r.states[e.name]=new Qp(e.style,e.options&&e.options.params||{})})),$p(this.states,"true","1"),$p(this.states,"false","0"),n.transitions.forEach((function(e){r.transitionFactories.push(new Yp(t,e,r.states))})),this.fallbackTransition=new Yp(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},this.states)}return _createClass(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find((function(a){return a.match(e,t,n,r)}))||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function $p(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var em=new Fp,tm=function(){function e(t,n,r){_classCallCheck(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return _createClass(e,[{key:"register",value:function(e,t){var n=[],r=Ip(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: "+n.join("\n"));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,a=zf(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,a,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],o=this._animations[e],s=new Map;if(o?(n=Lp(this._driver,t,o,"ng-enter","ng-leave",{},{},a,em,i)).forEach((function(e){var t=Uf(s,e.element,{});e.postStyleProps.forEach((function(e){return t[e]=null}))})):(i.push("The requested animation doesn't exist or has already been destroyed"),n=[]),i.length)throw new Error("Unable to create the animation due to the following errors: "+i.join("\n"));s.forEach((function(e,t){Object.keys(e).forEach((function(n){e[n]=r._driver.computeStyle(t,n,"*")}))}));var u=Lf(n.map((function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)})));return this._playersById[e]=u,u.onDestroy((function(){return r.destroy(e)})),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by "+e);return t}},{key:"listen",value:function(e,t,n,r){var a=Wf(t,"","","");return Bf(this._getPlayer(e),n,a,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var a=this._getPlayer(e);switch(n){case"play":a.play();break;case"pause":a.pause();break;case"reset":a.reset();break;case"restart":a.restart();break;case"finish":a.finish();break;case"init":a.init();break;case"setPosition":a.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),nm=[],rm={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},am={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},im=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_classCallCheck(this,e),this.namespaceId=n;var r,a=t&&t.hasOwnProperty("value");if(this.value=null!=(r=a?t.value:t)?r:null,a){var i=sp(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}return _createClass(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach((function(e){null==n[e]&&(n[e]=t[e])}))}}}]),e}(),om=new im("void"),sm=function(){function e(t,n,r){_classCallCheck(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,pm(n,this._hostClassName)}return _createClass(e,[{key:"listen",value:function(e,t,n,r){var a,i=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(a=n)&&"done"!=a)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=Uf(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=Uf(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(pm(e,"ng-trigger"),pm(e,"ng-trigger-"+t),u[t]=om),function(){i._engine.afterFlush((function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),i._triggers[t]||delete u[t]}))}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this._getTrigger(t),o=new cm(this.id,t,e),s=this._engine.statesByElement.get(e);s||(pm(e,"ng-trigger"),pm(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new im(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=om),"void"===c.value||u.value!==c.value){var l=Uf(this._engine.playersByElement,e,[]);l.forEach((function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()}));var h=i.matchTransition(u.value,c.value,e,c.params),d=!1;if(!h){if(!a)return;h=i.fallbackTransition,d=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:u,toState:c,player:o,isFallbackTransition:d}),d||(pm(e,"ng-animate-queued"),o.onStart((function(){mm(e,"ng-animate-queued")}))),o.onDone((function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var a=n.indexOf(o);a>=0&&n.splice(a,1)}})),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var a=0;a<n.length;a++){var i=n[a];if(!t.hasOwnProperty(i)||e[i]!==t[i])return!1}return!0}(u.params,c.params)){var f=[],p=i.matchStyles(u.value,u.params,f),m=i.matchStyles(c.value,c.params,f);f.length?this._engine.reportError(f):this._engine.afterFlush((function(){dp(e,p),hp(e,m)}))}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach((function(t,n){delete t[e]})),this._elementListeners.forEach((function(n,r){t._elementListeners.set(r,n.filter((function(t){return t.name!=e})))}))}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach((function(e){return e.destroy()})),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._engine.driver.query(e,".ng-trigger",!0).forEach((function(e){if(!e.__ng_removed){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach((function(n){return n.triggerLeaveAnimation(e,t,!1,!0)})):n.clearElementCache(e)}}))}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var a=this,i=this._engine.statesByElement.get(e);if(i){var o=[];if(Object.keys(i).forEach((function(t){if(a._triggers[t]){var n=a.trigger(e,t,"void",r);n&&o.push(n)}})),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&Lf(o).onDone((function(){return a._engine.processLeaveNode(e)})),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e);if(n){var r=new Set;n.forEach((function(n){var a=n.name;if(!r.has(a)){r.add(a);var i=t._triggers[a].fallbackTransition,o=t._engine.statesByElement.get(e)[a]||om,s=new im("void"),u=new cm(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:i,fromState:o,toState:s,player:u,isFallbackTransition:!0})}}))}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t,!0),!this.triggerLeaveAnimation(e,t,!0)){var a=!1;if(r.totalAnimations){var i=r.players.length?r.playersByQueriedElement.get(e):[];if(i&&i.length)a=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){a=!0;break}}this.prepareLeaveAnimationListeners(e),a?r.markElementAsRemoved(this.id,e,!1,t):(r.afterFlush((function(){return n.clearElementCache(e)})),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}},{key:"insertNode",value:function(e,t){pm(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach((function(r){var a=r.player;if(!a.destroyed){var i=r.element,o=t._elementListeners.get(i);o&&o.forEach((function(t){if(t.name==r.triggerName){var n=Wf(i,r.triggerName,r.fromState.value,r.toState.value);n._data=e,Bf(r.player,t.phase,n,t.callback)}})),a.markedForDestroy?t._engine.afterFlush((function(){a.destroy()})):n.push(r)}})),this._queue=[],n.sort((function(e,n){var r=e.transition.ast.depCount,a=n.transition.ast.depCount;return 0==r||0==a?r-a:t._engine.driver.containsElement(e.element,n.element)?1:-1}))}},{key:"destroy",value:function(e){this.players.forEach((function(e){return e.destroy()})),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find((function(t){return t.element===e}))||t}}]),e}(),um=function(){function e(t,n,r){_classCallCheck(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return _createClass(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach((function(t){t.players.forEach((function(t){t.queued&&e.push(t)}))})),e}},{key:"createNamespace",value:function(e,t){var n=new sm(e,t,this);return t.parentNode?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,a=n;a>=0;a--)if(this.driver.containsElement(this._namespaceList[a].hostElement,t)){this._namespaceList.splice(a+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush((function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)})),this.afterFlushAnimationsDone((function(){return r.destroy(t)}))}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),a=0;a<r.length;a++){var i=n[r[a]].namespaceId;if(i){var o=this._fetchNamespace(i);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(lm(t)){var a=this._fetchNamespace(e);if(a)return a.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(lm(t)){var a=t.__ng_removed;if(a&&a.setForRemoval){a.setForRemoval=!1,a.setForMove=!0;var i=this.collectedLeaveElements.indexOf(t);i>=0&&this.collectedLeaveElements.splice(i,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),pm(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),mm(e,"ng-animate-disabled"))}},{key:"removeNode",value:function(e,t,n,r){if(lm(t)){var a=e?this._fetchNamespace(e):null;if(a?a.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var i=this.namespacesByHostElement.get(t);i&&i.id!==e&&i.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,a){return lm(t)?this._fetchNamespace(e).listen(t,n,r,a):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,a){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,a)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,".ng-trigger",!0);n.forEach((function(e){return t.destroyActiveAnimationsForElement(e)})),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,".ng-animating",!0)).forEach((function(e){return t.finishActiveQueriedAnimationOnElement(e)}))}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach((function(e){e.queued?e.markedForDestroy=!0:e.destroy()}))}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach((function(e){return e.finish()}))}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise((function(t){if(e.players.length)return Lf(e.players).onDone((function(){return t()}));t()}))}},{key:"processLeaveNode",value:function(e){var t=this,n=e.__ng_removed;if(n&&n.setForRemoval){if(e.__ng_removed=rm,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach((function(e){t.markElementAsDisabled(e,!1)}))}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((function(t,n){return e._balanceNamespaceList(t,n)})),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)pm(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var a=[];try{n=this._flushAnimations(a,t)}finally{for(var i=0;i<a.length;i++)a[i]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach((function(e){return e()})),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?Lf(n).onDone((function(){s.forEach((function(e){return e()}))})):s.forEach((function(e){return e()}))}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n "+e.join("\n"))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new Fp,a=[],i=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach((function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])}));var h=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=fm(d,this.collectedEnterElements),p=new Map,m=0;f.forEach((function(e,t){var n="ng-enter"+m++;p.set(t,n),e.forEach((function(e){return pm(e,n)}))}));for(var v=[],g=new Set,y=new Set,b=0;b<this.collectedLeaveElements.length;b++){var k=this.collectedLeaveElements[b],_=k.__ng_removed;_&&_.setForRemoval&&(v.push(k),g.add(k),_.hasAnimation?this.driver.query(k,".ng-star-inserted",!0).forEach((function(e){return g.add(e)})):y.add(k))}var w=new Map,x=fm(d,Array.from(g));x.forEach((function(e,t){var n="ng-leave"+m++;w.set(t,n),e.forEach((function(e){return pm(e,n)}))})),e.push((function(){f.forEach((function(e,t){var n=p.get(t);e.forEach((function(e){return mm(e,n)}))})),x.forEach((function(e,t){var n=w.get(t);e.forEach((function(e){return mm(e,n)}))})),v.forEach((function(e){n.processLeaveNode(e)}))}));for(var C=[],O=[],S=this._namespaceList.length-1;S>=0;S--)this._namespaceList[S].drainQueuedTransitions(t).forEach((function(e){var t=e.player,i=e.element;if(C.push(t),n.collectedEnterElements.length){var l=i.__ng_removed;if(l&&l.setForMove)return void t.destroy()}var d=!h||!n.driver.containsElement(h,i),f=w.get(i),m=p.get(i),v=n._buildInstruction(e,r,m,f,d);if(v.errors&&v.errors.length)O.push(v);else{if(d)return t.onStart((function(){return dp(i,v.fromStyles)})),t.onDestroy((function(){return hp(i,v.toStyles)})),void a.push(t);if(e.isFallbackTransition)return t.onStart((function(){return dp(i,v.fromStyles)})),t.onDestroy((function(){return hp(i,v.toStyles)})),void a.push(t);v.timelines.forEach((function(e){return e.stretchStartingKeyframe=!0})),r.append(i,v.timelines),o.push({instruction:v,player:t,element:i}),v.queriedElements.forEach((function(e){return Uf(s,e,[]).push(t)})),v.preStyleProps.forEach((function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach((function(e){return r.add(e)}))}})),v.postStyleProps.forEach((function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach((function(e){return r.add(e)}))}))}}));if(O.length){var T=[];O.forEach((function(e){T.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach((function(e){return T.push("- ".concat(e,"\n"))}))})),C.forEach((function(e){return e.destroy()})),this.reportError(T)}var I=new Map,E=new Map;o.forEach((function(e){var t=e.element;r.has(t)&&(E.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,I))})),a.forEach((function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach((function(e){Uf(I,t,[]).push(e),e.destroy()}))}));var N=v.filter((function(e){return gm(e,u,c)})),A=new Map;dm(A,this.driver,y,c,"*").forEach((function(e){gm(e,u,c)&&N.push(e)}));var R=new Map;f.forEach((function(e,t){dm(R,n.driver,new Set(e),u,"!")})),N.forEach((function(e){var t=A.get(e),n=R.get(e);A.set(e,Object.assign({},t,n))}));var D=[],j=[],F={};o.forEach((function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy((function(){return hp(t,s.toStyles)})),o.disabled=!0,o.overrideTotalTime(s.totalTime),void a.push(o);var u=F;if(E.size>1){for(var c=t,h=[];c=c.parentNode;){var d=E.get(c);if(d){u=d;break}h.push(c)}h.forEach((function(e){return E.set(e,u)}))}var f=n._buildAnimation(o.namespaceId,s,I,i,R,A);if(o.setRealPlayer(f),u===F)D.push(o);else{var p=n.playersByElement.get(u);p&&p.length&&(o.parentPlayer=Lf(p)),a.push(o)}}else dp(t,s.fromStyles),o.onDestroy((function(){return hp(t,s.toStyles)})),j.push(o),l.has(t)&&a.push(o)})),j.forEach((function(e){var t=i.get(e.element);if(t&&t.length){var n=Lf(t);e.setRealPlayer(n)}})),a.forEach((function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()}));for(var M=0;M<v.length;M++){var P=v[M],L=P.__ng_removed;if(mm(P,"ng-leave"),!L||!L.hasAnimation){var z=[];if(s.size){var B=s.get(P);B&&B.length&&z.push.apply(z,_toConsumableArray(B));for(var V=this.driver.query(P,".ng-animating",!0),W=0;W<V.length;W++){var U=s.get(V[W]);U&&U.length&&z.push.apply(z,_toConsumableArray(U))}}var H=z.filter((function(e){return!e.destroyed}));H.length?vm(this,P,H):this.processLeaveNode(P)}}return v.length=0,D.forEach((function(e){n.players.push(e),e.onDone((function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)})),e.play()})),D}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,a){var i=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(i=o)}else{var s=this.playersByElement.get(e);if(s){var u=!a||"void"==a;s.forEach((function(e){e.queued||(u||e.triggerName==r)&&i.push(e)}))}}return(n||r)&&(i=i.filter((function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)}))),i}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,a=this,i=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=_createForOfIteratorHelper(t.timelines);try{var c=function(){var e=r.value.element,u=e!==i,c=Uf(n,e,[]);a._getPreviousPlayers(e,u,o,s,t.toState).forEach((function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)}))};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}dp(i,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,a,i){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,h=new Set,d=t.timelines.map((function(t){var d=t.element;l.add(d);var f=d.__ng_removed;if(f&&f.removedBeforeQueried)return new Ff(t.duration,t.delay);var p,m,v=d!==u,g=(p=(n.get(d)||nm).map((function(e){return e.getRealPlayer()})),m=[],function e(t,n){for(var r=0;r<t.length;r++){var a=t[r];a instanceof Mf?e(a.players,n):n.push(a)}}(p,m),m).filter((function(e){return!!e.element&&e.element===d})),y=a.get(d),b=i.get(d),k=zf(0,o._normalizer,0,t.keyframes,y,b),_=o._buildPlayer(t,k,g);if(t.subTimeline&&r&&h.add(d),v){var w=new cm(e,s,d);w.setRealPlayer(_),c.push(w)}return _}));c.forEach((function(e){Uf(o.playersByQueriedElement,e.element,[]).push(e),e.onDone((function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)}))})),l.forEach((function(e){return pm(e,"ng-animating")}));var f=Lf(d);return f.onDestroy((function(){l.forEach((function(e){return mm(e,"ng-animating")})),hp(u,t.toStyles)})),h.forEach((function(e){Uf(r,e,[]).push(f)})),f}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Ff(e.duration,e.delay)}}]),e}(),cm=function(){function e(t,n,r){_classCallCheck(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new Ff,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return _createClass(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach((function(n){t._queuedCallbacks[n].forEach((function(t){return Bf(e,n,void 0,t)}))})),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart((function(){return n.triggerCallback("start")})),e.onDone((function(){return t.finish()})),e.onDestroy((function(){return t.destroy()}))}},{key:"_queueEvent",value:function(e,t){Uf(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function lm(e){return e&&1===e.nodeType}function hm(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function dm(e,t,n,r,a){var i=[];n.forEach((function(e){return i.push(hm(e))}));var o=[];r.forEach((function(n,r){var i={};n.forEach((function(e){var n=i[e]=t.computeStyle(r,e,a);n&&0!=n.length||(r.__ng_removed=am,o.push(r))})),e.set(r,i)}));var s=0;return n.forEach((function(e){return hm(e,i[s++])})),o}function fm(e,t){var n=new Map;if(e.forEach((function(e){return n.set(e,[])})),0==t.length)return n;var r=new Set(t),a=new Map;return t.forEach((function(e){var t=function e(t){if(!t)return 1;var i=a.get(t);if(i)return i;var o=t.parentNode;return i=n.has(o)?o:r.has(o)?1:e(o),a.set(t,i),i}(e);1!==t&&n.get(t).push(e)})),n}function pm(e,t){if(e.classList)e.classList.add(t);else{var n=e.$$classes;n||(n=e.$$classes={}),n[t]=!0}}function mm(e,t){if(e.classList)e.classList.remove(t);else{var n=e.$$classes;n&&delete n[t]}}function vm(e,t,n){Lf(n).onDone((function(){return e.processLeaveNode(t)}))}function gm(e,t,n){var r=n.get(e);if(!r)return!1;var a=t.get(e);return a?r.forEach((function(e){return a.add(e)})):t.set(e,r),n.delete(e),!0}var ym=function(){function e(t,n,r){var a=this;_classCallCheck(this,e),this.bodyNode=t,this._driver=n,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new um(t,n,r),this._timelineEngine=new tm(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return a.onRemovalComplete(e,t)}}return _createClass(e,[{key:"registerTrigger",value:function(e,t,n,r,a){var i=e+"-"+r,o=this._triggerCache[i];if(!o){var s=[],u=Ip(this._driver,a,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t){return new Jp(e,t)}(r,u),this._triggerCache[i]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var a=_slicedToArray(Hf(n),2),i=a[0],o=a[1];this._timelineEngine.command(i,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,a){if("@"==n.charAt(0)){var i=_slicedToArray(Hf(n),2),o=i[0],s=i[1];return this._timelineEngine.listen(o,t,s,a)}return this._transitionEngine.listen(e,t,n,r,a)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function bm(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=_m(t[0]),t.length>1&&(r=_m(t[t.length-1]))):t&&(n=_m(t)),n||r?new km(e,n,r):null}var km=function(){var e=function(){function e(t,n,r){_classCallCheck(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var a=e.initialStylesByElement.get(t);a||e.initialStylesByElement.set(t,a={}),this._initialStyles=a}return _createClass(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&hp(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(hp(this._element,this._initialStyles),this._endStyles&&(hp(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(dp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(dp(this._element,this._endStyles),this._endStyles=null),hp(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function _m(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var a=n[r];wm(a)&&((t=t||{})[a]=e[a])}return t}function wm(e){return"display"===e||"position"===e}var xm=function(){function e(t,n,r,a,i,o,s){var u=this;_classCallCheck(this,e),this._element=t,this._name=n,this._duration=r,this._delay=a,this._easing=i,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return _createClass(e,[{key:"apply",value:function(){var e,t,n;e=this._element,t="".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name),(n=Em(e,"").trim()).length&&(function(e,t){for(var n=0;n<e.length;n++)e.charAt(n)}(n),t="".concat(n,", ").concat(t)),Im(e,"",t),Tm(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){Cm(this._element,this._name,"paused")}},{key:"resume",value:function(){Cm(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=Om(this._element,this._name);this._position=e*this._duration,Im(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),Tm(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){var e,t,n,r;this._destroyed||(this._destroyed=!0,this.finish(),e=this._element,t=this._name,n=Em(e,"").split(","),(r=Sm(n,t))>=0&&(n.splice(r,1),Im(e,"",n.join(","))))}}]),e}();function Cm(e,t,n){Im(e,"PlayState",n,Om(e,t))}function Om(e,t){var n=Em(e,"");return n.indexOf(",")>0?Sm(n.split(","),t):Sm([n],t)}function Sm(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function Tm(e,t,n){n?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function Im(e,t,n,r){var a="animation"+t;if(null!=r){var i=e.style[a];if(i.length){var o=i.split(",");o[r]=n,n=o.join(",")}}e.style[a]=n}function Em(e,t){return e.style["animation"+t]}var Nm=function(){function e(t,n,r,a,i,o,s,u){_classCallCheck(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=a,this._delay=i,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=a+i,this._buildStyler()}return _createClass(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new xm(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",(function(){return e.finish()}))}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach((function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:xp(e.element,r))}))}this.currentSnapshot=t}}]),e}(),Am=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).element=e,a._startingStyles={},a.__initialized=!1,a._styles=tp(r),a}return _createClass(n,[{key:"init",value:function(){var e=this;!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach((function(t){e._startingStyles[t]=e.element.style[t]})),_get(_getPrototypeOf(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;this._startingStyles&&(this.init(),Object.keys(this._styles).forEach((function(t){return e.element.style.setProperty(t,e._styles[t])})),_get(_getPrototypeOf(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;this._startingStyles&&(Object.keys(this._startingStyles).forEach((function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)})),this._startingStyles=null,_get(_getPrototypeOf(n.prototype),"destroy",this).call(this))}}]),n}(Ff),Rm=function(){function e(){_classCallCheck(this,e),this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return Qf(e)}},{key:"matchesElement",value:function(e,t){return Jf(e,t)}},{key:"containsElement",value:function(e,t){return $f(e,t)}},{key:"query",value:function(e,t,n){return ep(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map((function(e){return tp(e)}));var r="@keyframes ".concat(t," {\n"),a="";n.forEach((function(e){a=" ";var t=parseFloat(e.offset);r+="".concat(a).concat(100*t,"% {\n"),a+=" ",Object.keys(e).forEach((function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(a,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(a).concat(t,": ").concat(n,";\n"))}})),r+=a+"}\n"})),r+="}\n";var i=document.createElement("style");return i.innerHTML=r,i}},{key:"animate",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;o&&this._notifyFaultyScrubber();var s=i.filter((function(e){return e instanceof Nm})),u={};kp(n,r)&&s.forEach((function(e){var t=e.currentSnapshot;Object.keys(t).forEach((function(e){return u[e]=t[e]}))}));var c=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach((function(e){Object.keys(e).forEach((function(n){"offset"!=n&&"easing"!=n&&(t[n]=e[n])}))})),t}(t=_p(e,t,u));if(0==n)return new Am(e,c);var l="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(e,l,t);document.querySelector("head").appendChild(h);var d=bm(e,t),f=new Nm(e,t,l,n,r,a,c,d);return f.onDestroy((function(){var e;(e=h).parentNode.removeChild(e)})),f}},{key:"_notifyFaultyScrubber",value:function(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}]),e}(),Dm=function(){function e(t,n,r,a){_classCallCheck(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",(function(){return e._onFinish()}))}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach((function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:xp(e.element,n))})),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}(),jm=function(){function e(){_classCallCheck(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(Fm().toString()),this._cssKeyframesDriver=new Rm}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return Qf(e)}},{key:"matchesElement",value:function(e,t){return Jf(e,t)}},{key:"containsElement",value:function(e,t){return $f(e,t)}},{key:"query",value:function(e,t,n){return ep(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,a,i);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};a&&(s.easing=a);var u={},c=i.filter((function(e){return e instanceof Dm}));kp(n,r)&&c.forEach((function(e){var t=e.currentSnapshot;Object.keys(t).forEach((function(e){return u[e]=t[e]}))}));var l=bm(e,t=_p(e,t=t.map((function(e){return up(e,!1)})),u));return new Dm(e,t,s,l)}}]),e}();function Fm(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}var Mm=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this))._nextAnimationId=0,a._renderer=e.createRenderer(r.body,{id:"0",encapsulation:Ue.None,styles:[],data:{animation:[]}}),a}return _createClass(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?Rf(e):e;return zm(this._renderer,null,t,"register",[n]),new Pm(t,this._renderer)}}]),n}(Af),Pm=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this))._id=e,a._renderer=r,a}return _createClass(n,[{key:"create",value:function(e,t){return new Lm(this._id,e,t||{},this._renderer)}}]),n}(function(){return function e(){_classCallCheck(this,e)}}()),Lm=function(){function e(t,n,r,a){_classCallCheck(this,e),this.id=t,this.element=n,this._renderer=a,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return _createClass(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return zm(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset")}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){return 0}}]),e}();function zm(e,t,n,r,a){return e.setProperty(t,"@@".concat(n,":").concat(r),a)}var Bm=function(){function e(t,n,r){_classCallCheck(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return _createClass(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var a=this._rendererCache.get(r);return a||(a=new Vm("",r,this.engine),this._rendererCache.set(r,a)),a}var i=t.id,o=t.id+"-"+this._currentId;return this._currentId++,this.engine.register(o,e),t.data.animation.forEach((function(t){return n.engine.registerTrigger(i,o,e,t.name,t)})),new Wm(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then((function(){e._microtaskId++}))}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run((function(){return t(n)})):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then((function(){r._zone.run((function(){r._animationCallbacksBuffer.forEach((function(e){var t=_slicedToArray(e,2);(0,t[0])(t[1])})),r._animationCallbacksBuffer=[]}))})),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular((function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)})),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}(),Vm=function(){function e(t,n,r){_classCallCheck(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return _createClass(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,!0)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),Wm=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,r,a,i)).factory=e,o.namespaceId=r,o}return _createClass(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r,a,i=this;if("@"==t.charAt(0)){var o,s=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),u=t.substr(1),c="";return"@"!=u.charAt(0)&&(a=(r=u).indexOf("."),u=(o=_slicedToArray([r.substring(0,a),r.substr(a+1)],2))[0],c=o[1]),this.engine.listen(this.namespaceId,s,u,c,(function(e){i.factory.scheduleListenerCallback(e._data||-1,n,e)}))}return this.delegate.listen(e,t,n)}}]),n}(Vm),Um=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){return _classCallCheck(this,n),t.call(this,e.body,r,a)}return n}(ym);function Hm(){return"function"==typeof Fm()?new jm:new Rm}function Gm(){return new Kp}function Km(e,t,n){return new Bm(e,t,n)}var qm=new Ie("AnimationModuleType"),Xm=function e(){_classCallCheck(this,e)},Zm=Hn({encapsulation:2,styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(.4,0,.2,1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}@media (-ms-high-contrast:active){.mat-card{outline:solid 1px}}.mat-card-actions,.mat-card-content,.mat-card-subtitle{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media (max-width:599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card-content>:first-child,.mat-card>:first-child{margin-top:0}.mat-card-content>:last-child:not(.mat-card-footer),.mat-card>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-subtitle:not(:first-child),.mat-card-title:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],data:{}});function Ym(e){return Xi(2,[Wi(null,0),Wi(null,1)],null,null)}var Qm=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],Jm=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;_classCallCheck(this,n),(i=t.call(this,e))._focusMonitor=r,i._animationMode=a,i.isRoundButton=i._hasHostAttributes("mat-fab","mat-mini-fab"),i.isIconButton=i._hasHostAttributes("mat-icon-button");var o,s=_createForOfIteratorHelper(Qm);try{for(s.s();!(o=s.n()).done;){var u=o.value;i._hasHostAttributes(u)&&i._getHostElement().classList.add(u)}}catch(c){s.e(c)}finally{s.f()}return e.nativeElement.classList.add("mat-button-base"),i._focusMonitor.monitor(i._elementRef,!0),i.isRoundButton&&(i.color="accent"),i}return _createClass(n,[{key:"ngOnDestroy",value:function(){this._focusMonitor.stopMonitoring(this._elementRef)}},{key:"focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"program",t=arguments.length>1?arguments[1]:void 0;this._focusMonitor.focusVia(this._getHostElement(),e,t)}},{key:"_getHostElement",value:function(){return this._elementRef.nativeElement}},{key:"_isRippleDisabled",value:function(){return this.disableRipple||this.disabled}},{key:"_hasHostAttributes",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.some((function(t){return e._getHostElement().hasAttribute(t)}))}}]),n}(yf(function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a)))._disabled=!1,e}return _createClass(n,[{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=jd(e)}}]),n}(bf((function e(t){_classCallCheck(this,e),this._elementRef=t}))))),$m=function e(){_classCallCheck(this,e)},ev=Hn({encapsulation:2,styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media (hover:none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-flat-button,.mat-icon-button,.mat-stroked-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-flat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-focus-overlay,.mat-stroked-button .mat-button-ripple.mat-ripple{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button .mat-icon,.mat-icon-button i{line-height:24px}.mat-button-focus-overlay,.mat-button-ripple.mat-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}@media (-ms-high-contrast:active){.mat-button-focus-overlay{background-color:#fff}}@media (-ms-high-contrast:black-on-white){.mat-button-focus-overlay{background-color:#000}}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}@media (-ms-high-contrast:active){.mat-button,.mat-fab,.mat-flat-button,.mat-icon-button,.mat-mini-fab,.mat-raised-button{outline:solid 1px}}"],data:{}});function tv(e){return Xi(2,[Pi(671088640,1,{ripple:0}),(e()(),Ri(1,0,null,null,1,"span",[["class","mat-button-wrapper"]],null,null,null,null,null)),Wi(null,0),(e()(),Ri(3,0,null,null,1,"div",[["class","mat-button-ripple mat-ripple"],["matRipple",""]],[[2,"mat-button-ripple-round",null],[2,"mat-ripple-unbounded",null]],null,null,null,null)),Jr(4,212992,[[1,4]],0,If,[nn,Xa,Vd,[2,Tf],[2,qm]],{centered:[0,"centered"],disabled:[1,"disabled"],trigger:[2,"trigger"]},null),(e()(),Ri(5,0,null,null,0,"div",[["class","mat-button-focus-overlay"]],null,null,null,null,null))],(function(e,t){var n=t.component;e(t,4,0,n.isIconButton,n._isRippleDisabled(),n._getHostElement())}),(function(e,t){var n=t.component;e(t,3,0,n.isRoundButton||n.isIconButton,zr(t,4).unbounded)}))}var nv,rv=n("+hG3");function av(){return null==nv&&(nv=Object(rv.backend)().epsilon()),nv}var iv=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),ov=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),sv=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),uv=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),cv=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}();function lv(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function hv(e,t){if(!e)throw new cv(t)}function dv(e,t){var n,r=0,a=_createForOfIteratorHelper(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(i){a.e(i)}finally{a.f()}return r}function fv(e){return 1===e.length?e[0]:e}function pv(e){return Array.isArray(e)?e:[e]}function mv(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function vv(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}Error;var gv={};function yv(e){if(null==e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function bv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof e){var i,o=e;if(o in n)i=n[o];else if(o in gv)i=gv[o];else if(null==(i=t[o]))throw new sv("Unknown ".concat(r,": ").concat(e,". This may be due to one of the following reasons:\n1. The ").concat(r," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(r," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));return i}var s,u,c,l=e;if(null==l.className||null==l.config)throw new sv(r+": Improper config format: "+JSON.stringify(l)+".\n'className' and 'config' must set.");var h,d,f=l.className;if(f in n?(h=(s=_slicedToArray(n[f],2))[0],d=s[1]):f in gv?(h=(u=_slicedToArray(gv.className,2))[0],d=u[1]):f in t&&(h=(c=_slicedToArray(t[f],2))[0],d=c[1]),null==h)throw new sv("Unknown ".concat(r,": ").concat(f,". This may be due to one of the following reasons:\n1. The ").concat(r," is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ").concat(r," is defined in JavaScript, but is not registered properly with tf.serialization.registerClass()."));if(null!=d){for(var p={},m=0,v=Object.keys(gv);m<v.length;m++){var g=v[m];p[g]=gv[g]}for(var y=0,b=Object.keys(n);y<b.length;y++){var k=b[y];p[k]=n[k]}l.config.customObjects=p;for(var _=Object.assign({},gv),w=0,x=Object.keys(n);w<x.length;w++){var C=x[w];gv[C]=n[C]}!function e(t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach((function(t){return e(t)}));else for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n],i=t[a];null!=i&&"object"==typeof i&&(Array.isArray(i)||"ndarray"!==i.type||"number"!=typeof i.value?e(i):t[a]=i.value)}}(l.config);var O=d(h,l.config,n,a);return gv=Object.assign({},_),O}for(var S=Object.assign({},gv),T=0,I=Object.keys(n);T<I.length;T++){var E=I[T];gv[E]=n[E]}var N=new h(l.config);return gv=Object.assign({},S),N}function kv(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function _v(e){if(null==e)return e;var t,n=[],r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function wv(e){if(null==e)throw new sv("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function xv(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new sv("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function Cv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return hv(n>=0),hv(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function Ov(e,t){Array.isArray(e)?(rv.util.assert(e.length>0,(function(){return t+" is unexpectedly an empty array."})),e.forEach((function(e,n){return Ov(e,"element ".concat(n+1," of ").concat(t))}))):rv.util.assert(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+function e(t){return null===t?"null":Array.isArray(t)?"["+t.map((function(t){return e(t)})).join(",")+"]":"string"==typeof t?'"'.concat(t,'"'):""+t}(e)+"."}))}function Sv(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}function Tv(e,t){return Object(rv.tidy)((function(){return rv.sqrt(rv.sum(rv.mul(e,e),t,!0))}))}var Iv=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getConfig",value:function(){return{}}}]),n}(rv.serialization.Serializable),Ev=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return Object(rv.tidy)((function(){var n=Tv(e,t.axis),r=rv.clipByValue(n,0,t.maxValue);return rv.mul(e,rv.div(r,rv.add(av(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(Iv);Ev.className="MaxNorm",rv.serialization.registerClass(Ev);var Nv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return Object(rv.tidy)((function(){return rv.div(e,rv.add(av(),Tv(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(Iv);Nv.className="UnitNorm",rv.serialization.registerClass(Nv);var Av=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rv.relu(e)}}]),n}(Iv);Av.className="NonNeg",rv.serialization.registerClass(Av);var Rv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return Object(rv.tidy)((function(){var n=Tv(e,t.axis),r=rv.add(rv.mul(t.rate,rv.clipByValue(n,t.minValue,t.maxValue)),rv.mul(1-t.rate,n));return rv.mul(e,rv.div(r,rv.add(av(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(Iv);Rv.className="MinMaxNorm",rv.serialization.registerClass(Rv);var Dv={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function jv(e){return yv(e)}function Fv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return bv(e,rv.serialization.SerializationMap.getMap().classNameMap,t,"constraint")}function Mv(e){return null==e?null:"string"==typeof e?Fv({className:e in Dv?Dv[e]:e,config:{}}):e instanceof Iv?e:Fv(e)}var Pv=["channelsFirst","channelsLast"],Lv=["nearest","bilinear"],zv=["valid","same","causal"],Bv=["max","avg"],Vv=["sum","mul","concat","ave"],Wv=new Map;function Uv(e){xv(Pv,"DataFormat",e)}function Hv(e){xv(zv,"PaddingMode",e)}function Gv(e){xv(Bv,"PoolMode",e)}var Kv=[];function qv(e,t){Kv.push(e);try{var n=t();return Kv.pop(),n}catch(r){throw Kv.pop(),r}}function Xv(e){if(!Qv(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===Kv.length?"":Kv.join("/")+"/")+e}function Zv(e){if(!Qv(e))throw new Error("Not a valid tensor name: '"+e+"'");Wv.has(e)||Wv.set(e,0);var t=Wv.get(e);if(Wv.set(e,Wv.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return Wv.set(n,1),n}return e}var Yv=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Qv(e){return!!e.match(Yv)}function Jv(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function $v(e){return e=Array.isArray(e)?new Float32Array(e):e,Object(rv.tensor1d)(e)}function eg(e){return rv.min($v(e)).dataSync()[0]}function tg(e){return rv.max($v(e)).dataSync()[0]}function ng(e,t){if(t<e)throw new sv("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function rg(e,t){return e.asType(t)}function ag(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function ig(e,t,n){return Object(rv.tidy)((function(){switch(e.rank){case 1:return rv.slice1d(e,t,n);case 2:return rv.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return rv.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return rv.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return rv.slice(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return rv.slice(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new sv("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}))}function og(e,t,n){return Object(rv.tidy)((function(){switch(e.rank){case 1:return rv.slice1d(e,t,n);case 2:return rv.slice2d(e,[0,t],[e.shape[0],n]);case 3:return rv.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return rv.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new sv("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}}))}function sg(e,t,n,r){return Object(rv.tidy)((function(){switch(e.rank){case 1:return rv.slice1d(e,t,n);case 2:switch(r){case 1:return ig(e,t,n);case 2:return og(e,t,n);default:throw new sv("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return ig(e,t,n);case 2:return rv.slice3d(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return og(e,t,n);default:throw new sv("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return ig(e,t,n);case 2:return rv.slice4d(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return rv.slice4d(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return og(e,t,n);default:throw new sv("The axis is not within the rank of the tensor "+r)}default:throw new sv("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}}))}function ug(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),rv.concat(e,n)}function cg(e,t){switch(e.rank){case 1:return rv.concat1d([e,t]);case 2:return rv.concat2d([e,t],0);case 3:return rv.concat3d([e,t],0);case 4:return rv.concat4d([e,t],0);default:throw new sv("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function lg(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new sv("The length of input n (".concat(t.length,") does not match the number of dimensions in input x (").concat(e.rank,")"));return rv.tile(e,t)}function hg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return rv.randomNormal(e,t,n,r,a)}function dg(e,t,n,r){if(e.rank<2||t.rank<2)throw new uv("dot requires both inputs to be rank >= 2 but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new uv("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ".concat(e.shape," and  y shape = ")+t.shape);if(2===e.rank&&2===t.rank)return rv.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?mg(e.rank,r,"channelsLast"):null,activation:n});var a=e.shape.slice(),i=a.pop();e=e.reshape([-1,i]);var o=t.shape.slice(),s=o.pop(),u=o.pop(),c=[].concat(_toConsumableArray(o),[s]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(l).reshape([u,-1]);var h=[].concat(_toConsumableArray(a),_toConsumableArray(c));return rv.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?mg(e.rank,r,"channelsLast"):null,activation:n}).reshape(h)}function fg(e,t,n){return Object(rv.tidy)((function(){return t=Array.isArray(t)?Object(rv.tensor1d)(t,"int32"):t.toInt(),rv.gather(e,t,n)}))}function pg(e){return rv.mul(e,e)}function mg(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new sv("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e);if(5===e){if("channelsFirst"===n)return t.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return t.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===e){if("channelsFirst"===n)return t.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return t.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===e){if("channelsFirst"===n)return t.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return t.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(e<3)return t;throw new sv("Unsupported input rank by biasAdd: "+t.rank)}function vg(e,t,n){return Object(rv.tidy)((function(){return null==n&&(n="channelsLast"),Uv(n),e.add(mg(e.rank,t,n))}))}function gg(e,t,n,r){return Object(rv.tidy)((function(){return rv.dropout(e,t,n,r)}))}function yg(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var bg=["fanIn","fanOut","fanAvg"],kg=["normal","uniform","truncatedNormal"],_g=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(rv.serialization.Serializable),wg=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e,t){return Object(rv.zeros)(e,t)}}]),n}(_g);wg.className="Zeros",rv.serialization.registerClass(wg);var xg=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e,t){return Object(rv.ones)(e,t)}}]),n}(_g);xg.className="Ones",rv.serialization.registerClass(xg);var Cg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),r=t.call(this),"object"!=typeof e)throw new sv("Expected argument of type ConstantConfig but got "+e);if(void 0===e.value)throw new sv("config must have value set but got "+e);return r.value=e.value,_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){var n=this;return Object(rv.tidy)((function(){return Object(rv.mul)(Object(rv.scalar)(n.value),Object(rv.ones)(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(_g);Cg.className="Constant",rv.serialization.registerClass(Cg);var Og=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return _createClass(n,[{key:"apply",value:function(e,t){return Object(rv.randomUniform)(e,this.minval,this.maxval,t)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(_g);Og.className="RandomUniform",rv.serialization.registerClass(Og);var Sg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return _createClass(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new uv("randomNormal does not support dType ".concat(t,"."));return hg(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(_g);Sg.className="RandomNormal",rv.serialization.registerClass(Sg);var Tg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return _createClass(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new uv("truncatedNormal does not support dType ".concat(t,"."));return Object(rv.truncatedNormal)(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(_g);Tg.className="TruncatedNormal",rv.serialization.registerClass(Tg);var Ig=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return _createClass(n,[{key:"apply",value:function(e,t){var n=this;return Object(rv.tidy)((function(){if(2!==e.length||e[0]!==e[1])throw new sv("Identity matrix initializer can only be used for 2D square matrices.");return Object(rv.mul)(n.gain,Object(rv.eye)(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(_g);Ig.className="Identity",rv.serialization.registerClass(Ig);var Eg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,a;if(_classCallCheck(this,n),r=t.call(this),e.scale<0)throw new sv("scale must be a positive float. Got: "+e.scale);return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,xv(bg,"FanMode",r.mode),r.distribution=null==e.distribution?"normal":e.distribution,a=r.distribution,xv(kg,"Distribution",a),r.seed=e.seed,_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(Uv(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=Jv(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=Jv(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=Jv(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if(i/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,a):Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new uv("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Object(rv.truncatedNormal)(e,0,o,t,this.seed)}var s=Math.sqrt(3*i);return Object(rv.randomUniform)(e,-s,s,t)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(_g);Eg.className="VarianceScaling",rv.serialization.registerClass(Eg);var Ng=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return Eg.className}}]),n}(Eg);Ng.className="GlorotUniform",rv.serialization.registerClass(Ng);var Ag=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return Eg.className}}]),n}(Eg);Ag.className="GlorotNormal",rv.serialization.registerClass(Ag);var Rg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return Eg.className}}]),n}(Eg);Rg.className="HeNormal",rv.serialization.registerClass(Rg);var Dg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return Eg.className}}]),n}(Eg);Dg.className="HeUniform",rv.serialization.registerClass(Dg);var jg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return Eg.className}}]),n}(Eg);jg.className="LeCunNormal",rv.serialization.registerClass(jg);var Fg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return Eg.className}}]),n}(Eg);Fg.className="LeCunNormal",rv.serialization.registerClass(Fg);var Mg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new uv("Random seed is not implemented for Orthogonal Initializer yet.");return _possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){var n=this;return Object(rv.tidy)((function(){if(e.length<2)throw new uv("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 (".concat(e[0]*e[1],") elements: Slowness may result."));var t=hg(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=rv.linalg.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Object(rv.mul)(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(_g);Mg.className="Orthogonal",rv.serialization.registerClass(Mg);var Pg={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Lg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return bv(e,rv.serialization.SerializationMap.getMap().classNameMap,t,"initializer")}function zg(e){return yv(e)}function Bg(e){if("string"==typeof e){var t=e in Pg?Pg[e]:e;if("GlorotNormal"===t)return new Ag;if("GlorotUniform"===t)return new Ng;if("HeNormal"===t)return new Rg;if("HeUniform"===t)return new Dg;if("LeCunNormal"===t)return new jg;if("LeCunUniform"===t)return new Fg;var n={};return n.className=t,n.config={},Lg(n)}return e instanceof _g?e:Lg(e)}var Vg=0;function Wg(){return Vg++}var Ug={};function Hg(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in Ug||(Ug[e]=0),Ug[e]+=1,e+Ug[e].toString()}function Gg(e){return Array.isArray(e)&&Array.isArray(e[0])}function Kg(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function qg(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new sv("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t}function Xg(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new sv("Expected exactly 1 Shape; got "+e.length)}return e}function Zg(e){var t,n=0,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n+=0===a.shape.length?1:a.shape.reduce((function(e,t){return e*t}))}}catch(i){r.e(i)}finally{r.f()}return n}var Yg=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Variable",a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;_classCallCheck(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=Wg(),this.originalName=Xv(r=null==r?"Variable":r),this.name=Zv(this.originalName),this.trainable_=a,this.constraint=i,this.val=rv.variable(t,this.trainable_,this.name,this.dtype)}return _createClass(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function Qg(e){return e.map((function(e){return e.read()}))}function Jg(e){e.forEach((function(e){e[0].write(e[1])}))}var $g,ey=function e(t){_classCallCheck(this,e),this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},ty=function e(t,n,r,a,i,o,s){_classCallCheck(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=Wg(),null!=o&&(this.originalName=Xv(o),this.name=Zv(this.originalName)),this.rank=n.length},ny=0,ry=function(){function e(t,n){_classCallCheck(this,e),this.callArgs=n,this.id=ny++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=_createForOfIteratorHelper(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(o){a.e(o)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return _createClass(e,[{key:"getConfig",value:function(){var e,t=[],n=_createForOfIteratorHelper(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(null!=r?r.name:null)}}catch(a){n.e(a)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),ay=0,iy=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=ay++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=mv(i)+"_"+Hg(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),e.dtype=u}return e.initialWeights=null!=r.weights?r.weights:null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return _createClass(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new ov("The layer has never been called and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new sv("Asked to get ".concat(t," at node ").concat(e,", but the layer has only ").concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return fv(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return fv(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new iv("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new iv("Layer "+this.name+" is not connected, no input to return.");return fv(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new iv("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new iv("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return fv(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=pv(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=pv(this.inputSpec);if(e.length!==t.length)throw new sv("Layer ".concat(this.name," expects ").concat(t.length," inputs, but it received ").concat(e.length," input tensors. Input received: ")+e);for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new sv("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected ndim=").concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new sv("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected max_ndim=").concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new sv("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected min_ndim=").concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new sv("Input ".concat(n," is incompatible with layer ").concat(this.name," : expected dtype=").concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new sv("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected axis ").concat(u," of input shape to have value ").concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var h=0;h<a.shape.length;++h){var d=a.shape[h],f=r.shape[h];if(null!=d&&null!=f&&d!==f)throw new sv("Input ".concat(n," is incompatible with layer ").concat(this.name,": expected shape=").concat(a.shape,", found shape=").concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=pv(e),i=!0,o=_createForOfIteratorHelper(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof ty)){i=!1;break}}}catch(l){o.e(l)}finally{o.f()}var s,u=!0,c=_createForOfIteratorHelper(a);try{for(c.s();!(s=c.n()).done;){if(s.value instanceof ty){u=!1;break}}}catch(l){c.e(l)}finally{c.f()}if(i===u)throw new sv("Arguments to apply() must be all SymbolicTensors or all Tensors");return qv(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=_createForOfIteratorHelper(pv(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch(l){o.e(l)}finally{o.f()}n.build(fv(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var c,h=n.call(e,t),d=[],f=_createForOfIteratorHelper(pv(h));try{for(f.s();!(c=f.n()).done;){var p=c.value;-1!==a.indexOf(p)&&(p=p.clone()),d.push(p)}}catch(l){f.e(l)}finally{f.f()}if(h=fv(d),null!=n.activityRegularizer)throw new uv("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return h}var m,v=function(e){var t,n=[],r=_createForOfIteratorHelper(e=pv(e));try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(l){r.e(l)}finally{r.f()}return fv(n)}(e),g=n.computeOutputShape(v);if(n.warnOnIncompatibleInputShape(Array.isArray(e)?v[0]:v),m=null!=g&&g.length>0&&Array.isArray(g[0])?g.map((function(r,a){return new ty("float32",r,n,pv(e),t,n.name,a)})):new ty("float32",g,n,pv(e),t,n.name),n.addInboundNode(e,m,null,null,v,g,t),n._refCount++,null!=n.activityRegularizer)throw new uv("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return m}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(e)+") does not match that of the "+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") of the layer ")+this.name);else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor (".concat(JSON.stringify(e),") does not match the expectation of layer ").concat(this.name,": ")+JSON.stringify(this.batchInputShape))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new iv("The layer ".concat(this.name," has never been called and thus has no defined output shape."));var e,t=[],n=_createForOfIteratorHelper(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(o){n.e(o)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new iv("The layer ".concat(this.name,' has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.'))}},{key:"countParams",value:function(){if(!this.built)throw new ov("You tried to call countParams() on ".concat(this.name,", but the layer is not built yet. Build it first by calling build(batchInputShape)."));return Zg(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Qg(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;Object(rv.tidy)((function(){var n=t.weights;if(n.length!==e.length)throw new sv('You called setWeights(weights) on layer "'.concat(t.name,'" with a weight list of length ').concat(e.length,", but the layer was expecting ").concat(n.length," weights. Provided weights: ").concat(e,"..."));if(0!==n.length){for(var r=[],a=Qg(n),i=0;i<a.length;++i){var o=a[i],s=n[i],u=e[i];if(!rv.util.arraysEqual(o.shape,u.shape))throw new sv("Layer weight shape ".concat(o.shape," not compatible with provided weight shape ")+u.shape);r.push([s,u])}Jg(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new sv("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=Bg("zeros"));var s=r.apply(t,n),u=new Yg(s,n,e,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(u.read())})),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=pv(e),null!=this._losses&&(t=this.losses).push.apply(t,_toConsumableArray(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, but was passed an inputMask."));t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, but was passed an inputMask."))}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=pv(e);t=pv(t),n=pv(n),r=pv(r),a=Kg(a),i=Kg(i);var u,c=[],l=[],h=[],d=_createForOfIteratorHelper(s);try{for(d.s();!(u=d.n()).done;){var f=u.value;c.push(f.sourceLayer),l.push(f.nodeIndex),h.push(f.tensorIndex)}}catch(m){d.e(m)}finally{d.f()}new ry({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:h,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been built yet."));if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used yet."));this.assertNotDisposed();var e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(rv.serialization.Serializable),oy=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:Hg("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new sv("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new sv("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new sv("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new ty(r.dtype,r.batchInputShape,_assertThisInitialized(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new ry({outboundLayer:_assertThisInitialized(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){throw new sv("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(iy);function sy(e){return uy.apply(this,arguments)}function uy(){return(uy=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!=typeof(o=t[i])&&(s=o,n.push(s.data()),r.push(i),a.push(s));if(!(n.length>0)){e.next=10;break}return e.next=7,Promise.all(n);case 7:for(u=e.sent,c=0;c<u.length;++c)t[r[c]]=u[c][0];Object(rv.dispose)(a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cy(e){if(null!=e)for(var t in e){var n=e[t];"number"!=typeof n&&n.dispose()}}oy.className="InputLayer",rv.serialization.registerClass(oy),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}($g||($g={}));var ly=function(){function e(){_classCallCheck(this,e),this.validationData=null}var t,n,r,a,i,o;return _createClass(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"onEpochEnd",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"onBatchBegin",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"onBatchEnd",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"setModel",value:function(e){}}]),e}(),hy=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;_classCallCheck(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}var t,n,r,a,i,o;return _createClass(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=_createForOfIteratorHelper(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=_createForOfIteratorHelper(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"onEpochBegin",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return o.apply(this,arguments)})},{key:"onEpochEnd",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return i.apply(this,arguments)})},{key:"onBatchBegin",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return a.apply(this,arguments)})},{key:"onBatchEnd",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return r.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=_createForOfIteratorHelper(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=_createForOfIteratorHelper(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return t.apply(this,arguments)})}]),e}(),dy=function(e){_inherits(i,e);var t,n,r,a=_createSuper(i);function i(){return _classCallCheck(this,i),a.call(this)}return _createClass(i,[{key:"onEpochBegin",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onBatchEnd",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=function(e){var t=n[e];if("number"==typeof t)o.totals.hasOwnProperty(e)||(o.totals[e]=0),o.totals[e]=o.totals[e]+t*r;else{var a;e in o.totals?a=o.totals[e]:o.totals[e]=0;var i=Object(rv.tidy)((function(){return Object(rv.add)(o.totals[e],Object(rv.mul)(t,r))}));o.totals[e]=i,null!=a&&a.dispose()}},n)a(i);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"onEpochEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n){r=_createForOfIteratorHelper(this.params.metrics);try{for(i=function(){var e=a.value;null!=o.totals[e]&&("number"==typeof o.totals[e]?n[e]=o.totals[e]/o.seen:Object(rv.tidy)((function(){var t=Object(rv.mul)(Object(rv.div)(1,o.seen),o.totals[e]);n[e]=t,o.totals[e].dispose(),Object(rv.keep)(n[e])})))},r.s();!(a=r.n()).done;)i()}catch(t){r.e(t)}finally{r.f()}}case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),i}(ly),fy=function(e){_inherits(i,e);var t,n,r,a=_createSuper(i);function i(){return _classCallCheck(this,i),a.apply(this,arguments)}return _createClass(i,[{key:"onTrainBegin",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onEpochEnd",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"syncData",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!=typeof i[o]&&(t.push(i[o].data()),n.push(a),r.push(o));return e.next=4,Promise.all(t);case 4:for(s=e.sent,u=0;u<s.length;++u)this.history[n[u]][r[u]].dispose(),this.history[n[u]][r[u]]=s[u][0];case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(ly),py=function(e){_inherits(c,e);var t,n,r,a,i,o,s,u=_createSuper(c);function c(e,t){var n,r,a,i,o;if(_classCallCheck(this,c),(n=u.call(this)).currentEpoch=0,n.yieldEvery=t||"auto","auto"===n.yieldEvery&&(n.yieldEvery=125),"never"===n.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return rv.util.isNumber(n.yieldEvery)&&(n.maybeWait=(r=n.maybeWait.bind(_assertThisInitialized(n)),a=n.yieldEvery,o=rv.util.now(),function(){var e=rv.util.now();return e-o<a||(o=e,i=r.apply(void 0,arguments)),i})),n.trainBegin=e.onTrainBegin,n.trainEnd=e.onTrainEnd,n.epochBegin=e.onEpochBegin,n.epochEnd=e.onEpochEnd,n.batchBegin=e.onBatchBegin,n.batchEnd=e.onBatchEnd,n.yield=e.onYield,_possibleConstructorReturn(n)}return _createClass(c,[{key:"maybeWait",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],e.t0=null!=this.yield,!e.t0){e.next=6;break}return e.next=5,sy(r);case 5:a.push(this.yield(t,n,r));case 6:return a.push(Object(rv.nextFrame)()),e.next=9,Promise.all(a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"onEpochBegin",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,e.t0=null!=this.epochBegin,!e.t0){e.next=7;break}return e.next=5,sy(n);case 5:return e.next=7,this.epochBegin(t,n);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"onEpochEnd",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],e.t0=null!=this.epochEnd,!e.t0){e.next=6;break}return e.next=5,sy(n);case 5:r.push(this.epochEnd(t,n));case 6:return"epoch"===this.yieldEvery&&r.push(Object(rv.nextFrame)()),e.next=9,Promise.all(r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"onBatchBegin",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=this.batchBegin,!e.t0){e.next=6;break}return e.next=4,sy(n);case 4:return e.next=6,this.batchBegin(t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"onBatchEnd",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],e.t0=null!=this.batchEnd,!e.t0){e.next=6;break}return e.next=5,sy(n);case 5:r.push(this.batchEnd(t,n));case 6:return"batch"===this.yieldEvery?r.push(Object(rv.nextFrame)()):rv.util.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=9,Promise.all(r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=this.trainBegin,!e.t0){e.next=6;break}return e.next=4,sy(t);case 4:return e.next=6,this.trainBegin(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=this.trainEnd,!e.t0){e.next=6;break}return e.next=4,sy(t);case 4:return e.next=6,this.trainEnd(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),c}(ly);function my(e,t){return null==e&&(e={}),e instanceof ly?[e]:Array.isArray(e)&&e[0]instanceof ly?e:pv(e).map((function(e){return new py(e,t)}))}var vy=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"registerCallbackConstructor",value:function(t,n){rv.util.assert(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, but got "+t})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors)e.constructors[+n].forEach((function(e){if(e===t)throw new sv("Duplicate callback constructor.")}))}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,_toConsumableArray(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function gy(e,t,n,r,a,i,o,s,u){var c=new fy,l=[new dy].concat(_toConsumableArray(vy.createCallbacks(t)));null!=e&&l.push.apply(l,_toConsumableArray(e)),l.push(c);var h=new hy(l);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:h,history:c}}function yy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return bv(e,rv.serialization.SerializationMap.getMap().classNameMap,t,"layer",n)}function by(e,t){return Object(rv.tidy)((function(){"float32"!==e.dtype&&(e=e.asType("float32"));var n=rv.sum(pg(e),t,!0),r=rv.fill(n.shape,av()),a=rv.sqrt(rv.maximum(n,r));return rv.div(e,a)}))}function ky(e,t){return Object(rv.tidy)((function(){return rv.mean(pg(rv.sub(t,e)),-1)}))}function _y(e,t){return Object(rv.tidy)((function(){return rv.mean(rv.abs(rv.sub(t,e)),-1)}))}function wy(e,t){return Object(rv.tidy)((function(){var n=rv.sub(e,t),r=rv.clipByValue(rv.abs(e),av(),Number.MAX_VALUE),a=rv.abs(rv.div(n,r));return rv.mul(100,rv.mean(a,-1))}))}function xy(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(rv.tidy)((function(){if(n)t=rv.softmax(t);else{var r=rv.sum(t,t.shape.length-1,!0);t=rv.div(t,r)}return t=rv.clipByValue(t,av(),1-av()),rv.neg(rv.sum(rv.mul(e.toFloat(),rv.log(t)),t.shape.length-1))}))}function Cy(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(rv.tidy)((function(){var r,a,i=rv.floor((r=e,a=[Jv(r.shape)],r.reshape(a))).toInt(),o=(t=rv.clipByValue(t,av(),1-av())).shape;return xy(rv.oneHot(i,o[o.length-1]).reshape(o),t,n)}))}function Oy(e,t){return Object(rv.tidy)((function(){var n;return n=rv.clipByValue(t,av(),1-av()),n=rv.log(rv.div(n,rv.sub(1,n))),rv.mean(function(e,t){if(!rv.util.arraysEqual(e.shape,t.shape))throw new sv("logits and labels must have the same shape, but got shapes ".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Object(rv.tidy)((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function Sy(e,t){return Object(rv.tidy)((function(){var n=by(e,-1),r=by(t,-1),a=rv.mul(n,r);return rv.neg(rv.sum(a,-1))}))}vy.constructors={};var Ty={meanSquaredError:ky,meanAbsoluteError:_y,meanAbsolutePercentageError:wy,meanSquaredLogarithmicError:function(e,t){return Object(rv.tidy)((function(){var n=rv.clipByValue(t,av(),Number.MAX_VALUE),r=rv.log(rv.add(1,n)),a=rv.clipByValue(e,av(),Number.MAX_VALUE),i=rv.log(rv.add(1,a));return rv.mean(pg(rv.sub(r,i)),-1)}))},squaredHinge:function(e,t){return Object(rv.tidy)((function(){var n=rv.maximum(0,rv.sub(1,rv.mul(e,t)));return rv.mean(pg(n),-1)}))},hinge:function(e,t){return Object(rv.tidy)((function(){var n=rv.maximum(0,rv.sub(1,rv.mul(e,t)));return rv.mean(n,-1)}))},categoricalHinge:function(e,t){return Object(rv.tidy)((function(){var n=rv.sum(rv.mul(e,t),-1),r=rv.max(rv.mul(rv.sub(1,e),t),-1);return rv.maximum(0,rv.add(1,rv.sub(r,n)))}))},logcosh:function(e,t){return Object(rv.tidy)((function(){var n=Math.log(2),r=rv.sub(t,e),a=rv.sub(rv.add(r,rv.softplus(rv.mul(-2,r))),n);return rv.mean(a,-1)}))},categoricalCrossentropy:xy,sparseCategoricalCrossentropy:Cy,binaryCrossentropy:Oy,kullbackLeiblerDivergence:function(e,t){return Object(rv.tidy)((function(){var n=rv.clipByValue(e,av(),1),r=rv.clipByValue(t,av(),1);return rv.sum(rv.mul(e,rv.log(rv.div(n,r))),-1)}))},poisson:function(e,t){return Object(rv.tidy)((function(){var n=rv.log(rv.add(av(),t));return rv.mean(rv.sub(t,rv.mul(e,n)),-1)}))},cosineProximity:Sy};function Iy(e){if("string"==typeof e){if(e in Ty)return Ty[e];var t="Unknown loss "+e;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy')),new sv(t)}return e}function Ey(e,t){return Object(rv.tidy)((function(){var n=rv.mul(.5,rv.onesLike(t)),r=rg(rv.greater(t,n),e.dtype);return rv.mean(rv.equal(e,r),-1)}))}function Ny(e,t){return Object(rv.tidy)((function(){return rg(rv.equal(rv.argMax(e,-1),rv.argMax(t,-1)),"float32")}))}function Ay(e,t){return Oy(e,t)}function Ry(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),rv.equal(e,t).asType("float32")}var Dy=xy,jy=Cy,Fy={binaryAccuracy:Ey,categoricalAccuracy:Ny,precision:function(e,t){return Object(rv.tidy)((function(){var n=function(e,t){return Object(rv.tidy)((function(){return rv.logicalAnd(e.equal(1),t.equal(1)).sum().cast("float32")}))}(e,t),r=function(e,t){return Object(rv.tidy)((function(){return rv.logicalAnd(e.equal(0),t.equal(1)).sum().cast("float32")}))}(e,t),a=n.add(r);return rv.where(rv.greater(a,0),n.div(a),0).cast("float32")}))},categoricalCrossentropy:Dy,sparseCategoricalCrossentropy:jy,mse:ky,MSE:ky,mae:_y,MAE:_y,mape:wy,MAPE:wy,cosine:Sy};function My(e){if("string"==typeof e&&e in Fy)return Fy[e];if("string"!=typeof e&&null!=e)return e;throw new sv("Unknown metric "+e)}function Py(e){if(hv(null!==e,"Unknown LossOrMetricFn "+e),"string"==typeof e)return e;for(var t,n=0,r=Object.keys(Ty);n<r.length;n++){var a=r[n];if(Ty[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(Fy);i<o.length;i++){var s=o[i];if(Fy[s]===e){t=s;break}}return void 0!==t?t:e.name}function Ly(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!function e(t){if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];if("string"!=typeof a)return!1;if(!e(t[a]))return!1}return!0}if(Array.isArray(t)){var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){if(!e(i.value))return!1}}catch(u){o.e(u)}finally{o.f()}return!0}return!1}var s=typeof t;return"string"===s||"number"===s||"boolean"===s}(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>1048576&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in size (length=').concat(r.length," when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576."))}}function zy(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function By(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(a){r="multiple"}zy(["".concat(e.name," (").concat(e.getClassName(),")"),r,e.countParams().toString()],t,n)}function Vy(e,t,n,r){var a;try{a=JSON.stringify(e.outputShape)}catch(p){a="multiple"}var i,o=[],s=_createForOfIteratorHelper(e.inboundNodes);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var c=0;c<u.inboundLayers.length;++c)o.push("".concat(u.inboundLayers[c].name,"[").concat(u.nodeIndices[c],"][").concat(u.tensorIndices[c],"]"))}}catch(p){s.e(p)}finally{s.f()}var l=e.name,h=e.getClassName(),d=0===o.length?"":o[0];zy(["".concat(l," (").concat(h,")"),a,e.countParams().toString(),d],t,r);for(var f=1;f<o.length;++f)zy(["","","",o[f]],t,r)}function Wy(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}var Uy=function(){function e(t){if(_classCallCheck(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(o){a.e(o)}finally{a.f()}}}return _createClass(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new sv("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Object(rv.cast)(t,e.dtype)}catch(n){throw new sv("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype of the key '").concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof ty){if(null==this.id2Value[e.id])throw new sv("Nonexistent key: "+e.name);return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new sv("Feed dict has no SymbolicTensor name: "+e);return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof ty){if(null==this.id2Value[e.id])throw new sv("Nonexistent key: "+e.name);return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new sv("Feed dict has no SymbolicTensor name: "+e);return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&Object(rv.dispose)(this.id2Mask)}}]),e}(),Hy={},Gy={};function Ky(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),s=o?e:[e],u=s.map((function(e){return e.name})),c=[],l=t.names(),h=_createForOfIteratorHelper(u);try{for(h.s();!(a=h.n()).done;){var d=a.value;-1!==l.indexOf(d)?c.push(t.getValue(d)):c.push(null)}}catch(P){h.e(P)}finally{h.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var f,p,m=u.join(",")+"|"+t.names().join(",");if(null==Hy[m]){var v=function(e,t){rv.util.assert(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=Xy(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,s=_createForOfIteratorHelper(e);try{for(s.s();!(i=s.n()).done;){var u,c=Xy(i.value,t),l=c.sorted,h=c.recipientMap,d=_createForOfIteratorHelper(l);try{for(d.s();!(u=d.n()).done;){var f=u.value;o.has(f.name)||(n.push(f),o.add(f.name))}}catch(P){d.e(P)}finally{d.f()}var p=function(e){null==r[e]&&(r[e]=new Set),h[e].forEach((function(t){return r[e].add(t)}))};for(var m in h)p(m)}}catch(P){s.e(P)}finally{s.f()}}return{sorted:n,recipientCounts:qy(r)}}(s,t);f=v.sorted,p=v.recipientCounts,Hy[m]=f,Gy[m]=p}f=Hy[m],p={},i||Object.assign(p,Gy[m]);for(var g=new Uy(t),y=0;y<f.length;++y){if(null!=r){var b=Object(rv.memory)().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var k=f[y],_=k.sourceLayer;if(!(_ instanceof oy)){var w,x=[],C=[],O=[],S=!1,T=_createForOfIteratorHelper(k.inputs);try{for(T.s();!(w=T.n()).done;){var I=w.value,E=g.getValue(I),N=g.getMask(I);x.push(E),C.push(N),null!=N&&(S=!0),i||(p[I.name]--,0!==p[I.name]||t.hasKey(I)||-1!==u.indexOf(I.name)||E.isDisposed||!0===I.sourceLayer.stateful||O.push(E))}}catch(P){T.e(P)}finally{T.f()}S&&((n=n||{}).mask=C[0]);var A=pv(_.apply(x,n)),R=null;_.supportsMasking&&(R=_.computeMask(x,C));for(var D=Zy(k),j=Array.isArray(D)?D:[D],F=0;F<j.length;++F){g.hasKey(j[F])||g.add(j[F],A[F],Array.isArray(R)?R[0]:R);var M=u.indexOf(j[F].name);-1!==M&&(c[M]=A[F])}i||Object(rv.dispose)(O)}}return g.disposeMasks(),o?c:c[0]}function qy(e){var t={};for(var n in e)t[n]=e[n].size;return t}function Xy(e,t){var n,r=new Set,a=[],i={},o=_createForOfIteratorHelper(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(m){o.e(m)}finally{o.f()}var u=[],c=[];for(u.push(e);u.length>0;){var l=u[u.length-1];if(r.has(l.name))u.pop();else{var h=c[c.length-1]===u.length-1;if(0===l.inputs.length||h)u.pop(),a.push(l),r.add(l.name),h&&c.pop();else{c.push(u.length-1);var d,f=_createForOfIteratorHelper(l.inputs);try{for(f.s();!(d=f.n()).done;){var p=d.value;null==i[p.name]&&(i[p.name]=new Set),i[p.name].add(l.name),r.has(p.name)||u.push(p)}}catch(m){f.e(m)}finally{f.f()}}}}return{sorted:a,recipientMap:i}}function Zy(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=_createForOfIteratorHelper(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(o){i.e(o)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function Yy(e,t){return function(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided classWeight is an array of ".concat(e.length," element(s), but the model has ").concat(r," outputs. Make sure a set of weights is provided for each model output."));return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){a.push(t in e?e[t]:null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, so classWeight must be either an array with ").concat(r," elements or an object with ").concat(t," keys. Provided classWeight not understood: ").concat(JSON.stringify(e)))}(e,t)}function Qy(e,t,n,r){return Jy.apply(this,arguments)}function Jy(){return(Jy=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a){var i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=12;break}return i=Object(rv.tidy)((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") during handling of class weights. The size is expected to be >= 1."))}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during handling of class weights. The rank is expected to be 1 or 2."))})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),Object(rv.dispose)(i),s=[],e.abrupt("return",(o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. The class ".concat(e," exists in the data but not in classWeight"));s.push(r[e])})),Object(rv.tensor1d)(s,"float32")));case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $y(e,t){return Object(rv.mul)(e,t)}function eb(e,t){var n,r;n=t.xs,r=t.ys,rv.util.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+t}));var a=tb("input",e.inputNames,n),i=tb("output",e.outputNames,r),o=a[0].shape[0];rv.util.assert(a.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset provides ").concat(a.length," inputs.  (Expected input keys: ")+JSON.stringify(e.inputNames)+")"})),rv.util.assert(i.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset provides ").concat(i.length," outputs.  (Expected output keys: ")+JSON.stringify(e.outputNames)+")"}));for(var s=function(t){rv.util.assert(a[t].shape[0]===o,(function(){return"Batch size mismatch: input ".concat(e.inputNames[t]," has ").concat(a[t].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],".")}))},u=0;u<a.length;u++)s(u);for(var c=function(t){rv.util.assert(i[t].shape[0]===o,(function(){return"Batch size mismatch: output ".concat(e.outputNames[t]," has ").concat(i[t].shape[0],"; expected  ").concat(o," based on input ").concat(e.inputNames[0],".")}))},l=0;l<i.length;l++)c(l);return{xs:a,ys:i}}function tb(e,t,n){if(n instanceof rv.Tensor)return[n];if(Array.isArray(n))return rv.util.assert(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new sv("The feature data generated by the dataset lacks the required ".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch(s){i.e(s)}finally{i.f()}return a}function nb(e){return"function"==typeof e.iterator}function rb(e){rv.util.assert(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got "+e}))}function ab(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return ig(e,t,n-t)})):ig(e,t,n-t)}function ib(e,t){return rv.tidy((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return ib(e,t)})):fg(e,"int32"===t.dtype?t:t.toInt())}))}function ob(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function sb(e){var t=[];e instanceof rv.Tensor&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(ag(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function ub(e,t){if(null!=e){var n=[];if(t instanceof rv.Tensor)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t)n.push(t[r].id);var a=[];if(e instanceof rv.Tensor)-1===n.indexOf(e.id)&&a.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&a.push(e)}));else if(null!=e)for(var i in e){var o=e[i];-1===n.indexOf(o.id)&&a.push(o)}a.forEach((function(e){e.isDisposed||e.dispose()}))}}function cb(e){return Array.isArray(e)}function lb(e){return!function(e){return e instanceof rv.Tensor}(e)&&!cb(e)}function hb(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(cb(e)&&e.length>0)o=!0;else if(lb(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new sv("Error when checking model ".concat(i," expected no data, but got ")+e)}return[]}if(null==e)return t.map((function(e){return null}));if(lb(e)){e=e,r=[];var u,c=_createForOfIteratorHelper(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(null==e[l])throw new sv('No data provided for "'.concat(l,'". Need data for each key in: ')+t);r.push(e[l])}}catch(v){c.e(v)}finally{c.f()}}else if(cb(e)){if((e=e).length!==t.length)throw new sv("Error when checking model ".concat(i,": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got the following list of Tensor(s): ")+e);r=e}else{if(e=e,t.length>1)throw new sv("The model ".concat(i," expects ").concat(t.length," Tensor(s), but only received one Tensor. Found: Tensor with shape ")+e.shape);r=[e]}if(r=sb(r),null!=n)for(var h=0;h<t.length;++h)if(null!=n[h]){var d=r[h];if(d.shape.length!==n[h].length)throw new sv("Error when checking ".concat(i,": expected ").concat(t[h]," to have ").concat(n[h].length," dimension(s). but got array with shape ")+d.shape);for(var f=0;f<n[h].length;++f)if(0!==f||a){var p=d.shape[f],m=n[h][f];if(null!=m&&m>=0&&p!==m)throw new sv("Error when checking ".concat(i,": expected ").concat(t[h]," to have shape [").concat(n[h],"], but got array with shape [").concat(d.shape,"]."))}}return r}function db(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new sv("Error when checking model ".concat(i,": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ").concat(t.length," Tensor(s), but instead got ").concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new sv("The model expects ".concat(t.length," ").concat(i," Tensors, but only received one Tensor. Found: array with shape ")+JSON.stringify(e.shape)+".");r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new sv("Error when checking ".concat(i,": expected ").concat(t[o]," to have ").concat(n[o].length," dimension(s), but got array with shape ")+JSON.stringify(s.shape));for(var u=0;u<n[o].length;++u)if(0!==u||a){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new sv("Error when checking ".concat(i,": expected ").concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but got array with shape ").concat(JSON.stringify(s.shape),"."))}}}var fb=function(e){_inherits(u,e);var t,n,r,a,i,o,s=_createSuper(u);function u(e){var t;return _classCallCheck(this,u),(t=s.call(this,e)).isTraining=!1,t}return _createClass(u,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new sv("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=function(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,_toConsumableArray(s))}if(t){var u,c=_createForOfIteratorHelper(e.layers);try{for(c.s();!(u=c.n()).done;){var l,h=u.value,d=!1,f=_createForOfIteratorHelper(h.inboundNodes);try{for(f.s();!(l=f.n()).done;){var p=l.value;if(-1!==r.indexOf(p)){if(d){t=!1;break}d=!0}}}catch(m){f.e(m)}finally{f.f()}if(!t)break}}catch(m){c.e(m)}finally{c.f()}}return t}(e),o=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,_toConsumableArray(e.nodesByDepth[s]))}a("_".repeat(t)),zy(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?By(c[l],n,a):Vy(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var h=function(e){return Zg(null!=e.collectedTrainableWeights?e.collectedTrainableWeights:e.trainableWeights)}(e),d=Zg(e.nonTrainableWeights);a("Total params: "+(h+d)),a("Trainable params: "+h),a("Non-trainable params: "+d),a("_".repeat(t))}(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return rv.train.adagrad(.01)},Adadelta:function(){return rv.train.adadelta(1,.95,av())},Adam:function(){return rv.train.adam(.001,.9,.999,av())},Adamax:function(){return rv.train.adamax(.002,.9,.999,av(),0)},RMSProp:function(){return rv.train.rmsprop(.001,.9,0,av())},SGD:function(){return rv.train.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new sv("Unknown Optimizer "+e)}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof rv.Optimizer))throw new sv("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new sv("When passing an Array as loss, it should have one entry per model output. The model has ".concat(this.outputs.length," output(s), but you passed loss=").concat(e.loss,"."));n=e.loss.map((function(e){return Iy(e)}))}else{var r=Iy(e.loss);this.outputs.forEach((function(e){n.push(r)}))}else{for(var a in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(a))throw new sv('Unknown entry in loss dictionary: "'.concat(a,'". Only expected the following keys: ')+this.outputNames);var i,o=_createForOfIteratorHelper(this.outputNames);try{for(o.s();!(i=o.n()).done;){var s=i.value;null==e.loss[s]&&console.warn('Output "'.concat(s,'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ').concat(s," during training")),n.push(Iy(e.loss[s]))}}catch(f){o.e(f)}finally{o.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var u=0;u<this.outputs.length;++u){var c=this.internalOutputShapes[u];this.feedOutputNames.push(this.outputNames[u]),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[u])}var l=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],qv("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===l.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var h=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"==typeof e||"function"==typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!=typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+e);n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch(f){i.e(f)}finally{i.f()}return a}(e.metrics,this.outputNames),d=function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])};qv("metric",(function(){for(var e=function(e){-1===l.indexOf(e)&&function(n){var r,a,i,o,s=_createForOfIteratorHelper(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;if("string"==typeof u&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(u)){var c=t.internalOutputShapes[e],l=void 0;1===c[c.length-1]||t.lossFunctions[e]===Oy?-1!==["accuracy","acc"].indexOf(u)?a=Ey:-1!==["crossentropy","ce"].indexOf(u)&&(a=Ay):t.lossFunctions[e]===Cy?-1!==["accuracy","acc"].indexOf(u)?a=Ry:-1!==["crossentropy","ce"].indexOf(u)&&(a=jy):-1!==["accuracy","acc"].indexOf(u)?a=Ny:-1!==["crossentropy","ce"].indexOf(u)&&(a=Dy),-1!==["accuracy","acc"].indexOf(u)?l="acc":-1!==["crossentropy","ce"].indexOf(u)&&(l="ce"),i=a,r=""+l}else{var h=My(u);i=h,r=""+Py(u)}var p=void 0;qv(r,(function(){p=i})),d(e,r,p)}}catch(f){s.e(f)}finally{s.f()}}(h[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;rb(r);var a=this.standardizeUserDataXY(e,t,!0,r);try{var i=a[0].concat(a[1]);return this.makeTestFunction(),fv(this.testLoop(this.testFunction,i,r,n.verbose,n.steps))}finally{ub(a[0],e),ub(a[1],t)}}},{key:"evaluateDataset",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.makeTestFunction(),function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=4;break}throw new uv("Verbose mode is not implemented yet.");case 4:if(rv.util.assert(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(r.batches)})),"function"!=typeof n.next){e.next=9;break}e.t0=n,e.next=12;break;case 9:return e.next=11,n.iterator();case 11:e.t0=e.sent;case 12:s=e.t0,u=0,c=0,l=regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.next();case 2:if(n=e.sent,o=rv.tidy((function(){return n.value&&function(){var e=eb(t,n.value),r=e.xs,a=e.ys,s=r.concat(a),l=rv.tidy((function(){return i(s)}));if(rv.dispose(s),0===c)for(var h=0;h<l.length;++h)o.push(Object(rv.scalar)(0));for(var d=s[0].shape[0],f=function(e){var t=l[e],n=o[e];o[e]=rv.tidy((function(){return rv.add(o[e],rv.mul(d,t))})),c>0&&rv.dispose(n)},p=0;p<l.length;++p)f(p);rv.dispose(l),u+=d,++c}(),o})),!n.done){e.next=6;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, ".concat(r.batches," batches). You may need to use the repeat() function when building your dataset.")),e.abrupt("return","break");case 6:case"end":return e.stop()}}),e)}));case 15:if(a&&!(c<r.batches)){e.next=22;break}return e.delegateYield(l(),"t1",17);case 17:if("break"!==e.t1){e.next=20;break}return e.abrupt("break",22);case 20:e.next=15;break;case 22:for(h=0;h<o.length;++h)d=o[h],o[h]=rv.div(o[h],u),rv.dispose(d);return e.abrupt("return",fv(o));case 24:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()(this,t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new sv("If ".concat(a," is set, batchSize must be null or undefined.Got batchSize = ")+t)}else{if(null==e)throw new sv("Either the input data should have a defined shape, or "+a+" shoud be specified.");r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new sv("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=this.retrieveSymbolicTensors(n?t:[t]),a=new Uy;if(e instanceof rv.Tensor&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new sv("The number of inputs provided (".concat(e.length,") does not match the number of inputs of this model (").concat(this.inputs.length,")."));for(var i=0;i<this.inputs.length;++i)a.add(this.inputs[i],e[i])}else{var o,s=_createForOfIteratorHelper(this.inputs);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=e[u.name];if(null==c)throw new sv("No value is provided for the model's input "+u.name);a.add(u,c)}}catch(h){s.e(h)}finally{s.f()}}var l=Ky(r,a);return n?l:l[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=lv(null,e.length),r=e.length,a=_createForOfIteratorHelper(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var c=s.indexOf(e[u]);if(-1!==c&&(n[u]=o[c],r--),0===r)break}if(0===r)break}}catch(h){a.e(h)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new sv("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(l))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return rv.tidy((function(){var a=t.checkNumSamples(e);if(r)throw new uv("Verbose predictLoop() is not implemented yet.");for(var i=ob(a,n),o=t.outputs.map((function(e){return[]})),s=function(n){rv.tidy((function(){var r=ab(e,i[n][0],i[n][1]),a=[];if(Array.isArray(r))for(var o=0;o<r.length;++o)a.push({key:t.inputs[o],value:r[o]});else a.push({key:t.inputs[0],value:r});var s=new Uy(a);return Ky(t.outputs,s)})).forEach((function(e,t){return o[t].push(e)}))},u=0;u<i.length;++u)s(u);return fv(o.map((function(e){return rv.concat(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=sb(e);db(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return rb(r),this.predictLoop(n,r)}finally{ub(n,e)}}},{key:"predictOnBatch",value:function(e){db(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new ov("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a];r.push(this.feedLossFns[a]===Cy?i.slice(0,i.length-1).concat([1]):i)}if(function(e,t,n){var r=_v(e.map((function(e){return e.shape[0]})));r.sort();var a=_v(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new sv("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map((function(e){return e.shape}))));if(a.length>1)throw new sv("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map((function(e){return e.shape}))));if(r.length>0&&a.length>0&&!rv.util.arraysEqual(r,a))throw new sv("Input Tensors should have the same number of samples as target Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target sample(s)."))}(e=hb(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=hb(t,this.feedOutputNames,r,!1,"target")),function(e,t,n){for(var r=[ky,Oy,xy],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===xy&&1===i.shape[i.shape.length-1])throw new sv("You are passing a target array of shape ".concat(i.shape," while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes]."));if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var h=u[l],d=c[l];if(null!=d&&h!==d)throw new sv("A target Tensor with shape ".concat(i.shape," was passed for an output of shape ").concat(s,", while using a loss function that expects targets to have the same shape as the output."))}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!=0)throw new sv("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a){var i,o,s,u,c,l,h,d,f,p=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(p.length>4&&void 0!==p[4])||p[4],o=p.length>5?p[5]:void 0,s=this.standardizeUserDataXY(t,n,i,o),u=_slicedToArray(s,2),c=u[0],l=u[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(h=null,null==a){e.next=19;break}d=Yy(a,this.outputNames),h=[],f=0;case 10:if(!(f<d.length)){e.next=19;break}return e.t0=h,e.next=14,Qy(l[f],null,d[f]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++f,e.next=10;break;case 19:return e.abrupt("return",[c,l,h]);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return rv.tidy((function(){var o=r.checkNumSamples(t,n,i,"steps"),s=[];if(a>0)throw new uv("Verbose mode is not implemented yet.");if(null!=i)throw new uv("steps mode in testLoop() is not implemented yet");for(var u=ob(o,n),c=Object(rv.tensor1d)(ng(0,o)),l=0;l<u.length;++l){var h=u[l][0],d=u[l][1],f=ig(c,h,d-h),p=ib(t,f),m=e(p);if(0===l)for(var v=0;v<m.length;++v)s.push(Object(rv.scalar)(0));for(var g=0;g<m.length;++g)s[g]=rv.add(s[g],rv.mul(d-h,m[g]))}for(var y=0;y<s.length;++y)s[y]=rv.div(s[y],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;dv(e,r)>1&&(a+="_"+dv(e.slice(0,n),r)),t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],s=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],s=0;s<e.inputs.length;++s)t.push({key:e.inputs[s],value:r[s]});for(var u,c=new Uy(t),l=Ky(e.outputs,c,{training:!0}),h=0;h<e.lossFunctions.length;++h){var d=(0,e.lossFunctions[h])(a[h],l[h]);null!=i[h]&&(d=$y(d,i[h]));var f=rv.mean(d);n.push(f),u=0===h?d:rv.add(u,d)}for(var p=0;p<e.metricsTensors.length;++p){var m=void 0;if(e.outputs.length>1&&p<e.outputs.length)m=n[p];else{var v=e.metricsTensors[p][1];m=rv.mean((0,e.metricsTensors[p][0])(a[v],l[v]))}rv.keep(m),o.push(m)}return u=rv.mean(u),e.calculateLosses().forEach((function(e){u=rv.add(u,e)})),u}),!0,s)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return rv.tidy((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],s=0;s<e.inputs.length;++s)o.push({key:e.inputs[s],value:a[s]});for(var u=new Uy(o),c=Ky(e.outputs,u),l=0;l<e.lossFunctions.length;++l){var h=rv.mean((0,e.lossFunctions[l])(i[l],c[l]));n=0===l?h:rv.add(n,h),r.push(n)}for(var d=0;d<e.metricsTensors.length;++d){var f=e.metricsTensors[d][1],p=rv.mean((0,e.metricsTensors[d][0])(i[f],c[f]));r.push(p)}return r}))}}},{key:"fit",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},e.abrupt("return",function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,k,_,w,x,C,O,S,T=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=T.length>3&&void 0!==T[3]?T[3]:{},!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,rb(d=null==a.batchSize?32:a.batchSize),f=!1,e.next=10,t.standardizeUserData(n,r,a.sampleWeight,a.classWeight,f,d);case 10:if(p=e.sent,i=p[0],o=p[1],h=p[2],v=!1,!(null!=a.validationData&&a.validationData.length>0)){e.next=24;break}if(v=!0,2===a.validationData.length){e.next=16;break}throw 3===a.validationData.length?new uv("validationData including sample weights is not supported yet."):new sv("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+a.validationData+" is invalid.");case 16:return s=a.validationData[0],u=a.validationData[1],g=!0,e.next=20,t.standardizeUserData(s,u,null,null,g,d);case 20:y=e.sent,c=y[0],l=y[1],m=c.concat(l),e.next=25;break;case 24:null!=a.validationSplit&&a.validationSplit>0&&a.validationSplit<1?(v=!0,b=Math.floor(i[0].shape[0]*(1-a.validationSplit)),k=i[0].shape[0],c=ab(i,b,k),i=ab(i,0,b),l=ab(o,b,k),o=ab(o,0,b),m=c.concat(l)):null!=a.validationSteps&&(v=!0);case 25:return _=i.concat(o).concat(h),t.checkTrainableWeightsConsistency(),w=t.makeTrainFunction(),x=t.getDedupedMetricsNames(),v?(t.makeTestFunction(),C=t.testFunction,O=x.slice().concat(x.map((function(e){return"val_"+e})))):(C=null,m=[],O=x.slice()),S=my(a.callbacks,a.yieldEvery),e.next=32,function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a,i,o,s,u,c,l,h,d,f,p,m){var v,g,y,b,k,_,w,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==i&&(i=32),null==o&&(o=1),null==h&&(h=!0),null==f&&(f=0),v=!1,null!=c&&null!=l&&(v=!0),null!=(g=t.checkNumSamples(r,i,null,"steps_per_epoch"))&&(y=ng(0,g)),null==s&&(s=1),b=gy(u,s,o,f,g,null,i,v,d),k=b.callbackList,_=b.history,k.setModel(t),t.history=_,e.next=10,k.onTrainBegin();case 10:t.stopTraining_=!1,w=regeneratorRuntime.mark((function e(o){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.onEpochBegin(o);case 2:return s={},e.delegateYield(regeneratorRuntime.mark((function e(){var o,u,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("batch"!==h){e.next=2;break}throw new uv("batch shuffling is not implemneted yet");case 2:h&&rv.util.shuffle(y),o=Object(rv.tensor1d)(y),u=ob(g,i),d=regeneratorRuntime.mark((function e(h){var d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d={},e.next=3,k.onBatchBegin(h,d);case 3:return rv.tidy((function(){var e=u[h][0],f=u[h][1],p=ig(o,e,f-e);d.batch=h,d.size=f-e;for(var m=ib(r,p),g=n(m),y=0;y<a.length;++y){var b=g[y];d[a[y]]=b,rv.keep(b)}if(h===u.length-1&&v)for(var k=t.testLoop(c,l,i),_=0;_<a.length;++_){var w=a[_],x=k[_];rv.keep(x),s["val_"+w]=x}})),e.next=6,k.onBatchEnd(h,d);case 6:if(cy(d),!t.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),f=0;case 6:if(!(f<u.length)){e.next=14;break}return e.delegateYield(d(f),"t0",8);case 8:if("break"!==e.t0){e.next=11;break}return e.abrupt("break",14);case 11:++f,e.next=6;break;case 14:o.dispose();case 15:case"end":return e.stop()}}),e)}))(),"t0",4);case 4:return e.next=6,k.onEpochEnd(o,s);case 6:if(!t.stopTraining_){e.next=8;break}return e.abrupt("return","break");case 8:case"end":return e.stop()}}),e)})),x=f;case 13:if(!(x<o)){e.next=21;break}return e.delegateYield(w(x),"t0",15);case 15:if("break"!==e.t0){e.next=18;break}return e.abrupt("break",21);case 18:++x,e.next=13;break;case 21:return e.next=23,k.onTrainEnd();case 23:return e.next=25,t.history.syncData();case 25:return e.abrupt("return",t.history);case 26:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,o,s,u,c,l,h,d,f,p,m){return e.apply(this,arguments)}}()(t,w,_,x,d,a.epochs,a.verbose,S,C,m,a.shuffle,O,a.initialEpoch);case 32:return e.abrupt("return",e.sent);case 33:return e.prev=33,t.isTraining=!1,ub(i,n),ub(o,r),ub(c,s),ub(l,u),null!=h&&rv.dispose(h),e.finish(33);case 36:case"end":return e.stop()}}),e,null,[[4,,33,36]])})));return function(t,n,r){return e.apply(this,arguments)}}()(this,t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"fitDataset",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,k,_,w,x,C,O,S,T,I,E,N,A,R,D,j,F;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,rv.util.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),rv.util.assert(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),rv.util.assert(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+r.epochs})),rv.util.assert(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+r.batchesPerEpoch})),rv.util.assert(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,(i=null!=r.validationData)&&(nb(r.validationData)?rv.util.assert(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+r.validationBatches})):(u=function(e){if(3===e.length)throw new uv("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(r.validationData),o=u.xs,s=u.ys)),c=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),h=i?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),d=my(r.callbacks,r.yieldEvery),f=null==r.verbose?1:r.verbose,p=gy(d,f,r.epochs,null,null,function(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}(n,r),null,i,h),m=p.callbackList,v=p.history,m.setModel(t),t.history=v,e.next=14,m.onTrainBegin();case 14:return t.stopTraining_=!1,g=null==r.initialEpoch?0:r.initialEpoch,e.next=18,n.iterator();case 18:y=e.sent;case 19:if(!(g<r.epochs)){e.next=89;break}return b={},e.next=23,m.onEpochBegin(g);case 23:if(k=0,_=0,e.t0=a,e.t0){e.next=29;break}return e.next=28,n.iterator();case 28:y=e.sent;case 29:if(a&&!(k<r.batchesPerEpoch)){e.next=82;break}return e.next=32,y.next();case 32:if(w=e.sent,!a||!w.done){e.next=36;break}return console.warn("You provided `batchesPerEpoch` as "+r.batchesPerEpoch+", but your dataset iterator ran out of data after "+k+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+r.batchesPerEpoch*r.epochs+" batches). You may need to use the repeat() function when building your dataset."),e.abrupt("break",82);case 36:if(null==w.value){e.next=63;break}return x=eb(t,w.value),C=x.xs,O=x.ys,(S={}).batch=_,S.size=C[0].shape[0],e.next=42,m.onBatchBegin(_,S);case 42:if(T=[],null==r.classWeight){e.next=55;break}I=Yy(r.classWeight,t.outputNames),E=0;case 46:if(!(E<I.length)){e.next=55;break}return e.t1=T,e.next=50,Qy(O[E],null,I[E]);case 50:e.t2=e.sent,e.t1.push.call(e.t1,e.t2);case 52:++E,e.next=46;break;case 55:for(N=C.concat(O).concat(T),A=c(N),rv.dispose(N),R=0;R<l.length;++R)D=A[R],S[l[R]]=D,rv.keep(D);return e.next=60,m.onBatchEnd(_,S);case 60:cy(S),_++,k++;case 63:if(!(a?k>=r.batchesPerEpoch:w.done)){e.next=78;break}if(!i){e.next=77;break}if(j=void 0,!nb(r.validationData)){e.next=74;break}return e.t4=pv,e.next=70,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 70:e.t5=e.sent,e.t3=(0,e.t4)(e.t5),e.next=75;break;case 74:e.t3=pv(t.evaluate(o,s,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));case 75:for(j=e.t3,F=0;F<t.metricsNames.length;++F)b["val_"+t.metricsNames[F]]=j[F];case 77:return e.abrupt("break",82);case 78:if(!t.stopTraining_){e.next=80;break}return e.abrupt("break",82);case 80:e.next=29;break;case 82:return e.next=84,m.onEpochEnd(g,b);case 84:if(g++,!t.stopTraining_){e.next=87;break}return e.abrupt("break",89);case 87:e.next=19;break;case 89:return e.next=91,m.onTrainEnd();case 91:return e.next=93,t.history.syncData();case 93:return e.abrupt("return",t.history);case 94:return e.prev=94,t.isTraining=!1,e.finish(94);case 97:case"end":return e.stop()}}),e,null,[[4,,94,97]])})));return function(t,n,r){return e.apply(this,arguments)}}()(this,t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"trainOnBatch",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction()(a.concat(i)),s=[],u=_createForOfIteratorHelper(o),e.prev=8,u.s();case 10:if((c=u.n()).done){e.next=18;break}return l=c.value,e.next=14,l.data();case 14:h=e.sent,s.push(h[0]);case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),u.e(e.t0);case 23:return e.prev=23,u.f(),e.finish(23);case 26:return e.abrupt("return",(rv.dispose(o),fv(s)));case 27:case"end":return e.stop()}}),e,this,[[8,20,23,26]])}))),function(e,t){return n.apply(this,arguments)})},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=_get(_getPrototypeOf(u.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=rv.memory().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-rv.memory().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"==typeof this.loss)e=mv(this.loss);else if(Array.isArray(this.loss)){var t,n=_createForOfIteratorHelper(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!=typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(u){n.e(u)}finally{n.f()}e=this.loss.map((function(e){return mv(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!=typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=mv(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[mv(Py(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return mv(Py(e))}));var e={};for(var t in this.metrics)e[t]=mv(Py(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=yy(function e(t,n){if(null===t)return null;if("string"==typeof t)return vv(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var r=[],a=t.length,i=0;i<a;++i){var o=t[i];Wy(n,i,o)?r.push(o):r.push(e(o,n))}return r}for(var s={},u=0,c=Object.keys(t);u<c.length;u++){var l=c[u],h=t[l];if("name"===l&&"string"==typeof h)s[l]=h;else{var d=vv(l);s[d]=e(h,d)}}return s}(e.optimizer_config));if("string"==typeof e.loss)t=vv(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return vv(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=vv(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return vv(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=vv(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=7;break}if(0!==(r=rv.io.getSaveHandlers(t)).length){e.next=4;break}throw new sv("Cannot find any save handlers for URL '".concat(t,"'"));case 4:if(!(r.length>1)){e.next=6;break}throw new sv("Found more than one (".concat(r.length,") save handlers for URL '").concat(t,"'"));case 6:t=r[0];case 7:if(null!=t.save){e.next=9;break}throw new sv("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 9:return e.next=11,rv.io.encodeWeights(this.getNamedWeights(n));case 11:if(a=e.sent,i={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v2.8.6",convertedBy:null},null==n||!n.includeOptimizer||null==this.optimizer){e.next=27;break}return i.trainingConfig=this.getTrainingConfig(),s="optimizer",e.t0=rv.io,e.next=19,this.optimizer.getWeights();case 19:return e.t1=e.sent,e.t2=s,e.next=23,e.t0.encodeWeights.call(e.t0,e.t1,e.t2);case 23:u=e.sent,c=u.data,l=u.specs,(o=a.specs).push.apply(o,_toConsumableArray(l)),a.data=rv.io.concatenateArrayBuffers([a.data,c]);case 27:return e.abrupt("return",(null!=this.userDefinedMetadata&&(Ly(this.userDefinedMetadata,this.name,!0),i.userDefinedMetadata=this.userDefinedMetadata),i.weightData=a.data,i.weightSpecs=a.specs,t.save(i)));case 28:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"setUserDefinedMetadata",value:function(e){Ly(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),u}(function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=Hg(a)}if(r.supportsMasking=!1,r.trainable_=!0,r.inputs=Array.isArray(e.inputs)?e.inputs.slice():[e.inputs],r.outputs=Array.isArray(e.outputs)?e.outputs.slice():[e.outputs],_v(r.inputs).length!==r.inputs.length)throw new sv("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map((function(e){return e.name})));_v(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map((function(e){return e.name}))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=_createForOfIteratorHelper(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.nodeIndex,c=s.tensorIndex;r.outputLayers.push(s.sourceLayer),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(c)}}catch(me){o.e(me)}finally{o.f()}var l,h=_createForOfIteratorHelper(r.inputs);try{for(h.s();!(l=h.n()).done;){var d=l.value,f=d.sourceLayer,p=d.nodeIndex,m=d.tensorIndex;hv(0===p,"input layer has >1 nodes"),hv(0===m,"input layer has >1 tensors"),r.inputLayers.push(f),r.inputLayersNodeIndices.push(p),r.inputLayersTensorIndices.push(m)}}catch(me){h.e(me)}finally{h.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var v=0;v<r.inputLayers.length;v++){var g=r.inputLayers[v];if(!(g instanceof oy))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: ".concat(e.inputs,". Input ").concat(v," (0-based) originates from layer type ").concat(g.getClassName(),"."));r.inputNames.push(g.name),r.feedInputShapes.push(g.batchInputShape),r.feedInputNames.push(g.name)}var y,b=_createForOfIteratorHelper(r.outputLayers);try{for(b.s();!(y=b.n()).done;){var k=y.value;r.outputNames.push(k.name)}}catch(me){b.e(me)}finally{b.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var _,w={},x={},C={},O={},S={},T=[],I=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new ov("The tensor ".concat(t.name,' at layer "').concat(o.name,'" is part of a cycle.'));if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,s)),o.id in S||(S[o.id]=Object.keys(S).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,h=0;h<l;h++)e(c.inputTensors[h],a,i,c.inboundLayers[h],c.nodeIndices[h],c.tensorIndices[h]);for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);T.push(c)}},E=[],N=[],A=_createForOfIteratorHelper(r.outputs);try{for(A.s();!(_=A.n()).done;){I(_.value,E,N)}}catch(me){A.e(me)}finally{A.f()}var R,D=_createForOfIteratorHelper(T.slice().reverse());try{for(D.s();!(R=D.n()).done;){var j=R.value;x[j.id]=j,j.id in w||(w[j.id]=0);var F=w[j.id];F=Math.max(F,null==C[j.outboundLayer.id]?0:C[j.outboundLayer.id]),C[j.outboundLayer.id]=F,O[j.outboundLayer.id]=j.outboundLayer,w[j.id]=F;for(var M=0;M<j.inboundLayers.length;M++){var P=j.inboundLayers[M].inboundNodes[j.nodeIndices[M]];w[P.id]=Math.max(F+1,null==w[P.id]?0:w[P.id]),x[P.id]=P}}}catch(me){D.e(me)}finally{D.f()}var L={};for(var z in w){var B=w[z];B in L||(L[B]=[]),L[B].push(x[z])}var V={};for(var W in C){var U=C[W];U in V||(V[U]=[]),V[U].push(O[W])}var H=Object.keys(V).map((function(e){return parseInt(e,10)})).sort(kv);r.layers=[];var G,K=_createForOfIteratorHelper(H);try{for(K.s();!(G=K.n()).done;){var q=V[G.value];q.sort((function(e,t){var n=S[e.id],r=S[t.id];return n<r?-1:n>r?1:0}));var X,Z=_createForOfIteratorHelper(q);try{for(Z.s();!(X=Z.n()).done;){var Y=X.value;Y instanceof n&&r.internalContainerRefs.push(Y),r.layers.push(Y)}}catch(me){Z.e(me)}finally{Z.f()}}}catch(me){K.e(me)}finally{K.f()}r.layersByDepth=V,H=Object.keys(L).map((function(e){return parseInt(e,10)})).sort(kv);var Q,J=r.inputs.slice(),$=[],ee=_createForOfIteratorHelper(H);try{for(ee.s();!(Q=ee.n()).done;){var te,ne=_createForOfIteratorHelper(L[Q.value]);try{for(ne.s();!(te=ne.n()).done;){var re=te.value,ae=re.outboundLayer;if(null!=ae){var ie,oe=_createForOfIteratorHelper(re.inputTensors);try{for(oe.s();!(ie=oe.n()).done;){var se=ie.value;if(-1===J.indexOf(se))throw new ov("Graph disconnected: cannot obtain value for tensor "+se+' at layer "'.concat(ae.name,'". The following previous layers were accessed without issue: ')+$)}}catch(me){oe.e(me)}finally{oe.f()}var ue,ce=_createForOfIteratorHelper(re.outputTensors);try{for(ce.s();!(ue=ce.n()).done;){var le=ue.value;J.push(le)}}catch(me){ce.e(me)}finally{ce.f()}$.push(ae.name)}}}catch(me){ne.e(me)}finally{ne.f()}}}catch(me){ee.e(me)}finally{ee.f()}r.nodesByDepth=L;var he,de=r.layers.map((function(e){return e.name})),fe=_createForOfIteratorHelper(de);try{var pe=function(){var e=he.value,t=de.filter((function(t){return t===e})).length;if(1!==t)throw new ov('The name "'.concat(e,'" is used ').concat(t," times in the model. All layer names should be unique. Layer names: ")+JSON.stringify(de))};for(fe.s();!(he=fe.n()).done;)pe()}catch(me){fe.e(me)}finally{fe.f()}return r.outboundNodes=[],r.inboundNodes=[],new ry({outboundLayer:_assertThisInitialized(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,_possibleConstructorReturn(r)}return _createClass(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){var t,n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(s){n.e(s)}finally{n.f()}var a,i=_createForOfIteratorHelper(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(s){i.e(s)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new sv("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.nonTrainableWeights))}}catch(u){n.e(u)}finally{n.f()}if(!this.trainable){var a,i=[],o=_createForOfIteratorHelper(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,_toConsumableArray(s.trainableWeights))}}catch(u){o.e(u)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=t.value,u=_createForOfIteratorHelper(s.weights);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(null!=r[c.originalName])throw new sv("Duplicate weight name: "+c.originalName);r[c.originalName]=c,a++}}catch(v){u.e(v)}finally{u.f()}}}catch(v){i.e(v)}finally{i.f()}var l=[];for(var h in e){var d=h;if(null==r[h]){var f=h.split("/");d=f.slice(0,-2).concat([f[f.length-1]]).join("/")}if(null!=r[d])l.push([r[d],e[h]]);else if(n)throw new sv("Provided weight data has no target variable: "+h);delete r[d]}if(n){var p=[];for(var m in r)p.push(m);if(p.length>0)throw new sv("".concat(p.length," of ").concat(a," weights are not set: ")+p)}Jg(l)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers 2.8.6",t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function e(t,n){if(null==t)return null;if("string"==typeof t)return mv(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var r=[],a=t.length,i=0;i<a;++i){var o=t[i];Wy(n,i,o)?r.push(o):r.push(e(o,n))}return r}for(var s={},u=0,c=Object.keys(t);u<c.length;u++){var l=c[u],h=t[l];s[mv(l)]="name"!==l&&"className"!==l||"string"!=typeof h?e(h,l):h}return s}(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){e=pv(e);for(var r=new Uy,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return Ky(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var r;return e=pv(e),r=null==t?lv(null,e.length):pv(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=Kg(e);if(t.length!==this.inputLayers.length)throw new sv("Invalid inputShape argument ".concat(e,": model has ").concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++)n[this.inputLayers[r].name+"_0_0"]=t[r];var a=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(kv);if(a.length>1){var i,o=_createForOfIteratorHelper(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=_createForOfIteratorHelper(this.nodesByDepth[u]);try{for(c.s();!(s=c.n()).done;){var l=s.value,h=l.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(h.id)){for(var d=[],f=0;f<l.inboundLayers.length;f++)d.push(n["".concat(l.inboundLayers[f].name,"_").concat(l.nodeIndices[f],"_").concat(l.tensorIndices[f])]);for(var p=Kg(h.computeOutputShape(fv(d))),m=h.inboundNodes.indexOf(l),v=0;v<p.length;v++)n["".concat(h.name,"_").concat(m,"_").concat(v)]=p[v]}}}catch(w){c.e(w)}finally{c.f()}}}catch(w){o.e(w)}finally{o.f()}}for(var g=[],y=[],b=0;b<this.outputLayers.length;b++)y.push("".concat(this.outputLayers[b].name,"_").concat(this.outputLayersNodeIndices[b],"_").concat(this.outputLayersTensorIndices[b]));for(var k=0;k<y.length;k++){var _=y[k];hv(_ in n),g.push(n[_])}return fv(g)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=lv(null,e.length));for(var n={},r=0;r<this.inputs.length;++r)n[this.inputs[r].id]=[e[r],t[r]];var a,i=_createForOfIteratorHelper(Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(kv));try{for(i.s();!(a=i.n()).done;){var o,s=a.value,u=_createForOfIteratorHelper(this.nodesByDepth[s]);try{for(u.s();!(o=u.n()).done;){var c,l=o.value,h=l.outboundLayer,d=l.inputTensors,f=l.outputTensors,p=new Array,m=_createForOfIteratorHelper(d);try{for(m.s();!(c=m.n()).done;){var v=c.value;v.id in n&&p.push(n[v.id])}}catch(F){m.e(F)}finally{m.f()}if(p.length===d.length){var g=void 0,y=void 0,b=void 0,k=void 0,_={};if(null!=l.callArgs&&(_=l.callArgs),1===p.length){var w=_slicedToArray(p[0],2),x=w[0],C=w[1];null==_.mask&&(_.mask=C),b=pv(h.call(x,_)),k=pv(h.computeMask(x,C)),g=[x],y=[C]}else g=p.map((function(e){return e[0]})),y=p.map((function(e){return e[1]})),null==_.mask&&(_.mask=y),b=pv(h.call(g,_)),k=pv(h.computeMask(g,y));if(h.activityRegularizer)throw new uv("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var O=0;O<f.length;++O)n[f[O].id]=[b[O],k[O]]}}}catch(F){u.e(F)}finally{u.f()}}}catch(F){i.e(F)}finally{i.f()}var S,T=[],I=[],E=[],N=_createForOfIteratorHelper(this.outputs);try{for(N.s();!(S=N.n()).done;){var A=S.value;hv(A.id in n,"Could not compute output ".concat(A.name," : ").concat(A.id));var R=_slicedToArray(n[A.id],2),D=R[0],j=R[1];E.push(D.shape),T.push(D),I.push(j)}}catch(F){N.e(F)}finally{N.f()}return[T,I,E]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch(c){i.e(c)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new sv("Was asked to retrieve layer at index ".concat(t,", but model only has ").concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new sv("Provide either a layer name or layer index");var n,r=_createForOfIteratorHelper(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(i){r.e(i)}finally{r.f()}throw new sv("No such layer: "+e)}},{key:"calculateLosses",value:function(){var e=this;return Object(rv.tidy)((function(){var t,r=[],a=_createForOfIteratorHelper(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,_toConsumableArray(i.calculateLosses()))}}catch(u){a.e(u)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var h=o.inboundNodes[l],d=n.nodeKey(o,l),f={};if(this.containerNodes.has(d)){if(h.callArgs)try{JSON.stringify(h.callArgs),f=h.callArgs}catch(N){console.warn("Layer ".concat(o.name," was passed non-serializable keyword arguments: ")+h.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),f={}}if(h.inboundLayers.length>0){for(var p=[],m=0;m<h.inboundLayers.length;m++){var v=h.inboundLayers[m],g=h.tensorIndices[m],y=r[n.nodeKey(v,h.nodeIndices[m])];null==y&&(y=0),p.push([v.name,y,g,f])}c.push(p)}}}var b={};b.name=o.name,b.className=s,b.config=u,b.inboundNodes=c,a.push(b)}}catch(N){i.e(N)}finally{i.f()}t.layers=a;for(var k=[],_=0;_<this.inputLayers.length;_++){var w=this.inputLayers[_],x=n.nodeKey(w,this.inputLayersNodeIndices[_]);if(this.containerNodes.has(x)){var C=r[x];null==C&&(C=0),k.push([w.name,C,this.inputLayersTensorIndices[_]])}}t.inputLayers=k;for(var O=[],S=0;S<this.outputLayers.length;S++){var T=this.outputLayers[S],I=n.nodeKey(T,this.outputLayersNodeIndices[S]);if(this.containerNodes.has(I)){var E=r[I];null==E&&(E=0),O.push([T.name,E,this.outputLayersTensorIndices[S]])}}return t.outputLayers=O,t}},{key:"stateful",get:function(){if(this._stateful)throw new sv("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=_createForOfIteratorHelper(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;Object(rv.tidy)((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=_createForOfIteratorHelper(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u[0],l=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(c in r))return void i(e,t);var d=r[c];if(d.inboundNodes.length<=l)return void i(e,t);o.push(d.inboundNodes[l].outputTensors[h])}}catch(f){s.e(f)}finally{s.f()}o.length>0&&e.apply(fv(o),n)}function s(e){var a=e.name,o=yy(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new sv("Corrupted configuration, expected array for nodeData: "+e);i(o,e)}))}var u,c=t.name,l=t.layers,h=_createForOfIteratorHelper(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;s(d)}}catch(P){h.e(P)}finally{h.f()}for(;!wv(a);){var f,p=_createForOfIteratorHelper(l);try{for(p.s();!(f=p.n()).done;){var m=f.value,v=r[m.name];if(v.name in a){var g=a[v.name];delete a[v.name];var y,b=_createForOfIteratorHelper(g);try{for(b.s();!(y=b.n()).done;){var k=y.value;o(v,k)}}catch(P){b.e(P)}finally{b.f()}}}}catch(P){p.e(P)}finally{p.f()}}var _,w=[],x=[],C=t.inputLayers,O=_createForOfIteratorHelper(C);try{for(O.s();!(_=O.n()).done;){var S=_.value,T=S[0],I=S[1],E=S[2];hv(T in r),w.push(r[T].inboundNodes[I].outputTensors[E])}}catch(P){O.e(P)}finally{O.f()}var N,A=t.outputLayers,R=_createForOfIteratorHelper(A);try{for(R.s();!(N=R.n()).done;){var D=N.value,j=D[0],F=D[1],M=D[2];hv(j in r),x.push(r[j].inboundNodes[F].outputTensors[M])}}catch(P){R.e(P)}finally{R.f()}return new e({inputs:w,outputs:x,name:c})}}]),n}(iy));fb.className="Model",rv.serialization.registerClass(fb);var pb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(fb);pb.className="Functional",rv.serialization.registerClass(pb);var mb=function(e){_inherits(o,e);var t,n,r,a,i=_createSuper(o);function o(e){var t;if(_classCallCheck(this,o),e=e||{},(t=i.call(this,{inputs:[],outputs:[]})).trainable=!0,t.built=!1,t.name=null!=e.name?e.name:Hg("sequential_"),null!=e.layers){var n,r=_createForOfIteratorHelper(e.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.add(a)}}catch(s){r.e(s)}finally{r.f()}}return _possibleConstructorReturn(t)}return _createClass(o,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new sv("Negative dimension size caused by adding layer "+e.name+" with input shape ["+e.inboundNodes[0].inputTensors[0].shape+"]")}},{key:"add",value:function(e){var t,n=e instanceof o||e instanceof fb;if(n){if(1!==(t=e).outputs.length)throw new sv("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new sv("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new sv("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var r=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new sv("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new oy({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new sv("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ".concat(e.name," which has ").concat(e.inboundNodes.length," pre-existing inbound connections."));if(1!==e.inboundNodes[0].outputTensors.length)throw new sv("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=function e(t,n,r){if((null==n||null!=r&&r>0)&&(n=t.sourceLayer,r=t.nodeIndex),0===n.inboundNodes.length)return[t];var a=n.inboundNodes[r];if(0===a.inboundLayers.length)return a.inputTensors;for(var i=[],o=0;o<a.inboundLayers.length;o++){var s,u=_createForOfIteratorHelper(e(a.inputTensors[o],a.inboundLayers[o],a.nodeIndices[o]));try{for(u.s();!(s=u.n()).done;){var c=s.value;-1===i.indexOf(c)&&i.push(c)}}catch(l){u.e(l)}finally{u.f()}}return i}(this.outputs[0])}this.inboundNodes=[],new ry({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:lv(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var a=e.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(Xg(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new fb({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),_get(_getPrototypeOf(o.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),_get(_getPrototypeOf(o.prototype),"summary",this).call(this,e,t,n)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new ov("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new ov("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new ov("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"fitDataset",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new ov("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"trainOnBatch",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"stopTraining",get:function(){if(null==this.model)throw new sv("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new sv("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(i){n.e(i)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new sv("Legacy serialization format not supported yet.");n=t}else rv.util.assert(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),n=t.layers,delete t.layers,a=t;var i=new e(a);if(!(i instanceof o))throw new uv("Sequential.fromConfig called on non-Sequential input: "+i);var s,u=_createForOfIteratorHelper(n);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=yy(c,void 0,r);r&&l.setFastWeightInitDuringBuild(!0),i.add(l)}}catch(h){u.e(h)}finally{u.f()}return i}}]),o}(fb);mb.className="Sequential",rv.serialization.registerClass(mb);var vb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getConfig",value:function(){return{}}}]),n}(rv.serialization.Serializable),gb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new uv("Support for alpha values other than 1 (".concat(t,") is not implemented yet."));return rv.elu(e)}(e,t)}}]),n}(vb);gb.className="elu",rv.serialization.registerClass(gb);var yb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rv.selu(e)}}]),n}(vb);yb.className="selu",rv.serialization.registerClass(yb);var bb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rv.relu(e)}}]),n}(vb);bb.className="relu",rv.serialization.registerClass(bb);var kb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return Object(rv.tidy)((function(){return rv.minimum(6,rv.relu(e))}))}}]),n}(vb);kb.className="relu6",rv.serialization.registerClass(kb);var _b=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return e}}]),n}(vb);_b.className="linear",rv.serialization.registerClass(_b);var wb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rv.sigmoid(e)}}]),n}(vb);wb.className="sigmoid",rv.serialization.registerClass(wb);var xb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return function(e){return Object(rv.tidy)((function(){var t=rv.add(.5,rv.mul(.2,e));return rv.clipByValue(t,0,1)}))}(e)}}]),n}(vb);xb.className="hardSigmoid",rv.serialization.registerClass(xb);var Cb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rv.softplus(e)}}]),n}(vb);Cb.className="softplus",rv.serialization.registerClass(Cb);var Ob=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return function(e){return Object(rv.tidy)((function(){return rv.div(e,rv.abs(e).add(1))}))}(e)}}]),n}(vb);Ob.className="softsign",rv.serialization.registerClass(Ob);var Sb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rv.tanh(e)}}]),n}(vb);Sb.className="tanh",rv.serialization.registerClass(Sb);var Tb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return rv.softmax(e,t)}}]),n}(vb);Tb.className="softmax",rv.serialization.registerClass(Tb);var Ib=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return rv.logSoftmax(e,t)}}]),n}(vb);Ib.className="logSoftmax",rv.serialization.registerClass(Ib);var Eb=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(rv.tidy)((function(){return rv.sigmoid(e.mul(t)).mul(e)}))}}]),n}(vb);function Nb(e){return e.getClassName()}function Ab(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return bv(e,rv.serialization.SerializationMap.getMap().classNameMap,t,"activation")}function Rb(e){if(null==e)return Ab({className:"linear",config:{}});if("string"==typeof e){var t={};return t.className=e,t.config={},Ab(t)}return e instanceof vb?e:Ab(e)}Eb.className="swish",rv.serialization.registerClass(Eb);var Db=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(rv.serialization.Serializable),jb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this),function(e){if(null!=e&&"object"!=typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+e)}(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return Object(rv.tidy)((function(){var n=Object(rv.zeros)([1]);return t.hasL1&&(n=Object(rv.add)(n,Object(rv.sum)(rv.mul(t.l1,Object(rv.abs)(e))))),t.hasL2&&(n=Object(rv.add)(n,Object(rv.sum)(rv.mul(t.l2,pg(e))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(Db);jb.className="L1L2",rv.serialization.registerClass(jb);var Fb={l1l2:"L1L2"};function Mb(e){return yv(e)}function Pb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return bv(e,rv.serialization.SerializationMap.getMap().classNameMap,t,"regularizer")}function Lb(e){return null==e?null:"string"==typeof e?Pb({className:e in Fb?Fb[e]:e,config:{}}):e instanceof Db?e:Pb(e)}var zb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return _createClass(n,[{key:"call",value:function(e,t){e=qg(e);var n=Object(rv.relu)(e);return null!=this.maxValue&&(n=Object(rv.clipByValue)(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);zb.className="ReLU",rv.serialization.registerClass(zb);var Bb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return _createClass(n,[{key:"call",value:function(e,t){var n=qg(e);return Object(rv.leakyRelu)(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Bb.className="LeakyReLU",rv.serialization.registerClass(Bb);var Vb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=Bg(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=Lb(e.alphaRegularizer),r.alphaConstraint=Mv(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new sv("Expected sharedAxes to be a number or an array of numbers, but got "+e.sharedAxes);r.sharedAxes=[e.sharedAxes]}return _possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){var t=(e=Xg(e)).slice(1);if(null!=this.sharedAxes){var n,r=_createForOfIteratorHelper(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(o){r.e(o)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new ey({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=qg(e),Object(rv.prelu)(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:zg(this.alphaInitializer),alphaRegularizer:Mb(this.alphaRegularizer),alphaConstraint:jv(this.alphaConstraint),sharedAxes:this.sharedAxes},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Vb.className="PReLU",rv.serialization.registerClass(Vb);var Wb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new uv("Non-default alpha value (".concat(e.alpha,") is not supported by the ELU layer yet."));return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,_possibleConstructorReturn(r)}return _createClass(n,[{key:"call",value:function(e,t){var n=qg(e);return Object(rv.elu)(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Wb.className="ELU",rv.serialization.registerClass(Wb);var Ub=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return _createClass(n,[{key:"call",value:function(e,t){var n=qg(e);return n.mul(rg(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Ub.className="ThresholdedReLU",rv.serialization.registerClass(Ub);var Hb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new Tb).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return _createClass(n,[{key:"call",value:function(e,t){var n=qg(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);function Gb(e,t,n){if("number"==typeof e)return lv(e,t);if(e.length!==t)throw new sv("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new sv("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers. Received: ").concat(JSON.stringify(e)," including a non-integer number ")+a)}return e;var i}function Kb(e,t,n,r){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return null==e?e:(a="same"===n?e:e-(t+(t-1)*(i-1))+1,Math.floor((a+r-1)/r))}function qb(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+tg([n-t,0]);else{if("same"!==r)throw new sv("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function Xb(e,t){return Object(rv.tidy)((function(){return Uv(t),"channelsFirst"===t?rv.transpose(e,[0,2,3,1]):e}))}function Zb(e,t){return Object(rv.tidy)((function(){return Uv(t),"channelsFirst"===t?rv.transpose(e,[0,2,3,4,1]):e}))}function Yb(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Object(rv.tidy)((function(){if(null==i&&(i="channelsLast"),Uv(i),3!==e.rank&&4!==e.rank)throw new sv("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new sv("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ".concat(e.rank,"."));var u=Xb(e,i);if("causal"===a)throw new uv("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=rv.fused.conv2d({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=rv.transpose(u,[0,3,1,2])),u}))}Hb.className="Softmax",rv.serialization.registerClass(Hb);var Qb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;if(_classCallCheck(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,Ov(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new uv("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is not implemented yet."));if(a.kernelSize=Gb(r.kernelSize,e,"kernelSize"),a.strides=Gb(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,Hv(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,Uv(a.dataFormat),a.activation=Rb(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=Bg(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=Mv(r.biasConstraint),a.biasRegularizer=Lb(r.biasRegularizer),a.activityRegularizer=Lb(r.activityRegularizer),a.dilationRate=Gb(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new sv("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(a.dilationRate));if(2===a.rank){if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new sv("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(a.dilationRate))}else if(3===a.rank)if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new sv("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(a.dilationRate));return _possibleConstructorReturn(a)}return _createClass(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Nb(this.activation),useBias:this.useBias,biasInitializer:zg(this.biasInitializer),biasRegularizer:Mb(this.biasRegularizer),activityRegularizer:Mb(this.activityRegularizer),biasConstraint:jv(this.biasConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(hv("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!Cv(e.kernelSize,"number",1,3))throw new sv("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(iy),Jb=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,Ov(a.filters,"filters"),a.kernelInitializer=Bg(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=Mv(r.kernelConstraint),a.kernelRegularizer=Lb(r.kernelRegularizer),a}return _createClass(n,[{key:"build",value:function(e){e=Xg(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new sv("The channel dimension of the input should be defined. Found "+e[t]);var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:_defineProperty({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var t;e=qg(e);var r=null==n.bias?null:n.bias.read(),a=Sv(n.activation.getClassName());if(null!=a&&2===n.rank)t=Yb(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Object(rv.tidy)((function(){if(null==i&&(i="channelsLast"),Uv(i),3!==e.shape.length)throw new sv("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(3!==t.shape.length)throw new sv("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new sv("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if("channelsFirst"===i&&(e=rv.transpose(e,[0,2,1])),"causal"===a)throw new uv("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=rv.conv1d(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=vg(s,n)),s}))}(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=Yb(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new uv("convolutions greater than 3D are not implemented yet.");t=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return Object(rv.tidy)((function(){if(null==i&&(i="channelsLast"),Uv(i),4!==e.rank&&5!==e.rank)throw new sv("conv3dWithBias expects input to be of rank 4 or 5, but received "+e.rank+".");if(4!==t.rank&&5!==t.rank)throw new sv("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+e.rank+".");var s=Zb(e,i);if("causal"===a)throw new uv("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=rv.conv3d(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=vg(s,n)),"channelsFirst"===i&&(s=rv.transpose(s,[0,4,1,2,3])),s}))}(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=Xg(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=Kb(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:zg(this.kernelInitializer),kernelRegularizer:Mb(this.kernelRegularizer),kernelConstraint:jv(this.kernelConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new sv("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(e.filters))}}]),n}(Qb),$b=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return _createClass(n,[{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&!Cv(e.kernelSize,"number",1,2))throw new sv("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Jb);$b.className="Conv2D",rv.serialization.registerClass($b);var ek=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return _createClass(n,[{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new sv("Conv3D expects config.kernelSize to be number or [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Jb);ek.className="Conv3D",rv.serialization.registerClass(ek);var tk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).inputSpec=[new ey({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new sv("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return _possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){if(4!==(e=Xg(e)).length)throw new sv("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new sv("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ey({ndim:4,axes:_defineProperty({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return rv.tidy((function(){var t=qg(e);if(4!==t.shape.length)throw new sv("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+t.shape.length);var r,a,i=t.shape;"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var o=i[a],s=n.kernelSize[1],u=n.strides[1],c=[i[0],qb(i[r],n.strides[0],n.kernelSize[0],n.padding),qb(o,u,s,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=rv.transpose(t,[0,2,3,1]));var l=rv.conv2dTranspose(t,n.kernel.read(),c,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(l=rv.transpose(l,[0,3,1,2])),null!=n.bias&&(l=vg(l,n.bias.read(),n.dataFormat)),null!=n.activation&&(l=n.activation.apply(l)),l}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=Xg(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=qb(a[n],s,i,this.padding),a[r]=qb(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}($b);tk.className="Conv2DTranspose",rv.serialization.registerClass(tk);var nk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;if(_classCallCheck(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new sv("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new sv("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new sv("SeparableConv".concat(a.rank,"D supports only padding modes: 'same' and 'valid', but received ")+JSON.stringify(r.padding));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=Bg(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=Lb(r.depthwiseRegularizer),a.depthwiseConstraint=Mv(r.depthwiseConstraint),a.pointwiseInitializer=Bg(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=Lb(r.pointwiseRegularizer),a.pointwiseConstraint=Mv(r.pointwiseConstraint),_possibleConstructorReturn(a)}return _createClass(n,[{key:"build",value:function(e){if((e=Xg(e)).length<this.rank+2)throw new sv("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+(this.rank+2)+", but received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new sv("The channel dimension of the inputs should be defined, but found "+JSON.stringify(e[t]));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new ey({ndim:this.rank+2,axes:_defineProperty({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var t;if(e=qg(e),1===n.rank)throw new uv("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=rv.transpose(e,[0,2,3,1])),t=rv.separableConv2d(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=vg(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=rv.transpose(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=zg(this.depthwiseInitializer),e.pointwiseInitializer=zg(this.pointwiseInitializer),e.depthwiseRegularizer=Mb(this.depthwiseRegularizer),e.pointwiseRegularizer=Mb(this.pointwiseRegularizer),e.depthwiseConstraint=jv(this.depthwiseConstraint),e.pointwiseConstraint=jv(this.pointwiseConstraint),e}}]),n}(Jb);nk.className="SeparableConv";var rk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,2,e)}return n}(nk);rk.className="SeparableConv2D",rv.serialization.registerClass(rk);var ak=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return _createClass(n,[{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&!Cv(e.kernelSize,"number",1,1))throw new sv("Conv1D expects config.kernelSize to be number or number[] with length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Jb);ak.className="Conv1D",rv.serialization.registerClass(ak);var ik=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){if(e=qg(e),"channelsLast"===n.dataFormat){var t=sg(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return sg(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=sg(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return sg(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);ik.className="Cropping2D",rv.serialization.registerClass(ik);var ok=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Uv(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,xv(Lv,"InterpolationFormat",r.interpolation),r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],null==e[2]?null:this.size[0]*e[2],null==e[3]?null:this.size[1]*e[3]]:[e[0],null==e[1]?null:this.size[0]*e[1],null==e[2]?null:this.size[1]*e[2],e[3]]}},{key:"call",value:function(e,t){var n=this;return rv.tidy((function(){var t=qg(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=rv.transpose(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?t.resizeNearestNeighbor([a,i]):t.resizeBilinear([a,i]);return rv.transpose(o,[0,3,1,2])}var s=n.size[0]*r[1],u=n.size[1]*r[2];return"nearest"===n.interpolation?t.resizeNearestNeighbor([s,u]):t.resizeBilinear([s,u])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);ok.className="UpSampling2D",rv.serialization.registerClass(ok);var sk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=Bg(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Mv(e.depthwiseConstraint),r.depthwiseRegularizer=Lb(e.depthwiseRegularizer),r}return _createClass(n,[{key:"build",value:function(e){if((e=Xg(e)).length<4)throw new sv("Inputs to DepthwiseConv2D should have rank 4. Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new sv("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (".concat(e[t],")."));var n=e[t];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return Object(rv.tidy)((function(){null==a&&(a="channelsLast"),Uv(a);var o=Xb(e,a);if(4!==e.rank)throw new sv("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(4!==t.rank)throw new sv("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return o=rv.depthwiseConv2d(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=rv.transpose(o,[0,3,1,2])),o}))}(e=qg(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=vg(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=Xg(e);var t="channelsFirst"===this.dataFormat?e[3]:e[2],n="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=Kb("channelsFirst"===this.dataFormat?e[2]:e[1],this.kernelSize[0],this.padding,this.strides[0]),a=Kb(t,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],n,r,a]:[e[0],r,a,n]}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=zg(this.depthwiseInitializer),e.depthwiseRegularizer=Mb(this.depthwiseRegularizer),e.depthwiseConstraint=jv(this.depthwiseRegularizer),e}}]),n}(Qb);function uk(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new sv("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function ck(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return rv.tidy((function(){var u=t.shape.length;if(u<3)throw new sv("Input should be at least 3D, but is ".concat(u,"D."));var c=[1,0].concat(ng(2,u));if(t=rv.transpose(t,c),null!=i)throw new uv("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=a.asType("bool").asType("float32")).rank===u-1&&(a=rv.expandDims(a,-1)),a=rv.transpose(a,c)),r&&(t=rv.reverse(t,0),null!=a&&(a=rv.reverse(a,0)));var l,h,d,f=[],p=n,m=t.shape[0],v=rv.unstack(t);null!=a&&(h=rv.unstack(a));for(var g=function(t){var n=v[t],r=rv.tidy((function(){return e(n,p)}));if(null==a)l=r[0],p=r[1];else{var i=rv.tidy((function(){var e=h[t],n=rv.onesLike(e).sub(e);return{output:r[0].mul(e).add(p[0].mul(n)),newStates:p.map((function(t,a){return r[1][a].mul(e).add(t.mul(n))}))}}));l=i.output,p=i.newStates}s&&f.push(l)},y=0;y<m;++y)g(y);return s&&(d=rv.stack(f,1)),[l,d,p]}))}sk.className="DepthwiseConv2D",rv.serialization.registerClass(sk);var lk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,a;if(_classCallCheck(this,n),r=t.call(this,e),null==e.cell)throw new sv("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new yk({cells:e.cell}):e.cell).stateSize)throw new sv("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new ey({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],_possibleConstructorReturn(r)}return _createClass(n,[{key:"getStates",value:function(){return null==this.states_?ng(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){Gg(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=_createForOfIteratorHelper(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch(u){o.e(u)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return rv.tidy((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new uv("Constants support is not implemented in RNN yet.");Gg(e)&&(e=e[0]),e=e;var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new ey({shape:[t,null].concat(_toConsumableArray(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!rv.util.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new sv("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; However cell.stateSize is ")+this.cell.stateSize)}else this.stateSpec=r.map((function(e){return new ey({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(rv.tidy)((function(){if(!t.stateful)throw new iv("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new sv("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)t.states_=Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return rv.zeros([r,e])})):[rv.zeros([r,t.cell.stateSize])];else if(null==e)rv.dispose(t.states_),null!=t.keptStates&&(rv.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return rv.zeros([r,e])})):t.states_[0]=rv.zeros([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new sv("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ")+e);!0===n?t.keptStates.push(t.states_.slice()):rv.dispose(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,s=[r,o];if(!rv.util.arraysEqual(i.shape,s))throw new sv("State ".concat(a," is incompatible with layer ").concat(t.name,": expected shape=").concat(s,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return rv.keep(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=uk(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,c=_createForOfIteratorHelper(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.stateSpec.push(new ey({shape:l.shape}))}}catch(m){c.e(m)}finally{c.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof ty){var h=[e].concat(o),d=this.inputSpec.concat(s),f=this.inputSpec;this.inputSpec=d;var p=_get(_getPrototypeOf(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=f,p}return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=qg(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new sv("RNN Layer has ".concat(o," state(s) but was passed ")+i.length+" initial state(s).");n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=ck((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],h=u[2];n.stateful&&n.resetStates(h,a);var d=n.returnSequences?l:c;return n.returnState?[d].concat(h):d}))}},{key:"getInitialState",value:function(e){var t=this;return Object(rv.tidy)((function(){var n=rv.zeros(e.shape);return n=ag(n=rv.sum(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?lg(n,[1,e]):n})):t.cell.stateSize>1?[lg(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign({},r,e,t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=yy(t.cell,n);return new e(Object.assign(t,{cell:r}))}}]),n}(iy);lk.className="RNN",rv.serialization.registerClass(lk);var hk=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(iy),dk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Ov(r.units,"units"),r.activation=Rb(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Bg(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Bg(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Bg(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Lb(e.kernelRegularizer),r.recurrentRegularizer=Lb(e.recurrentRegularizer),r.biasRegularizer=Lb(e.biasRegularizer),r.kernelConstraint=Mv(e.kernelConstraint),r.recurrentConstraint=Mv(e.recurrentConstraint),r.biasConstraint=Mv(e.biasConstraint),r.dropout=eg([1,tg([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=eg([1,tg([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return _createClass(n,[{key:"build",value:function(e){e=Xg(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){if(2!==(e=e).length)throw new sv("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=bk({ones:function(){return rv.onesLike(e)},rate:n.dropout,training:i})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=bk({ones:function(){return rv.onesLike(r)},rate:n.recurrentDropout,training:i}));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=dg(null!=o?rv.mul(e,o):e,n.kernel.read()),null!=n.bias&&(a=vg(a,n.bias.read())),null!=s&&(r=rv.mul(r,s));var u=rv.add(a,dg(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:Nb(this.activation),useBias:this.useBias,kernelInitializer:zg(this.kernelInitializer),recurrentInitializer:zg(this.recurrentInitializer),biasInitializer:zg(this.biasInitializer),kernelRegularizer:Mb(this.kernelRegularizer),recurrentRegularizer:Mb(this.recurrentRegularizer),biasRegularizer:Mb(this.biasRegularizer),activityRegularizer:Mb(this.activityRegularizer),kernelConstraint:jv(this.kernelConstraint),recurrentConstraint:jv(this.recurrentConstraint),biasConstraint:jv(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,t)}}]),n}(hk);dk.className="SimpleRNNCell",rv.serialization.registerClass(dk);var fk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),e.cell=new dk(e),t.call(this,e)}return _createClass(n,[{key:"call",value:function(e,t){var r=this;return Object(rv.tidy)((function(){return null!=r.cell.dropoutMask&&(rv.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(rv.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,e,{mask:null==t?null:t.mask,training:null==t?null:t.training,initialState:null==t?null:t.initialState})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(lk);fk.className="SimpleRNN",rv.serialization.registerClass(fk);var pk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new sv("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,Ov(r.units,"units"),r.activation=Rb(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Rb(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Bg(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Bg(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Bg(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Lb(e.kernelRegularizer),r.recurrentRegularizer=Lb(e.recurrentRegularizer),r.biasRegularizer=Lb(e.biasRegularizer),r.kernelConstraint=Mv(e.kernelConstraint),r.recurrentConstraint=Mv(e.recurrentConstraint),r.biasConstraint=Mv(e.biasConstraint),r.dropout=eg([1,tg([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=eg([1,tg([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){e=Xg(e),this.kernel=this.addWeight("kernel",[e[e.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){if(2!==(e=e).length)throw new sv("GRUCell expects 2 input Tensors (inputs, h, c), got "+e.length+".");var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=bk({ones:function(){return rv.onesLike(e)},rate:n.dropout,training:r,count:3})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=bk({ones:function(){return rv.onesLike(a)},rate:n.recurrentDropout,training:r,count:3}));var i,o,s,u=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=rv.mul(e,n.dropoutMask[0]));var c=dg(e,n.kernel.read());n.useBias&&(c=vg(c,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=rv.mul(a,u[0]));var l=n.recurrentKernel.read(),h=_slicedToArray(rv.split(l,[2*n.units,n.units],l.rank-1),2),d=h[0],f=h[1],p=dg(a,d),m=_slicedToArray(rv.split(c,3,c.rank-1),3),v=m[0],g=m[1],y=m[2],b=_slicedToArray(rv.split(p,2,p.rank-1),2),k=b[0],_=b[1];i=n.recurrentActivation.apply(rv.add(v,k)),o=n.recurrentActivation.apply(rv.add(g,_));var w=dg(rv.mul(o,a),f);s=n.activation.apply(rv.add(y,w));var x=rv.add(rv.mul(i,a),rv.mul(rv.add(1,rv.neg(i)),s));return[x,x]}))}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:Nb(this.activation),recurrentActivation:Nb(this.recurrentActivation),useBias:this.useBias,kernelInitializer:zg(this.kernelInitializer),recurrentInitializer:zg(this.recurrentInitializer),biasInitializer:zg(this.biasInitializer),kernelRegularizer:Mb(this.kernelRegularizer),recurrentRegularizer:Mb(this.recurrentRegularizer),biasRegularizer:Mb(this.biasRegularizer),activityRegularizer:Mb(this.activityRegularizer),kernelConstraint:jv(this.kernelConstraint),recurrentConstraint:jv(this.recurrentConstraint),biasConstraint:jv(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,t)}}]),n}(hk);pk.className="GRUCell",rv.serialization.registerClass(pk);var mk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new pk(e),t.call(this,e)}return _createClass(n,[{key:"call",value:function(e,t){var r=this;return Object(rv.tidy)((function(){return null!=r.cell.dropoutMask&&(rv.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(rv.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,e,{mask:null==t?null:t.mask,training:null==t?null:t.training,initialState:null==t?null:t.initialState})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(lk);mk.className="GRU",rv.serialization.registerClass(mk);var vk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Ov(r.units,"units"),r.activation=Rb(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Rb(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Bg(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Bg(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Bg(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=Lb(e.kernelRegularizer),r.recurrentRegularizer=Lb(e.recurrentRegularizer),r.biasRegularizer=Lb(e.biasRegularizer),r.kernelConstraint=Mv(e.kernelConstraint),r.recurrentConstraint=Mv(e.recurrentConstraint),r.biasConstraint=Mv(e.biasConstraint),r.dropout=eg([1,tg([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=eg([1,tg([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return _createClass(n,[{key:"build",value:function(e){var t,n;if(e=Xg(e),this.kernel=this.addWeight("kernel",[e[e.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var r=this.biasInitializer,a=this.units;n=new((t=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e,t){var n=r.apply([a]),i=(new xg).apply([a]),o=r.apply([2*a]);return cg(cg(n,i),o)}}]),n}(_g)).className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var r=null!=t.training&&t.training;if(3!==(e=e).length)throw new sv("LSTMCell expects 3 input Tensors (inputs, h, c), got "+e.length+".");var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=bk({ones:function(){return rv.onesLike(e)},rate:n.dropout,training:r,count:4})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=bk({ones:function(){return rv.onesLike(a)},rate:n.recurrentDropout,training:r,count:4}));var o,s,u,c,l=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=rv.mul(e,n.dropoutMask[0]));var h=dg(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=rv.mul(a,l[0])),h=rv.add(h,dg(a,n.recurrentKernel.read())),n.useBias&&(h=vg(h,n.bias.read()));var d=_slicedToArray(rv.split(h,4,h.rank-1),4),f=d[0],p=d[1],m=d[2],v=d[3];o=n.recurrentActivation.apply(f),s=n.recurrentActivation.apply(p),u=rv.add(rv.mul(s,i),rv.mul(o,n.activation.apply(m))),c=n.recurrentActivation.apply(v);var g=rv.mul(c,n.activation.apply(u));return[g,g,u]}))}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:Nb(this.activation),recurrentActivation:Nb(this.recurrentActivation),useBias:this.useBias,kernelInitializer:zg(this.kernelInitializer),recurrentInitializer:zg(this.recurrentInitializer),biasInitializer:zg(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Mb(this.kernelRegularizer),recurrentRegularizer:Mb(this.recurrentRegularizer),biasRegularizer:Mb(this.biasRegularizer),activityRegularizer:Mb(this.activityRegularizer),kernelConstraint:jv(this.kernelConstraint),recurrentConstraint:jv(this.recurrentConstraint),biasConstraint:jv(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,t)}}]),n}(hk);vk.className="LSTMCell",rv.serialization.registerClass(vk);var gk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new vk(e),t.call(this,e)}return _createClass(n,[{key:"call",value:function(e,t){var r=this;return Object(rv.tidy)((function(){return null!=r.cell.dropoutMask&&(rv.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(rv.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,e,{mask:null==t?null:t.mask,training:null==t?null:t.training,initialState:null==t?null:t.initialState})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(lk);gk.className="LSTM",rv.serialization.registerClass(gk);var yk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).cells=e.cells,r}return _createClass(n,[{key:"stateSize",get:function(){var e,t=[],n=_createForOfIteratorHelper(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,_toConsumableArray(r.stateSize)):t.push(r.stateSize)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var r,a=(e=e).slice(1),i=[],o=_createForOfIteratorHelper(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(v){o.e(v)}finally{o.f()}i.reverse();for(var u,c=[],l=0;l<n.cells.length;++l){var h=n.cells[l];a=i[l],u=0===l?[e[0]].concat(a):[u[0]].concat(a),u=h.call(u,t),c.push(u.slice(1))}a=[];var d,f=_createForOfIteratorHelper(c.slice().reverse());try{for(f.s();!(d=f.n()).done;){var p,m=d.value;(p=a).push.apply(p,_toConsumableArray(m))}}catch(v){f.e(v)}finally{f.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;Gg(e)&&(e=e[0]),e=e,this.cells.forEach((function(n,r){qv("RNNCell_"+r,(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t=this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}));return Object.assign({},e,{cells:t})}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.trainableWeights))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.nonTrainableWeights))}}catch(u){n.e(u)}finally{n.f()}if(!this.trainable){var a,i=[],o=_createForOfIteratorHelper(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,_toConsumableArray(s.trainableWeights))}}catch(u){o.e(u)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.weights))}}catch(a){n.e(a)}finally{n.f()}return Qg(t)}},{key:"setWeights",value:function(e){var t,n=[],r=_createForOfIteratorHelper(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=e.splice(a.weights.length),o=0;o<a.weights.length;++o)n.push([a.weights[o],i[o]])}catch(s){r.e(s)}finally{r.f()}Jg(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=_createForOfIteratorHelper(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(yy(o,r))}}catch(s){i.e(s)}finally{i.f()}return new e({cells:a})}}]),n}(hk);function bk(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,s=function(){return gg(t(),n)},u=function(){return yg(s,t,a)};return!o||o<=1?rv.keep(u().clone()):Array(o).fill(void 0).map(u).map((function(e){return rv.keep(e.clone())}))}yk.className="StackedRNNCells",rv.serialization.registerClass(yk);var kk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),e.unroll)throw new uv("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new uv("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new ey({ndim:5})],r}return _createClass(n,[{key:"call",value:function(e,t){var r=this;return rv.tidy((function(){if(null!=r.cell.dropoutMask&&(rv.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(rv.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new sv("ConvRNN2D cell does not support constants");return _get(_getPrototypeOf(n.prototype),"call",r).call(r,e,{mask:null==t?null:t.mask,training:null==t?null:t.training,initialState:null==t?null:t.initialState})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(_toConsumableArray(t.slice(2)))),this.returnState&&(t=[t].concat(_toConsumableArray(Array(2).fill([e[0]].concat(_toConsumableArray(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return rv.tidy((function(){var n=t.cell.stateSize,r=t.computeSingleOutputShape(e.shape),a=[r[0]].concat(_toConsumableArray(r.slice(2))),i=rv.zeros(a);return Array.isArray(n)?Array(n.length).fill(i):[i]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];rv.tidy((function(){if(!t.stateful)throw new iv("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat(_toConsumableArray(a.slice(2)));if(null==r[0])throw new sv("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())t.states_=Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(){return rv.zeros(i)})):[rv.zeros(i)];else if(null==e)rv.dispose(t.states_),null!=t.keptStates&&(rv.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return rv.zeros(i)})):t.states_[0]=rv.zeros(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new sv("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), but it received ").concat(e.length," state value(s). Input received: ")+e);n?t.keptStates.push(t.states_.slice()):rv.dispose(t.states_);for(var o=0;o<t.states_.length;++o){var s=e[o],u=i;if(!rv.util.arraysEqual(s.shape,u))throw new sv("State ".concat(o," is incompatible with layer ").concat(t.name,": expected shape=").concat(u,", received shape=").concat(s.shape));t.states_[o]=s}}t.states_=t.states_.map((function(e){return rv.keep(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,s=t.dilationRate,u="channelsFirst"===n,c=e[u?4:3],l=Kb(e[u?3:2],a[0],i,o[0],s[0]),h=Kb(c,a[1],i,o[1],s[1]);return[].concat(_toConsumableArray(e.slice(0,2)),_toConsumableArray(u?[r,l,h]:[l,h,r]))}}]),n}(lk);kk.className="ConvRNN2D";var _k=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;_classCallCheck(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,s=e.padding,u=e.dataFormat,c=e.dilationRate;return(r=t.call(this,Object.assign({},e,{units:a}))).filters=a,Ov(r.filters,"filters"),r.kernelSize=Gb(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return Ov(e,"kernelSize")})),r.strides=Gb(o||1,2,"strides"),r.strides.forEach((function(e){return Ov(e,"strides")})),r.padding=s||"valid",Hv(r.padding),r.dataFormat=u||"channelsLast",Uv(r.dataFormat),r.dilationRate=Gb(c||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return Ov(e,"dilationRate")})),r}return _createClass(n,[{key:"build",value:function(e){var t;e=Xg(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new sv("The channel dimension of the input should be defined. Found "+e[n]);var r=this.kernelSize.concat([e[n],4*this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var a=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var i;if(this.unitForgetBias){var o=this.biasInitializer,s=this.filters;i=new((t=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e,t){return ug([o.apply([s]),rv.ones([s]),o.apply([2*s])])}}]),n}(_g)).className="CustomInit",t)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,i,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return rv.tidy((function(){if(3!==e.length)throw new sv("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+e.length+".");var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=bk({ones:function(){return rv.onesLike(a)},rate:n.dropout,training:r,count:4}));var s=n.dropoutMask,u=function(e,t,n){return t&&t[n]?rv.mul(t[n],e):e},c=u(a,s,0),l=u(a,s,1),h=u(a,s,2),d=u(a,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=bk({ones:function(){return rv.onesLike(i)},rate:n.recurrentDropout,training:r,count:4}));var f=n.recurrentDropoutMask,p=u(i,f,0),m=u(i,f,1),v=u(i,f,2),g=u(i,f,3),y=_slicedToArray(rv.split(n.kernel.read(),4,3),4),b=y[0],k=y[1],_=y[2],w=y[3],x=_slicedToArray(n.useBias?rv.split(n.bias.read(),4):[null,null,null,null],4),C=x[0],O=x[1],S=x[2],T=x[3];c=n.inputConv(c,b,C,n.padding),l=n.inputConv(l,k,O,n.padding),h=n.inputConv(h,_,S,n.padding),d=n.inputConv(d,w,T,n.padding);var I=_slicedToArray(rv.split(n.recurrentKernel.read(),4,3),4),E=I[0],N=I[1],A=I[2],R=I[3];p=n.recurrentConv(p,E),m=n.recurrentConv(m,N),v=n.recurrentConv(v,A),g=n.recurrentConv(g,R);var D=n.recurrentActivation.apply(rv.add(c,p)),j=n.recurrentActivation.apply(rv.add(l,m)),F=rv.add(rv.mul(j,o),rv.mul(D,n.activation.apply(rv.add(h,v)))),M=rv.mul(n.recurrentActivation.apply(rv.add(d,g)),n.activation.apply(F));return[M,M,F]}))}},{key:"getConfig",value:function(){var e=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),["units"]);return Object.assign({},e,{filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides})}},{key:"inputConv",value:function(e,t,n,r){var a=rv.conv2d(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?vg(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return rv.conv2d(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(vk);_k.className="ConvLSTM2DCell",rv.serialization.registerClass(_k);var wk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){_classCallCheck(this,n);var r=new _k(e);return t.call(this,Object.assign({},e,{cell:r}))}return _createClass(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(kk);wk.className="ConvLSTM2D",rv.serialization.registerClass(wk);var xk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return _createClass(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return yg((function(){return gg(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return _get(_getPrototypeOf(n.prototype),"dispose",this).call(this)}}]),n}(iy);xk.className="Dropout",rv.serialization.registerClass(xk);var Ck=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return _createClass(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(xk);Ck.className="SpatialDropout1D",rv.serialization.registerClass(Ck);var Ok=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,Ov(r.units,"units"),r.activation=Rb(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=Bg(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Bg(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Mv(e.kernelConstraint),r.biasConstraint=Mv(e.biasConstraint),r.kernelRegularizer=Lb(e.kernelRegularizer),r.biasRegularizer=Lb(e.biasRegularizer),r.activityRegularizer=Lb(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){var t=(e=Xg(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:_defineProperty({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=Xg(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r,a=qg(e),i=Sv(n.activation.getClassName());return null!=i?r=dg(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=dg(a,n.kernel.read()),null!=n.bias&&(r=vg(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:Nb(this.activation),useBias:this.useBias,kernelInitializer:zg(this.kernelInitializer),biasInitializer:zg(this.biasInitializer),kernelRegularizer:Mb(this.kernelRegularizer),biasRegularizer:Mb(this.biasRegularizer),activityRegularizer:Mb(this.activityRegularizer),kernelConstraint:jv(this.kernelConstraint),biasConstraint:jv(this.biasConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Ok.className="Dense",rv.serialization.registerClass(Ok);var Sk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e=e||{})).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t,n=_createForOfIteratorHelper((e=Xg(e)).slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new sv('The shape of the input to "Flatten" is not fully defined (got '.concat(e.slice(1),'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.'))}}catch(r){n.e(r)}finally{n.f()}return[e[0],Jv(e,1)]}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=r.transpose(a)}return function(e){if(e.rank<=1)throw new sv("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],Jv(e.shape,1)];return e.reshape(t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Sk.className="Flatten",rv.serialization.registerClass(Sk);var Tk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=Rb(e.activation),r}return _createClass(n,[{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:Nb(this.activation)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Tk.className="Activation",rv.serialization.registerClass(Tk);var Ik=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){return e=qg(e),t=e,r=n.n,Object(rv.tidy)((function(){if(2!==t.shape.length)throw new sv("repeat() expects a rank-2 tensor, but received a rank-".concat(t.shape.length," tensor."));return lg(ag(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Ik.className="RepeatVector",rv.serialization.registerClass(Ik);var Ek=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;_classCallCheck(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return _createClass(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new sv("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=Jv(e);if(null!==i){if(0===a||u%a!=0)throw new sv(n);r[i]=u/a}else if(u!==a)throw new sv(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Ek.className="Reshape",rv.serialization.registerClass(Ek);var Nk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+e.dims+" instead.");var a=ng(1,e.dims.length+1);if(!rv.util.arraysEqual(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new ey({ndim:r.dims.length+1})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t=(e=Xg(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return Object(rv.transpose)(qg(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Nk.className="Permute",rv.serialization.registerClass(Nk);var Ak=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=qg(e);return Object(rv.any)(Object(rv.notEqual)(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e),a=Object(rv.any)(Object(rv.notEqual)(r,n.maskValue),-1,!0);return r.mul(a.asType(r.dtype))}))}}]),n}(iy);Ak.className="Masking",rv.serialization.registerClass(Ak);var Rk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=null==e.inputLength?[a,null]:[a].concat(pv(e.inputLength))}return r.inputDim=e.inputDim,Ov(r.inputDim,"inputDim"),r.outputDim=e.outputDim,Ov(r.outputDim,"outputDim"),r.embeddingsInitializer=Bg(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=Lb(e.embeddingsRegularizer),r.activityRegularizer=Lb(e.activityRegularizer),r.embeddingsConstraint=Mv(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return Object(rv.tidy)((function(){return n.maskZero?(e=qg(e),Object(rv.notEqual)(e,Object(rv.zerosLike)(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=Xg(e),null==this.inputLength)return[].concat(_toConsumableArray(e),[this.outputDim]);var t=pv(this.inputLength);if(t.length!==e.length-1)throw new sv('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ")+e);for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new sv('"inputLength" is '.concat(this.inputLength,", but received input shape has shape ")+e);null==a&&(t[n]=i),n++}return[e[0]].concat(_toConsumableArray(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e);return"int32"!==r.dtype&&(r=rg(r,"int32")),fg(n.embeddings.read(),r.as1D()).reshape(Xg(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:zg(this.embeddingsInitializer),embeddingsRegularizer:Mb(this.embeddingsRegularizer),activityRegularizer:Mb(this.activityRegularizer),embeddingsConstraint:jv(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Rk.className="Embedding",rv.serialization.registerClass(Rk);var Dk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return _createClass(n,[{key:"mergeFunction",value:function(e){throw new uv}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new sv("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Xg(e)]),(e=e).length<2)throw new sv("A merge layer should be called on an Array of at least 2 inputs. Got ".concat(e.length," input(s)."));var t,n=[],r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(c){r.e(c)}finally{r.f()}if((n=_v(n)).length>1)throw new sv("Can not merge tensors with different batch sizes. Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));this.reshapeRequired=-1!==e.indexOf(null)||1!==_v(u).length}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){if(e=e,n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=tg(r),o=_createForOfIteratorHelper(e);try{for(o.s();!(a=o.n()).done;){for(var s=a.value,u=s.rank,c=0;c<i-u;++c)s=ag(s,1);t.push(s)}}catch(S){o.e(S)}finally{o.f()}return n.mergeFunction(t)}var l,h=!1,d=_createForOfIteratorHelper(e);try{for(d.s();!(l=d.n()).done;){var f=l.value,p=f.rank;if(null==p){var m=f.shape,v=m[0],g=m.slice(1).concat([v]),y=f.reshape([v].concat(Jv(m.slice(1))));y=(y=rv.transpose(y,[1,0])).reshape(g),t.push(y),h=!0}else if(p>1){var b=ng(1,p).concat([0]);t.push(rv.transpose(f,b)),h=!0}else t.push(f)}}catch(S){d.e(S)}finally{d.f()}var k=n.mergeFunction(t),_=k.rank;if(h)if(null==_){var w=k.shape,x=w[w.length-1],C=[x].concat(w.slice(0,w.length-1));k=rv.transpose(k.reshape([-1,x]),[1,0]).reshape(C)}else if(_>1){var O=[_-1].concat(ng(0,_-1));k=rv.transpose(k,O)}return k}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==(e=e)[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=_createForOfIteratorHelper(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch(u){o.e(u)}finally{o.f()}return t=1===(i=_v(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return rv.tidy((function(){if(null==t)return null;if(!Array.isArray(t))throw new sv("`mask` should be an Array");if(!Array.isArray(e))throw new sv("`inputs` should be an Array");if(t.length!==e.length)throw new sv("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:rv.expandDims(e,0)})))[0],r=1;r<t.length-1;++r)n=rv.logicalAnd(n,t[r]);return n}))}}]),n}(iy),jk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return Object(rv.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=rv.add(t,e[n]);return t}))}}]),n}(Dk);jk.className="Add",rv.serialization.registerClass(jk);var Fk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return Object(rv.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=rv.mul(t,e[n]);return t}))}}]),n}(Dk);Fk.className="Multiply",rv.serialization.registerClass(Fk);var Mk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return Object(rv.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=rv.add(t,e[n]);return rv.mul(1/e.length,t)}))}}]),n}(Dk);Mk.className="Average",rv.serialization.registerClass(Mk);var Pk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return Object(rv.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=rv.maximum(t,e[n]);return t}))}}]),n}(Dk);Pk.className="Maximum",rv.serialization.registerClass(Pk);var Lk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return Object(rv.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=rv.minimum(t,e[n]);return t}))}}]),n}(Dk);Lk.className="Minimum",rv.serialization.registerClass(Lk);var zk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return _createClass(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new sv("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=_createForOfIteratorHelper(e=e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(h){r.e(h)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var s,u=!1,c=_createForOfIteratorHelper(a);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(rv.util.arraysEqual(l,o)){u=!0;break}}}catch(h){c.e(h)}finally{c.f()}u||a.push(o)}if(a.length>1)throw new sv("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return Object(rv.tidy)((function(){return ug(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new sv("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=_createForOfIteratorHelper(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new sv("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new sv("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new sv("Mismatch in the length of mask (".concat(t.length,") and the legnth of inputs (").concat(e.length,")"));return rv.tidy((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)a.push(null==t[i]?rv.onesLike(e[i]).asType("bool"):t[i].rank<e[i].rank?rv.expandDims(t[i],-1):t[i]);var o=rv.concat(a,n.axis);return rv.all(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Dk);function Bk(e,t){for(;e<0;)e+=t;return e}zk.className="Concatenate",rv.serialization.registerClass(zk);var Vk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return _createClass(n,[{key:"build",value:function(e){rv.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new uv("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new sv("Dimension incompatibility: ".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new sv("A `Dot` layer must be called on exactly 2 inputs, but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return Bk(t,e[n].shape.length)})):[Bk(this.axes,n.shape.length),Bk(this.axes,r.shape.length)],this.normalize&&(n=by(n,t[0]),r=by(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new uv("batchDot is not implemented for tensors of 4D or higher rank yet");if(rv.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, but got "+e.shape.length})),rv.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, but got "+t.shape.length})),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new uv("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return rv.tidy((function(){var n,o;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=e.reshape(e.shape.concat(c))}else n=0;if(o=2===e.shape.length&&2===t.shape.length?i[0]===i[1]?e.mul(t).sum(i[0]):e.transpose([1,0]).mul(t).sum(i[1]):e.matMul(t,i[0]!==e.shape.length-1,i[1]===t.shape.length-1),n>0){for(var h,d=[],f=h=r>a?r+a-3:r-1;f<h+n;++f)d.push(f);o=o.squeeze(d)}return 1===o.shape.length&&(o=o.expandDims(1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[Bk(this.axes,e.length),Bk(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){rv.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new uv("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Dk);Vk.className="Dot",rv.serialization.registerClass(Vk);var Wk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e);return yg((function(){return hg(r.shape,0,n.stddev).add(r)}),(function(){return r}),t.training||!1)}))}}]),n}(iy);Wk.className="GaussianNoise",rv.serialization.registerClass(Wk);var Uk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t);var r=qg(e);return n.rate>0&&n.rate<1?yg((function(){var e=Math.sqrt(n.rate/(1-n.rate));return r.mul(hg(r.shape,1,e))}),(function(){return r}),t.training||!1):r}))}}]),n}(iy);Uk.className="GaussianDropout",rv.serialization.registerClass(Uk);var Hk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return _createClass(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||qg(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return yg((function(){var t=qg(e),a=-1.7580993408473766,i=Object(rv.greaterEqual)(Object(rv.randomUniform)(r),n.rate);i=rg(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate;return t.mul(i).add(i.add(-1).mul(a)).mul(o).add(s)}),(function(){return qg(e)}),t.training||!1)}return e}))}}]),n}(iy);function Gk(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=rv.batchNorm2d(e,t,n,r,a,o);else if(3===e.rank)i=rv.batchNorm3d(e,t,n,r,a,o);else{if(4!==e.rank)throw new uv("batchNormalization is not implemented for array of rank ".concat(e.rank," yet"));i=rv.batchNorm4d(e,t,n,r,a,o)}return i}Hk.className="AlphaDropout",rv.serialization.registerClass(Hk);var Kk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Bg(e.betaInitializer||"zeros"),r.gammaInitializer=Bg(e.gammaInitializer||"ones"),r.movingMeanInitializer=Bg(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Bg(e.movingVarianceInitializer||"ones"),r.betaConstraint=Mv(e.betaConstraint),r.gammaConstraint=Mv(e.gammaConstraint),r.betaRegularizer=Lb(e.betaRegularizer),r.gammaRegularizer=Lb(e.gammaRegularizer),r}return _createClass(n,[{key:"build",value:function(e){e=Xg(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new sv("Axis ".concat(t," of input tensor should have a defined dimension but the layer received an input with shape ")+JSON.stringify(e)+".");this.inputSpec=[new ey({ndim:e.length,axes:_defineProperty({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var r=null!=t.training&&t.training,a=qg(e),i=a.shape,o=i.length,s=ng(0,o),u=n.axis>=0?n.axis:n.axis+o;s.splice(u,1);var c=lv(1,o);c[u]=i[u];var l=s.slice();l.sort();var h=!rv.util.arraysEqual(l,ng(0,o).slice(0,o-1));if(!r)return function(){if(h){var e=n.movingMean.read().reshape(c),t=n.movingVariance.read().reshape(c),r=n.center?n.beta.read().reshape(c):null,i=n.scale?n.gamma.read().reshape(c):null;return Gk(a,e,t,r,i,n.epsilon)}return Gk(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var d=_slicedToArray(function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return rv.util.arraysEqual(r.slice().sort(),ng(0,e.rank-1))?function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Object(rv.tidy)((function(){var i=rv.moments(e,r),o=i.mean,s=i.variance;return[Gk(e,o,s,n,t,a),o,s]}))}(e,t,n,r,a):function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Object(rv.tidy)((function(){var i,o=rv.moments(e,r),s=o.mean,u=o.variance,c=[],l=_createForOfIteratorHelper(ng(0,e.rank));try{for(l.s();!(i=l.n()).done;){var h=i.value;-1!==r.indexOf(h)?c.push(1):c.push(e.shape[h])}}catch(v){l.e(v)}finally{l.f()}var d=s.reshape(c),f=u.reshape(c),p=null==t?null:t.reshape(c),m=null==n?null:n.reshape(c);return[Gk(e,d,f,m,p,a),s,u]}))}(e,t,n,r,a)}(a,n.gamma.read(),n.beta.read(),s,n.epsilon),3),f=d[0],p=d[1],m=d[2],v=function(e,t,n){rv.tidy((function(){var r=1-n,a=e.read(),i=a.sub(t).mul(r);e.write(a.sub(i))}))};return v(n.movingMean,p,n.momentum),v(n.movingVariance,m,n.momentum),f}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:zg(this.betaInitializer),gammaInitializer:zg(this.gammaInitializer),movingMeanInitializer:zg(this.movingMeanInitializer),movingVarianceInitializer:zg(this.movingVarianceInitializer),betaRegularizer:Mb(this.betaRegularizer),gammaRegularizer:Mb(this.gammaRegularizer),betaConstraint:jv(this.betaConstraint),gammaConstraint:jv(this.gammaConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);Kk.className="BatchNormalization",rv.serialization.registerClass(Kk);var qk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"==typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));var a,i=_createForOfIteratorHelper(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}catch(s){i.e(s)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Bg(e.betaInitializer||"zeros"),r.gammaInitializer=Bg(e.gammaInitializer||"ones"),r.betaRegularizer=Lb(e.betaRegularizer),r.gammaRegularizer=Lb(e.gammaRegularizer),r.supportsMasking=!0,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){var t=(e=Xg(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=_createForOfIteratorHelper(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: "+i)}}catch(s){a.e(s)}finally{a.f()}if(this.axis.length!==_v(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var o=this.axis.map((function(t){return e[t]}));this.gamma=this.scale?this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=qg(e),a=r.shape,i=a.length;return Object(rv.tidy)((function(){var e,t=Object(rv.moments)(r,n.axis,!0),o=t.mean,s=t.variance,u=lv(1,i),c=_createForOfIteratorHelper(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;u[l]=a[l]}}catch(g){c.e(g)}finally{c.f()}for(var h=function(e){return null!=e&&e.shape.length!==i&&n.axis!==[i-1]?e.reshape(u):e},d=h(n.gamma.read()),f=h(n.beta.read()),p=[],m=[],v=0;v<i;++v)-1!==n.axis.indexOf(v)?(p.push(a[v]),m.push(1)):(p.push(1),m.push(a[v]));return o=o.tile(p),s=s.tile(p),d=d.tile(m),f=f.tile(m),Gk(r,o,s,f,d,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:zg(this.betaInitializer),gammaInitializer:zg(this.gammaInitializer),betaRegularizer:Mb(this.betaRegularizer),gammaRegularizer:Mb(this.gammaRegularizer)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);qk.className="LayerNormalization",rv.serialization.registerClass(qk);var Xk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new sv("ZeroPadding2D expects padding to be a length-2 array, but received a length-".concat(e.padding.length," array."));var a,i;if("number"==typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new sv("ZeroPadding2D expects height padding to be a length-2 array, but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new sv("ZeroPadding2D expects width padding to be a length-2 array, but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new ey({ndim:4})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=Xg(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){return t=qg(e),r=n.padding,a=n.dataFormat,Object(rv.tidy)((function(){if(4!==t.rank)throw new sv("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new sv("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new sv("Unknown data format: ".concat(a,". Supported data formats are 'channelsLast' and 'channelsFirst."));var e;return e="channelsFirst"===a?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],rv.pad(t,e)}));var t,r,a}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy);function Zk(e,t,n,r,a,i){return Object(rv.tidy)((function(){var o;Uv(a),Gv(i),Hv(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=Xb(e,a);var s="same"===r?"same":"valid";return o="max"===i?rv.maxPool(e,t,n,s):rv.avgPool(e,t,n,s),"channelsFirst"===a&&(o=rv.transpose(o,[0,3,1,2])),o}))}function Yk(e,t,n,r,a,i){return Object(rv.tidy)((function(){var o;Uv(a),Gv(i),Hv(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=Zb(e,a);var s="same"===r?"same":"valid";return o="max"===i?rv.maxPool3d(e,t,n,s):rv.avgPool3d(e,t,n,s),"channelsFirst"===a&&(o=rv.transpose(o,[0,4,1,2,3])),o}))}Xk.className="ZeroPadding2D",rv.serialization.registerClass(Xk);var Qk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"==typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new sv("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.poolSize));r.poolSize=e.poolSize}if(Ov(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"==typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new sv("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.strides));r.strides=e.strides}return Ov(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,Hv(r.padding),r.inputSpec=[new ey({ndim:3})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t=Kb((e=Xg(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){n.invokeCallHook(e,t),e=ag(qg(e),2);var r=n.poolingFunction(qg(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return rv.squeeze(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy),Jk=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Uv(a),Hv(r),Zk(e,t,n,r,a,"max")}}]),n}(Qk);Jk.className="MaxPooling1D",rv.serialization.registerClass(Jk);var $k=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Uv(a),Hv(r),Zk(e,t,n,r,a,"avg")}}]),n}(Qk);$k.className="AveragePooling1D",rv.serialization.registerClass($k);var e_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new sv("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+e.strides.length+".");r.strides=e.strides}else r.strides=[e.strides,e.strides];return Ov(r.poolSize,"poolSize"),Ov(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Uv(r.dataFormat),Hv(r.padding),r.inputSpec=[new ey({ndim:4})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){e=Xg(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=Kb(t,this.poolSize[0],this.padding,this.strides[0]),n=Kb(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(qg(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy),t_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Uv(a),Hv(r),Zk(e,t,n,r,a,"max")}}]),n}(e_);t_.className="MaxPooling2D",rv.serialization.registerClass(t_);var n_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Uv(a),Hv(r),Zk(e,t,n,r,a,"avg")}}]),n}(e_);n_.className="AveragePooling2D",rv.serialization.registerClass(n_);var r_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new sv("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+e.strides.length+".");r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return Ov(r.poolSize,"poolSize"),Ov(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Uv(r.dataFormat),Hv(r.padding),r.inputSpec=[new ey({ndim:5})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){e=Xg(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=Kb(t,this.poolSize[0],this.padding,this.strides[0]),n=Kb(n,this.poolSize[1],this.padding,this.strides[1]),r=Kb(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(qg(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy),a_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Uv(a),Hv(r),Yk(e,t,n,r,a,"max")}}]),n}(r_);a_.className="MaxPooling3D",rv.serialization.registerClass(a_);var i_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Uv(a),Hv(r),Yk(e,t,n,r,a,"avg")}}]),n}(r_);i_.className="AveragePooling3D",rv.serialization.registerClass(i_);var o_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).inputSpec=[new ey({ndim:3})],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new uv}}]),n}(iy),s_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e||{})}return _createClass(n,[{key:"call",value:function(e,t){return Object(rv.tidy)((function(){var t=qg(e);return rv.mean(t,1)}))}}]),n}(o_);s_.className="GlobalAveragePooling1D",rv.serialization.registerClass(s_);var u_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e||{})}return _createClass(n,[{key:"call",value:function(e,t){return Object(rv.tidy)((function(){var t=qg(e);return rv.max(t,1)}))}}]),n}(o_);u_.className="GlobalMaxPooling1D",rv.serialization.registerClass(u_);var c_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Uv(r.dataFormat),r.inputSpec=[new ey({ndim:4})],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e=e,"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new uv}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(iy),l_=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var t=qg(e);return rv.mean(t,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))}}]),n}(c_);l_.className="GlobalAveragePooling2D",rv.serialization.registerClass(l_);var h_=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var t=qg(e);return rv.max(t,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))}}]),n}(c_);h_.className="GlobalMaxPooling2D",rv.serialization.registerClass(h_);var d_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).layer=e.layer,r}return _createClass(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=yy(t.layer,n);delete t.layer;var a={layer:r};return Object.assign(a,t),new e(a)}}]),n}(iy),f_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return _createClass(n,[{key:"build",value:function(e){if((e=Xg(e)).length<3)throw new sv("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),_get(_getPrototypeOf(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=Xg(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t);return[n[0],e[1]].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){return ck((function(e,r){return[qg(n.layer.call(e,t)),[]]}),e=qg(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(d_);f_.className="TimeDistributed",rv.serialization.registerClass(f_);var p_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;_classCallCheck(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=yy(i),a.goBackwards=!0!==a.goBackwards;var o={};if(o.className=e.layer.getClassName(),o.config=a,r.backwardLayer=yy(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,xv(Vv,"BidirectionalMergeMode",r.mergeMode),e.weights)throw new uv("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return _createClass(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=Math.floor(e.length/2);this.forwardLayer.setWeights(e.slice(0,t)),this.backwardLayer.setWeights(e.slice(t))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),a=a,this.returnState?(r=a.slice(1),t=a[0]):t=a[0],t=t,"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):fv(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=uk(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new sv("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,_toConsumableArray(r));var c=r.map((function(e){return new ey({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,_toConsumableArray(c))}if(null!=a)throw new uv("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof ty,h=0,d=o;h<d.length;h++){if(d[h]instanceof ty!==l)throw new sv("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var f=[e].concat(o),p=this.inputSpec.concat(s),m=this.inputSpec;this.inputSpec=p;var v=_get(_getPrototypeOf(n.prototype),"apply",this).call(this,f,t);return this.inputSpec=m,v}return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Object(rv.tidy)((function(){var r,a,i,o,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),c=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=rv.reverse(a,1)),"concat"===n.mergeMode?o=ug([r,a]):"sum"===n.mergeMode?o=rv.add(r,a):"ave"===n.mergeMode?o=rv.mul(.5,rv.add(r,a)):"mul"===n.mergeMode?o=rv.mul(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;qv(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),qv(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=yy(t.layer);if(delete t.layer,null!=t.numConstants)throw new uv("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(d_);p_.className="Bidirectional",rv.serialization.registerClass(p_),n("CtZu");var m_,v_=n("YSVl");function g_(e){return null===e?null:y_(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function y_(e){return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof rv.Tensor))}function b_(e){return e instanceof rv.Tensor?{value:e.clone(),recurse:!1}:y_(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var k_=function(){function e(t){if(_classCallCheck(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return _createClass(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(a){n.e(a)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),__=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.call(this,n.INITIAL_CAPACITY)}return _createClass(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){_get(_getPrototypeOf(n.prototype),"isFull",this).call(this)&&this.expand(),_get(_getPrototypeOf(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){_get(_getPrototypeOf(n.prototype),"isFull",this).call(this)&&this.expand(),_get(_getPrototypeOf(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(k_);__.INITIAL_CAPACITY=32;var w_=function(){function e(){_classCallCheck(this,e)}var t,n,r,a,i,o;return _createClass(e,[{key:"toArray",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent;case 9:e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"toArrayForTest",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=3,t.next();case 3:r=e.sent;case 4:if(r.done){e.next=11;break}return n.push(r.value),e.next=8,t.next();case 8:r=e.sent;case 9:e.next=4;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"resolveFully",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent;case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"resolveWhile",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value);case 9:e.next=4;break;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"handleErrors",value:function(e){return new A_(this,e)}},{key:"filter",value:function(e){return new E_(this,e)}},{key:"map",value:function(e){return new N_(this,e)}},{key:"mapAsync",value:function(e){return new R_(this,e)}},{key:"serialMapAsync",value:function(e){return new R_(this,e).serial()}},{key:"flatmap",value:function(e){return new D_(this,e)}},{key:"forEachAsync",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"serialForEach",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new I_(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g_;return this.rowMajorBatch(e,t).map((function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g_;return function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,a=t[0];if(r.has(a))throw new Error("Circular references are not supported.");var i=n(t);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(y_(a)){var o=Array.isArray(a)?[]:{};r.add(a);var s=function(a){var i=e(t.map((function(e){return e[a]})),n,r);o[a]=i};for(var u in a)s(u);return r.delete(a),o}throw new Error("Can't recurse into non-iterable type: "+a)}return i.value}(e,t)}(e,n)}))}},{key:"concatenate",value:function(e,t){return new j_(new x_([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new T_(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new S_(this,e)}},{key:"prefetch",value:function(e){return new F_(this,e)}},{key:"shuffle",value:function(e,t){return new M_(this,e,t)}},{key:"serial",value:function(){return new O_(this)}}]),e}(),x_=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e){var t;return _classCallCheck(this,r),(t=n.call(this)).items=e,t.trav=0,t}return _createClass(r,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],e.abrupt("return",(this.trav++,{value:(n=t,function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==t)return null;if(a.has(t))throw new Error("Circular references are not supported.");if(r.has(t))return r.get(t);var i=n(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(y_(t)){var o=Array.isArray(t)?[]:{};for(var s in a.add(t),t){var u=e(t[s],n,r,a);o[s]=u}return a.delete(t),o}throw new Error("Can't recurse into non-iterable type: "+t)}return r.set(t,i.value),i.value}(n,b_)),done:!1}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(w_),C_=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e){var t;return _classCallCheck(this,r),(t=n.call(this)).nextFn=e,t}return _createClass(r,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: "+e.t0.message,e.t0;case 7:case"end":return e.stop()}}),e,this,[[0,4]])}))),function(){return t.apply(this,arguments)})}]),r}(w_),O_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t;return _classCallCheck(this,a),(t=r.call(this)).upstream=e,t.lastRead=Promise.resolve({value:null,done:!1}),t}return _createClass(a,[{key:"summary",value:function(){return this.upstream.summary()+" -> Serial"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}(w_),S_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.maxCount=t,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return this.upstream.summary()+" -> Skip"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:rv.dispose(t.value);case 7:e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}(w_),T_=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.maxCount=t,a.count=0,a}return _createClass(r,[{key:"summary",value:function(){return this.upstream.summary()+" -> Take"}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(w_),I_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.batchSize=t,n.enableSmallLastBatch=i,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return this.upstream.summary()+" -> RowMajorBatch"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=10;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=7;break}return e.abrupt("return",this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0});case 7:t.push(n.value);case 8:e.next=1;break;case 10:return e.abrupt("return",{value:t,done:!1});case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}(w_),E_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.predicate=t,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return this.upstream.summary()+" -> Filter"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=5;break}return e.abrupt("return",t);case 5:rv.dispose(t.value);case 6:e.next=0;break;case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}(w_),N_=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return _createClass(r,[{key:"summary",value:function(){return this.upstream.summary()+" -> Map"}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=rv.tensor_util.getTensorsInContainer(t.value),r=this.transform(t.value),a=rv.tensor_util.getTensorsInContainer(r),i=_createForOfIteratorHelper(n);try{for(i.s();!(o=i.n()).done;)s=o.value,rv.tensor_util.isTensorInList(s,a)||s.dispose()}catch(u){i.e(u)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(w_),A_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.handler=t,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return this.upstream.summary()+" -> handleErrors"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.upstream.next();case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),this.handler(e.t0)){e.next=10;break}return e.abrupt("return",{value:null,done:!0});case 10:e.next=0;break;case 12:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return t.apply(this,arguments)})}]),a}(w_),R_=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return _createClass(r,[{key:"summary",value:function(){return this.upstream.summary()+" -> AsyncMap"}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=rv.tensor_util.getTensorsInContainer(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=rv.tensor_util.getTensorsInContainer(r),i=_createForOfIteratorHelper(n);try{for(i.s();!(o=i.n()).done;)s=o.value,rv.tensor_util.isTensorInList(s,a)||s.dispose()}catch(u){i.e(u)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(w_),D_=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return _createClass(r,[{key:"summary",value:function(){return this.upstream.summary()+" -> Flatmap"}},{key:"pump",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=rv.tensor_util.getTensorsInContainer(t.value),r=this.transform(t.value),a=rv.tensor_util.getTensorsInContainer(r),this.outputQueue.pushAll(r),i=_createForOfIteratorHelper(n);try{for(i.s();!(o=i.n()).done;)s=o.value,rv.tensor_util.isTensorInList(s,a)||s.dispose()}catch(u){i.e(u)}finally{i.f()}return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(){var e;return _classCallCheck(this,a),(e=r.call(this)).outputQueue=new __,e.lastRead=Promise.resolve({value:null,done:!1}),e}return _createClass(a,[{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}(w_)),j_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).baseErrorHandler=t,n.lastRead=null,n.iterator=null,n.moreIterators=e,n}return _createClass(a,[{key:"summary",value:function(){return"TODO: fill in upstream of chained summaries -> Chained"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.readFromChain(this.lastRead),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"readFromChain",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=9;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 9:return e.next=11,this.iterator.next();case 11:return r=e.sent,e.abrupt("return",r.done?(this.iterator=null,this.readFromChain(t)):r);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),a}(w_);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(m_||(m_={}));var F_=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new k_(r),a}return _createClass(n,[{key:"summary",value:function(){return this.upstream.summary()+" -> Prefetch"}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(w_),M_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t,n){var i;return _classCallCheck(this,a),(i=r.call(this,e,t)).upstream=e,i.windowSize=t,i.upstreamExhausted=!1,i.random=v_.alea(n||rv.util.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return _createClass(a,[{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=11;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if((n=e.sent).done){e.next=8;break}return e.abrupt("return",(this.refill(),n));case 8:this.upstreamExhausted=!0;case 9:e.next=1;break;case 11:return e.abrupt("return",{value:null,done:!0});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}(F_),P_=function(){function e(){_classCallCheck(this,e),this.size=null}var t,n,r;return _createClass(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return rv.util.assert(e>0,(function(){return"batchSize needs to be positive, but it is\n      "+e})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),L_(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,z_));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,L_(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,L_(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return rv.tidy((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"map",value:function(e){var t=this;return L_(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return rv.tidy((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return L_(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return L_(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,L_(_asyncToGenerator(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(r=(a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.t1=!1,e.abrupt("return",{value:e.t0,done:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),new C_(a)).take(e),new j_(r,void 0)));case 1:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,L_(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=v_.alea(t||rv.util.now().toString());return L_(_asyncToGenerator(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,L_(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"toArrayForTest",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function L_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){_inherits(i,n);var r,a=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=a.apply(this,arguments)).size=t,e}return _createClass(i,[{key:"iterator",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}]),i}(P_))}function z_(e){return null===e?null:null==(t=e[0])||null===(n=t)||"object"!=typeof n&&"function"!=typeof n||Array.isArray(t)||"object"==typeof t&&t instanceof rv.Tensor||rv.util.isTypedArray(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof rv.Tensor?rv.stack(e):rv.tensor(e)}(e),recurse:!1}:{value:null,recurse:!0};var t,n}function B_(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&rv.util.assert("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors in the CPU backend."}))}))}P_.MAX_BUFFER_SIZE=1e4,Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");var V_=rv.kernel_impls.whereImpl,W_=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(){var e;return _classCallCheck(this,a),(e=r.call(this)).blockSize=48,e.firstUse=!0,e.data=new rv.DataStorage(_assertThisInitialized(e),Object(rv.engine)()),e}return _createClass(a,[{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,Object(rv.env)().get("IS_NODE")&&rv.backend_util.warn("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&rv.util.isString(n[0])){var a=n.map((function(e){return rv.util.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r){this.data.set(e,{values:t,dtype:r,refCount:1})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;if("complex64"===n){var a=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return rv.backend_util.mergeRealAndImagArrays(a,i)}return this.data.get(e).values}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return rv.util.decodeString(e)}))}catch(cz){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(rv.buffer)(e.shape,e.dtype,n)}},{key:"makeOutput",value:function(e,t,n){var r=this.write(e,t,n);return Object(rv.engine)().makeTensorFromDataId(r,t,n,this)}},{key:"disposeData",value:function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensorInfos;null!=t&&(this.disposeData(t.real.dataId),this.disposeData(t.imag.dataId)),this.data.delete(e)}}},{key:"disposeIntermediateTensorInfo",value:function(e){var t=e.dataId;if(this.data.has(t)){var n=this.data.get(t);n.refCount--,n.refCount<1&&this.disposeData(t)}}},{key:"time",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=rv.util.now(),e.abrupt("return",(t(),{kernelMs:rv.util.now()-n}));case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){B_([e],"where");var t=this.readSync(e.dataId);return V_(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return _get(_getPrototypeOf(a.prototype),"epsilon",this).call(this)}}]),a}(rv.KernelBackend);function U_(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(B_(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var u=o,c=u.data.get(s.dataId).values,l=rv.util.sizeFromShape(s.shape),h=n||s.dtype,d=rv.util.getArrayFromDType(h,l),f=0;f<l;++f)d[f]=t(c[f],i);return u.makeTensorInfo(s.shape,h,d)}}function H_(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(B_(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var u=o,c=u.data.get(s.dataId).values,l=n||s.dtype,h=t(c,l,i);return u.makeTensorInfo(s.shape,l,h)}}Object(rv.registerBackend)("cpu",(function(){return new W_}),1);var G_=U_(rv.Elu,(function(e){return e>=0?e:Math.exp(e)-1})),K_={kernelName:rv.Elu,backendName:"cpu",kernelFunc:G_};function q_(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var X_={kernelName:rv.Identity,backendName:"cpu",kernelFunc:q_};function Z_(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;B_([a],"leakyRelu");for(var o=rv.util.sizeFromShape(a.shape),s=n.data.get(a.dataId).values,u=rv.util.getTypedArrayFromDType("float32",o),c=0;c<s.length;c++)u[c]=s[c]<0?i*s[c]:s[c];return n.makeTensorInfo(a.shape,"float32",u)}var Y_={kernelName:rv.LeakyRelu,backendName:"cpu",kernelFunc:Z_};function Q_(e){return function(t,n,r,a,i){var o=rv.backend_util.assertAndGetBroadcastShape(t,n),s=o.length,u=rv.util.computeStrides(o),c=rv.util.sizeFromShape(o),l=rv.util.getTypedArrayFromDType(i,c),h=t.length,d=n.length,f=rv.util.computeStrides(t),p=rv.util.computeStrides(n),m=rv.backend_util.getBroadcastDims(t,o),v=rv.backend_util.getBroadcastDims(n,o);if(m.length+v.length===0)for(var g=0;g<l.length;++g)l[g]=e(r[g%r.length],a[g%a.length]);else for(var y=function(t){var n=rv.util.indexToLoc(t,s,u),i=n.slice(-h);m.forEach((function(e){return i[e]=0}));var o=rv.util.locToIndex(i,h,f),c=n.slice(-d);v.forEach((function(e){return c[e]=0}));var g=rv.util.locToIndex(c,d,p);l[t]=e(r[o],a[g])},b=0;b<l.length;++b)y(b);return[l,o]}}var J_=Q_((function(e,t){return e<0?t*e:e}));function $_(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;B_([r,a],"prelu");var i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=_slicedToArray(J_(r.shape,a.shape,i,o,r.dtype),2),u=s[0],c=s[1];return n.makeTensorInfo(c,r.dtype,u)}var ew={kernelName:rv.Prelu,backendName:"cpu",kernelFunc:$_},tw=U_(rv.Relu,(function(e){return Math.max(0,e)})),nw={kernelName:rv.Relu,backendName:"cpu",kernelFunc:tw},rw=U_(rv.Relu6,(function(e){return Math.min(Math.max(0,e),6)})),aw={kernelName:rv.Relu6,backendName:"cpu",kernelFunc:rw};function iw(e,t,n,r,a){if("linear"===n)return q_({inputs:{x:t},backend:e});if("relu"===n)return tw({inputs:{x:t},backend:e});if("elu"===n)return G_({inputs:{x:t},backend:e});if("relu6"===n)return rw({inputs:{x:t},backend:e});if("prelu"===n)return $_({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return Z_({inputs:{x:t},backend:e,attrs:{alpha:a}});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function ow(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}var sw={kernelName:rv.Complex,backendName:"cpu",kernelFunc:ow};function uw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n)return ow({inputs:{real:uw(e,t,"float32"),imag:uw(e,t,"float32")},backend:e});var r=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(t),n);return e.makeTensorInfo(t,n,r)}function cw(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var lw={kernelName:rv.Real,backendName:"cpu",kernelFunc:cw};function hw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return q_({inputs:{x:a},backend:n});var o=uw(n,a.shape,a.dtype),s=hw({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),u=ow({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("complex64"===a.dtype){var c=cw({inputs:{input:a},backend:n}),l=hw({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),l}if(!rv.util.hasEncodingLoss(a.dtype,i)){var h=q_({inputs:{x:a},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:i}}if("int32"===i){var d=n.data.get(a.dataId).values,f=Int32Array.from(d);return n.makeTensorInfo(a.shape,"int32",f)}if("bool"===i){var p=n.data.get(a.dataId).values,m=rv.util.toTypedArray([0],a.dtype),v=_slicedToArray(Q_((function(e,t){return e!==t?1:0}))(a.shape,[],p,m,"bool"),2),g=v[0],y=v[1];return n.makeTensorInfo(y,"bool",g)}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(i))}var dw={kernelName:rv.Cast,backendName:"cpu",kernelFunc:hw};function fw(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,s=a.b,u=i;B_([o,s],e);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,h=r||o.dtype,d=_slicedToArray(t(o.shape,s.shape,c,l,h),2),f=d[0],p=d[1];return u.makeTensorInfo(p,h,f)}:function(e){var a=e.inputs,i=e.backend,o=a.a,s=a.b,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){var c=hw({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),l=u.data.get(c.dataId),h=l.complexTensorInfos.imag,d=u.data.get(l.complexTensorInfos.real.dataId).values,f=u.data.get(h.dataId).values,p=hw({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),m=u.data.get(p.dataId),v=m.complexTensorInfos.imag,g=u.data.get(m.complexTensorInfos.real.dataId).values,y=u.data.get(v.dataId).values,b=_slicedToArray(n(o.shape,s.shape,d,f,g,y),3),k=b[0],_=b[1],w=b[2],x=u.makeTensorInfo(w,"float32",k),C=u.makeTensorInfo(w,"float32",_),O=ow({inputs:{real:x,imag:C},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(p),u.disposeIntermediateTensorInfo(x),u.disposeIntermediateTensorInfo(C),O}var S=u.data.get(o.dataId).values,T=u.data.get(s.dataId).values,I=r||o.dtype,E=_slicedToArray(t(o.shape,s.shape,S,T,I),2),N=E[0],A=E[1];return u.makeTensorInfo(A,I,N)}}function pw(e){return function(t,n,r,a,i,o){var s=rv.backend_util.assertAndGetBroadcastShape(t,n),u=rv.util.sizeFromShape(s),c=s.length,l=rv.util.computeStrides(s),h=rv.util.getTypedArrayFromDType("float32",u),d=rv.util.getTypedArrayFromDType("float32",u),f=rv.backend_util.getBroadcastDims(t,s),p=rv.backend_util.getBroadcastDims(n,s),m=rv.backend_util.mergeRealAndImagArrays(r,a),v=rv.backend_util.mergeRealAndImagArrays(i,o),g=t.length,y=rv.util.computeStrides(t),b=n.length,k=rv.util.computeStrides(n);if(f.length+p.length===0)for(var _=0;_<h.length;_++){var w=_%m.length,x=_%v.length,C=e(m[2*w],m[2*w+1],v[2*x],v[2*x+1]);h[_]=C.real,d[_]=C.imag}else for(var O=function(t){var n=rv.util.indexToLoc(t,c,l),r=n.slice(-g);f.forEach((function(e){return r[e]=0}));var a=rv.util.locToIndex(r,g,y),i=n.slice(-b);p.forEach((function(e){return i[e]=0}));var o=rv.util.locToIndex(i,b,k),s=e(m[2*a],m[2*a+1],v[2*o],v[2*o+1]);h[t]=s.real,d[t]=s.imag},S=0;S<h.length;S++)O(S);return[h,d,s]}}var mw=Q_((function(e,t){return e+t})),vw=pw((function(e,t,n,r){return{real:e+n,imag:t+r}})),gw=fw(rv.Add,mw,vw),yw={kernelName:rv.Add,backendName:"cpu",kernelFunc:gw};function bw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=rv.util.sizeFromShape(a.shape),s=rv.util.inferFromImplicitShape(i,o),u=rv.util.sizeFromShape(s);rv.util.assert(o===u,(function(){return"The new shape (".concat(s,") has ").concat(u," elements and the old shape (").concat(a.shape,") has ").concat(o," elements. The new shape and old shape must have the same number of elements.")})),n.incRef(a.dataId);var c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){var l=c.complexTensorInfos.imag;c.complexTensorInfos.real.shape=s,l.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}var kw={kernelName:rv.Reshape,backendName:"cpu",kernelFunc:bw};function _w(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=r.transposeA,s=r.transposeB;B_([a,i],"matMul");var u=a.shape.length,c=i.shape.length,l=o?a.shape[u-2]:a.shape[u-1],h=s?i.shape[c-1]:i.shape[c-2],d=o?a.shape[u-1]:a.shape[u-2],f=s?i.shape[c-2]:i.shape[c-1],p=a.shape.slice(0,-2),m=i.shape.slice(0,-2),v=rv.util.sizeFromShape(p),g=rv.util.sizeFromShape(m);rv.util.assert(u>=2&&c>=2&&(v===g||1===v||1===g),(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (".concat(p,") and (").concat(m,").")}));var y=(v>g?a.shape.slice(0,-2):i.shape.slice(0,-2)).concat([d,f]);rv.util.assert(l===h,(function(){return"Error in matMul: inner shapes (".concat(l,") and (").concat(h,") of Tensors with shapes ").concat(a.shape," and ").concat(i.shape," and transposeA=").concat(o," and transposeB=").concat(s," must match.")}));for(var b=s?[g,f,h]:[g,h,f],k=bw({inputs:{x:a},backend:n,attrs:{shape:o?[v,l,d]:[v,d,l]}}),_=bw({inputs:{x:i},backend:n,attrs:{shape:b}}),w=o?k.shape[1]:k.shape[2],x=o?k.shape[2]:k.shape[1],C=s?_.shape[1]:_.shape[2],O=Math.max(v,g),S=n.data.get(k.dataId).values,T=n.data.get(_.dataId).values,I=rv.util.computeStrides(k.shape),E=rv.util.computeStrides(_.shape),N=_slicedToArray(o?[I[0],1,I[1]]:[I[0],I[1],1],3),A=N[0],R=N[1],D=N[2],j=_slicedToArray(s?[1,E[1],E[0]]:[E[1],1,E[0]],3),F=j[0],M=j[1],P=j[2],L=x*C,z=Object(rv.buffer)([O,x,C],k.dtype),B=z.values,V=n.blockSize,W=0;W<O;W++)for(var U=0;U<x;U+=V)for(var H=0;H<C;H+=V)for(var G=0;G<w;G+=V)for(var K=Math.min(U+V,x),q=Math.min(H+V,C),X=Math.min(G+V,w),Z=U;Z<K;Z++)for(var Y=H;Y<q;Y++){for(var Q=0,J=G;J<X;J++){var $=Math.min(W,v-1)*A,ee=Math.min(W,g-1)*P;Q+=S[$+Z*R+J*D]*T[J*F+Y*M+ee]}B[W*L+(Z*C+Y)]+=Q}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(_),n.makeTensorInfo(y,z.dtype,z.values)}var ww={kernelName:rv.BatchMatMul,backendName:"cpu",kernelFunc:_w},xw={kernelName:rv._FusedMatMul,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,s=a.a,u=a.b,c=a.bias,l=a.preluActivationWeights,h=o.transposeA,d=o.transposeB,f=o.activation,p=o.leakyreluAlpha,m=[];t=_w({inputs:{a:s,b:u},attrs:{transposeA:h,transposeB:d},backend:i}),c&&(n=gw({inputs:{a:t,b:c},backend:i}),m.push(t),t=n),f&&(r=iw(i,t,f,l,p),m.push(t),t=r);for(var v=0,g=m;v<g.length;v++){var y=g[v];i.disposeIntermediateTensorInfo(y)}return t}};function Cw(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var Ow={kernelName:rv.Abs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;B_(t,"abs");var r=new Float32Array(rv.util.sizeFromShape(t.shape));return r=Cw(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,"float32")}},Sw=U_(rv.Acos,(function(e){return Math.acos(e)})),Tw={kernelName:rv.Acos,backendName:"cpu",kernelFunc:Sw},Iw=U_(rv.Acosh,(function(e){return Math.acosh(e)})),Ew={kernelName:rv.Acosh,backendName:"cpu",kernelFunc:Iw},Nw={kernelName:rv.AddN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;B_(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=Object(rv.buffer)(r[0].shape,r[0].dtype),o=i.values,s=0;s<r.length;s++)for(var u=a[s],c=0;c<o.length;c++)o[c]+=u[c];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function Aw(e,t,n,r,a){for(var i=t.length,o=rv.util.sizeFromShape(t),s=rv.util.computeStrides(t),u=rv.util.computeStrides(a),c=rv.util.getTypedArrayFromDType(n,rv.util.sizeFromShape(a)),l=0;l<o;++l){for(var h=rv.util.indexToLoc(l,i,s),d=new Array(h.length),f=0;f<d.length;f++)d[f]=h[r[f]];c[rv.util.locToIndex(d,i,u)]=e[l]}return c}function Rw(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;B_(a,"transpose");for(var o=new Array(a.shape.length),s=0;s<o.length;s++)o[s]=a.shape[i[s]];var u=Aw(r.data.get(a.dataId).values,a.shape,a.dtype,i,o);return{dataId:r.write(u,o,a.dtype),shape:o,dtype:a.dtype}}var Dw={kernelName:rv.Transpose,backendName:"cpu",kernelFunc:Rw},jw={kernelName:rv.All,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;B_(a,"all");var s=rv.util.parseAxisParam(i,a.shape),u=s,c=rv.backend_util.getAxesPermutation(u,a.shape.length),l=a;null!=c&&(l=Rw({inputs:{x:a},backend:n,attrs:{perm:c}}),u=rv.backend_util.getInnerMostAxes(u.length,a.shape.length)),rv.backend_util.assertAxesAreInnerMostDims("all",u,l.shape.length);for(var h=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(l.shape,u),2),d=h[0],f=h[1],p=rv.util.sizeFromShape(f),m=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(d),l.dtype),v=n.data.get(l.dataId).values,g=0;g<m.length;++g){for(var y=g*p,b=v[y],k=0;k<p;++k){var _=v[y+k];b=b&&_}m[g]=b}null!=c&&n.disposeIntermediateTensorInfo(l);var w=n.makeTensorInfo(d,l.dtype,m);if(o){var x=bw({inputs:{x:w},backend:n,attrs:{shape:rv.backend_util.expandShapeToKeepDim(d,s)}});return n.disposeIntermediateTensorInfo(w),x}return w}},Fw={kernelName:rv.Any,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;B_(a,"any");var s=rv.util.parseAxisParam(i,a.shape),u=s,c=rv.backend_util.getAxesPermutation(u,a.shape.length),l=a;null!=c&&(l=Rw({inputs:{x:a},backend:n,attrs:{perm:c}}),u=rv.backend_util.getInnerMostAxes(u.length,a.shape.length)),rv.backend_util.assertAxesAreInnerMostDims("any",u,l.shape.length);for(var h=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(l.shape,u),2),d=h[0],f=h[1],p=rv.util.sizeFromShape(f),m=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(d),l.dtype),v=n.data.get(l.dataId).values,g=0;g<m.length;++g){for(var y=g*p,b=v[y],k=0;k<p;++k){var _=v[y+k];b=b||_}m[g]=b}null!=c&&n.disposeIntermediateTensorInfo(l);var w=n.makeTensorInfo(d,l.dtype,m);if(o){var x=bw({inputs:{x:w},backend:n,attrs:{shape:rv.backend_util.expandShapeToKeepDim(d,s)}});return n.disposeIntermediateTensorInfo(w),x}return w}},Mw={kernelName:rv.ArgMax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;B_(a,"argMax");var o=rv.util.parseAxisParam(i,a.shape),s=rv.backend_util.getAxesPermutation(o,a.shape.length),u=a,c=[];null!=s&&(u=Rw({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=rv.backend_util.getInnerMostAxes(o.length,u.shape.length)),o=[o[0]],rv.backend_util.assertAxesAreInnerMostDims("argMax",o,u.shape.length);for(var l=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(u.shape,o),2),h=l[0],d=l[1],f=rv.util.sizeFromShape(h),p=rv.util.makeZerosTypedArray(f,"int32"),m=rv.util.sizeFromShape(d),v=n.data.get(u.dataId).values,g=0;g<p.length;++g){for(var y=g*m,b=v[y],k=0,_=0;_<m;++_){var w=v[y+_];w>b&&(b=w,k=_)}p[g]=k}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",p)}},Pw={kernelName:rv.ArgMin,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;B_(a,"argMin");var o=rv.util.parseAxisParam(i,a.shape),s=rv.backend_util.getAxesPermutation(o,a.shape.length),u=a,c=[];null!=s&&(u=Rw({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=rv.backend_util.getInnerMostAxes(o.length,u.shape.length)),o=[o[0]],rv.backend_util.assertAxesAreInnerMostDims("argMin",o,u.shape.length);for(var l=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(u.shape,o),2),h=l[0],d=l[1],f=rv.util.sizeFromShape(h),p=rv.util.makeZerosTypedArray(f,"int32"),m=rv.util.sizeFromShape(d),v=n.data.get(u.dataId).values,g=0;g<p.length;++g){for(var y=g*m,b=v[y],k=0,_=0;_<m;++_){var w=v[y+_];w<b&&(b=w,k=_)}p[g]=k}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",p)}},Lw=U_(rv.Asin,(function(e){return Math.asin(e)})),zw={kernelName:rv.Asin,backendName:"cpu",kernelFunc:Lw},Bw=U_(rv.Asinh,(function(e){return Math.asinh(e)})),Vw={kernelName:rv.Asinh,backendName:"cpu",kernelFunc:Bw},Ww=U_(rv.Atan,(function(e){return Math.atan(e)})),Uw={kernelName:rv.Atan,backendName:"cpu",kernelFunc:Ww},Hw=Q_((function(e,t){return Math.atan2(e,t)})),Gw=fw(rv.Atan2,Hw),Kw={kernelName:rv.Atan2,backendName:"cpu",kernelFunc:Gw},qw=U_(rv.Atanh,(function(e){return Math.atanh(e)})),Xw={kernelName:rv.Atanh,backendName:"cpu",kernelFunc:qw};function Zw(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,h=a.effectiveFilterWidth,d=a.padInfo.top,f=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Object(rv.buffer)(a.outShape,n),v=m.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],k=0;k<a.batchSize;++k)for(var _=k*g,w=k*r[0],x=0;x<a.inChannels;++x)for(var C=0;C<a.outHeight;++C)for(var O=C*o-d,S=Math.max(0,O),T=Math.min(a.inHeight,l+O),I=_+C*y,E=0;E<a.outWidth;++E){for(var N=E*s-f,A=Math.max(0,N),R=Math.min(a.inWidth,h+N),D=p,j=0,F=0,M=S;M<T;M+=u){for(var P=w+M*r[1],L=A;L<R;L+=c){var z=e[P+L*r[2]+x];"max"===i&&z>D?D=z:"avg"===i&&(j+=z,F++)}if(isNaN(D))break}v[I+E*b+x]="avg"===i?j/F:D}return m}function Yw(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Object(rv.buffer)(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,m=Object(rv.buffer)(t,n,e),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var b=y*s-f,k=b;k<0;)k+=c;for(var _=Math.min(r.inHeight,h+b),w=0;w<r.outWidth;++w){for(var x=w*u-p,C=x;C<0;)C+=l;for(var O=Math.min(r.inWidth,d+x),S=Number.NEGATIVE_INFINITY,T=-1,I=k;I<_;I+=c)for(var E=I-b,N=C;N<O;N+=l){var A=N-x,R=m.get(v,I,N,g);R>S&&(S=R,T=a?i?((v*r.inHeight+I)*r.inWidth+N)*r.inChannels+g:(I*r.inWidth+N)*r.inChannels+g:E*d+A)}o.set(T,v,y,w,g)}}return o}function Qw(e,t,n,r,a,i){for(var o=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,h=a.dilationWidth,d=a.effectiveFilterDepth,f=a.effectiveFilterHeight,p=a.effectiveFilterWidth,m=a.padInfo.front,v=a.padInfo.top,g=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Object(rv.buffer)(a.outShape,n),k=b.values,_=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],x=a.outShape[3]*a.outShape[4],C=a.outShape[4],O=0;O<a.batchSize;++O)for(var S=O*_,T=O*r[0],I=0;I<a.inChannels;++I)for(var E=0;E<a.outDepth;++E){for(var N=E*o-m,A=N;A<0;)A+=c;for(var R=Math.min(a.inDepth,d+N),D=S+E*w,j=0;j<a.outHeight;++j){for(var F=j*s-v,M=F;M<0;)M+=l;for(var P=Math.min(a.inHeight,f+F),L=D+j*x,z=0;z<a.outWidth;++z){for(var B=z*u-g,V=B;V<0;)V+=h;for(var W=Math.min(a.inWidth,p+B),U=L+z*C,H=y,G=0,K=0,q=A;q<R;q+=c){for(var X=T+q*r[1],Z=M;Z<P;Z+=l){for(var Y=X+Z*r[2],Q=V;Q<W;Q+=h){var J=e[Y+Q*r[3]+I];if("max"===i&&J>H?H=J:"avg"===i&&(G+=J,K++),isNaN(H))break}if(isNaN(H))break}if(isNaN(H))break}k[U+I]="avg"===i?G/K:H}}}return b}var Jw={kernelName:rv.AvgPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;B_(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(o," and dilations '1'")}));var c,l=rv.backend_util.computePool2DInfo(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&rv.util.arraysEqual(l.inShape,l.outShape))c=q_({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,d=rv.util.computeStrides(a.shape),f=Zw(h,0,a.dtype,d,l,"avg");c=n.makeTensorInfo(l.outShape,a.dtype,f.values)}return c}},$w={kernelName:rv.AvgPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=r.dilations;B_(a,"avgPool3d");var h=l;null==h&&(h=[1,1,1]);var d=rv.backend_util.computePool3DInfo(a.shape,i,o,h,s,u,c),f=Qw(n.data.get(a.dataId).values,0,a.dtype,rv.util.computeStrides(a.shape),d,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}},ex={kernelName:rv.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dilations,l=r.dimRoundingMode;B_([a,i],"avgPool3DGrad");for(var h=rv.backend_util.computePool3DInfo(i.shape,o,s,c,u,l),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,m=h.filterDepth,v=h.filterHeight,g=h.filterWidth,y=h.dilationDepth,b=h.dilationHeight,k=h.dilationWidth,_=h.effectiveFilterDepth,w=h.effectiveFilterHeight,x=h.effectiveFilterWidth,C=_-1-h.padInfo.front,O=x-1-h.padInfo.left,S=w-1-h.padInfo.top,T=Object(rv.buffer)(i.shape,"float32"),I=1/(m*v*g),E=n.bufferSync(a),N=0;N<h.batchSize;++N)for(var A=0;A<h.inChannels;++A)for(var R=0;R<h.inDepth;++R)for(var D=0;D<h.inHeight;++D)for(var j=0;j<h.inWidth;++j){for(var F=R-C,M=D-S,P=j-O,L=0,z=0;z<_;z+=y){var B=(F+z)/d;if(!(B<0||B>=h.outDepth||Math.floor(B)!==B))for(var V=0;V<w;V+=b){var W=(M+V)/f;if(!(W<0||W>=h.outHeight||Math.floor(W)!==W))for(var U=0;U<x;U+=k){var H=(P+U)/p;H<0||H>=h.outWidth||Math.floor(H)!==H||(L+=E.get(N,B,W,H,A))}}}T.set(L*I,N,R,D,j,A)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}},tx={kernelName:rv.AvgPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;B_([a,i],"avgPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=rv.backend_util.computePool2DInfo(o.shape,s,u,1,c),h=l.strideHeight,d=l.strideWidth,f=l.filterHeight,p=l.filterWidth,m=l.dilationHeight,v=l.dilationWidth,g=l.effectiveFilterHeight,y=l.effectiveFilterWidth,b=y-1-l.padInfo.left,k=g-1-l.padInfo.top,_=Object(rv.buffer)(o.shape,"float32"),w=1/(f*p),x=n.data.get(a.dataId).values,C=Object(rv.buffer)(a.shape,"float32",x),O=0;O<l.batchSize;++O)for(var S=0;S<l.inChannels;++S)for(var T=0;T<l.inHeight;++T)for(var I=0;I<l.inWidth;++I){for(var E=T-k,N=I-b,A=0,R=0;R<g;R+=m){var D=(E+R)/h;if(!(D<0||D>=l.outHeight||Math.floor(D)!==D))for(var j=0;j<y;j+=v){var F=(N+j)/d;F<0||F>=l.outWidth||Math.floor(F)!==F||(A+=C.get(O,D,F,S))}}_.set(A*w,O,T,I,S)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}},nx={kernelName:rv.FusedBatchNorm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,s=t.mean,u=t.variance;rv.util.assert(s.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),rv.util.assert(null==o||s.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),rv.util.assert(null==i||s.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),B_([a,s,u,i,o],"batchNorm");var c=r.varianceEpsilon;null==c&&(c=.001);for(var l=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,d=n.data.get(u.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(l.length),v=p.length,g=f.length,y=d.length,b=h.length,k=0,_=0,w=0,x=0,C=0;C<l.length;++C)m[C]=p[k++]+(l[C]-h[_++])*f[w++]/Math.sqrt(d[x++]+c),k>=v&&(k=0),_>=b&&(_=0),w>=g&&(w=0),x>=y&&(x=0);return n.makeTensorInfo(a.shape,a.dtype,m)}};function rx(e,t,n,r,a){var i=rv.slice_util.isSliceContinous(r,t,n),o=rv.util.sizeFromShape(n),s=rv.util.computeStrides(r);if(i){var u=rv.slice_util.computeFlatOffset(t,s);return"string"===a?e.slice(u,u+o):e.subarray(u,u+o)}for(var c="string"===a?rv.backend_util.fromUint8ToStringArray(e):e,l=Object(rv.buffer)(r,a,c),h=Object(rv.buffer)(n,a),d=0;d<h.size;++d){var f=h.indexToLoc(d),p=f.map((function(e,n){return e+t[n]}));h.set.apply(h,[l.get.apply(l,_toConsumableArray(p))].concat(_toConsumableArray(f)))}return"string"===a?rv.backend_util.fromStringArrayToUint8(h.values):h.values}function ax(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size;B_(a,"slice");var s=_slicedToArray(rv.slice_util.parseSliceParams(a,i,o),2),u=s[0],c=s[1];rv.slice_util.assertParamsValid(a,u,c);var l=rx(n.data.get(a.dataId).values,u,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,l)}var ix={kernelName:rv.Slice,backendName:"cpu",kernelFunc:ax},ox={kernelName:rv.BatchToSpaceND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;B_([a],"batchToSpaceND");var s=i.reduce((function(e,t){return e*t})),u=rv.backend_util.getReshaped(a.shape,i,s),c=rv.backend_util.getPermuted(u.length,i.length),l=rv.backend_util.getReshapedPermuted(a.shape,i,s),h=rv.backend_util.getSliceBeginCoords(o,i.length),d=rv.backend_util.getSliceSize(l,o,i.length),f=bw({inputs:{x:a},backend:n,attrs:{shape:u}}),p=Rw({inputs:{x:f},backend:n,attrs:{perm:c}}),m=bw({inputs:{x:p},backend:n,attrs:{shape:l}}),v=ax({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),v}};function sx(e,t,n,r,a){for(var i=rv.util.sizeFromShape(r),o=rv.util.makeZerosTypedArray(a,n),s=0;s<e.length;s++){var u=e[s];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o[u]+=i>0?t[s]:1)}return o}function ux(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=Object(rv.buffer)([a,n],t.dtype),s=0;s<a;s++)for(var u=0;u<i;u++){var c=e.get(s,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||o.set(r?1:t.size>0?o.get(s,c)+t.get(s,u):o.get(s,c)+1,s,c)}return o}var cx={kernelName:rv.Bincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=sx(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};function lx(e){return function(t,n,r){for(var a=rv.util.getTypedArrayFromDType(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}var hx=lx((function(e){return Math.ceil(e)})),dx=H_(rv.Ceil,hx),fx={kernelName:rv.Ceil,backendName:"cpu",kernelFunc:dx},px=U_(rv.ClipByValue,(function(e,t){return e>t.clipValueMax?t.clipValueMax:e<t.clipValueMin?t.clipValueMin:e})),mx={kernelName:rv.ClipByValue,backendName:"cpu",kernelFunc:px},vx={kernelName:rv.ComplexAbs,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(rv.util.sizeFromShape(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.imag,o=n.data.get(a.complexTensorInfos.real.dataId).values,s=n.data.get(i.dataId).values,u=0;u<o.length;u++)r[u]=Math.hypot(o[u],s[u]);return n.makeOutput(r,t.shape,"float32")}};function gx(e,t,n,r){var a=rv.util.getArrayFromDType(n,rv.util.sizeFromShape(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=rv.util.sizeFromShape(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?rv.backend_util.fromUint8ToStringArray(e.vals):e.vals,i=0,s=0;s<e.shape[0];++s)for(var u=s*t[1]+o,c=0;c<e.shape[1];++c)a[u+c]=r[i++];o+=e.shape[1]}))}return a}function yx(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var bx={kernelName:rv.Imag,backendName:"cpu",kernelFunc:yx};function kx(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=rv.util.parseAxisParam(r,t[0].shape)[0],i=rv.backend_util.computeOutShape(t.map((function(e){return e.shape})),a);if(0===rv.util.sizeFromShape(i))return n.makeTensorInfo(i,t[0].dtype,[]);var o=t.filter((function(e){return rv.util.sizeFromShape(e.shape)>0}));if(1===o.length)return q_({inputs:{x:o[0]},backend:n});var s=o.map((function(e){return e.shape}));if(rv.backend_util.assertParamsConsistent(s,a),"complex64"===o[0].dtype){var u=o.map((function(e){return cw({inputs:{input:e},backend:n})})),c=o.map((function(e){return yx({inputs:{input:e},backend:n})})),l=kx({inputs:u,backend:n,attrs:{axis:a}}),h=kx({inputs:c,backend:n,attrs:{axis:a}}),d=ow({inputs:{real:l,imag:h},backend:n});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),d}var f=o.map((function(e){var t=rv.util.sizeFromShape(e.shape.slice(a));return bw({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),p=gx(f.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}})),i=rv.backend_util.computeOutShape(f.map((function(e){return e.shape})),1),t[0].dtype,1===f[0].shape[0]),m=rv.backend_util.computeOutShape(o.map((function(e){return e.shape})),a),v=n.makeTensorInfo(m,t[0].dtype,p);return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}var _x={kernelName:rv.Concat,backendName:"cpu",kernelFunc:kx};function wx(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dilations,l=r.dimRoundingMode;B_([a,i],"conv2d");for(var h=rv.backend_util.convertConv2DDataFormat(u),d=rv.backend_util.computeConv2DInfo(a.shape,i.shape,o,c,s,l,!1,h),f=d.filterHeight,p=d.filterWidth,m=d.dilationHeight,v=d.dilationWidth,g=d.padInfo.left,y=d.padInfo.top,b="channelsLast"===d.dataFormat,k=new rv.TensorBuffer(d.outShape,a.dtype),_=rv.util.computeStrides(a.shape),w=rv.util.computeStrides(i.shape),x=_[0],C=b?_[1]:_[2],O=b?_[2]:1,S=b?1:_[1],T=k.strides[0],I=b?k.strides[1]:k.strides[2],E=b?k.strides[2]:1,N=b?1:k.strides[1],A=n.data.get(a.dataId).values,R=n.data.get(i.dataId).values,D=k.values,j=0;j<d.batchSize;++j)for(var F=j*x,M=j*T,P=0;P<d.outHeight;++P)for(var L=M+P*I,z=P*d.strideHeight-y,B=0;B<f;++B){var V=z+B*m;if(!(V<0||V>=d.inHeight))for(var W=B*w[0],U=F+V*C,H=0;H<d.outWidth;++H)for(var G=L+H*E,K=H*d.strideWidth-g,q=0;q<p;++q){var X=K+q*v;if(!(X<0||X>=d.inWidth))for(var Z=U+X*O,Y=W+q*w[1],Q=0;Q<d.inChannels;++Q){for(var J=A[Z+Q*S],$=0;$<d.outChannels;++$)D[G+$*N]+=J*R[Y+$];Y+=d.outChannels}}}return n.makeTensorInfo(k.shape,k.dtype,D)}var xx={kernelName:rv.Conv2D,backendName:"cpu",kernelFunc:wx},Cx={kernelName:rv.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape;B_([a,i],"conv2dBackpropFilter");for(var h=rv.backend_util.convertConv2DDataFormat(u),d=rv.backend_util.computeConv2DInfo(a.shape,l,o,1,s,c,!1,h),f=d.strideHeight,p=d.strideWidth,m=d.filterHeight,v=d.filterWidth,g="channelsLast"===d.dataFormat,y=new rv.TensorBuffer(d.filterShape,"float32"),b=d.padInfo.left,k=d.padInfo.top,_=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,x=new rv.TensorBuffer(a.shape,a.dtype,_),C=new rv.TensorBuffer(i.shape,i.dtype,w),O=0;O<m;++O)for(var S=Math.max(0,Math.ceil((k-O)/f)),T=Math.min(d.outHeight,(d.inHeight+k-O)/f),I=0;I<v;++I)for(var E=Math.max(0,Math.ceil((b-I)/p)),N=Math.min(d.outWidth,(d.inWidth+b-I)/p),A=0;A<d.inChannels;++A)for(var R=0;R<d.outChannels;++R){for(var D=0,j=0;j<d.batchSize;++j)for(var F=S;F<T;++F)for(var M=O+F*f-k,P=E;P<N;++P){var L=I+P*p-b;D+=g?x.get(j,M,L,A)*C.get(j,F,P,R):x.get(j,A,M,L)*C.get(j,R,F,P)}y.set(D,O,I,A,R)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},Ox={kernelName:rv.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode;B_([a,i],"conv2dBackpropInput");var h=rv.util.computeStrides(i.shape),d=rv.util.computeStrides(a.shape),f=rv.backend_util.convertConv2DDataFormat(c),p=rv.backend_util.computeConv2DInfo(o,i.shape,s,1,u,l,!1,f),m=new rv.TensorBuffer(p.inShape,"float32"),v=m.values,g=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,b=_slicedToArray(h,3),k=b[0],_=b[1],w=b[2],x=p.batchSize,C=p.filterHeight,O=p.filterWidth,S=p.inChannels,T=p.inHeight,I=p.inWidth,E=p.outChannels,N=p.outHeight,A=p.outWidth,R=p.strideHeight,D=p.strideWidth;f=p.dataFormat;for(var j=C-1-p.padInfo.top,F=O-1-p.padInfo.left,M="channelsLast"===f,P=m.strides[0],L=M?m.strides[1]:m.strides[2],z=M?m.strides[2]:1,B=M?1:m.strides[1],V=d[0],W=M?d[1]:d[2],U=M?d[2]:1,H=M?1:d[1],G=0;G<x;++G)for(var K=0;K<S;++K)for(var q=0;q<T;++q)for(var X=q-j,Z=Math.max(0,Math.ceil(X/R)),Y=Math.min(N,(C+X)/R),Q=0;Q<I;++Q){for(var J=Q-F,$=Math.max(0,Math.ceil(J/D)),ee=Math.min(A,(O+J)/D),te=0,ne=Z;ne<Y;++ne)for(var re=ne*R-X,ae=$;ae<ee;++ae)for(var ie=V*G+W*ne+U*ae,oe=k*(C-1-re)+_*(O-1-(ae*D-J))+w*K,se=0;se<E;++se)te+=g[ie+H*se]*y[oe+se];v[P*G+L*q+z*Q+B*K]=te}return n.makeTensorInfo(m.shape,m.dtype,m.values)}},Sx={kernelName:rv.Conv3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations;B_([a,i],"conv3d");for(var c=rv.backend_util.computeConv3DInfo(a.shape,i.shape,o,u,s),l=c.filterDepth,h=c.filterHeight,d=c.filterWidth,f=c.dilationDepth,p=c.dilationHeight,m=c.dilationWidth,v=c.padInfo,g=v.front,y=v.left,b=v.top,k=new rv.TensorBuffer(c.outShape,a.dtype),_=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,x=k.values,C=rv.util.computeStrides(a.shape),O=rv.util.computeStrides(i.shape),S=0;S<c.batchSize;++S)for(var T=S*C[0],I=S*k.strides[0],E=0;E<c.outDepth;++E)for(var N=I+E*k.strides[1],A=E*c.strideDepth-g,R=0;R<l;++R){var D=A+R*f;if(!(D<0||D>=c.inDepth))for(var j=R*O[0],F=T+D*C[1],M=0;M<c.outHeight;++M)for(var P=N+M*k.strides[2],L=M*c.strideHeight-b,z=0;z<h;++z){var B=L+z*p;if(!(B<0||B>=c.inHeight))for(var V=j+z*O[1],W=F+B*C[2],U=0;U<c.outWidth;++U)for(var H=P+U*c.outChannels,G=U*c.strideWidth-y,K=0;K<d;++K){var q=G+K*m;if(!(q<0||q>=c.inWidth))for(var X=W+q*c.inChannels,Z=V+K*O[2],Y=0;Y<c.inChannels;++Y){for(var Q=_[X+Y],J=0;J<c.outChannels;++J)x[H+J]+=Q*w[Z+J];Z+=c.outChannels}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}},Tx={kernelName:rv.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape;B_([a,i],"conv3dBackpropFilterV2");for(var c=rv.util.computeStrides(a.shape),l=rv.util.computeStrides(i.shape),h=rv.backend_util.computeConv3DInfo(a.shape,u,o,1,s),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,m=h.filterDepth,v=h.filterHeight,g=h.filterWidth,y=new rv.TensorBuffer(h.filterShape,"float32"),b=y.values,k=_slicedToArray(y.strides,4),_=k[0],w=k[1],x=k[2],C=k[3],O=n.data.get(i.dataId).values,S=_slicedToArray(l,4),T=S[0],I=S[1],E=S[2],N=S[3],A=n.data.get(a.dataId).values,R=_slicedToArray(c,4),D=R[0],j=R[1],F=R[2],M=R[3],P=h.padInfo.front,L=h.padInfo.left,z=h.padInfo.top,B=0;B<m;++B)for(var V=Math.max(0,Math.ceil((P-B)/d)),W=Math.min(h.outDepth,(h.inDepth+P-B)/d),U=B*_,H=0;H<v;++H)for(var G=Math.max(0,Math.ceil((z-H)/f)),K=Math.min(h.outHeight,(h.inHeight+z-H)/f),q=H*w+U,X=0;X<g;++X)for(var Z=Math.max(0,Math.ceil((L-X)/p)),Y=Math.min(h.outWidth,(h.inWidth+L-X)/p),Q=X*x+q,J=0;J<h.inChannels;++J)for(var $=J*C+Q,ee=0;ee<h.outChannels;++ee){for(var te=0,ne=0;ne<h.batchSize;++ne)for(var re=ne*D,ae=ne*T,ie=V;ie<W;++ie)for(var oe=(B+ie*d-P)*j+re,se=ie*I+ae,ue=G;ue<K;++ue)for(var ce=(H+ue*f-z)*F+oe,le=ue*E+se,he=Z;he<Y;++he)te+=A[(X+he*p-L)*M+ce+J]*O[he*N+le+ee];b[$+ee]=te}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},Ix={kernelName:rv.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=r.inputShape;B_([a],"conv3dBackpropInputV2");for(var c=rv.util.computeStrides(a.shape),l=rv.util.computeStrides(i.shape),h=rv.backend_util.computeConv3DInfo(u,i.shape,s,1,o),d=new rv.TensorBuffer(h.inShape,"float32"),f=d.values,p=_slicedToArray(d.strides,4),m=p[0],v=p[1],g=p[2],y=p[3],b=n.data.get(a.dataId).values,k=_slicedToArray(c,4),_=k[0],w=k[1],x=k[2],C=k[3],O=n.data.get(i.dataId).values,S=_slicedToArray(l,4),T=S[0],I=S[1],E=S[2],N=S[3],A=h.batchSize,R=h.filterDepth,D=h.filterHeight,j=h.filterWidth,F=h.inChannels,M=h.inDepth,P=h.inHeight,L=h.inWidth,z=h.outChannels,B=h.outDepth,V=h.outHeight,W=h.outWidth,U=h.strideDepth,H=h.strideHeight,G=h.strideWidth,K=R-1-h.padInfo.front,q=D-1-h.padInfo.top,X=j-1-h.padInfo.left,Z=0;Z<A;++Z)for(var Y=0;Y<F;++Y)for(var Q=0;Q<M;++Q)for(var J=Q-K,$=Math.max(0,Math.ceil(J/U)),ee=Math.min(B,(R+J)/U),te=0;te<P;++te)for(var ne=te-q,re=Math.max(0,Math.ceil(ne/H)),ae=Math.min(V,(D+ne)/H),ie=0;ie<L;++ie){for(var oe=ie-X,se=Math.max(0,Math.ceil(oe/G)),ue=Math.min(W,(j+oe)/G),ce=0,le=$;le<ee;++le)for(var he=le*U-J,de=re;de<ae;++de)for(var fe=de*H-ne,pe=se;pe<ue;++pe)for(var me=_*Z+w*le+x*de+C*pe,ve=T*(R-1-he)+I*(D-1-fe)+E*(j-1-(pe*G-oe))+N*Y,ge=0;ge<z;++ge)ce+=b[me+ge]*O[ve+ge];f[m*Z+v*Q+g*te+y*ie+Y]=ce}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},Ex=U_(rv.Cos,(function(e){return Math.cos(e)})),Nx={kernelName:rv.Cos,backendName:"cpu",kernelFunc:Ex},Ax=U_(rv.Cosh,(function(e){return Math.cosh(e)})),Rx={kernelName:rv.Cosh,backendName:"cpu",kernelFunc:Ax},Dx={kernelName:rv.CropAndResize,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=_slicedToArray(a.shape,4),h=l[0],d=l[1],f=l[2],p=l[3],m=i.shape[0],v=_slicedToArray(s,2),g=v[0],y=v[1],b=Object(rv.buffer)([m,g,y,p],"float32"),k=n.data.get(i.dataId).values,_=n.data.get(o.dataId).values,w=n.data.get(a.dataId).values,x=rv.util.computeStrides(a.shape),C=rv.util.computeStrides(b.shape),O=0;O<m;O++){var S=4*O,T=k[S],I=k[S+1],E=k[S+2],N=k[S+3],A=_[O];if(!(A>=h))for(var R=g>1?(E-T)*(d-1)/(g-1):0,D=y>1?(N-I)*(f-1)/(y-1):0,j=0;j<g;j++){var F=g>1?T*(d-1)+j*R:.5*(T+E)*(d-1);if(F<0||F>d-1)for(var M=0;M<y;M++)for(var P=0;P<p;P++)b.values[P+M*C[2]+j*C[1]+O*C[0]]=c;else if("bilinear"===u)for(var L=Math.floor(F),z=Math.ceil(F),B=F-L,V=0;V<y;V++){var W=y>1?I*(f-1)+V*D:.5*(I+N)*(f-1);if(W<0||W>f-1)for(var U=0;U<p;U++)b.values[U+V*C[2]+j*C[1]+O*C[0]]=c;else for(var H=Math.floor(W),G=Math.ceil(W),K=W-H,q=0;q<p;q++){var X=q+H*x[2]+L*x[1]+A*x[0],Z=w[X],Y=w[X=q+G*x[2]+L*x[1]+A*x[0]],Q=w[X=q+H*x[2]+z*x[1]+A*x[0]],J=w[X=q+G*x[2]+z*x[1]+A*x[0]],$=Z+(Y-Z)*K;X=q+V*C[2]+j*C[1]+O*C[0],b.values[X]=$+(Q+(J-Q)*K-$)*B}}else for(var ee=0;ee<y;++ee){var te=y>1?I*(f-1)+ee*D:.5*(I+N)*(f-1);if(te<0||te>f-1)for(var ne=0;ne<p;ne++)b.values[ne+ee*C[2]+j*C[1]+O*C[0]]=c;else for(var re=Math.round(te),ae=Math.round(F),ie=0;ie<p;ie++)b.values[ie+ee*C[2]+j*C[1]+O*C[0]]=w[ie+re*x[2]+ae*x[1]+A*x[0]]}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},jx={kernelName:rv.Cumsum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;B_(a,"cumsum");var u=rv.backend_util.getAxesPermutation([i],a.shape.length),c=a;null!=u&&(c=Rw({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=rv.backend_util.getInnerMostAxes(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var h=Object(rv.upcastType)(c.dtype,"int32"),d=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=s?function(e,t){return e+p-t-1}:function(e,t){return e+t},v=0;v<f.length;v+=p)for(var g=0;g<p;g++){var y=m(v,g);if(0===g)d[y]=o?0:f[y];else{var b=m(v,g-1);d[y]=o?f[b]+d[b]:f[y]+d[b]}}var k=n.makeTensorInfo(c.shape,h,d);if(null!=u){var _=Rw({inputs:{x:k},backend:n,attrs:{perm:rv.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(c),_}return k}},Fx={kernelName:rv.DenseBincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=sx(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}if(2===a.shape.length){var c=ux(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+a.shape.length+".")}},Mx={kernelName:rv.DepthToSpace,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;rv.util.assert("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o})),rv.util.assert(i>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+i}));for(var s=a.shape[0],u=a.shape[1],c=a.shape[2],l=a.shape[3],h=u*i,d=c*i,f=l/(i*i),p=n.data.get(a.dataId).values,m=new Float32Array(s*h*d*f),v=0,g=0;g<s;++g)for(var y=0;y<h;++y)for(var b=Math.floor(y/i),k=y%i,_=0;_<d;++_)for(var w=Math.floor(_/i),x=(k*i+_%i)*f,C=0;C<f;++C)m[v++]=p[C+x+l*(w+c*(b+u*g))];return n.makeTensorInfo([s,h,d,f],a.dtype,m)}};function Px(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode;B_([a,i],"depthwiseConv2DNative");var l=rv.util.computeStrides(a.shape),h=rv.util.computeStrides(i.shape),d=u;null==d&&(d=[1,1]),rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(o,d),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(o," and dilations '").concat(d,"'")}));for(var f=rv.backend_util.computeConv2DInfo(a.shape,i.shape,o,d,s,c,!0),p=f.filterHeight,m=f.filterWidth,v=f.dilationHeight,g=f.dilationWidth,y=f.padInfo,b=y.left,k=y.top,_=f.outChannels/f.inChannels,w=new rv.TensorBuffer(f.outShape,a.dtype),x=n.data.get(a.dataId).values,C=n.data.get(i.dataId).values,O=w.values,S=0;S<f.batchSize;++S)for(var T=S*l[0],I=S*w.strides[0],E=0;E<f.outHeight;++E)for(var N=I+E*w.strides[1],A=E*f.strideHeight-b,R=0;R<p;++R){var D=A+R*v;if(!(D<0||D>=f.inHeight))for(var j=R*h[0],F=T+D*l[1],M=0;M<f.outWidth;++M)for(var P=N+M*w.strides[2],L=M*f.strideWidth-k,z=0;z<m;++z){var B=L+z*g;if(!(B<0||B>=f.inWidth))for(var V=F+B*f.inChannels,W=P,U=j+z*h[1],H=0;H<f.inChannels;++H){for(var G=x[V+H],K=0;K<_;++K)O[W+K]+=G*C[U+K];W+=_,U+=_}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var Lx={kernelName:rv.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:Px},zx={kernelName:rv.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape;B_([a,i],"depthwiseConv2dNativeBackpropFilter");for(var h=rv.backend_util.computeConv2DInfo(a.shape,l,o,s,u,c,!0),d=h.strideHeight,f=h.strideWidth,p=h.filterHeight,m=h.filterWidth,v=new rv.TensorBuffer(h.filterShape,"float32"),g=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,k=n.data.get(a.dataId).values,_=new rv.TensorBuffer(a.shape,a.dtype,k),w=n.data.get(i.dataId).values,x=new rv.TensorBuffer(i.shape,i.dtype,w),C=0;C<p;++C)for(var O=Math.max(0,Math.ceil((y-C)/d)),S=Math.min(h.outHeight,(h.inHeight+y-C)/d),T=0;T<m;++T)for(var I=Math.max(0,Math.ceil((g-T)/f)),E=Math.min(h.outWidth,(h.inWidth+g-T)/f),N=0;N<h.outChannels;++N){for(var A=Math.trunc(N/b),R=N%b,D=0,j=0;j<h.batchSize;++j)for(var F=O;F<S;++F)for(var M=C+F*d-y,P=I;P<E;++P)D+=_.get(j,M,T+P*f-g,A)*x.get(j,F,P,N);v.set(D,C,T,A,R)}return n.makeTensorInfo(v.shape,v.dtype,v.values)}},Bx={kernelName:rv.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.inputShape;B_([a,i],"depthwiseConv2DNativeBackpropInput");for(var h=rv.util.computeStrides(a.shape),d=rv.util.computeStrides(i.shape),f=rv.backend_util.computeConv2DInfo(l,i.shape,o,s,u,c,!0),p=new rv.TensorBuffer(f.inShape,"float32"),m=p.values,v=_slicedToArray(p.strides,3),g=v[0],y=v[1],b=v[2],k=n.data.get(a.dataId).values,_=_slicedToArray(h,3),w=_[0],x=_[1],C=_[2],O=n.data.get(i.dataId).values,S=_slicedToArray(d,3),T=S[0],I=S[1],E=S[2],N=f.batchSize,A=f.filterHeight,R=f.filterWidth,D=f.inChannels,j=f.inHeight,F=f.inWidth,M=f.outChannels,P=f.outHeight,L=f.outWidth,z=f.strideHeight,B=f.strideWidth,V=A-1-f.padInfo.top,W=R-1-f.padInfo.left,U=M/D,H=0;H<N;++H)for(var G=0;G<D;++G)for(var K=0;K<j;++K)for(var q=K-V,X=Math.max(0,Math.ceil(q/z)),Z=Math.min(P,(A+q)/z),Y=0;Y<F;++Y){for(var Q=Y-W,J=Math.max(0,Math.ceil(Q/B)),$=Math.min(L,(R+Q)/B),ee=0,te=X;te<Z;++te)for(var ne=te*z-q,re=J;re<$;++re)for(var ae=w*H+x*te+C*re,ie=T*(A-1-ne)+I*(R-1-(re*B-Q))+E*G,oe=0;oe<U;++oe)ee+=k[ae+(G*U+oe)]*O[ie+oe];m[g*H+y*K+b*Y+G]=ee}return n.makeTensorInfo(p.shape,p.dtype,p.values)}},Vx={kernelName:rv.Diag,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=rv.util.sizeFromShape(r.shape),i=n.data.get(r.dataId).values,o=Object(rv.buffer)([a,a],r.dtype),s=o.values,u=0;u<i.length;u++)s[u*a+u]=i[u];var c=[].concat(_toConsumableArray(r.shape),_toConsumableArray(r.shape));return n.makeTensorInfo(c,o.dtype,o.values)}},Wx={kernelName:rv.Dilation2D,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=n,l=c.data.get(a.dataId).values,h=a.shape.length,d=c.data.get(i.dataId).values,f=i.shape.length,p=rv.backend_util.computeDilation2DInfo(a.shape,i.shape,o,s,"NHWC",u),m=p.batchSize,v=p.inHeight,g=p.inWidth,y=p.inChannels,b=p.outHeight,k=p.outWidth,_=p.padInfo,w=p.strideHeight,x=p.strideWidth,C=p.filterHeight,O=p.filterWidth,S=p.dilationHeight,T=p.dilationWidth,I=p.outShape,E=rv.util.sizeFromShape(I),N=I.length,A=rv.util.getArrayFromDType(a.dtype,E),R=0;R<m;++R)for(var D=0;D<b;++D)for(var j=D*w-_.top,F=0;F<k;++F)for(var M=F*x-_.left,P=0;P<y;++P){for(var L=Number.MIN_SAFE_INTEGER,z=0;z<C;++z){var B=j+z*S;if(B>=0&&B<v)for(var V=0;V<O;++V){var W=M+V*T;if(W>=0&&W<g){var U=rv.util.locToIndex([R,B,W,P],h,rv.util.computeStrides(a.shape)),H=rv.util.locToIndex([z,V,P],f,rv.util.computeStrides(i.shape)),G=l[U]+d[H];G>L&&(L=G)}}}A[rv.util.locToIndex([R,D,F,P],N,rv.util.computeStrides(I))]=L}return{dataId:c.write(rv.util.toTypedArray(A,a.dtype),I,a.dtype),shape:I,dtype:a.dtype}}},Ux={kernelName:rv.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,h=rv.util.toNestedArray(a.shape,l.data.get(a.dataId).values),d=rv.util.toNestedArray(i.shape,l.data.get(i.dataId).values),f=rv.backend_util.computeDilation2DInfo(a.shape,i.shape,s,u,"NHWC",c),p=f.batchSize,m=f.inHeight,v=f.inWidth,g=f.inChannels,y=f.outHeight,b=f.outWidth,k=f.padInfo,_=f.strideHeight,w=f.strideWidth,x=f.filterHeight,C=f.filterWidth,O=f.dilationHeight,S=f.dilationWidth,T=f.outShape;rv.util.assert(o.rank===T.length,(function(){return"Error in ".concat(rv.Dilation2DBackpropFilter,", dy must have the same rank as output ").concat(T.length,", but got ")+o.rank}));for(var I=rv.util.toNestedArray(T,l.data.get(o.dataId).values),E=rv.util.makeZerosNestedTypedArray(i.shape,i.dtype),N=0;N<p;++N)for(var A=0;A<y;++A)for(var R=A*_-k.top,D=0;D<b;++D)for(var j=D*w-k.left,F=0;F<g;++F){for(var M=Number.MIN_SAFE_INTEGER,P=0,L=0,z=0;z<x;++z){var B=R+z*O;if(B>=0&&B<m)for(var V=0;V<C;++V){var W=j+V*S;if(W>=0&&W<v){var U=h[N][B][W][F]+d[z][V][F];U>M&&(M=U,P=z,L=V)}}}E[P][L][F]+=I[N][A][D][F]}return{dataId:l.write(rv.util.toTypedArray(E,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},Hx={kernelName:rv.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,h=rv.util.toNestedArray(a.shape,l.data.get(a.dataId).values),d=rv.util.toNestedArray(i.shape,l.data.get(i.dataId).values),f=rv.backend_util.computeDilation2DInfo(a.shape,i.shape,s,u,"NHWC",c),p=f.batchSize,m=f.inHeight,v=f.inWidth,g=f.inChannels,y=f.outHeight,b=f.outWidth,k=f.padInfo,_=f.strideHeight,w=f.strideWidth,x=f.filterHeight,C=f.filterWidth,O=f.dilationHeight,S=f.dilationWidth,T=f.outShape;rv.util.assert(o.rank===T.length,(function(){return"Error in ".concat(rv.Dilation2DBackpropInput,", dy must have the same rank as output ").concat(T.length,", but got ")+o.rank}));for(var I=rv.util.toNestedArray(T,l.data.get(o.dataId).values),E=rv.util.makeZerosNestedTypedArray(a.shape,a.dtype),N=0;N<p;++N)for(var A=0;A<y;++A)for(var R=A*_-k.top,D=0;D<b;++D)for(var j=D*w-k.left,F=0;F<g;++F){for(var M=Number.MIN_SAFE_INTEGER,P=R<0?0:R,L=j<0?0:j,z=0;z<x;++z){var B=R+z*O;if(B>=0&&B<m)for(var V=0;V<C;++V){var W=j+V*S;if(W>=0&&W<v){var U=h[N][B][W][F]+d[z][V][F];U>M&&(M=U,P=B,L=W)}}}E[N][P][L][F]+=I[N][A][D][F]}return{dataId:l.write(rv.util.toTypedArray(E,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},Gx={kernelName:rv.EluGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;B_([r,a],"eluGrad");for(var i=new Float32Array(rv.util.sizeFromShape(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,u=0;u<o.length;++u){var c=o[u];i[u]=c>=1?s[u]:s[u]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}},Kx=Q_((function(e,t){return e===t?1:0})),qx=fw(rv.Equal,Kx,null,"bool"),Xx={kernelName:rv.Equal,backendName:"cpu",kernelFunc:qx},Zx=rv.backend_util.ERF_P,Yx=rv.backend_util.ERF_A1,Qx=rv.backend_util.ERF_A2,Jx=rv.backend_util.ERF_A3,$x=rv.backend_util.ERF_A4,eC=rv.backend_util.ERF_A5,tC=U_(rv.Erf,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+Zx*n);return t*(1-((((eC*r+$x)*r+Jx)*r+Qx)*r+Yx)*r*Math.exp(-n*n))})),nC={kernelName:rv.Erf,backendName:"cpu",kernelFunc:tC},rC=lx((function(e){return Math.exp(e)})),aC=H_(rv.Exp,rC),iC={kernelName:rv.Exp,backendName:"cpu",kernelFunc:aC};function oC(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,s=a.shape.slice(),u=i;return i<0&&(rv.util.assert(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+i+1),s.splice(u,0,1),bw({inputs:{x:a},backend:n,attrs:{shape:s}})}var sC={kernelName:rv.ExpandDims,backendName:"cpu",kernelFunc:oC},uC=lx((function(e){return Math.expm1(e)})),cC=H_(rv.Expm1,uC),lC={kernelName:rv.Expm1,backendName:"cpu",kernelFunc:cC},hC=Q_((function(e,t){return e*t})),dC=pw((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),fC=fw(rv.Multiply,hC,dC),pC={kernelName:rv.Multiply,backendName:"cpu",kernelFunc:fC},mC=Q_((function(e,t){return e/t})),vC=fw(rv.RealDiv,mC),gC={kernelName:rv.RealDiv,backendName:"cpu",kernelFunc:vC},yC=Q_((function(e,t){return e-t})),bC=pw((function(e,t,n,r){return{real:e-n,imag:t-r}})),kC=fw(rv.Sub,yC,bC),_C={kernelName:rv.Sub,backendName:"cpu",kernelFunc:kC};function wC(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[a,i],l=rv.util.sizeFromShape(c),h=rv.util.getTypedArrayFromDType("float32",l),d=rv.util.getTypedArrayFromDType("float32",l),f=0;f<a;f++){for(var p=ax({inputs:{x:s},backend:n,attrs:{begin:[f,0],size:[1,i]}}),m=ax({inputs:{x:u},backend:n,attrs:{begin:[f,0],size:[1,i]}}),v=ow({inputs:{real:p,imag:m},backend:n}),g=xC(v,t,n),y=g.real,b=g.imag,k=rv.backend_util.mergeRealAndImagArrays(y,b),_=0;_<i;_++){var w=rv.backend_util.getComplexWithIndex(k,_);h[f*i+_]=w.real,d[f*i+_]=w.imag}n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v)}var x=n.makeTensorInfo(c,"float32",h),C=n.makeTensorInfo(c,"float32",d),O=ow({inputs:{real:x,imag:C},backend:n});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(C),O}function xC(e,t,n){var r=rv.util.sizeFromShape(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0==((g=r)&g-1)){var s=function e(t,n,r,a,i){if(1===r)return{real:t,imag:n};var o=rv.backend_util.mergeRealAndImagArrays(t,n),s=r/2,u=rv.backend_util.complexWithEvenIndex(o),c=u.real,l=u.imag,h=[c.length],d=i.makeTensorInfo(h,"float32",c),f=i.makeTensorInfo(h,"float32",l),p=ow({inputs:{real:d,imag:f},backend:i}),m=rv.backend_util.complexWithOddIndex(o),v=m.real,g=m.imag,y=[v.length],b=i.makeTensorInfo(y,"float32",v),k=i.makeTensorInfo(y,"float32",g),_=ow({inputs:{real:b,imag:k},backend:i}),w=e(c,l,s,a,i),x=w.real,C=w.imag,O=[x.length],S=i.makeTensorInfo(O,"float32",x),T=i.makeTensorInfo(O,"float32",C),I=ow({inputs:{real:S,imag:T},backend:i}),E=e(v,g,s,a,i),N=E.real,A=E.imag,R=[N.length],D=i.makeTensorInfo(R,"float32",N),j=i.makeTensorInfo(R,"float32",A),F=ow({inputs:{real:D,imag:j},backend:i}),M=rv.backend_util.exponents(r,a),P=[M.real.length],L=i.makeTensorInfo(P,"float32",M.real),z=i.makeTensorInfo(P,"float32",M.imag),B=ow({inputs:{real:L,imag:z},backend:i}),V=fC({inputs:{a:B,b:F},backend:i}),W=gw({inputs:{a:I,b:V},backend:i}),U=kC({inputs:{a:I,b:V},backend:i}),H=cw({inputs:{input:W},backend:i}),G=cw({inputs:{input:U},backend:i}),K=yx({inputs:{input:W},backend:i}),q=yx({inputs:{input:U},backend:i}),X=kx({inputs:[H,G],backend:i,attrs:{axis:0}}),Z=kx({inputs:[K,q],backend:i,attrs:{axis:0}}),Y=i.data.get(X.dataId).values,Q=i.data.get(Z.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(k),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(S),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(Z),{real:Y,imag:Q}}(i,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){var c=n.makeTensorInfo(u,"float32",s.real),l=n.makeTensorInfo(u,"float32",s.imag),h=n.makeTensorInfo([],"float32",rv.util.createScalarValue(r,"float32")),d=q_({inputs:{x:h},backend:n}),f=gC.kernelFunc({inputs:{a:c,b:h},backend:n}),p=gC.kernelFunc({inputs:{a:l,b:d},backend:n}),m=n.data.get(f.dataId).values,v=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:v}}return s}var g,y=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=rv.backend_util.exponent(a*s,t,n),c=rv.backend_util.getComplexWithIndex(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),rv.backend_util.assignToTypedArray(r,i,o,a)}return r}(rv.backend_util.mergeRealAndImagArrays(i,o),r,t);return rv.backend_util.splitRealAndImagArrays(y)}var CC={kernelName:rv.FFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=rv.util.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],o=bw({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=wC(o,!1,n),u=bw({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};function OC(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||rv.util.inferDtype(a),o=rv.util.getArrayFromDType(i,rv.util.sizeFromShape(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var SC={kernelName:rv.Fill,backendName:"cpu",kernelFunc:OC},TC={kernelName:rv.FlipLeftRight,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.image,a=n,i=rv.util.getTypedArrayFromDType(r.dtype,rv.util.sizeFromShape(r.shape)),o=_slicedToArray(r.shape,4),s=o[0],u=o[1],c=o[2],l=o[3],h=a.data.get(r.dataId).values,d=0;d<s;d++)for(var f=d*c*u*l,p=0;p<u;p++)for(var m=p*(c*l),v=0;v<c;v++)for(var g=v*l,y=0;y<l;y++){var b=Math.round(c-[s,p,v,y][2]),k=f+m+g+y,_=h[k];b>=0&&b<c&&(_=h[f+m+b*l+y]),i[k]=_}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},IC=lx((function(e){return Math.floor(e)})),EC=H_(rv.Floor,IC),NC={kernelName:rv.Floor,backendName:"cpu",kernelFunc:EC},AC=Q_((function(e,t){return Math.floor(e/t)})),RC=fw(rv.FloorDiv,AC,null,"int32"),DC={kernelName:rv.FloorDiv,backendName:"cpu",kernelFunc:RC},jC={kernelName:rv.FusedConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,d=r.dimRoundingMode,f=r.activation,p=r.leakyreluAlpha,m=wx({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:d}});if(o){var v=m;m=gw({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(v)}if(f){var g=m;m=iw(n,m,f,s,p),n.disposeIntermediateTensorInfo(g)}return m}},FC={kernelName:rv.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,d=r.dimRoundingMode,f=r.activation,p=r.leakyreluAlpha,m=Px({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:d}});if(o){var v=m;m=gw({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(v)}if(f){var g=m;m=iw(n,m,f,s,p),n.disposeIntermediateTensorInfo(g)}return m}},MC={kernelName:rv.GatherNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=rv.util.sizeFromShape(r.shape),o=a.shape,s=o[o.length-1],u=_slicedToArray(rv.backend_util.prepareAndValidate(r,a),4),c=u[0],l=u[1],h=u[2],d=u[3];if(0===l)return n.makeTensorInfo(c,r.dtype,[]);for(var f=Object(rv.buffer)([l,h],r.dtype),p=n.data.get(a.dataId).values,m=n.data.get(r.dataId).values,v=0;v<l;v++){for(var g=[],y=0,b=0;b<s;b++){var k=p[v*s+b];y+=k*d[b],g.push(k)}if(y<0||y>=i/h)throw new Error("Invalid indices: ".concat(g," does not index into ").concat(r.shape));for(var _=0;_<h;_++)f.values[v*h+_]=m[y*h+_]}return n.makeTensorInfo(c,f.dtype,f.values)}};function PC(e,t,n){for(var r=Object(rv.buffer)(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=t.locToIndex([i[0],i[2]]);i[2]=t.values[o];var s=e.locToIndex(i);r.values[a]=e.values[s]}return r}var LC={kernelName:rv.GatherV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims;B_([a,i],"gatherV2");var u=s;null==s&&(u=0);var c=rv.util.sizeFromShape(i.shape),l=rv.util.parseAxisParam(o,a.shape)[0],h=rv.backend_util.segment_util.collectGatherOpShapeInfo(a,i,l,u),d=bw({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),f=bw({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,c/h.batchSize]}}),p=[h.batchSize,h.outerSize,c/h.batchSize,h.sliceSize],m=n.bufferSync(f),v=PC(n.bufferSync(d),m,p);return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.makeTensorInfo(h.outputShape,v.dtype,v.values)}},zC=Q_((function(e,t){return e>t?1:0})),BC=fw(rv.Greater,zC,null,"bool"),VC={kernelName:rv.Greater,backendName:"cpu",kernelFunc:BC},WC=Q_((function(e,t){return e>=t?1:0})),UC=fw(rv.GreaterEqual,WC,null,"bool"),HC={kernelName:rv.GreaterEqual,backendName:"cpu",kernelFunc:UC},GC={kernelName:rv.IFFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=rv.util.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],o=bw({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=wC(o,!0,n),u=bw({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},KC=U_(rv.IsFinite,(function(e){return Number.isFinite(e)?1:0}),"bool"),qC={kernelName:rv.IsFinite,backendName:"cpu",kernelFunc:KC},XC=U_(rv.IsInf,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),ZC={kernelName:rv.IsInf,backendName:"cpu",kernelFunc:XC},YC=U_(rv.IsNan,(function(e){return Number.isNaN(e)?1:0}),"bool"),QC={kernelName:rv.IsNan,backendName:"cpu",kernelFunc:YC},JC=Q_((function(e,t){return e<t?1:0})),$C=fw(rv.Less,JC,null,"bool"),eO={kernelName:rv.Less,backendName:"cpu",kernelFunc:$C},tO=Q_((function(e,t){return e<=t?1:0})),nO=fw(rv.LessEqual,tO,null,"bool"),rO={kernelName:rv.LessEqual,backendName:"cpu",kernelFunc:nO};function aO(e,t,n){var r=(t-e)/(n-1),a=rv.util.makeZerosTypedArray(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var iO={kernelName:rv.LinSpace,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=aO(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},oO=lx((function(e){return Math.log(e)})),sO=H_(rv.Log,oO),uO={kernelName:rv.Log,backendName:"cpu",kernelFunc:sO},cO=U_(rv.Log1p,(function(e){return Math.log1p(e)})),lO={kernelName:rv.Log1p,backendName:"cpu",kernelFunc:cO},hO=Q_((function(e,t){return e&&t})),dO=fw(rv.LogicalAnd,hO,null,"bool"),fO={kernelName:rv.LogicalAnd,backendName:"cpu",kernelFunc:dO},pO=U_(rv.LogicalNot,(function(e){return e?0:1}),"bool"),mO={kernelName:rv.LogicalNot,backendName:"cpu",kernelFunc:pO},vO=Q_((function(e,t){return e||t})),gO=fw(rv.LogicalOr,vO,null,"bool"),yO={kernelName:rv.LogicalOr,backendName:"cpu",kernelFunc:gO},bO={kernelName:rv.LRN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta;B_(a,"LRN");var c=a.shape[3],l=c-1,h=n.data.get(a.dataId).values,d=rv.util.sizeFromShape(a.shape),f=new Float32Array(d);function p(e){for(var t=e%c,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,l),a=0;n<=r;n++){var o=h[n];a+=o*o}return a}for(var m=0;m<d;m++){var v=p(m),g=h[m]*Math.pow(o+s*v,-u);f[m]=g}return n.makeTensorInfo(a.shape,a.dtype,f)}},kO={kernelName:rv.LRNGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta;B_(o,"LRNGrad");for(var h=rv.util.sizeFromShape(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,v=new Float32Array(h),g=h,y=0;y<g;y++){for(var b=y%d,k=y-b+Math.max(0,b-s),_=y-b+Math.min(d,b+s+1),w=0,x=k;x<_;x++)w+=Math.pow(p[x],2);w=c*w+u;for(var C=k;C<_;C++){var O=-2*c*l*p[C]*m[y]/w;y===C&&(O+=Math.pow(w,-l)),O*=f[y],v[C]+=O}}return n.makeTensorInfo(o.shape,a.dtype,v)}};function _O(e,t,n,r){for(var a=rv.util.getTypedArrayFromDType(r,rv.util.sizeFromShape(n)),i=0;i<a.length;++i){for(var o=i*t,s=e[o],u=0;u<t;++u){var c=e[o+u];c>s&&(s=c)}a[i]=s}return a}function wO(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=n,u=a.shape,c=u.length,l=rv.util.parseAxisParam(i,u),h=l,d=rv.backend_util.getAxesPermutation(h,c),f=s.data.get(a.dataId).values;if(null!=d){for(var p=new Array(c),m=0;m<p.length;m++)p[m]=u[d[m]];f=Aw(f,u,a.dtype,d,p),h=rv.backend_util.getInnerMostAxes(h.length,c),u=p}B_(a,"max"),rv.backend_util.assertAxesAreInnerMostDims("max",h,c);var v=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(u,h),2),g=v[0],y=v[1],b=_O(f,rv.util.sizeFromShape(y),g,a.dtype),k=s.write(b,g,a.dtype),_=g;return o&&(_=rv.backend_util.expandShapeToKeepDim(g,l)),{dataId:k,shape:_,dtype:a.dtype}}var xO={kernelName:rv.Max,backendName:"cpu",kernelFunc:wO},CO=Q_((function(e,t){return Math.max(e,t)})),OO=fw(rv.Maximum,CO),SO={kernelName:rv.Maximum,backendName:"cpu",kernelFunc:OO},TO={kernelName:rv.MaxPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;B_(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(o," and dilations '1'")}));var c,l=rv.backend_util.computePool2DInfo(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&rv.util.arraysEqual(l.inShape,l.outShape))c=q_({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,d=rv.util.computeStrides(a.shape),f=Zw(h,0,a.dtype,d,l,"max");c=n.makeTensorInfo(l.outShape,a.dtype,f.values)}return c}},IO={kernelName:rv.MaxPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=r.dilations;B_(a,"maxPool3d");var h=l;null==h&&(h=[1,1,1]);var d=rv.backend_util.computePool3DInfo(a.shape,i,o,h,s,u,c),f=Qw(n.data.get(a.dataId).values,0,a.dtype,rv.util.computeStrides(a.shape),d,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}},EO={kernelName:rv.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dilations,l=r.dimRoundingMode;B_([a,i],"maxPool3DGrad");for(var h=rv.backend_util.computePool3DInfo(i.shape,o,s,c,u,l),d=function(e,t){for(var n=Object(rv.buffer)(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,m=0;m<t.batchSize;++m)for(var v=0;v<t.inChannels;++v)for(var g=0;g<t.outDepth;++g){for(var y=g*r-d,b=y;b<0;)b+=o;for(var k=Math.min(t.inDepth,c+y),_=0;_<t.outHeight;++_){for(var w=_*a-f,x=w;x<0;)x+=s;for(var C=Math.min(t.inHeight,l+w),O=0;O<t.outWidth;++O){for(var S=O*i-p,T=S;T<0;)T+=u;for(var I=Math.min(t.inWidth,h+S),E=Number.NEGATIVE_INFINITY,N=-1,A=b;A<k;A+=o)for(var R=A-y,D=x;D<C;D+=s)for(var j=D-w,F=T;F<I;F+=u){var M=F-S,P=e.get(m,A,D,F,v);P>=E&&(E=P,N=R*l*h+j*l+M)}n.set(N,m,g,_,O,v)}}}return n}(n.bufferSync(i),h),f=h.strideDepth,p=h.strideHeight,m=h.strideWidth,v=h.dilationDepth,g=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterDepth,k=h.effectiveFilterHeight,_=h.effectiveFilterWidth,w=b-1-h.padInfo.front,x=_-1-h.padInfo.left,C=k-1-h.padInfo.top,O=Object(rv.buffer)(i.shape,"float32"),S=n.bufferSync(a),T=0;T<h.batchSize;++T)for(var I=0;I<h.inChannels;++I)for(var E=0;E<h.inDepth;++E)for(var N=0;N<h.inHeight;++N)for(var A=0;A<h.inWidth;++A){for(var R=E-w,D=N-C,j=A-x,F=0,M=0;M<b;M+=v){var P=(R+M)/f;if(!(P<0||P>=h.outDepth||Math.floor(P)!==P))for(var L=0;L<k;L+=g){var z=(D+L)/p;if(!(z<0||z>=h.outHeight||Math.floor(z)!==z))for(var B=0;B<_;B+=y){var V=(j+B)/m;if(!(V<0||V>=h.outWidth||Math.floor(V)!==V)){var W=b*k*_-1-d.get(T,P,z,V,I)===M*k*_+L*_+B?1:0;0!==W&&(F+=S.get(T,P,z,V,I)*W)}}}}O.set(F,T,E,N,A,I)}return n.makeTensorInfo(O.shape,O.dtype,O.values)}},NO={kernelName:rv.MaxPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;B_([i,t.output],"maxPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=rv.backend_util.computePool2DInfo(o.shape,s,u,1,c,l),d=n.data.get(o.dataId).values,f=Object(rv.buffer)(h.outShape,o.dtype,Yw(d,o.shape,o.dtype,h).values),p=h.strideHeight,m=h.strideWidth,v=h.dilationHeight,g=h.dilationWidth,y=h.effectiveFilterHeight,b=h.effectiveFilterWidth,k=b-1-h.padInfo.left,_=y-1-h.padInfo.top,w=Object(rv.buffer)(o.shape,"float32"),x=n.data.get(a.dataId).values,C=Object(rv.buffer)(a.shape,"float32",x),O=0;O<h.batchSize;++O)for(var S=0;S<h.inChannels;++S)for(var T=0;T<h.inHeight;++T)for(var I=0;I<h.inWidth;++I){for(var E=T-_,N=I-k,A=0,R=0;R<y;R+=v){var D=(E+R)/p;if(!(D<0||D>=h.outHeight||Math.floor(D)!==D))for(var j=0;j<b;j+=g){var F=(N+j)/m;if(!(F<0||F>=h.outWidth||Math.floor(F)!==F)){var M=y*b-1-f.get(O,D,F,S)===R*b+j?1:0;0!==M&&(A+=C.get(O,D,F,S)*M)}}}w.set(A,O,T,I,S)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},AO={kernelName:rv.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;B_(a,"MaxPoolWithArgmax");var l=c.data.get(a.dataId).values,h=rv.backend_util.computePool2DInfo(a.shape,i,o,[1,1],s),d=_slicedToArray(function(e,t,n,r,a){var i=Zw(e,0,n,rv.util.computeStrides(t),a,"max"),o=Yw(e,t,n,a,!0,r);return[i.values,o.values]}(l,a.shape,a.dtype,u,h),2),f=d[0],p=d[1],m=c.write(f,h.outShape,a.dtype),v=c.write(p,h.outShape,a.dtype);return[{dataId:m,shape:h.outShape,dtype:a.dtype},{dataId:v,shape:h.outShape,dtype:"int32"}]}};function RO(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims;B_(i,"sum");var u=(t="bool"===i.dtype?hw({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):q_({inputs:{x:i},backend:r})).shape.length,c=rv.util.parseAxisParam(o,t.shape),l=rv.backend_util.getAxesPermutation(c,u),h=c,d=t;null!=l&&(d=Rw({inputs:{x:t},backend:r,attrs:{perm:l}}),h=rv.backend_util.getInnerMostAxes(h.length,u)),rv.backend_util.assertAxesAreInnerMostDims("sum",h,d.shape.length);for(var f=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(d.shape,h),2),p=f[0],m=f[1],v=uw(r,p,rv.backend_util.upcastType(d.dtype,"int32")),g=rv.util.sizeFromShape(m),y=r.data.get(v.dataId).values,b=r.data.get(d.dataId).values,k=0;k<y.length;++k){for(var _=k*g,w=0,x=0;x<g;++x)w+=b[_+x];y[k]=w}if(s){var C=v;v=bw({inputs:{x:v},backend:r,attrs:{shape:rv.backend_util.expandShapeToKeepDim(v.shape,c)}}),r.disposeIntermediateTensorInfo(C)}return r.disposeIntermediateTensorInfo(t),null!=l&&r.disposeIntermediateTensorInfo(d),v}var DO={kernelName:rv.Sum,backendName:"cpu",kernelFunc:RO},jO={kernelName:rv.Mean,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=rv.util.parseAxisParam(i,a.shape),u=rv.backend_util.computeOutAndReduceShapes(a.shape,s),c=rv.util.sizeFromShape(u[1]),l=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));l.push(h);var d=hw({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});l.push(d);var f=vC({inputs:{a:d,b:h},backend:n});l.push(f);var p=RO({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:o}});return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),p}},FO={kernelName:rv.Min,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;B_(a,"min");var s=rv.util.parseAxisParam(i,a.shape),u=s,c=rv.backend_util.getAxesPermutation(u,a.shape.length),l=a;null!=c&&(l=Rw({inputs:{x:a},backend:n,attrs:{perm:c}}),u=rv.backend_util.getInnerMostAxes(u.length,a.shape.length)),rv.backend_util.assertAxesAreInnerMostDims("min",u,l.shape.length);for(var h=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(l.shape,u),2),d=h[0],f=h[1],p=rv.util.sizeFromShape(f),m=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(d),l.dtype),v=n.data.get(l.dataId).values,g=0;g<m.length;++g){for(var y=g*p,b=v[y],k=0;k<p;++k){var _=v[y+k];_<b&&(b=_)}m[g]=b}null!=c&&n.disposeIntermediateTensorInfo(l);var w=n.makeTensorInfo(d,l.dtype,m);if(o){var x=bw({inputs:{x:w},backend:n,attrs:{shape:rv.backend_util.expandShapeToKeepDim(d,s)}});return n.disposeIntermediateTensorInfo(w),x}return w}},MO=Q_((function(e,t){return Math.min(e,t)})),PO=fw(rv.Minimum,MO),LO={kernelName:rv.Minimum,backendName:"cpu",kernelFunc:PO},zO={kernelName:rv.MirrorPad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;B_(a,"mirrorPad");for(var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=i.map((function(e,t){return e[0]+a.shape[t]})),l="reflect"===o?0:1,h=n.data.get(a.dataId).values,d=a.shape.length,f=rv.util.computeStrides(a.shape),p=rv.util.sizeFromShape(s),m=s.length,v=rv.util.computeStrides(s),g=rv.util.getTypedArrayFromDType(a.dtype,p),y=0;y<p;y++){for(var b=rv.util.indexToLoc(y,m,v),k=0;k<m;k++)b[k]<u[k]?b[k]=2*u[k]-b[k]-l:b[k]>=c[k]&&(b[k]=2*(c[k]-1)-b[k]+l);b=b.map((function(e,t){return e-u[t]}));var _=rv.util.locToIndex(b,d,f);g[y]=h[_]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},BO=Q_((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),VO=fw(rv.Mod,BO),WO={kernelName:rv.Mod,backendName:"cpu",kernelFunc:VO};function UO(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank ".concat(o," and dim was ").concat(s));var u=rv.util.parseAxisParam([s],a.shape),c=wO({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=rv.backend_util.expandShapeToKeepDim(c.shape,u),h=bw({inputs:{x:c},backend:n,attrs:{shape:l}}),d=kC({inputs:{a:a,b:h},backend:n}),f=aC({inputs:{x:d},backend:n}),p=RO({inputs:{x:f},backend:n,attrs:{axis:u,keepDims:!1}}),m=bw({inputs:{x:p},backend:n,attrs:{shape:l}}),v=vC({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),v}var HO={kernelName:rv.Softmax,backendName:"cpu",kernelFunc:UO},GO={kernelName:rv.Multinomial,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized;B_(a,"multinomial");for(var u=s?a:UO({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],h=n.data.get(u.dataId).values,d=[c,i],f=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(d),"int32"),p=0;p<c;++p){var m=p*l,v=new Float32Array(l-1);v[0]=h[m];for(var g=1;g<v.length;++g)v[g]=v[g-1]+h[m+g];for(var y=v_.alea(o.toString()),b=p*i,k=0;k<i;++k){var _=y();f[b+k]=v.length;for(var w=0;w<v.length;w++)if(_<v[w]){f[b+k]=w;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(d,"int32",f)}};function KO(e,t,n){var r=rv.util.createScalarValue(-1,n);return hC([],t,r,e,n)}var qO={kernelName:rv.Neg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;B_(r,"neg");var a=_slicedToArray(KO(n.data.get(r.dataId).values,r.shape,r.dtype),2),i=a[0],o=a[1];return n.makeTensorInfo(o,r.dtype,i)}},XO=rv.kernel_impls.nonMaxSuppressionV3Impl,ZO={kernelName:rv.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;B_(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,h=XO(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},YO=rv.kernel_impls.nonMaxSuppressionV4Impl,QO={kernelName:rv.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize;B_(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,d=YO(l,h,o,s,u,c),f=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},JO=rv.kernel_impls.nonMaxSuppressionV5Impl,$O={kernelName:rv.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma;B_(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,d=JO(l,h,o,s,u,c),f=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},eS=Q_((function(e,t){return e!==t?1:0})),tS=fw(rv.NotEqual,eS,null,"bool"),nS={kernelName:rv.NotEqual,backendName:"cpu",kernelFunc:tS},rS={kernelName:rv.OneHot,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.depth,o=r.onValue,s=r.offValue;B_(a,"oneHot");var u=rv.util.sizeFromShape(a.shape),c=new Float32Array(u*i);c.fill(s);for(var l=n.data.get(a.dataId).values,h=0;h<u;++h)l[h]>=0&&l[h]<i&&(c[h*i+l[h]]=o);return n.makeTensorInfo([].concat(_toConsumableArray(a.shape),[i]),"int32",c)}};function aS(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=cw({inputs:{input:r},backend:n}),i=aS({inputs:{x:a},backend:n}),o=yx({inputs:{input:r},backend:n}),s=aS({inputs:{x:o},backend:n}),u=ow({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return OC({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var iS={kernelName:rv.ZerosLike,backendName:"cpu",kernelFunc:aS},oS={kernelName:rv.OnesLike,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=cw({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=yx({inputs:{input:a},backend:r}),u=aS({inputs:{x:s},backend:r}),c=ow({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return OC({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function sS(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return oC({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){rv.util.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),rv.util.assert(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=kx({inputs:t.map((function(e){var t=oC({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}var uS={kernelName:rv.Pack,backendName:"cpu",kernelFunc:sS},cS={kernelName:rv.PadV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;B_(a,"pad");var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=rv.util.sizeFromShape(a.shape),h=a.shape.length,d=rv.util.computeStrides(a.shape),f=rv.util.sizeFromShape(s),p=s.length,m=rv.util.computeStrides(s),v=rv.util.getTypedArrayFromDType(a.dtype,f);0!==o&&v.fill(o);for(var g=0;g<l;g++){var y=rv.util.indexToLoc(g,h,d).map((function(e,t){return e+u[t]}));v[rv.util.locToIndex(y,p,m)]=c[g]}return{dataId:n.write(v,s,a.dtype),shape:s,dtype:a.dtype}}},lS=Q_((function(e,t){return Math.pow(e,t)})),hS=fw(rv.Pow,lS),dS={kernelName:rv.Pow,backendName:"cpu",kernelFunc:hS};function fS(e,t,n,r){for(var a=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(e,r),2),i=a[0],o=a[1],s=Object(rv.upcastType)(t,"int32"),u=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(i),s),c=rv.util.sizeFromShape(o),l=0;l<u.length;++l){for(var h=l*c,d=1,f=0;f<c;++f)d*=n[h+f];u[l]=d}return{outVals:u,outShape:i,outDtype:s}}var pS={kernelName:rv.Prod,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;B_(a,"prod");var s=a.shape.length,u=rv.util.parseAxisParam(i,a.shape),c=rv.backend_util.getAxesPermutation(u,s),l=u,h=a,d=[];null!=c&&(h=Rw({inputs:{x:a},backend:n,attrs:{perm:c}}),d.push(h),l=rv.backend_util.getInnerMostAxes(l.length,s));var f=n.data.get(h.dataId).values,p=fS(h.shape,h.dtype,f,l),m=p.outVals,v=p.outShape,g=p.outDtype,y=v;return o&&(y=rv.backend_util.expandShapeToKeepDim(v,u)),d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,g,m)}};function mS(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return rv.util.makeZerosTypedArray(0,r);var a=Math.abs(Math.ceil((t-e)/n)),i=rv.util.makeZerosTypedArray(a,r);t<e&&1===n&&(n=-1),i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return i}var vS={kernelName:rv.Range,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=mS(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},gS=U_(rv.Reciprocal,(function(e){return 1/e})),yS={kernelName:rv.Reciprocal,backendName:"cpu",kernelFunc:gS},bS={kernelName:rv.ResizeBilinear,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;B_(a,"resizeBilinear");for(var u=rv.util.computeStrides(a.shape),c=_slicedToArray(s,2),l=c[0],h=c[1],d=_slicedToArray(a.shape,4),f=d[0],p=d[1],m=d[2],v=d[3],g=n.data.get(a.dataId).values,y=new Float32Array(rv.util.sizeFromShape([f,l,h,v])),b=[i&&l>1?p-1:p,i&&h>1?m-1:m],k=[i&&l>1?l-1:l,i&&h>1?h-1:h],_=0,w=b[0]/k[0],x=b[1]/k[1],C=0;C<f;C++)for(var O=0;O<l;O++){var S;S=o?w*(O+.5)-.5:w*O;for(var T=Math.max(0,Math.floor(S)),I=S-T,E=Math.min(p-1,Math.ceil(S)),N=C*u[0]+T*u[1],A=C*u[0]+E*u[1],R=0;R<h;R++){var D;D=o?x*(R+.5)-.5:x*R;for(var j=Math.max(0,Math.floor(D)),F=D-j,M=Math.min(m-1,Math.ceil(D)),P=N+j*u[2],L=A+j*u[2],z=N+M*u[2],B=A+M*u[2],V=0;V<v;V++){var W=g[P+V],U=g[L+V],H=W+(g[z+V]-W)*F;y[_++]=H+(U+(g[B+V]-U)*F-H)*I}}}return n.makeTensorInfo([f,l,h,v],"float32",y)}},kS={kernelName:rv.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;B_([i,a],"resizeBilinearGrad");for(var s=rv.util.computeStrides(a.shape),u=_slicedToArray(a.shape,4),c=u[0],l=u[1],h=u[2],d=u[3],f=_slicedToArray(i.shape,3),p=f[1],m=f[2],v=new Float32Array(c*l*h*d),g=[o&&p>1?l-1:l,o&&m>1?h-1:h],y=[o&&p>1?p-1:p,o&&m>1?m-1:m],b=g[0]/y[0],k=g[1]/y[1],_=n.data.get(i.dataId).values,w=0,x=0;x<c;x++)for(var C=x*s[0],O=0;O<p;O++)for(var S=O*b,T=Math.floor(S),I=Math.min(Math.ceil(S),l-1),E=C+T*s[1],N=C+I*s[1],A=S-T,R=1-A,D=0;D<m;D++)for(var j=D*k,F=Math.floor(j),M=Math.min(Math.ceil(j),h-1),P=j-F,L=1-P,z=E+F*s[2],B=E+M*s[2],V=N+F*s[2],W=N+M*s[2],U=R*L,H=R*P,G=A*L,K=A*P,q=0;q<d;q++){var X=_[w++];v[z+q]+=X*U,v[B+q]+=X*H,v[V+q]+=X*G,v[W+q]+=X*K}return n.makeTensorInfo([c,h,l,d],"float32",v)}},_S={kernelName:rv.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;B_(a,"resizeNearestNeighbor");for(var u=rv.util.computeStrides(a.shape),c=_slicedToArray(s,2),l=c[0],h=c[1],d=_slicedToArray(a.shape,4),f=d[0],p=d[1],m=d[2],v=d[3],g=n.data.get(a.dataId).values,y=new Float32Array(f*l*h*v),b=[i&&l>1?p-1:p,i&&h>1?m-1:m],k=[i&&l>1?l-1:l,i&&h>1?h-1:h],_=b[0]/k[0],w=b[1]/k[1],x=0,C=0;C<f;C++)for(var O=C*u[0],S=0;S<l;S++){var T=o?_*(S+.5):_*S,I=Math.min(p-1,i?Math.round(T):Math.floor(T));o&&(I=Math.max(0,I));for(var E=O+I*u[1],N=0;N<h;N++){var A=o?w*(N+.5):w*N,R=Math.min(m-1,i?Math.round(A):Math.floor(A));o&&(R=Math.max(0,R));for(var D=E+R*u[2],j=0;j<v;j++)y[x++]=g[D+j]}}return n.makeTensorInfo([f,l,h,v],a.dtype,y)}},wS={kernelName:rv.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;B_([i,a],"resizeNearestNeighborGrad");for(var s=rv.util.computeStrides(a.shape),u=rv.util.computeStrides(i.shape),c=_slicedToArray(a.shape,4),l=c[0],h=c[1],d=c[2],f=c[3],p=_slicedToArray(i.shape,3),m=p[1],v=p[2],g=new Float32Array(l*h*d*f),y=n.data.get(i.dataId).values,b=[o&&m>1?h-1:h,o&&v>1?d-1:d],k=[o&&m>1?m-1:m,o&&v>1?v-1:v],_=b[0]/k[0],w=b[1]/k[1],x=1/_,C=1/w,O=2*Math.ceil(x)+2,S=2*Math.ceil(C)+2,T=0;T<l;T++)for(var I=T*s[0],E=0;E<h;E++)for(var N=I+E*s[1],A=Math.floor(E*x),R=Math.floor(A-O/2),D=0;D<d;D++)for(var j=N+D*s[2],F=Math.floor(D*C),M=Math.floor(F-S/2),P=0;P<f;P++){for(var L=0,z=0;z<O;z++){var B=z+R;if(!(B<0||B>=m)){var V=I+B*u[1],W=B*_;if(E===Math.min(h-1,o?Math.round(W):Math.floor(W)))for(var U=0;U<S;U++){var H=U+M;if(!(H<0||H>=v)){var G=V+H*u[2],K=H*w;D===Math.min(d-1,o?Math.round(K):Math.floor(K))&&(L+=y[G+P])}}}}g[j+P]=L}return n.makeTensorInfo(a.shape,a.dtype,g)}},xS={kernelName:rv.Reverse,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;B_(a,"reverse");var o=a.shape.length,s=rv.util.parseAxisParam(i,a.shape);if(0===o)return q_({inputs:{x:a},backend:n});for(var u=new rv.TensorBuffer(a.shape,a.dtype),c=n.bufferSync(a),l=function(e){var t=u.indexToLoc(e),n=t.slice();s.forEach((function(e){return n[e]=a.shape[e]-1-n[e]})),u.set.apply(u,[c.get.apply(c,_toConsumableArray(n))].concat(_toConsumableArray(t)))},h=0;h<u.size;h++)l(h);return n.makeTensorInfo(u.shape,u.dtype,u.values)}},CS={kernelName:rv.RotateWithOffset,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=rv.util.getTypedArrayFromDType(a.dtype,rv.util.sizeFromShape(a.shape)),l=_slicedToArray(a.shape,4),h=l[0],d=l[1],f=l[2],p=l[3],m=_slicedToArray(rv.backend_util.getImageCenter(s,d,f),2),v=m[0],g=m[1],y=Math.sin(i),b=Math.cos(i),k=u.data.get(a.dataId).values,_=0;_<h;_++)for(var w=_*f*d*p,x=0;x<d;x++)for(var C=x*(f*p),O=0;O<f;O++)for(var S=O*p,T=0;T<p;T++){var I=[h,x,O,T],E=I[2],N=I[1],A=(E-v)*b-(N-g)*y,R=(E-v)*y+(N-g)*b;A=Math.round(A+v),R=Math.round(R+g);var D=o;"number"!=typeof o&&(D=3===T?255:o[T]),A>=0&&A<f&&R>=0&&R<d&&(D=k[w+R*(f*p)+A*p+T]),c[w+C+S+T]=D}return{dataId:u.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},OS=U_(rv.Round,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2==0?t:t+1})),SS={kernelName:rv.Round,backendName:"cpu",kernelFunc:OS},TS=lx((function(e){return 1/Math.sqrt(e)})),IS=H_(rv.Rsqrt,TS),ES={kernelName:rv.Rsqrt,backendName:"cpu",kernelFunc:IS};function NS(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],h=e.values,d=t.values;if(0===r)return Object(rv.buffer)(n,t.dtype);var f=Object(rv.buffer)(l,t.dtype);f.values.fill(u);for(var p=0;p<i;p++){for(var m=[],v=0,g=0;g<o;g++){var y=h[p*o+g];m.push(y),v+=y*s[g]}if(v<0||v>=r/a)throw new Error("Invalid indices: ".concat(m," does not index into ").concat(n));for(var b=0;b<a;b++)c?f.values[v*a+b]+=d[p*a+b]:f.values[v*a+b]=0===t.rank?d[0]:d[p*a+b]}return f}var AS={kernelName:rv.ScatterNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=rv.backend_util.calculateShapes(i,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize,f=NS(n.bufferSync(a),n.bufferSync(i),o,d,l,c,u,h,0,!0);return n.makeTensorInfo(o,f.dtype,f.values)}},RS={kernelName:rv.Select,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;B_([r,a,i],"select");for(var o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=Object(rv.upcastType)(a.dtype,i.dtype),h=rv.util.makeZerosTypedArray(rv.util.sizeFromShape(a.shape),l),d=0,f=0===o||o>1||1===a.shape.length?1:rv.util.sizeFromShape(a.shape.slice(1)),p=0;p<s.length;p++)for(var m=0;m<f;m++)h[d++]=1===s[p]?u[p]:c[p];return n.makeTensorInfo(a.shape,l,h)}},DS=rv.backend_util.SELU_SCALEALPHA,jS=rv.backend_util.SELU_SCALE,FS=U_(rv.Selu,(function(e){return e>=0?jS*e:DS*(Math.exp(e)-1)})),MS={kernelName:rv.Selu,backendName:"cpu",kernelFunc:FS},PS=U_(rv.Sigmoid,(function(e){return 1/(1+Math.exp(-e))})),LS={kernelName:rv.Sigmoid,backendName:"cpu",kernelFunc:PS},zS=U_(rv.Sign,(function(e){return e<0?-1:e>0?1:0})),BS={kernelName:rv.Sign,backendName:"cpu",kernelFunc:zS},VS=U_(rv.Sin,(function(e){return Math.sin(e)})),WS={kernelName:rv.Sin,backendName:"cpu",kernelFunc:VS},US=U_(rv.Sinh,(function(e){return Math.sinh(e)})),HS={kernelName:rv.Sinh,backendName:"cpu",kernelFunc:US},GS=Math.log(1.1920928955078125e-7)+2,KS=U_(rv.Softplus,(function(e){var t=e>-GS,n=e<GS,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),qS={kernelName:rv.Softplus,backendName:"cpu",kernelFunc:KS},XS={kernelName:rv.SpaceToBatchND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;B_([a],"spaceToBatchND");var s=rv.util.sizeFromShape(i),u=[[0,0]];u.push.apply(u,_toConsumableArray(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=cS.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),h=rv.backend_util.getReshaped(l.shape,i,s,!1),d=rv.backend_util.getPermuted(h.length,i.length,!1),f=rv.backend_util.getReshapedPermuted(l.shape,i,s,!1),p=bw({inputs:{x:l},backend:n,attrs:{shape:h}}),m=Rw({inputs:{x:p},backend:n,attrs:{perm:d}}),v=bw({inputs:{x:m},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),v}},ZS={kernelName:rv.SparseToDense,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=rv.backend_util.calculateShapes(i,a,s),c=u.sliceRank,l=u.numUpdates,h=u.sliceSize,d=u.strides,f=u.outputSize,p=NS(n.bufferSync(a),n.bufferSync(i),s,f,h,l,c,d,n.data.get(o.dataId).values[0],!1);return n.makeTensorInfo(s,p.dtype,p.values)}},YS={kernelName:rv.SplitV,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=r.axis,s=rv.util.parseAxisParam(o,a.shape)[0],u=rv.backend_util.prepareSplitSize(a,i,s),c=new Array(a.shape.length).fill(0),l=a.shape.slice();return u.map((function(e){var t=_toConsumableArray(l);t[s]=e;var r=ax({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[s]+=e,r}))}},QS=U_(rv.Sqrt,(function(e){return Math.sqrt(e)})),JS={kernelName:rv.Sqrt,backendName:"cpu",kernelFunc:QS},$S={kernelName:rv.Square,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;B_(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},eT=Q_((function(e,t){var n=e-t;return n*n})),tT=fw(rv.SquaredDifference,eT),nT={kernelName:rv.SquaredDifference,backendName:"cpu",kernelFunc:tT},rT=U_(rv.Step,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),aT={kernelName:rv.Step,backendName:"cpu",kernelFunc:rT};function iT(e,t,n,r){for(var a=Object(rv.buffer)(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),s=new Array(o.length),u=0;u<s.length;u++)s[u]=o[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,s)].concat(_toConsumableArray(o)))}return a}var oT={kernelName:rv.StridedSlice,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,s=r.strides,u=r.beginMask,c=r.endMask,l=r.ellipsisMask,h=r.newAxisMask,d=r.shrinkAxisMask;B_(a,"stridedSlice");var f,p=rv.slice_util.sliceInfo(a.shape,i,o,s,u,c,l,h,d),m=p.nonStrided,v=p.$begin,g=p.$strides,y=p.size,b=p.newShape,k=p.outShape,_=bw({inputs:{x:a},backend:n,attrs:{shape:b}});if(m){var w=ax({inputs:{x:_},backend:n,attrs:{begin:v,size:y}});f=bw({inputs:{x:w},backend:n,attrs:{shape:k}}),n.disposeIntermediateTensorInfo(w)}else if(k.some((function(e){return 0===e})))f=n.makeTensorInfo(k,a.dtype,[]);else{var x=iT(k,n.bufferSync(_),g,v);f=n.makeTensorInfo(x.shape,x.dtype,x.values)}var C=bw({inputs:{x:f},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(f),C}},sT=U_(rv.Tan,(function(e){return Math.tan(e)})),uT={kernelName:rv.Tan,backendName:"cpu",kernelFunc:sT},cT=U_(rv.Tanh,(function(e){return Math.tanh(e)}));function lT(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=Object(rv.buffer)(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var c=e.locToIndex(s);a.values[i]=e.values[c]}return a}function hT(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=rv.util.getTypedArrayFromDType(n,o*r),c=rv.util.getTypedArrayFromDType("int32",o*r),l=0;l<o;l++){for(var h=l*s,d=e.subarray(h,h+s),f=[],p=0;p<d.length;p++)f.push({value:d[p],index:p});f.sort((function(e,t){return t.value-e.value}));for(var m=l*r,v=u.subarray(m,m+r),g=c.subarray(m,m+r),y=0;y<r;y++)v[y]=f[y].value,g[y]=f[y].index}var b=t.slice();return b[b.length-1]=r,[Object(rv.buffer)(b,n,u),Object(rv.buffer)(b,"int32",c)]}function dT(e,t,n,r){for(var a=rv.util.parseAxisParam(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var s=a+1;s<n.length;s++)i[2]*=n[s];for(var u={},c=new Int32Array(n[a]),l=new rv.TensorBuffer(i,r,e),h=[],d=1===i[0]&&1===i[2],f=0;f<n[a];f++){var p=void 0;if(d)p=e[f].toString();else{for(var m=[],v=0;v<i[0];v++)for(var g=0;g<i[2];g++)m.push(l.get(v,f,g));p=m.join(",")}if(void 0!==u[p])c[f]=u[p];else{var y=Object.keys(u).length;u[p]=y,c[f]=y,h.push(f)}}var b=i.slice();b[1]=Object.keys(u).length;var k=new rv.TensorBuffer(b,r);h.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)k.set(l.get(n,e,r),n,t,r)}));var _=n.slice();return _[a]=b[1],{outputValues:k.values,outputShape:_,indices:c}}for(var fT=0,pT=[xw,Ow,Tw,Ew,yw,Nw,jw,Fw,Mw,Pw,zw,Vw,Uw,Kw,Xw,Jw,$w,ex,tx,ww,nx,ox,cx,dw,fx,mx,sw,vx,_x,Cx,Ox,xx,Tx,Ix,Sx,Nx,Rx,Dx,jx,Fx,Mx,Lx,zx,Bx,Vx,Wx,Hx,Ux,gC,K_,Gx,Xx,nC,iC,sC,lC,CC,SC,TC,NC,DC,jC,FC,MC,LC,VC,HC,X_,GC,bx,qC,ZC,QC,Y_,eO,rO,iO,uO,lO,fO,mO,yO,bO,kO,SO,TO,IO,EO,NO,AO,xO,jO,FO,LO,zO,WO,GO,pC,qO,ZO,QO,$O,nS,rS,oS,uS,cS,dS,ew,pS,vS,lw,yS,nw,aw,kw,bS,kS,_S,wS,xS,CS,SS,ES,AS,RS,MS,LS,BS,WS,HS,ix,HO,qS,XS,ZS,YS,JS,$S,nT,aT,oT,_C,DO,uT,{kernelName:rv.Tanh,backendName:"cpu",kernelFunc:cT},{kernelName:rv.Tile,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;B_(a,"tile");var o=lT(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},{kernelName:rv.TopK,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k;B_(a,"topk");var o=_slicedToArray(hT(n.data.get(a.dataId).values,a.shape,a.dtype,i),2),s=o[0],u=o[1];return[n.makeTensorInfo(s.shape,s.dtype,s.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}},Dw,{kernelName:rv.Unique,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;B_(i,"unique");var o=dT(r.data.get(i.dataId).values,a,i.shape,i.dtype),s=o.outputValues,u=o.outputShape,c=o.indices;return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}},{kernelName:rv.Unpack,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,s=a.shape[i],u=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(u[c++]=a.shape[l]);var h=new Array(o).fill(0),d=a.shape.slice();d[i]=1;for(var f=new Array(s),p=0;p<f.length;p++){h[i]=p;var m=ax({inputs:{x:a},backend:n,attrs:{begin:h,size:d}});f[p]=bw({inputs:{x:m},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(m)}return f}},{kernelName:rv.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;B_(a,"unsortedSegmentSum");for(var s=[],u=[],c=a.shape.length-i.shape.length,l=i,h=0;h<c;++h){var d=oC({inputs:{input:l},backend:n,attrs:{dim:h+1}});l=d,u.push(d)}for(var f=0;f<o;++f){var p=rv.util.createScalarValue(f,"int32"),m=n.makeTensorInfo([],"int32",p),v=qx({inputs:{a:m,b:l},backend:n}),g=hw({inputs:{x:v},backend:n,attrs:{dtype:"float32"}}),y=fC({inputs:{a:g,b:a},backend:n}),b=RO({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});s.push(b),u.push(m),u.push(v),u.push(g),u.push(y),u.push(b)}var k=sS({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),k}},iS];fT<pT.length;fT++){var mT=pT[fT];Object(rv.registerKernel)(mT)}var vT,gT,yT,bT={},kT={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function _T(e){if(!(e in bT)){var t=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete bT[e]}),!1),1===e?t.getContext("webgl",kT)||t.getContext("experimental-webgl",kT):t.getContext("webgl2",kT)}(e);if(null===t)return console.log("Could not get context for WebGL version",e),null;bT[e]=t}var n=bT[e];return n.isContextLost()?(delete bT[e],_T(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),bT[e])}function wT(e,t){return[t,e]}function xT(e){var t=rv.util.sizeFromShape(e),n=Math.ceil(t/4);return rv.util.sizeToSquarishShape(n)}function CT(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function OT(e,t){var n,r,a,i,o,s,u,c,l,h=e;return 2===Object(rv.env)().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,s=4,u=1,c=h.HALF_FLOAT,l=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function ST(e,t){var n=t();return Object(rv.env)().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}(e,t))}(e),n}function TT(e){return!!(Object(rv.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function IT(e,t){return PT(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(vT||(vT={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(gT||(gT={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(yT||(yT={}));var ET,NT,AT=/ERROR: [0-9]+:([0-9]+):/g;function RT(e,t){if(ST(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function DT(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(ST(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),ST(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),ST(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function jT(e,t,n){ST(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),ST(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function FT(e,t){ST(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),ST(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function MT(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}(e,t))}function PT(e,t,n){var r=ST(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function LT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return rv.util.sizeFromShape(e.slice(0,e.length-t))}function zT(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function BT(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[LT(e)].concat(_toConsumableArray(zT(e)))),t}function VT(e){return e%2==0}function WT(e,t){if(e=e.slice(-2),t=t.slice(-2),rv.util.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(VT(n)&&VT(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&VT(e[0])&&VT(t[0])}function UT(e,t){return null!=e.getExtension(t)}function HT(e){try{if(null!=_T(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function GT(e){var t=OT(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function KT(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&rv.util.assert("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors in the WebGL backend."}))}))}var qT=Object(rv.env)();function XT(){var e,t,n,r,a,i,o,s,u,c;return 2===Object(rv.env)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function ZT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=rv.util.computeStrides(t);return r.map((function(t,a){return"int ".concat(e[a]," = ").concat(n," / ").concat(t,"; ").concat(a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t),";")})).join("")}function YT(e){var t=rv.util.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}qT.registerFlag("HAS_WEBGL",(function(){return qT.getNumber("WEBGL_VERSION")>0})),qT.registerFlag("WEBGL_VERSION",(function(){return HT(2)?2:HT(1)?1:0})),qT.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),qT.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===qT.get("WEBGL_VERSION")})),qT.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),qT.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),qT.registerFlag("WEBGL_PACK",(function(){return qT.getBool("HAS_WEBGL")})),qT.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_PACK_CLIP",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),qT.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_PACK_REDUCE",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_CONV_IM2COL",(function(){return qT.getBool("WEBGL_PACK")})),qT.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==ET){var t=_T(e);ET=t.getParameter(t.MAX_TEXTURE_SIZE)}return ET}(qT.getNumber("WEBGL_VERSION"))})),qT.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==NT){var t=_T(e);NT=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,NT)}(qT.getNumber("WEBGL_VERSION"))})),qT.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=qT.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=_T(e);return UT(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:UT(t,"EXT_disjoint_timer_query")?1:0}(e)})),qT.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return qT.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!rv.device_util.isMobile()})),qT.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=_T(e);if(1===e){if(!UT(t,"OES_texture_float"))return!1}else if(!UT(t,"EXT_color_buffer_float"))return!1;return GT(t)}(qT.getNumber("WEBGL_VERSION"))})),qT.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!qT.getBool("WEBGL_FORCE_F16_TEXTURES")&&qT.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),qT.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return function(e){if(0===e)return!1;var t=_T(e);if(1!==e){if(UT(t,"EXT_color_buffer_float"))return GT(t);if(UT(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=OT(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),i}(t,n)}return!1}return!!UT(t,"OES_texture_float")&&!!UT(t,"WEBGL_color_buffer_float")&&GT(t)}(qT.getNumber("WEBGL_VERSION"))})),qT.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=qT.getNumber("WEBGL_VERSION"))&&null!=_T(e).fenceSync;var e})),qT.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return qT.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),qT.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ".concat(e,"."))}));var QT="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",JT=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=vT.DENSE;var n=xT(t),r=XT();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(ZT(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},$T=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=vT.DENSE;var n=xT(t),r=XT();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(ZT(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},eI=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.outTexUsage=gT.DOWNLOAD;var n=XT();this.outputShape=t,this.userCode="\n      ".concat(QT,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},tI=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=gT.DOWNLOAD;var n=XT();this.outputShape=t,this.userCode="\n      ".concat(QT,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},nI=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.variableNames=["A"];var a=XT(),i=_slicedToArray(n,2),o=i[0],s=i[1];this.outputShape=t;var u="result";r&&(u="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(YT(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(s,";\n        int c = imod(flatIndex, ").concat(s,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(u,", 0., 0., 0.);\n      }\n    ")},rI=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=XT(),i=_slicedToArray(n,2),o=i[0],s=i[1];this.outputShape=t;var u="",c="result";r&&(c="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var h=0;h<=1;h++){var d=2*l+h;u+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(h," < ").concat(t[2],") {\n            localCoords[2] += ").concat(h,";\n            if(localCoords[1] + ").concat(l," < ").concat(t[1],") {\n              localCoords[1] += ").concat(l,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(s,";\n              c = imod(flatIndex, ").concat(s,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(d,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(d,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(d,"] = values[2];\n              } else {\n                result[").concat(d,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(YT(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(u,"\n\n        ").concat(a.output," = ").concat(c,";\n      }\n    ")};function aI(e,t,n,r,a,i){!function(e,t){var n=Object(rv.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error("Requested texture size [".concat(e,"x").concat(t,"] is invalid."));if(e>n||t>n)throw new Error("Requested texture size [".concat(e,"x").concat(t,"] greater than WebGL maximum on this browser / GPU [").concat(n,"x").concat(n,"]."))}(t,n);var o=function(e){return PT(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return ST(e,(function(){return e.bindTexture(s,o)})),ST(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),ST(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),ST(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),ST(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),ST(e,(function(){return e.texImage2D(s,0,r,t,n,0,a,i,null)})),ST(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),o}function iI(e){return e.internalFormatFloat}function oI(e){return e.internalFormatHalfFloat}function sI(e){return e.downloadTextureFormat}function uI(e){return e.internalFormatPackedFloat}function cI(e){return e.internalFormatPackedHalfFloat}var lI=function(){function e(t){_classCallCheck(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Object(rv.env)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){bT[e]=t}(n,t)):this.gl=_T(n);var r="WEBGL_color_buffer_float";if(1===Object(rv.env)().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=IT(this.gl,"OES_texture_float"),UT(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=IT(this.gl,"OES_texture_half_float");else if(Object(rv.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),UT(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=IT(this.gl,"EXT_color_buffer_half_float");else if(Object(rv.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",UT(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!UT(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=function(e){return function(e,t){var n=PT(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return ST(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),ST(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl),this.indexBuffer=function(e){return function(e,t){var n=PT(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return ST(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),ST(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}(this.gl),this.framebuffer=function(e){return PT(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=OT(this.gl,this.textureHalfFloatExtension)}var t;return _createClass(e,[{key:"debug",get:function(){return Object(rv.env)().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;ST(t,(function(){return t.finish()})),ST(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),ST(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),ST(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),ST(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),ST(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_slicedToArray(wT(t,n),2);return aI(e,a[0],a[1],iI(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_slicedToArray(wT(t,n),2);return aI(e,a[0],a[1],oI(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_slicedToArray(wT(t,n),2);return aI(e,a[0],a[1],sI(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){ST(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?ST(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):ST(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),ST(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;ST(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),ST(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),ST(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_slicedToArray(CT(t,n),2);return aI(e,a[0],a[1],cI(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_slicedToArray(CT(t,n),2);return aI(e,a[0],a[1],uI(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(FT(this.gl,this.framebuffer),this.outputTexture=null),ST(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=_slicedToArray(wT(t,n),2),i=a[0],o=a[1],s=new Uint8Array(t*n*4);return ST(e,(function(){return e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return function(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=_slicedToArray(CT(e,t),2);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}(this.gl,e,0,0,0,a,i)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();ST(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return ST(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),ST(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),ST(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(Object(rv.env)().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return ST(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=function(e,t){var n=PT(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(ST(e,(function(){return e.shaderSource(n,t)})),ST(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=AT.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return rv.util.rightPad((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),h=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+rv.util.rightPad(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(t,e),r=function(e){var t=XT();return function(e,t){var n=PT(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(ST(e,(function(){return e.shaderSource(n,t)})),ST(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}(t),a=function(e){return PT(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t);return ST(t,(function(){return t.attachShader(a,r)})),ST(t,(function(){return t.attachShader(a,n)})),function(e,t){if(ST(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,a),this.debug&&RT(t,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return ST(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),DT(e,t,"clipSpacePos",n,3,20,0)&&DT(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&ST(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&RT(this.gl,this.program),ST(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n){return PT(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),ST(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),function(e,t,n,r){ST(e,(function(){return function(e,t,n){(function(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE".concat(n,"]."))})(e,n),ST(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),ST(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),ST(e,(function(){return e.uniform1i(n,r)}))}(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=_slicedToArray(CT(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&RT(this.gl,this.program),MT(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),ST(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),ST(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=IT(this.gl,2===Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rv.util.repeatedTry((function(){return n.disposed||n.isQueryAvailable(t,Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||rv.util.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),jT(this.gl,e,this.framebuffer),this.debug&&MT(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(jT(this.gl,this.outputTexture,this.framebuffer),this.debug&&MT(this.gl)):FT(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;jT(r,e,this.framebuffer),this.debug&&MT(r),this.outputTexture=e,ST(r,(function(){return r.viewport(0,0,t,n)})),ST(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),ST(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}(),hI=rv.backend_util.getBroadcastDims,dI="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",fI="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",pI="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",mI="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function vI(e){return"offset"+e}function gI(e){var t=e.name,n=rv.util.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function yI(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function bI(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function kI(e,t){return t.map((function(t){return e[t]})).join(", ")}function _I(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but was executed with ").concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!rv.util.arraysEqual(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!rv.util.arraysEqual(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape ".concat(o," and ").concat(s," must match"))}}))}var wI=r.addImpl,xI=r.bincountImpl,CI=r.bincountReduceImpl,OI=r.ceilImpl,SI=r.concatImpl,TI=r.expImpl,II=r.expm1Impl,EI=r.floorImpl,NI=r.gatherV2Impl,AI=r.greaterImpl,RI=r.lessImpl,DI=r.linSpaceImpl,jI=r.logImpl,FI=r.maxImpl,MI=r.maximumImpl,PI=r.minimumImpl,LI=r.multiplyImpl,zI=r.negImpl,BI=r.prodImpl,VI=r.rangeImpl,WI=r.rsqrtImpl,UI=r.simpleAbsImpl,HI=r.sliceImpl,GI=r.stridedSliceImpl,KI=r.subImpl,qI=r.tileImpl,XI=r.topKImpl,ZI=r.transposeImpl,YI=r.uniqueImpl;function QI(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function JI(e,t){return 1===t?[e]:QI(e,t)}var $I=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=JI("rc",n),a=yI(n),i=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),s=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i=t[t.length-1-o]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0"):"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(s,"));\n          }\n        }\n      ")}},eE=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r,a="",i=0;i<4;i++){var o="thisRC = rc;";i%2==1&&(o+="thisRC.z += 1;"),i>1&&(o+="thisRC.y += 1;"),a+="\n        ".concat(o,"\n        ").concat(i>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(i,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(i>0?"}":"","\n      ")}this.userCode="\n      ".concat((r=n,"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(ZT(["r","c","d"],r),"\n      return ivec3(r, c, d);\n    }\n  ")),"\n      ").concat(YT(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(a,"\n\n        setOutput(result);\n      }\n    ")},tE=function(){function e(t){_classCallCheck(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return _createClass(e,[{key:"acquireTexture",value:function(e,t,n){var r=rE(t,n),a=aE(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=nE(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return r===yT.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===yT.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===yT.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===yT.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===yT.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=rE(n,r),i=aE(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=nE(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=Object(rv.env)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var u=this.usedTextures[i],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(this.numFreeTextures+this.numUsedTextures,")"));var e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: "+this._numBytesAllocated),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function nE(e,t,n,r,a){var i,o=function(e,t){switch(e){case yT.PACKED_2X2_FLOAT32:return uI(t);case yT.PACKED_2X2_FLOAT16:return cI(t);case yT.UNPACKED_FLOAT32:return iI(t);case yT.UNPACKED_FLOAT16:return oI(t);case yT.PACKED_4X1_UNSIGNED_BYTE:return sI(t);default:throw new Error("Unknown physical texture type "+e)}}(t,r);if(a){var s=_slicedToArray(CT(e[0],e[1]),2);i=s[0]*s[1]}else{var u=_slicedToArray(wT(e[0],e[1]),2);i=u[0]*u[1]}return i*function(e,t){if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===e.RGBA16F)return 8;throw new Error("Unknown internal format "+t)}(n,o)}function rE(e,t){if(e===gT.UPLOAD)return yT.PACKED_2X2_FLOAT32;if(e===gT.RENDER||null==e)return function(e){return Object(rv.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?yT.PACKED_2X2_FLOAT32:yT.UNPACKED_FLOAT32:e?yT.PACKED_2X2_FLOAT16:yT.UNPACKED_FLOAT16}(t);if(e===gT.DOWNLOAD||e===gT.PIXELS)return yT.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function aE(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var iE=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},oE="return abs(x);",sE="return x;",uE=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},cE=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=JI("rc",n),a=yI(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")},lE=rv.kernel_impls.whereImpl,hE={},dE=function(e){_inherits(i,e);var t,n,r,a=_createSuper(i);function i(e){var t,n;if(_classCallCheck(this,i),(t=a.call(this)).pendingRead=new WeakMap,t.pendingDisposal=new WeakSet,t.dataRefCount=new WeakMap,t.numBytesInGPU=0,t.uploadWaitMs=0,t.downloadWaitMs=0,t.warnedAboutMemory=!1,t.warnedAboutCPUBackend=!1,t.pendingDeletes=0,t.disposed=!1,!Object(rv.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var r=_T(Object(rv.env)().getNumber("WEBGL_VERSION"));t.binaryCache=((n=Object(rv.env)().getNumber("WEBGL_VERSION"))in hE||(hE[n]={}),hE[n]),t.gpgpu=new lI(r),t.canvas=r.canvas,t.gpgpuCreatedLocally=!0}else t.gpgpu=e,t.binaryCache={},t.gpgpuCreatedLocally=!1,t.canvas=e.gl.canvas;return t.textureManager=new tE(t.gpgpu),t.numMBBeforeWarning=null==Object(rv.env)().global.screen?1024:Object(rv.env)().global.screen.height*Object(rv.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,t.texData=new rv.DataStorage(_assertThisInitialized(t),Object(rv.engine)()),_possibleConstructorReturn(t)}return _createClass(i,[{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((Object(rv.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(rv.env)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:gT.UPLOAD,refCount:1,complexParentRefCount:0}),r}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"decComplexRef",value:function(e){if(this.texData.has(e)){var t=this.texData.get(e);t.complexParentRefCount>0&&t.refCount--}}},{key:"move",value:function(e,t,n,r){if(Object(rv.env)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:gT.UPLOAD,refCount:1,complexParentRefCount:0})}},{key:"disposeIntermediateTensorInfo",value:function(e){var t=e.dataId;if(this.texData.has(t)){var n=this.texData.get(t);n.refCount--,n.refCount<1&&this.disposeData(t)}}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new uE(o,sE):new iE(o,sE);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,d,f=null!=this.activeTimers;if(f&&(h=rv.util.now()),"complex64"===r){var p=this.readSync(a.real.dataId),m=this.readSync(a.imag.dataId);d=rv.backend_util.mergeRealAndImagArrays(p,m)}else d=this.getValuesFromTexture(e);return f&&(this.downloadWaitMs+=rv.util.now()-h),this.convertAndCacheOnCPU(e,d)}},{key:"read",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,s,u,c,l,h,d,f,p,m,v,g,y,b,k,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,s=r.dtype,u=r.complexTensorInfos,c=r.isPacked,null==o){e.next=8;break}return l=c?new uE(i,sE):new iE(i,sE),h=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:s}],s),d=this.read(h.dataId),e.abrupt("return",(this.disposeIntermediateTensorInfo(h),d));case 8:if(null==a){e.next=10;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 10:if(Object(rv.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==Object(rv.env)().getNumber("WEBGL_VERSION")){e.next=12;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 12:if(m=null,"complex64"!==s&&Object(rv.env)().get("WEBGL_BUFFER_SUPPORTED")&&(f=this.decode(t),g=this.texData.get(f.dataId),m=(v=this.gpgpu).createBufferFromTexture.apply(v,[g.texture].concat(_toConsumableArray(xT(i))))),this.pendingRead.set(t,[]),e.t0="complex64"!==s,!e.t0){e.next=19;break}return e.next=19,this.gpgpu.createAndWaitForFence();case 19:if("complex64"!==s){e.next=26;break}return e.next=22,Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]);case 22:y=e.sent,p=rv.backend_util.mergeRealAndImagArrays(y[0],y[1]),e.next=27;break;case 26:null==m?p=this.getValuesFromTexture(t):(b=rv.util.sizeFromShape(i),p=this.gpgpu.downloadFloat32MatrixFromBuffer(m,b));case 27:return null!=f&&this.disposeIntermediateTensorInfo(f),k=this.convertAndCacheOnCPU(t,p),_=this.pendingRead.get(t),e.abrupt("return",(this.pendingRead.delete(t),_.forEach((function(e){return e(k)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),k));case 30:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return rv.util.decodeString(e)}))}catch(cz){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(rv.buffer)(e.shape,e.dtype,n)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!TT(n)){if(Object(rv.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"));throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=rv.util.sizeFromShape(n);if(Object(rv.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,s=this.decode(e),u=this.texData.get(s.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[u.texture].concat(_toConsumableArray(xT(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),c}var l=Object(rv.env)().getBool("WEBGL_PACK")&&!0===a,h=l?BT(n):n,d=l?new tI(h):new eI(h),f=this.runWebGLProgram(d,[{shape:h,dtype:r,dataId:e}],"float32"),p=this.texData.get(f.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture,p.texShape[0],p.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(f),m}},{key:"time",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t(),i=rv.util.flatten(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=rv.util.flatten(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,a&&(this.programTimersStack=null),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=13;break}return e.next=9,Promise.all(i);case 9:u=e.sent,s.kernelMs=rv.util.sum(u),s.getExtraProfileInfo=function(){return u.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=14;break;case 13:s.kernelMs={error:"WebGL query timers are not supported in this environment."};case 14:return e.abrupt("return",(this.uploadWaitMs=0,this.downloadWaitMs=0,s));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:rv.util.now(),endMs:null}}},{key:"endTimer",value:function(e){return Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=rv.util.now(),e)}},{key:"getQueryTime",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(rv.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(t):t.endMs-t.startMs);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"disposeData",value:function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e))if(this.texData.get(e).complexParentRefCount>0)this.texData.get(e).refCount--;else{this.releaseGPUData(e);var t=this.texData.get(e).complexTensorInfos;null!=t&&(this.texData.get(t.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(t.real),this.texData.get(t.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(t.imag)),this.texData.delete(e)}}}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"getCPUBackend",value:function(){return Object(rv.env)().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Object(rv.engine)().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128,r=this.getCPUBackend();return Object(rv.env)().getBool("IS_TEST")||this.warnedAboutCPUBackend||null!=r||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=r&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&rv.util.sizeFromShape(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){rv.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return lE(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new uE(e.shape,t);return this.compileAndRun(r,[e],n)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=UI(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Object(rv.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,oE,e.dtype);var n=new iE(e.shape,oE);return this.compileAndRun(n,[e])}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&rv.util.isString(n[0])){var a=n.map((function(e){return rv.util.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){var r=this.makeTensorInfo(e,t,n).dataId;return Object(rv.engine)().makeTensorFromDataId(r,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new cE(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new $I(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[LT(e.shape)].concat(_toConsumableArray(zT(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[LT(t)].concat(_toConsumableArray(zT(t))),i=new eE(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=BT(a);return t=r?new $T(o):new JT(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===vT.DENSE){var u=xT(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===rv.util.sizeFromShape(o.shape))return s.values=rv.util.getTypedArrayFromDType(o.dtype,0),o;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&rv.util.sizeFromShape(t.shape)<=Object(rv.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),c.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!WT(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),c.push(t),n=a.texData.get(t.dataId),r.shape=i}return a.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var h,d={shape:o.shape,texData:s,isUniform:!1},f=function(e,t,n){var r="";t.concat(n).forEach((function(e){r+="".concat(e.shape,"_").concat(e.isUniform?"uniform":e.texData.texShape,"_").concat(null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0)}));var a=e.constructor.name;return a+="_"+r+"_"+e.userCode}(e,l,d),p=this.getAndSaveBinary(f,(function(){return function(e,t,n,r){var a=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=function(e,t,n,r){var a=[];e.forEach((function(e){var t=rv.util.sizeFromShape(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";")))}));var i,o,s=a.join("\n"),u=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";return r+=n?function e(t){switch(t.shapeInfo.logicalShape.length){case 0:return n=t.name,"\n    vec4 ".concat("get"+n.charAt(0).toUpperCase()+n.slice(1),"() {\n      return ").concat(XT().texture2D,"(").concat(n,", halfCR);\n    }\n  ");case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=XT();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(t);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],s=XT();if(null!=a&&rv.util.arraysEqual(t,a))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n\n        return ").concat(s.texture2D,"(").concat(n,", uv);\n      }\n    ");var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(Math.ceil(t[1]/2),", ").concat(u[0],", ").concat(u[1],", row, col);\n      return ").concat(s.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t);case 3:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var s=bI(t,n.slice(1));return"\n        ".concat(e(s),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(kI(["b","row","col"],[1,2]),");\n        }\n      ")}var u=o[0],c=o[1],l=Math.ceil(n[2]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(c,", ").concat(l*Math.ceil(n[1]/2),", ").concat(l,", b, row, col);\n      return ").concat(XT().texture2D,"(").concat(r,", uv);\n    }\n  ")}(t);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),h="int b, int row, int col",d="b * ".concat(l," + (row / 2) * ").concat(c," + (col / 2)"),f=2;f<n-1;f++)h="int b".concat(f,", ")+h,l*=t[n-f-1],d="b".concat(f," * ").concat(l," + ")+d;return"\n    vec4 ".concat(a,"(").concat(h,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(s,");\n      return ").concat(XT().texture2D,"(").concat(r,", uv);\n    }\n  ")}(t)}var n}(e):function e(t){var n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=_slicedToArray(e.shapeInfo.texShape,2),a=r[0],i=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=_slicedToArray(e.shapeInfo.texShape,2),s=o[0],u=o[1];return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", ").concat(vI(t),");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(t);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(gI(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=vI(t);return 1===i?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):1===a?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(t);case 2:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(null!=i&&rv.util.arraysEqual(n,i))return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(i[1],".0, ").concat(i[0],".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var o=rv.util.squeezeShape(n),s=o.newShape,u=o.keptDims;if(s.length<n.length){var c=bI(t,s);return"\n      ".concat(e(c),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(kI(["row","col"],u),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(gI(t),"\n      }\n    ");var l=i[0],h=i[1],d=vI(r);return 1===h?"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(l,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):1===l?"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(h,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(l,", ").concat(h,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(t);case 3:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],s=rv.util.squeezeShape(n),u=s.newShape,c=s.keptDims;if(u.length<n.length){var l=bI(t,u);return"\n        ".concat(e(l),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(kI(["row","col","depth"],c),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(gI(t),"\n      }\n    ");var h=t.shapeInfo.texShape,d=h[0],f=h[1],p=t.shapeInfo.flatOffset;return f===i&&null==p?"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(f,".0, ").concat(d,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      "):f===o&&null==p?"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(f,".0, ").concat(d,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(vI(r),";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(f,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(t);case 4:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,u=rv.util.squeezeShape(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=bI(t,c);return"\n      ".concat(e(h),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(kI(["row","col","depth","depth2"],l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(gI(t),"\n      }\n    ");var d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,p=f[0],m=f[1];return m===s&&null==d?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):m===i&&null==d?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(m,", index + ").concat(vI(r),");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(t);case 5:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[4],o=n[3]*i,s=n[2]*o,u=n[1]*s,c=rv.util.squeezeShape(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var d=bI(t,l);return"\n      ".concat(e(d),"\n      float ").concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(a,"(").concat(kI(["row","col","depth","depth2","depth3"],h),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(s,", ").concat(o,", ").concat(i,")) +\n          depth3;\n        ").concat(gI(t),"\n      }\n    ");var f=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,m=p[0],v=p[1];return v===u&&null==f?"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):v===i&&null==f?"\n      float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3],",\n               ").concat(n[2]*n[3],", ").concat(n[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," + depth * ").concat(o," +\n          depth2 * ").concat(i," + depth3 + ").concat(vI(r),";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(t);case 6:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=rv.util.squeezeShape(n),o=i.newShape,s=i.keptDims;if(o.length<n.length){var u=bI(t,o);return"\n      ".concat(e(u),"\n      float ").concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(a,"(").concat(kI(["row","col","depth","depth2","depth3","depth4"],s),");\n      }\n    ")}var c=n[5],l=n[4]*c,h=n[3]*l,d=n[2]*h,f=n[1]*d;if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(f,", ").concat(d,", ").concat(h,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(gI(t),"\n      }\n    ");var p=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,v=m[0],g=m[1];return g===f&&null==p?"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(d,", ").concat(h,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):g===c&&null==p?"\n      float ".concat(a,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3]*n[4],",\n               ").concat(n[2]*n[3]*n[4],",\n               ").concat(n[3]*n[4],",\n               ").concat(n[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(f," + col * ").concat(d," + depth * ").concat(h," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(vI(r),";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(t);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(e),e.shapeInfo.logicalShape.length<=t.logicalShape.length&&(r+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=hI(e.shapeInfo.logicalShape,t.logicalShape),c=yI(s),l=s-o,h=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(h[e+l]," = 0;")})).join("\n");var d;d=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+h[t+l]})).join(", ");var f="return outputValue;",p=1===rv.util.sizeFromShape(e.shapeInfo.logicalShape),m=1===rv.util.sizeFromShape(t.logicalShape);if(1!==o||p||m){if(p&&!m)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var v=o-2,g=o-1;u.indexOf(v)>-1&&u.indexOf(g)>-1?f="return vec4(outputValue.x);":u.indexOf(v)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(d,");\n      ").concat(f,"\n    }\n  ")}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.shapeInfo.logicalShape.length,o=t.logicalShape.length;if(!e.shapeInfo.isUniform&&i===o&&null==e.shapeInfo.flatOffset&&rv.util.arraysEqual(e.shapeInfo.texShape,t.texShape))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var s,u=yI(o),c=hI(e.shapeInfo.logicalShape,t.logicalShape),l=o-i,h=["x","y","z","w","u","v"];s=0===i?"":o<2&&c.length>=1?"coords = 0;":c.map((function(e){return"coords.".concat(h[e+l]," = 0;")})).join("\n");var d;return d=o<2&&i>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+h[t+l]})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(u," coords = getOutputCoords();\n      ").concat(s,"\n      return get").concat(r,"(").concat(d,");\n    }\n  ")}(e,t)),r}(e,t,r)})).join("\n"),c=t.texShape,l=XT(),h=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(l),d=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(dI,"\n    ").concat(fI,"\n    ").concat(pI,"\n  ")}(l);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return n=t,1===(r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    "):1===r[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ");case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(rv.util.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",u=2;u<e.length-1;u++)i*=e[e.length-u-1],o="\n      int b".concat(u," = index / ").concat(i,";\n      index -= b").concat(u," * ").concat(i,";\n    ")+o,s="b".concat(u,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t)}var n,r}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(l)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(n=t)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(n[1],".0);\n      }\n    "):1===n[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(n[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return resTexRC.x * ").concat(n[1]," + resTexRC.y;\n    }\n  ");case 2:return function(e,t){return rv.util.arraysEqual(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    "):1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=ZT(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=ZT(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=ZT(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=ZT(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(l)),r&&(d+=mI),[d,h,o,s,i,u,n].join("\n")}(i,s,a,t.packedInputs),c=e.createProgram(u),l=null,h=e.getUniformLocation(c,"NAN",!1);1===Object(rv.env)().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var d={},f=0;f<t.variableNames.length;f++){var p=t.variableNames[f];d[p]=e.getUniformLocation(c,p,!1),d["offset"+p]=e.getUniformLocation(c,"offset"+p,!1)}return{program:t,source:u,webGLProgram:c,uniformLocations:d,inShapeInfos:o,outShapeInfo:s,infLoc:l,nanLoc:h}}(a.gpgpu,e,l,d)})),m=null!=this.activeTimers;if(m&&(h=this.startTimer()),function(e,t,n,r,a){_I(t.inShapeInfos,n),_I([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===Object(rv.env)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset"+a];if(null!=i)if(n.isUniform)if(rv.util.sizeFromShape(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,p,l,d,r),c.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),m&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)})),!Object(rv.env)().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var v=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),v}return o}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=this.runWebGLProgram(e,t,n=n||t[0].dtype,r,a);return Object(rv.engine)().makeTensorFromDataId(i.dataId,i.shape,i.dtype)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;this.disposed||(Object(rv.env)().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(rv.tidy)((function(){if(!Object(rv.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=Object(rv.env)().getBool("DEBUG");Object(rv.env)().set("DEBUG",!1);var n=e.abs(Object(rv.scalar)(1e-8)).dataSync()[0];if(Object(rv.env)().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,s=t.isPacked;if(null==i){var u,c=null!=this.activeTimers;c&&(u=rv.util.now());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(rv.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?rv.util.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=rv.util.squeezeShape(e);e=r.newShape}var a=rv.util.sizeFromShape(e);if(e.length<=1&&a<=n)return[1,a];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var i,o=LT(e),s=2,u=2;return e.length&&(s=(i=_slicedToArray(zT(e),2))[0],u=i[1]),a=o*(s/2)*(u/2),rv.util.sizeToSquarishShape(a).map((function(e){return 2*e}))}return rv.util.sizeToSquarishShape(a)}(n,s),t.texShape=l),null!=a){var h,d,f=BT(n),p=l[1],m=l[0],v=a instanceof Uint8Array;s?(p=(h=_slicedToArray(CT(l[0],l[1]),2))[0],m=h[1],d=new rI(f,[m,p],v)):d=new nI(f,[m,p],v);var g=this.makeTensorInfo([m,p],r);this.texData.get(g.dataId).usage=v?gT.PIXELS:gT.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),p,m,a);var y=this.runWebGLProgram(d,[g],r,null,!0),b=this.texData.get(y.dataId);t.texture=b.texture,t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,this.disposeIntermediateTensorInfo(g),this.texData.delete(y.dataId),t.values=null,c&&(this.uploadWaitMs+=rv.util.now()-u)}else{var k=this.acquireTexture(l,o,r,s);t.texture=k}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, most likely due to a memory leak"))}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*rv.util.bytesPerElement(t)}}]),i}(rv.KernelBackend);rv.device_util.isBrowser()&&Object(rv.registerBackend)("webgl",(function(){return new dE}),2);var fE=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["A","B"],this.outputShape=rv.backend_util.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},pE=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=rv.backend_util.assertAndGetBroadcastShape(n,r);var i=this.outputShape.length,o="";if(a)if(0===i||1===rv.util.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          ".concat(yI(i)," coords = getOutputCoords();\n        "),1===i)o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var s=JI("coords",i);o+="\n            bool nextRowOutOfBounds =\n              (".concat(s[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(s[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")};function mE(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var vE={kernelName:rv.Identity,backendName:"webgl",kernelFunc:mE};function gE(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=mE({inputs:{x:r},backend:n});n.texData.get(s.dataId).complexParentRefCount++;var u=mE({inputs:{x:a},backend:n});return n.texData.get(u.dataId).complexParentRefCount++,o.complexTensorInfos={real:s,imag:u},i}var yE={kernelName:rv.Complex,backendName:"webgl",kernelFunc:gE},bE="return (a < 0.) ? b * a : a;",kE="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",_E={kernelName:rv.LeakyRelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",rv.util.createScalarValue(i,"float32")),s=Object(rv.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pE(kE,a.shape,o.shape):new fE(bE,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],a.dtype);return n.disposeIntermediateTensorInfo(o),u}},wE="return (a < 0.) ? b * a : a;",xE="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",CE={kernelName:rv.Prelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=Object(rv.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pE(xE,r.shape,a.shape):new fE(wE,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}};function OE(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,s=e.backend,u=o.x,c=s,l=a||u.dtype;if(c.shouldExecuteOnCPU([u])&&null!=r){var h=c.texData.get(u.dataId),d=r(h.values,l);return c.makeTensorInfo(u.shape,l,d)}return i=Object(rv.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new uE(u.shape,n):new iE(u.shape,t),c.runWebGLProgram(i,[u],l)}}function SE(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,s=e.cpuKernelImpl,u=e.dtype;return function(e){var r=e.inputs,i=e.backend,c=r.a,l=r.b,h=i;if(o&&"complex64"===c.dtype){var d=h.texData.get(c.dataId),f=h.texData.get(l.dataId),p=[[d.complexTensorInfos.real,f.complexTensorInfos.real],[d.complexTensorInfos.imag,f.complexTensorInfos.imag]].map((function(e){var n=_slicedToArray(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o={dataId:a.dataId,dtype:a.dtype,shape:l.shape},s=new fE(t,c.shape,l.shape);return h.runWebGLProgram(s,[i,o],Object(rv.upcastType)(r.dtype,a.dtype))})),m=_slicedToArray(p,2),v=m[0],g=m[1],y=gE({inputs:{real:v,imag:g},backend:h});return h.disposeIntermediateTensorInfo(v),h.disposeIntermediateTensorInfo(g),y}var b,k=u||Object(rv.upcastType)(c.dtype,l.dtype);if(h.shouldExecuteOnCPU([c,l])&&null!=s){var _=h.texData.get(c.dataId),w=h.texData.get(l.dataId),x=_slicedToArray(s(c.shape,l.shape,_.values,w.values,k),2),C=x[0],O=x[1],S=h.makeTensorInfo(O,k);return h.texData.get(S.dataId).values=C,S}return b=Object(rv.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new pE(n,c.shape,l.shape,a):new fE(t,c.shape,l.shape),h.runWebGLProgram(b,[c,l],k)}}function TE(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n";if("prelu"===e)return t?xE:wE;if("leakyrelu"===e)return t?kE:bE;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var IE=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];_classCallCheck(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;var l=Math.ceil((a?t[1]:t[2])/2),h=a?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",f=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",v="";s&&(m=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),v="result = activation(result);");var g=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");var y="rc.x",b="rc.x";t[0]<n[0]?y="int(min(float(rc.x), ".concat(t[0]-1,".))"):n[0]<t[0]&&(b="int(min(float(rc.x), ".concat(n[0]-1,".))")),this.userCode="\n      ".concat(m,"\n\n      const float sharedDimension = ").concat(l,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(l,"; i++) {\n          int batchA = ").concat(y,";\n          int batchB = ").concat(b,";\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(f[0]," * ").concat(p[0],");\n          result += (").concat(f[1]," * ").concat(p[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(g,"\n\n        ").concat(v,"\n\n        setOutput(result);\n      }\n    ")},EE=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=rv.backend_util.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},NE="return a * b;";function AE(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=rv.backend_util.upcastType(a.dtype,i.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),u=r.texData.get(i.dataId),c=new EE("return areal * breal - aimag * bimag;",a.shape,i.shape),l=new EE("return areal * bimag + aimag * breal;",a.shape,i.shape),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],d=r.runWebGLProgram(c,h,"float32"),f=r.runWebGLProgram(l,h,"float32"),p=gE({inputs:{real:d,imag:f},backend:r});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(f),p}if(r.shouldExecuteOnCPU([a,i])){var m=r.texData.get(a.dataId),v=r.texData.get(i.dataId),g=_slicedToArray(LI(a.shape,i.shape,m.values,v.values,o),2),y=g[0],b=g[1],k=r.makeTensorInfo(b,o);return r.texData.get(k.dataId).values=y,k}return t=Object(rv.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pE(NE,a.shape,i.shape):new fE(NE,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var RE={kernelName:rv.Multiply,backendName:"webgl",kernelFunc:AE};function DE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,s=rv.util.sizeFromShape(a.shape),u=rv.util.inferFromImplicitShape(i,s),c=rv.util.sizeFromShape(u);rv.util.assert(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old shape (").concat(a.shape,") has ").concat(s," elements. The new shape and old shape must have the same number of elements.")}));var l=o.texData.get(a.dataId);return!l.isPacked||WT(a.shape,u)||null!==l.texture&&WT(l.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[LT(e.shape)].concat(_toConsumableArray(zT(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[LT(t)].concat(_toConsumableArray(zT(t))),o=new eE(i,r),s=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(a,u,o)}var jE={kernelName:rv.Reshape,backendName:"webgl",kernelFunc:DE},FE=function e(t,n){_classCallCheck(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s=4*Math.floor(r/4),u=r%4,c="sumValue += dot(values, ones);";if(null!=n){var l=1/n;c="sumValue += dot(values * ".concat(rv.util.isInt(l)?l.toPrecision(2):l,", ones);")}var h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")},ME=function e(t,n){_classCallCheck(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),h=r%4,d="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n      }\n    "),f="vec4";"all"===n?(s="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===n&&(s="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===h,") {\n          ").concat(f," values = ").concat(f,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")};function PE(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=rv.backend_util.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var s,u,c=a[o],l=c.inSize,h=c.windowSize,d=c.outSize;s="mean"===n?0===o?new FE({windowSize:h,inSize:l,batchSize:e.shape[0],outSize:d},l):new FE({windowSize:h,inSize:l,batchSize:e.shape[0],outSize:d}):new ME({windowSize:h,inSize:l,batchSize:e.shape[0],outSize:d},n),u=i,i=r.runWebGLProgram(s,[i],t),u.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(u)}return i}var LE=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=yI(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")},zE=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=yI(this.rank),o=QI("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var c="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),h="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(l,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(l,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function BE(e,t,n){var r=Object(rv.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new zE(e.shape,t):new LE(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function VE(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=e.shape.length,i=rv.util.parseAxisParam(t,e.shape),o=i,s=rv.backend_util.getAxesPermutation(o,a),u=null!=s,c=e;u&&(c=BE(e,s,r),o=rv.backend_util.getInnerMostAxes(o.length,a)),rv.backend_util.assertAxesAreInnerMostDims("sum",o,a);var l=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(c.shape,o),2),h=l[0],d=l[1],f=h;n&&(f=rv.backend_util.expandShapeToKeepDim(h,i));var p=rv.util.sizeFromShape(d),m=DE({inputs:{x:c},attrs:{shape:[rv.util.sizeFromShape(e.shape)/p,p]},backend:r}),v=PE(m,Object(rv.sumOutType)(e.dtype),"sum",r),g=DE({inputs:{x:v},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(v),u&&r.disposeIntermediateTensorInfo(c),g}(t.x,r.axis,r.keepDims,n)}var WE={kernelName:rv.Sum,backendName:"webgl",kernelFunc:VE};function UE(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=new Array(i.shape.length),c=0;c<u.length;c++)u[c]=i.shape[o[c]];if(s.shouldExecuteOnCPU([i])){var l=s.texData.get(i.dataId),h=ZI(l.values,i.shape,i.dtype,o,u);t=s.makeTensorInfo(u,i.dtype),s.texData.get(t.dataId).values=h}else t=BE(i,o,s);return t}var HE={kernelName:rv.Transpose,backendName:"webgl",kernelFunc:UE};function GE(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,d=e.activation,f=void 0===d?null:d,p=t.shape.length,m=n.shape.length,v=r?t.shape[p-2]:t.shape[p-1],g=a?n.shape[m-1]:n.shape[m-2],y=r?t.shape[p-1]:t.shape[p-2],b=a?n.shape[m-2]:n.shape[m-1],k=t.shape.slice(0,-2),_=n.shape.slice(0,-2),w=rv.util.sizeFromShape(k),x=rv.util.sizeFromShape(_);rv.util.assert(p>=2&&m>=2&&(w===x||1===w||1===x),(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (".concat(k,") and (").concat(_,").")}));var C=(w>x?t.shape.slice(0,-2):n.shape.slice(0,-2)).concat([y,b]);rv.util.assert(v===g,(function(){return"Error in matMul: inner shapes (".concat(v,") and (").concat(g,") of Tensors with shapes ").concat(t.shape," and ").concat(n.shape," and transposeA=").concat(r," and transposeB=").concat(a," must match.")}));var O,S=r?[w,v,y]:[w,y,v],T=a?[x,b,g]:[x,g,b],I=DE({inputs:{x:t},backend:i,attrs:{shape:S}}),E=DE({inputs:{x:n},backend:i,attrs:{shape:T}}),N=[I,E],A=Math.max(w,x),R=r?I.shape[1]:I.shape[2],D=null!=s,j=null!=c,F="leakyrelu"===f,M=null!=f?TE(f,!0):null;if((1===y||1===b)&&R>1e3&&!1===(D||j||F||null!=M)){var P=I,L=E;r&&(P=UE({inputs:{x:I},backend:i,attrs:{perm:[0,2,1]}}),N.push(P)),a&&(L=UE({inputs:{x:E},backend:i,attrs:{perm:[0,2,1]}}),N.push(L));var z=1===b,B=P;1!==b&&(B=DE({inputs:{x:P},backend:i,attrs:{shape:[A,R,1]}}),N.push(B));var V=1===b?2:1,W=L;z&&(W=DE({inputs:{x:L},backend:i,attrs:{shape:[A,1,R]}}),N.push(W));var U=AE({inputs:{a:B,b:W},backend:i});O=VE({inputs:{x:U},backend:i,attrs:{axis:V,keepDims:!0}}),N.push(U)}else{var H=Object(rv.upcastType)(t.dtype,n.dtype),G=new IE(S,T,[A,y,b],r,a,D,M,j,F),K=[I,E];if(null!=s&&K.push(s),j&&K.push(c),F){var q=i.makeTensorInfo([],"float32",rv.util.createScalarValue(h,"float32"));K.push(q),N.push(q)}O=i.runWebGLProgram(G,K,H)}var X=DE({inputs:{x:O},backend:i,attrs:{shape:C}});N.push(O);for(var Z=0,Y=N;Z<Y.length;Z++){var Q=Y[Z];i.disposeIntermediateTensorInfo(Q)}return X}var KE={kernelName:rv._FusedMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return GE({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},qE={kernelName:rv.Abs,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=UI(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=Object(rv.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new uE(a.shape,"return abs(x);"):new iE(a.shape,"return abs(x);"),r.runWebGLProgram(t,[a],a.dtype)}},XE=OE({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),ZE={kernelName:rv.Acos,backendName:"webgl",kernelFunc:XE},YE=OE({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),QE={kernelName:rv.Acosh,backendName:"webgl",kernelFunc:YE},JE="return a + b;",$E=SE({opSnippet:JE,packedOpSnippet:JE,supportsComplex:!0,cpuKernelImpl:wI}),eN={kernelName:rv.Add,backendName:"webgl",kernelFunc:$E},tN=function e(t,n){_classCallCheck(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T"+t}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},nN=function e(t,n){_classCallCheck(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T"+t}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},rN={kernelName:rv.AddN,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return mE({inputs:{x:a[0]},backend:r});if(a.length>Object(rv.env)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),s=e({inputs:a.slice(i),backend:r});return e({inputs:[o,s],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return Object(rv.upcastType)(e,t)})),c=a.map((function(e){return e.shape})),l=Object(rv.env)().getBool("WEBGL_PACK")?new nN(a[0].shape,c):new tN(a[0].shape,c);return r.runWebGLProgram(l,a,u)}},aN={kernelName:rv.All,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=rv.util.parseAxisParam(i,a.shape),c=u,l=rv.backend_util.getAxesPermutation(c,s),h=a;null!=l&&(h=UE({inputs:{x:a},backend:n,attrs:{perm:l}}),c=rv.backend_util.getInnerMostAxes(c.length,s)),rv.backend_util.assertAxesAreInnerMostDims("all",c,s);var d,f=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(h.shape,c),2),p=f[0],m=f[1],v=DE({inputs:{x:h},backend:n,attrs:{shape:[-1,rv.util.sizeFromShape(m)]}}),g=PE(v,v.dtype,"all",n);return d=DE(o?{inputs:{x:g},backend:n,attrs:{shape:rv.backend_util.expandShapeToKeepDim(p,u)}}:{inputs:{x:g},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(h),d}},iN={kernelName:rv.Any,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=rv.util.parseAxisParam(i,a.shape),c=u,l=rv.backend_util.getAxesPermutation(c,s),h=a;null!=l&&(h=UE({inputs:{x:a},backend:n,attrs:{perm:l}}),c=rv.backend_util.getInnerMostAxes(c.length,s)),rv.backend_util.assertAxesAreInnerMostDims("any",c,s);var d,f=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(h.shape,c),2),p=f[0],m=f[1],v=DE({inputs:{x:h},backend:n,attrs:{shape:[-1,rv.util.sizeFromShape(m)]}}),g=PE(v,v.dtype,"any",n);return d=DE(o?{inputs:{x:g},backend:n,attrs:{shape:rv.backend_util.expandShapeToKeepDim(p,u)}}:{inputs:{x:g},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(h),d}},oN=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));",";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat("max"===n?">":"<"," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")},sN=function e(t,n,r,a){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,rv.util.assert(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=Math.ceil(t[t.length-1]/n);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,c=u.length,l=yI(c),h=JI("coords",c);if(1===i){var d=yI(s=c+1);o="\n        ".concat(d," sourceLocR = ").concat(d,"(").concat(h.join(),", 0);\n        ++").concat(h[c-1],";\n        ").concat(d," sourceLocG = ").concat(d,"(").concat(h.join(),", 0);\n        ++").concat(h[c-2],";\n        ").concat(d," sourceLocA = ").concat(d,"(").concat(h.join(),", 0);\n        --").concat(h[c-1],";\n        ").concat(d," sourceLocB = ").concat(d,"(").concat(h.join(),", 0);\n        --").concat(h[c-2],";")}else s=c,o="\n        ".concat(l," sourceLocR = coords;\n        ++").concat(h[c-1],";\n        ").concat(l," sourceLocG = coords;\n        ++").concat(h[c-2],";\n        ").concat(l," sourceLocA = coords;\n        --").concat(h[c-1],";\n        ").concat(l," sourceLocB = coords;\n        --").concat(h[c-2],";");var f=["x","y","z","w","u","v"].slice(0,s),p="."+f[s-1],m=f.map((function(e){return"int "+e})),v=JI("sourceLocR",s-1).concat("inIdx.r"),g=JI("sourceLocG",s-1).concat("inIdx.g"),y=JI("sourceLocB",s-1).concat("inIdx.b"),b=JI("sourceLocA",s-1).concat("inIdx.a"),k="max"===r?"greaterThan":"lessThan",_=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),")));"),w="vec4(\n            getAChannel(".concat(v.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(b.join(),") : 0.)"),x=a?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(f.join(),"),\n                                          vec2(").concat(f.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(f.join(),"),\n                               vec2(").concat(f.slice(-2).join(),"));\n      }\n      ").concat(x,"\n      void main() {\n        ").concat(l," coords = getOutputCoords();\n        bool hasNextCol = ").concat(h[c-1]," < ").concat(u[c-1]-1,";\n        bool hasNextRow = ").concat(h[c-2]," < ").concat(u[c-2]-1,";\n        ").concat(o,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(p,", sourceLocG").concat(p,",\n          sourceLocB").concat(p,", sourceLocA").concat(p,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(w,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(_,"\n          vec4 candidate = ").concat(w,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(k,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")};function uN(e,t,n,r){var a=[n];if(rv.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!Object(rv.env)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(t.shape,a),2),s=o[0],u=o[1],c=rv.util.sizeFromShape(u),l=DE({inputs:{x:t},backend:e,attrs:{shape:[-1,c]}});i.push(l);var h=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=n.shape[0],o=n.shape[1];null!=a&&(i=a.shape[0],o=a.shape[1]);var s=rv.backend_util.computeOptimalWindowSize(o),u={windowSize:s,inSize:o,batchSize:i,outSize:Math.ceil(o/s)},c=new oN(u,r,null==a),l=[n];null!=a&&l.push(a);var h=t.runWebGLProgram(c,l,"int32");if(1===h.shape[1])return h;var d=e(t,n,r,h);return t.disposeIntermediateTensorInfo(h),d}(e,l,r);i.push(h);var d=DE({inputs:{x:h},backend:e,attrs:{shape:s}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),d}return function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null!=a?a.shape:n.shape,o=rv.backend_util.computeOptimalWindowSize(i[i.length-1]),s=new sN(i,o,r,null==a),u=t.runWebGLProgram(s,null==a?[n]:[n,a],"int32");if(u.shape.length===n.shape.length){var c=e(t,n,r,u);return t.disposeIntermediateTensorInfo(u),c}return u}(e,t,r)}var cN={kernelName:rv.ArgMax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=rv.util.parseAxisParam(i,a.shape),s=rv.backend_util.getAxesPermutation(o,a.shape.length),u=a,c=[];null!=s&&(u=UE({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=rv.backend_util.getInnerMostAxes(o.length,u.shape.length)),rv.backend_util.assertAxesAreInnerMostDims("argMax",[o[0]],u.shape.length);var l=uN(n,u,o[0],"max");return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}},lN={kernelName:rv.ArgMin,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=rv.util.parseAxisParam(i,a.shape),s=rv.backend_util.getAxesPermutation(o,a.shape.length),u=a,c=[];null!=s&&(u=UE({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=rv.backend_util.getInnerMostAxes(o.length,u.shape.length)),rv.backend_util.assertAxesAreInnerMostDims("argMin",[o[0]],u.shape.length);var l=uN(n,u,o[0],"min");return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}},hN=OE({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),dN={kernelName:rv.Asin,backendName:"webgl",kernelFunc:hN},fN=OE({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),pN={kernelName:rv.Asinh,backendName:"webgl",kernelFunc:fN},mN=OE({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),vN={kernelName:rv.Atan,backendName:"webgl",kernelFunc:mN},gN=SE({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),yN={kernelName:rv.Atan2,backendName:"webgl",kernelFunc:gN},bN=OE({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),kN={kernelName:rv.Atanh,backendName:"webgl",kernelFunc:bN},_N=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var m="avg"===n,v="0.0";if(m||(v="-1.0 / 1e-20"),r)this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(f,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?"((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"):"(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"):"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var g="".concat(n,"(").concat(n,"(").concat(n,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===n&&(g="avgValue / count");var y=4*Math.floor(o/4),b=o%4,k="\n      if (".concat(m,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(p,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(y,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(k,"\n          }\n\n          int xC = xCCorner + ").concat(y,";\n          if (").concat(1===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(k,"\n          } else if (").concat(2===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(k,"\n          } else if (").concat(3===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(k,"\n          }\n        }\n        setOutput(").concat(g,");\n      }\n    ")}},wN=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,h=t.dilationHeight,d=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,m=t.effectiveFilterWidth,v=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,k="0.0";if(b||(k="-1.0 / 1e-20"),r)this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(f,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(h,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(m,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(m," +\n                      wR * ").concat(m," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var _="".concat(n,"(").concat(n,"(").concat(n,"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])");"avg"===n&&(_="avgValue / count");var w=4*Math.floor(o/4),x=o%4,C="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(k,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(k,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(C,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===x,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(2===x,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(3===x,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(C,"\n            }\n          }\n          setOutput(").concat(_,");\n        }\n      }\n    ")}},xN={kernelName:rv.AvgPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;KT(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides ".concat(o," and dilations '1'")}));var c=rv.backend_util.computePool2DInfo(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&rv.util.arraysEqual(c.inShape,c.outShape))return mE({inputs:{x:a},backend:n});var l=new _N(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}},CN={kernelName:rv.AvgPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=rv.backend_util.computePool3DInfo(a.shape,i,o,[1,1,1],s,u,c),h=new wN(l,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},ON=function e(t){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n      const float avgMultiplier = float(").concat(1/(t.filterHeight*t.filterWidth),");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,";\n            wR += ").concat(t.dilationHeight,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(r,";\n            wC+= ").concat(t.dilationWidth,") {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},SN=function e(t){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.effectiveFilterDepth,r=t.effectiveFilterHeight,a=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-t.padInfo.front,", ").concat(r-1-t.padInfo.top,", ").concat(a-1-t.padInfo.left,");\n      const float avgMultiplier = float(").concat(1/(t.filterDepth*t.filterHeight*t.filterWidth),");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(n,";\n            wD += ").concat(t.dilationDepth,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t.strideDepth,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(r,";\n              wR += ").concat(t.dilationHeight,") {\n            float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(a,";\n                wC += ").concat(t.dilationWidth,") {\n              float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},TN={kernelName:rv.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=rv.backend_util.computePool3DInfo(i.shape,o,s,[1,1,1],u,c),h=new SN(l);return n.runWebGLProgram(h,[a],i.dtype)}},IN={kernelName:rv.AvgPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;KT([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=rv.backend_util.computePool2DInfo(o.shape,s,u,1,c),h=new ON(l);return n.runWebGLProgram(h,[a],o.dtype)}},EN={kernelName:rv.BatchMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return GE({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},NN=function e(t,n,r,a,i,o){_classCallCheck(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],rv.backend_util.assertAndGetBroadcastShape(t,n),rv.backend_util.assertAndGetBroadcastShape(t,r);var s="0.0";null!=a&&(rv.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=i&&(rv.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},AN=function e(t,n,r,a,i,o){_classCallCheck(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],rv.backend_util.assertAndGetBroadcastShape(t,n),rv.backend_util.assertAndGetBroadcastShape(t,r);var s="vec4(0.0)";null!=a&&(rv.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(rv.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},RN={kernelName:rv.FusedBatchNorm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,s=t.offset,u=t.scale;rv.util.assert(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),rv.util.assert(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),rv.util.assert(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],h=null;null!=s&&(h=s.shape,l.push(s));var d=null;null!=u&&(d=u.shape,l.push(u));var f=Object(rv.env)().getBool("WEBGL_PACK_NORMALIZATION")?new AN(a.shape,i.shape,o.shape,h,d,c):new NN(a.shape,i.shape,o.shape,h,d,c);return n.runWebGLProgram(f,l,l[0].dtype)}},DN=function(){function e(t){_classCallCheck(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=yI(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return jN.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(t.map((function(e,t){return"sourceLoc.".concat(jN[t]," = start[").concat(t,"] + coords.").concat(jN[t],";")})).join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the length of start (").concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),jN=["x","y","z","w","u","v"],FN=function(){function e(t){_classCallCheck(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=yI(this.rank),r=JI("coords",this.rank),a=JI("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the length of start (").concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}();function MN(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size,s=_slicedToArray(rv.slice_util.parseSliceParams(a,i,o),2),u=s[0],c=s[1];if(rv.slice_util.assertParamsValid(a,u,c),0===rv.util.sizeFromShape(c))return n.makeTensorInfo(c,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var l=n.texData.get(a.dataId),h=HI(l.values,u,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,h)}var d=n.texData.get(a.dataId).isPacked,f=rv.slice_util.isSliceContinous(a.shape,u,c);if(d||!f){var p=Object(rv.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FN(c):new DN(c),m=p.getCustomSetupFunc(u);return n.runWebGLProgram(p,[a],a.dtype,m)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.complexParentRefCount=0,o.refCount=1,o.shape=n,o.dtype=e.dtype;var s=rv.slice_util.computeFlatOffset(t,rv.util.computeStrides(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,u,c,n)}var PN={kernelName:rv.Slice,backendName:"webgl",kernelFunc:MN},LN={kernelName:rv.BatchToSpaceND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;rv.util.assert(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=rv.backend_util.getReshaped(a.shape,i,s),c=rv.backend_util.getPermuted(u.length,i.length),l=rv.backend_util.getReshapedPermuted(a.shape,i,s),h=rv.backend_util.getSliceBeginCoords(o,i.length),d=rv.backend_util.getSliceSize(l,o,i.length),f=[],p=DE({inputs:{x:a},backend:n,attrs:{shape:u}}),m=UE({inputs:{x:p},backend:n,attrs:{perm:c}}),v=DE({inputs:{x:m},backend:n,attrs:{shape:l}}),g=MN({inputs:{x:v},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(m),f.push(v),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},zN={kernelName:rv.Bincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=xI(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}},BN=SE({opSnippet:"return float(a != b);",dtype:"bool"}),VN={kernelName:rv.NotEqual,backendName:"webgl",kernelFunc:BN};function WN(e){var t=e.inputs,n=e.backend,r=t.input;return mE({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var UN={kernelName:rv.Real,backendName:"webgl",kernelFunc:WN},HN={kernelName:rv.Cast,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return mE({inputs:{x:i},backend:r});var s=rv.zeros(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=gE({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(u),c}if("complex64"===i.dtype){var l=WN({inputs:{input:i},backend:r}),h=e({inputs:{x:l},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(l),h}if(!rv.util.hasEncodingLoss(i.dtype,o)){var d=mE({inputs:{x:i},backend:r});return{dataId:d.dataId,shape:d.shape,dtype:o}}if("int32"===o)return function(e,t){var n=new iE(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var f=r.makeTensorInfo([],"bool",rv.util.getTypedArrayFromDType("bool",1)),p=BN({inputs:{a:i,b:f},backend:r});return r.disposeIntermediateTensorInfo(f),p}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},GN="return ceil(x);",KN=OE({opSnippet:GN,packedOpSnippet:GN,cpuKernelImpl:OI}),qN={kernelName:rv.Ceil,backendName:"webgl",kernelFunc:KN},XN=function(){function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),ZN=function(){function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),YN={kernelName:rv.ClipByValue,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,s=a.clipValueMax,u=(t=Object(rv.env)().getBool("WEBGL_PACK_CLIP")?new ZN(i.shape):new XN(i.shape)).getCustomSetupFunc(o,s);return r.runWebGLProgram(t,[i],i.dtype,u)}},QN=function e(t){_classCallCheck(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "};function JN(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var $N={kernelName:rv.ComplexAbs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new QN(r.shape),o=[JN(r,a.complexTensorInfos.real),JN(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},eA=function e(t){_classCallCheck(this,e),this.outputShape=[],this.outputShape=rv.backend_util.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T"+t}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++)a.push("else if (yC < ".concat(n[i],") setOutput(getT").concat(i,"(yR, yC-").concat(n[i-1],"));"));a.push("else setOutput(getT".concat(n.length,"(yR, yC-").concat(n[n.length-1],"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")},tA=function e(t,n){_classCallCheck(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=rv.backend_util.computeOutShape(t,n);var r=this.outputShape,a=r.length,i=yI(a),o=JI("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T"+t}));var u=new Array(t.length-1);u[0]=t[0][n];for(var c=1;c<u.length;c++)u[c]=u[c-1]+t[c][n];for(var l=s[n],h=s.slice(-2),d=s.join(),f="if (".concat(l," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(d,"), vec2(").concat(h.join(),"));\n        }"),p=1;p<u.length;p++){var m=u[p-1];f+="\n        if (".concat(l," < ").concat(u[p],"  && ").concat(l," >= ").concat(u[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(nA(s,l,m),"),\n            vec2(").concat(nA(h,l,m),"));\n        }")}var v=u[u.length-1];f+="\n        return getChannel(\n          getT".concat(u.length,"(").concat(nA(s,l,v),"),\n          vec2(").concat(nA(h,l,v),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(f,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")};function nA(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function rA(e){var t=e.inputs,n=e.backend,r=t.input;return mE({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var aA={kernelName:rv.Imag,backendName:"webgl",kernelFunc:rA};function iA(e,t,n){var r=rv.backend_util.computeOutShape(e.map((function(e){return e.shape})),t);return{tensors2D:e.map((function(e){return DE({inputs:{x:e},attrs:{shape:[-1,rv.util.sizeFromShape(e.shape.slice(t))]},backend:n})})),outShape:r}}function oA(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=rv.util.parseAxisParam(r,t[0].shape)[0],i=rv.backend_util.computeOutShape(t.map((function(e){return e.shape})),a);if(0===rv.util.sizeFromShape(i))return n.makeTensorInfo(i,t[0].dtype,[]);var o=t.filter((function(e){return rv.util.sizeFromShape(e.shape)>0}));if(1===o.length)return mE({inputs:{x:o[0]},backend:n});var s=o.map((function(e){return e.shape}));return rv.backend_util.assertParamsConsistent(s,a),function e(t,n,r){var a=t[0].dtype;if("complex64"===a){var i=t.map((function(e){return WN({inputs:{input:e},backend:r})})),o=t.map((function(e){return rA({inputs:{input:e},backend:r})})),s=e(i,n,r),u=e(o,n,r),c=gE({inputs:{real:s,imag:u},backend:r});return i.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),o.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}if("string"===a){var l=iA(t,n,r),h=l.tensors2D,d=l.outShape,f=h.map((function(e){return{vals:r.readSync(e.dataId),shape:e.shape}})),p=SI(f,d,a,1===h[0].shape[0]),m=rv.backend_util.computeOutShape(t.map((function(e){return e.shape})),n),v=r.makeTensorInfo(m,a,p);return h.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),v}if(t.length>Object(rv.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var g=Math.floor(t.length/2),y=e(t.slice(0,g),n,r),b=e(t.slice(g),n,r),k=e([y,b],n,r);return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),k}if(Object(rv.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){var _=new tA(t.map((function(e){return e.shape})),n);return r.runWebGLProgram(_,t,a)}var w=iA(t,n,r),x=w.tensors2D,C=w.outShape,O=new eA(x.map((function(e){return e.shape}))),S=r.runWebGLProgram(O,x,a);x.forEach((function(e){return r.disposeIntermediateTensorInfo(e)}));var T=DE({inputs:{x:S},attrs:{shape:C},backend:r});return r.disposeIntermediateTensorInfo(S),T}(o,a,n)}var sA={kernelName:rv.Concat,backendName:"webgl",kernelFunc:oA},uA=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,d=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),m=t.inChannels%4,v="channelsLast"===t.dataFormat,g=v?1:2,y=v?2:3,b=v?3:1,k="",_="";r&&(k=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),_="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(k,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(f,"; wC++) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(v,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===m,") {\n\n              if (").concat(v,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(p,") *\n                    getW(wR, wC, ").concat(p,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(p,", xR, xC) *\n                    getW(wR, wC, ").concat(p,", d2);\n              }\n\n            } else if (").concat(2===m,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2)\n              );\n\n              if (").concat(v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===m,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(p,", d2),\n                getW(wR, wC, ").concat(p," + 1, d2),\n                getW(wR, wC, ").concat(p," + 2, d2)\n              );\n\n              if (").concat(v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(p,"),\n                  getX(batch, xR, xC, ").concat(p," + 1),\n                  getX(batch, xR, xC, ").concat(p," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(p,", xR, xC),\n                  getX(batch, ").concat(p," + 1, xR, xC),\n                  getX(batch, ").concat(p," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(_,"\n        setOutput(result);\n      }\n    ")},cA=function e(t){_classCallCheck(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,h=t.filterDepth,d=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),m=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(h,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===m,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},lA=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,s=r.strideHeight,u=r.padInfo,c=r.outWidth,l=r.dilationWidth,h=r.dilationHeight,d=r.dataFormat,f=u.left,p=u.top,m=i*a,v=XT(),g="channelsLast"===d,y=g?0:1,b=g?1:2,k="",_=0;_<=1;_++)for(var w=0;w<=1;w++)k+="\n          blockIndex = rc.y + ".concat(w,";\n          pos = rc.x + ").concat(_,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(c,")) * ").concat(s," - ").concat(p,";\n            d0 = offsetY + ").concat(h," * (pos / ").concat(m,");\n\n            if(d0 < ").concat(n[y]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(c,".) * ").concat(o,". - ").concat(f,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(m,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[b]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(g,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*_+w,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*_+w,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(k,"\n\n        ").concat(v.output," = result;\n      }\n    ")};function hA(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,d=e.activation,f=void 0===d?null:d,p=n.shape,m=i.texData.get(n.dataId),v="channelsLast"===a.dataFormat,g=[],y=p[2]%2!=0&&!!m.isPacked;if((1!=p[0]*p[1]*p[2]&&1!==a.outChannels||!(a.inChannels>1e3))&&Object(rv.env)().getBool("WEBGL_LAZILY_UNPACK")&&Object(rv.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&y){var b={dataId:n.dataId,shape:[1,v?p[0]*p[1]*(p[2]+1):p[0]*p[2]*(p[3]+1),a.inChannels],dtype:n.dtype},k=m.shape;m.shape=m.shape.slice(),m.shape[m.shape.length-2]++,rv.util.assert(WT(m.shape,b.shape),(function(){return"packed reshape ".concat(m.shape," to ").concat(b.shape," isn't free")}));var _=DE({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});g.push(_);var w=GE({a:b,b:_,backend:i,transposeA:!1,transposeB:!1,bias:s,activation:f,preluActivationWeights:c,leakyreluAlpha:h}),x=i.texData.get(w.dataId);rv.util.assert(x.isPacked,(function(){return"batchMatMul result is expected to be packed"})),m.shape=k,x.shape=a.outShape,(t=mE({inputs:{x:w},backend:i})).shape=a.outShape,g.push(w)}else{var C=DE({inputs:{x:n},backend:i,attrs:{shape:[1,v?p[0]*p[1]*p[2]:p[0]*p[2]*p[3],a.inChannels]}}),O=DE({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),S=GE({a:C,b:O,transposeA:!1,transposeB:!1,backend:i,bias:s,activation:f,preluActivationWeights:c,leakyreluAlpha:h});t=DE({inputs:{x:S},backend:i,attrs:{shape:a.outShape}}),g.push(C),g.push(O),g.push(S)}for(var T=0,I=g;T<I.length;T++){var E=I[T];i.disposeIntermediateTensorInfo(E)}return t}function dA(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,h=e.activation,d=void 0===h?null:h,f=r.filterWidth,p=r.filterHeight,m=r.inChannels,v=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,b=f*p*m,k=g*v,_=[b,k],w=[],x=DE({inputs:{x:t},backend:a,attrs:{shape:t.shape.slice(1)}}),C=DE({inputs:{x:n},backend:a,attrs:{shape:[1,b,rv.util.sizeFromShape(n.shape)/b]}});w.push(x),w.push(C);var O=new lA(_,x.shape,r),S=a.runWebGLProgram(O,[x],"float32"),T=DE({inputs:{x:S},backend:a,attrs:{shape:[1,_[0],_[1]]}});w.push(S),w.push(T);var I=null!=o,E=null!=u,N="leakyrelu"===d,A=d?TE(d,!0):null,R=new IE(T.shape,C.shape,[1,k,r.outChannels],!0,!1,I,A,E,N),D=[T,C];if(o&&D.push(o),E&&D.push(u),N){var j=a.makeTensorInfo([],"float32",rv.util.createScalarValue(l,"float32"));D.push(j),w.push(j)}var F=a.runWebGLProgram(R,D,"float32"),M=DE({inputs:{x:F},backend:a,attrs:{shape:y?[1,g,v,r.outChannels]:[1,r.outChannels,g,v]}});w.push(F);for(var P=0,L=w;P<L.length;P++){var z=L[P];a.disposeIntermediateTensorInfo(z)}return M}var fA={kernelName:rv.Conv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dataFormat,l=a.dilations,h=a.dimRoundingMode,d=rv.backend_util.convertConv2DDataFormat(c),f=rv.backend_util.computeConv2DInfo(i.shape,o.shape,s,l,u,h,!1,d);if(1!==f.filterHeight||1!==f.filterWidth||1!==f.dilationHeight||1!==f.dilationWidth||1!==f.strideHeight||1!==f.strideWidth||"SAME"!==f.padInfo.type&&"VALID"!==f.padInfo.type)if(Object(rv.env)().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=dA({x:i,filter:o,convInfo:f,backend:r});else{var p=new uA(f);t=r.runWebGLProgram(p,[i,o],"float32")}else t=hA({x:i,filter:o,convInfo:f,backend:r});var m=DE({inputs:{x:t},backend:r,attrs:{shape:f.outShape}});return r.disposeIntermediateTensorInfo(t),m}},pA=function e(t){_classCallCheck(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t.strideHeight," - ").concat(t.padInfo.top,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(t.strideWidth," - ").concat(t.padInfo.left,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat("channelsLast"===t.dataFormat,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},mA=function e(t){_classCallCheck(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a="channelsLast"===t.dataFormat;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(a?3:1,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(a?1:2,"], coords[").concat(a?2:3,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(a,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},vA=function e(t){_classCallCheck(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t.strideDepth," - ").concat(t.padInfo.front,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(t.strideHeight," - ").concat(t.padInfo.top,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(t.strideWidth," - ").concat(t.padInfo.left,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},gA=function e(t){_classCallCheck(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-t.padInfo.front,", ").concat(r-1-t.padInfo.top,", ").concat(a-1-t.padInfo.left,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(t.strideDepth,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},yA={kernelName:rv.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,h=rv.backend_util.convertConv2DDataFormat(u),d=rv.backend_util.computeConv2DInfo(a.shape,l,o,1,s,c,!1,h),f=new pA(d);return n.runWebGLProgram(f,[a,i],"float32")}},bA={kernelName:rv.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,h=rv.backend_util.convertConv2DDataFormat(c),d=rv.backend_util.computeConv2DInfo(o,i.shape,s,1,u,l,!1,h),f=new mA(d);return n.runWebGLProgram(f,[a,i],"float32")}},kA={kernelName:rv.Conv3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=rv.backend_util.computeConv3DInfo(a.shape,i.shape,o,u,s),l=new cA(c);return n.runWebGLProgram(l,[a,i],"float32")}},_A={kernelName:rv.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,c=rv.backend_util.computeConv3DInfo(a.shape,u,o,1,s),l=new vA(c);return n.runWebGLProgram(l,[a,i],"float32")}},wA={kernelName:rv.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=r.inputShape,c=rv.backend_util.computeConv3DInfo(u,i.shape,s,1,o),l=new gA(c);return n.runWebGLProgram(l,[a,i],"float32")}},xA=OE({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),CA={kernelName:rv.Cos,backendName:"webgl",kernelFunc:xA},OA=OE({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),SA={kernelName:rv.Cosh,backendName:"webgl",kernelFunc:OA},TA=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=_slicedToArray(t,4),s=o[0],u=o[1],c=o[2],l=o[3],h=_slicedToArray(n,1)[0],d=_slicedToArray(r,2),f=d[0],p=d[1];this.outputShape=[h,f,p,l];var m="bilinear"===a?1:0,v=u-1+".0",g=c-1+".0",y=_slicedToArray(f>1?[""+(u-1)/(f-1),"(y2-y1) * height_ratio","y1*".concat(v," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * "+v],3),b=y[0],k=y[1],_=y[2],w=_slicedToArray(p>1?[""+(c-1)/(p-1),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * "+g],3),x=w[0],C=w[1],O=w[2];this.userCode="\n      const float height_ratio = float(".concat(b,");\n      const float width_ratio = float(").concat(x,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(k,";\n        float width_scale = ").concat(C,";\n\n        float in_y = ").concat(_,";\n        if( in_y < 0.0 || in_y > ").concat(v," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(O,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},IA={kernelName:rv.CropAndResize,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new TA(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}},EA=function(){function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=n?"0.0":"getX(".concat(NA(a,"coords"),")"),o=t[t.length-1],s="",u="";n?(s=r?"end != "+(o-1):"end != 0",u=r?"end + 1":"end - 1"):(s=r?"end + pow2 < "+o:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(yI(a)," coords = getOutputCoords();\n        int end = ").concat(AA(a,"coords"),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(s,") {\n          int idx = ").concat(u,";\n          ").concat(AA(a,"coords")," = idx;\n          val += getX(").concat(NA(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function NA(e,t){if(1===e)return""+t;if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function AA(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var RA={kernelName:rv.Cumsum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse,u=a.shape.length,c=rv.backend_util.getAxesPermutation([i],u),l=a;null!=c&&(l=UE({inputs:{x:a},backend:n,attrs:{perm:c}}));var h=rv.backend_util.getInnerMostAxes(1,u)[0];if(h!==u-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(a.shape.length-1," but got axis=")+i);for(var d=l.shape[h],f=mE({inputs:{x:l},backend:n}),p=0;p<=Math.ceil(Math.log2(d))-1;p++){var m=new EA(l.shape,!1,s),v=m.getCustomSetupFunc(p),g=f;f=n.runWebGLProgram(m,[f],f.dtype,v),n.disposeIntermediateTensorInfo(g)}if(o){var y=new EA(l.shape,o,s),b=f;f=n.runWebGLProgram(y,[f],f.dtype),n.disposeIntermediateTensorInfo(b)}if(null!=c){var k=UE({inputs:{x:f},backend:n,attrs:{perm:rv.backend_util.getUndoAxesPermutation(c)}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(l),k}return f}},DA={kernelName:rv.DenseBincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=xI(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var h=n.bufferSync(a),d=n.bufferSync(i),f=CI(h,d,o,s);return n.makeTensorInfo(f.shape,i.dtype,f.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+a.shape.length+".")}},jA=function(){function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return _createClass(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}(),FA={kernelName:rv.DepthToSpace,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;rv.util.assert(i>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+i}));var s=a.shape[0],u=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),h=new jA("NHWC"===o?[s,u,c,l]:[s,l,u,c],i,o);return n.runWebGLProgram(h,[a],a.dtype)}},MA=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,s=t.inWidth,u=t.padInfo.top,c=t.padInfo.left,l=t.strideHeight,h=t.strideWidth,d=t.dilationHeight,f=t.dilationWidth,p=t.filterHeight,m=t.filterWidth,v=t.outChannels/t.inChannels,g="",y="";r&&(g=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),y="result = activation(result);");var b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(g,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(v,";\n        int q = d2 - d1 * ").concat(v,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(p,"; wR++) {\n          int xR = xRCorner + wR * ").concat(d,";\n\n          if (xR < 0 || xR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(m,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(s,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(b,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")},PA=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,s=t.inWidth,u=t.padInfo.top,c=t.padInfo.left,l=t.strideHeight,h=t.strideWidth,d=t.dilationHeight,f=t.dilationWidth,p=t.filterHeight,m=t.filterWidth,v=m,g="int xR; int xC; int xCOffset;",y=0;y<p;y++)for(var b=0;b<m;b++)g+="\n          vec4 xTexelR".concat(y,"C").concat(2*b," = vec4(0.);\n          vec4 wR").concat(y,"C").concat(b," = vec4(0.);\n          vec4 xR").concat(y,"C").concat(b," = vec4(0.);");for(var k=0;k<p;k++)for(var _=0;_<v;_++){var w=2*_;if(g+="\n          xR = xRCorner + ".concat(k*d,";\n          xC = xCCorner + ").concat(w*f,";\n        "),1===h){if(w<m&&(g+=c%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    xTexelR").concat(k,"C").concat(w,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(k,"C").concat(w," = vec4(previous.zw, xTexelR").concat(k,"C").concat(w,".xy);\n                } else {\n                  xR").concat(k,"C").concat(w," = vec4(0, 0, xTexelR").concat(k,"C").concat(w,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(o," && xC >= 0 && xC < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(w," = xTexelR").concat(k,"C").concat(w,";\n              "),w+1<m)){var x=c%2==0?rv.util.nearestLargerEven(f):f;f%2==0&&c%2==1||f%2!=0&&c%2!=1?(g+="\n                  xCOffset = xC + ".concat(c%2," + ").concat(x,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),f>1&&(g+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(o," &&\n                      xCOffset >= 0 && xCOffset < ").concat(s,") {\n                      xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                    }\n                  ")),g+="\n                  xR".concat(k,"C").concat(w+1," = vec4(\n                    xTexelR").concat(k,"C").concat(w,".zw, xTexelR").concat(k,"C").concat(w+2,".xy);\n                ")):g+="\n                  xCOffset = xC + ".concat(x,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(k,"C").concat(w+1," = xTexelR").concat(k,"C").concat(w+2,";\n                ")}}else w<m&&(g+="\n              if(xR >= 0 && xR < ".concat(o,") {\n            "),c%2==1?(g+="\n                xCOffset = xC + 1 - ".concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(w," = vec4(\n                  xTexelR").concat(k,"C").concat(w,".zw, xTexelR").concat(k,"C").concat(w+2,".zw);\n              "),w+1<m&&(g+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(h,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(k,"C").concat(w+1," = vec4(xTexelR").concat(k,"C").concat(w+2,".xy, final.xy);\n                "))):(g+="\n                if(xC >= 0 && xC < ".concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(w," = vec4(\n                  xTexelR").concat(k,"C").concat(w,".xy, xTexelR").concat(k,"C").concat(w+2,".xy);\n              "),w+1<m&&(g+="\n                  xR".concat(k,"C").concat(w+1," = vec4(\n                    xTexelR").concat(k,"C").concat(w,".zw, xTexelR").concat(k,"C").concat(w+2,".zw);\n                "))),g+="}");w<m&&(g+="\n            vec4 wTexelR".concat(k,"C").concat(w," = getW(").concat(k,", ").concat(w,", d1, q);\n            wR").concat(k,"C").concat(w," = vec4(wTexelR").concat(k,"C").concat(w,".xz, wTexelR").concat(k,"C").concat(w,".xz);\n          "),w+1<m&&(g+="\n              vec4 wTexelR".concat(k,"C").concat(w+1," = getW(").concat(k,", ").concat(w+1,", d1, q);\n              wR").concat(k,"C").concat(w+1," =\n                vec4(wTexelR").concat(k,"C").concat(w+1,".xz, wTexelR").concat(k,"C").concat(w+1,".xz);")))}for(var C=0;C<p;C++)for(var O=0;O<m;O++)g+="dotProd += xR".concat(C,"C").concat(O," * wR").concat(C,"C").concat(O,";");var S="",T="";r&&(S=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),T="result = activation(result);");var I=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(S,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(c,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(g,"\n\n        vec4 result = dotProd;\n        ").concat(I,"\n        ").concat(T,"\n        setOutput(result);\n      }\n    ")},LA={kernelName:rv.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode,l=u;null==l&&(l=[1,1]),rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var h,d=rv.backend_util.computeConv2DInfo(a.shape,i.shape,o,l,s,c,!0);return h=Object(rv.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels==1?new PA(d):new MA(d),n.runWebGLProgram(h,[a,i],"float32")}},zA=function e(t){_classCallCheck(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(t.outChannels/t.inChannels," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t.strideHeight," - ").concat(t.padInfo.top,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(t.strideWidth," - ").concat(t.padInfo.left,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},BA=function e(t){_classCallCheck(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(a,"; dm++) {\n              int d2 = d1 * ").concat(a," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},VA={kernelName:rv.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape,h=rv.backend_util.computeConv2DInfo(a.shape,l,o,s,u,c,!0),d=new zA(h);return n.runWebGLProgram(d,[a,i],"float32")}},WA={kernelName:rv.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.inputShape,h=rv.backend_util.computeConv2DInfo(l,i.shape,o,s,u,c,!0),d=new BA(h);return n.runWebGLProgram(d,[a,i],"float32")}},UA=function e(t){_classCallCheck(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},HA={kernelName:rv.Diag,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(_toConsumableArray(r.shape),_toConsumableArray(r.shape)),i=rv.util.sizeFromShape(r.shape),o=DE({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new UA(i),u=n.runWebGLProgram(s,[o],o.dtype),c=DE({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}},GA=function e(t){_classCallCheck(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,c=t.dilationHeight,l=t.dilationWidth,h=a.top,d=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")},KA={kernelName:rv.Dilation2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dilations,l=rv.backend_util.computeDilation2DInfo(i.shape,o.shape,s,u,"NHWC",c),h=new GA(l),d=DE({inputs:{x:t=r.runWebGLProgram(h,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),d}},qA=OE({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),XA={kernelName:rv.Elu,backendName:"webgl",kernelFunc:qA},ZA={kernelName:rv.EluGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=Object(rv.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new pE("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new fE("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},YA=SE({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),QA={kernelName:rv.Equal,backendName:"webgl",kernelFunc:YA},JA=OE({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(rv.backend_util.ERF_P,";\n  float a1 = ").concat(rv.backend_util.ERF_A1,";\n  float a2 = ").concat(rv.backend_util.ERF_A2,";\n  float a3 = ").concat(rv.backend_util.ERF_A3,";\n  float a4 = ").concat(rv.backend_util.ERF_A4,";\n  float a5 = ").concat(rv.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),$A={kernelName:rv.Erf,backendName:"webgl",kernelFunc:JA},eR="return exp(x);",tR=OE({opSnippet:eR,packedOpSnippet:eR,cpuKernelImpl:TI}),nR={kernelName:rv.Exp,backendName:"webgl",kernelFunc:tR};function rR(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(rv.util.assert(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),DE({inputs:{x:i},backend:r,attrs:{shape:s}})}var aR={kernelName:rv.ExpandDims,backendName:"webgl",kernelFunc:rR},iR="return exp(x) - 1.0;",oR=OE({opSnippet:iR,packedOpSnippet:iR,cpuKernelImpl:II}),sR={kernelName:rv.Expm1,backendName:"webgl",kernelFunc:oR},uR=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,s=r?a+".0":"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")};function cR(e,t,n){var r=n.texData.get(e.dataId),a=rv.util.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],o=DE({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new uR("real",s,t),c=new uR("imag",s,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(u,l,"float32"),d=n.runWebGLProgram(c,l,"float32"),f=gE({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);var p=DE({inputs:{x:f},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),p}var lR={kernelName:rv.FFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return cR(t.input,!1,n)}},hR=function(){function e(t,n){_classCallCheck(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}();function dR(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||rv.util.inferDtype(a))){var o=rv.util.getArrayFromDType(i,rv.util.sizeFromShape(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new hR(r,a),u=s.getCustomSetupFunc(a);return t.runWebGLProgram(s,[],i,u)}var fR,pR={kernelName:rv.Fill,backendName:"webgl",kernelFunc:dR},mR=function e(t){_classCallCheck(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},vR={kernelName:rv.FlipLeftRight,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new mR(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},gR="return floor(x);",yR=OE({opSnippet:gR,packedOpSnippet:gR,cpuKernelImpl:EI}),bR={kernelName:rv.Floor,backendName:"webgl",kernelFunc:yR},kR=SE({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),_R={kernelName:rv.FloorDiv,backendName:"webgl",kernelFunc:kR},wR=function e(t){_classCallCheck(this,e),this.variableNames=["A"];var n=XT(),r=_slicedToArray(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},xR=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=XT(),r=_slicedToArray(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},CR={kernelName:rv.FromPixels,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,u="undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap,c=_slicedToArray(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),l=c[0],h=c[1],d=[h,l],f=[h,l,i];(s||o||u)&&(null==fR&&(fR=document.createElement("canvas").getContext("2d")),fR.canvas.width=l,fR.canvas.height=h,fR.drawImage(a,0,0,l,h),a=fR.canvas);var p=n.makeTensorInfo(d,"int32");n.texData.get(p.dataId).usage=gT.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);var m=Object(rv.env)().getBool("WEBGL_PACK")?new xR(f):new wR(f),v=n.runWebGLProgram(m,[p],"int32");return n.disposeData(p.dataId),v}},OR={kernelName:rv.FusedConv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=n.bias,u=n.preluActivationWeights,c=a.strides,l=a.pad,h=a.dataFormat,d=a.dilations,f=a.dimRoundingMode,p=a.activation,m=a.leakyreluAlpha,v=rv.backend_util.convertConv2DDataFormat(h),g=rv.backend_util.computeConv2DInfo(i.shape,o.shape,c,d,l,f,!1,v),y=[];if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(Object(rv.env)().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=dA({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:m});else{var b=null!=s,k=null!=u,_="leakyrelu"===p,w=p?TE(p,!1):null,x=new uA(g,b,w,k,_),C=[i,o];if(s&&C.push(s),u&&C.push(u),_){var O=r.makeTensorInfo([],"float32",rv.util.createScalarValue(m,"float32"));C.push(O),y.push(O)}t=r.runWebGLProgram(x,C,"float32")}else t=hA({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:p,preluActivationWeights:u,leakyreluAlpha:m});var S=DE({inputs:{x:t},backend:r,attrs:{shape:g.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),S}},SR={kernelName:rv.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dilations,h=r.dimRoundingMode,d=r.activation,f=r.leakyreluAlpha,p=[],m=l;null==m&&(m=[1,1]),rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(u,m),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ".concat(u," and dilations '").concat(m,"'")}));var v,g=rv.backend_util.computeConv2DInfo(a.shape,i.shape,u,m,c,h,!0),y=Object(rv.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels==1,b=d?TE(d,y):null,k=[a,i],_=null!=o,w=null!=s,x="leakyrelu"===d;if(_&&k.push(o),w&&k.push(s),x){var C=n.makeTensorInfo([],"float32",rv.util.createScalarValue(f,"float32"));k.push(C),p.push(C)}v=y?new PA(g,_,b,w,x):new MA(g,_,b,w,x);var O=n.runWebGLProgram(v,k,"float32");return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),O}},TR=function e(t,n,r){_classCallCheck(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=yI(n.length),i=yI(r.length);this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(this.sliceDim>1?"strides[j]":"strides",";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")},IR={kernelName:rv.GatherNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=_slicedToArray(rv.backend_util.prepareAndValidate(r,a),4),u=s[0],c=s[1],l=s[2],h=s[3],d=DE({inputs:{x:a},backend:n,attrs:{shape:[c,o]}}),f=DE({inputs:{x:r},backend:n,attrs:{shape:[rv.util.sizeFromShape(r.shape)/l,l]}}),p=new TR(o,h,[c,l]),m=n.runWebGLProgram(p,[f,d],f.dtype),v=DE({inputs:{x:m},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),v}},ER=function e(t,n){_classCallCheck(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=yI(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)r.push(2===a?"int(getIndices(resRC.x, resRC.z))":""+n[a]);return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")},NR={kernelName:rv.GatherV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=rv.util.parseAxisParam(o,a.shape)[0],c=rv.backend_util.segment_util.collectGatherOpShapeInfo(a,i,u,s),l=rv.util.sizeFromShape(i.shape),h=[],d=DE({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=DE({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,l/c.batchSize]}});h.push(d),h.push(f);var p=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var m=n.bufferSync(f),v=n.bufferSync(d),g=NI(v,m,p);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(c.outputShape,g.dtype,g.values)}var y=new ER(d.shape,p),b=n.runWebGLProgram(y,[d,f],d.dtype);h.push(b);var k=DE({inputs:{x:b},backend:n,attrs:{shape:c.outputShape}});return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),k}},AR=SE({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:AI,dtype:"bool"}),RR={kernelName:rv.Greater,backendName:"webgl",kernelFunc:AR},DR=SE({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),jR={kernelName:rv.GreaterEqual,backendName:"webgl",kernelFunc:DR},FR={kernelName:rv.IFFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return cR(t.input,!0,n)}},MR=OE({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),PR={kernelName:rv.IsFinite,backendName:"webgl",kernelFunc:MR},LR=OE({opSnippet:"return float(isinf(x));",dtype:"bool"}),zR={kernelName:rv.IsInf,backendName:"webgl",kernelFunc:LR},BR=OE({opSnippet:"return float(isnan(x));",dtype:"bool"}),VR={kernelName:rv.IsNan,backendName:"webgl",kernelFunc:BR},WR=SE({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:RI,dtype:"bool"}),UR={kernelName:rv.Less,backendName:"webgl",kernelFunc:WR},HR=SE({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),GR={kernelName:rv.LessEqual,backendName:"webgl",kernelFunc:HR},KR={kernelName:rv.LinSpace,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=DI(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},qR=OE({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:jI}),XR={kernelName:rv.Log,backendName:"webgl",kernelFunc:qR},ZR=OE({opSnippet:"return log(1.0 + x);"}),YR={kernelName:rv.Log1p,backendName:"webgl",kernelFunc:ZR},QR=SE({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),JR={kernelName:rv.LogicalAnd,backendName:"webgl",kernelFunc:QR},$R=OE({opSnippet:"return float(!(x >= 1.0));"}),eD={kernelName:rv.LogicalNot,backendName:"webgl",kernelFunc:$R},tD=SE({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),nD={kernelName:rv.LogicalOr,backendName:"webgl",kernelFunc:tD},rD=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")},aD=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")},iD={kernelName:rv.LRN,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta,c=Object(rv.env)().getBool("WEBGL_PACK_NORMALIZATION")?new aD(a.shape,i,o,s,u):new rD(a.shape,i,o,s,u);return n.runWebGLProgram(c,[a],a.dtype)}},oD=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},sD={kernelName:rv.LRNGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,h=new oD(a.shape,s,u,c,l);return n.runWebGLProgram(h,[a,i,o],a.dtype)}};function uD(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=a.shape.length,u=rv.util.parseAxisParam(i,a.shape),c=u,l=rv.backend_util.getAxesPermutation(c,s),h=null!=l,d=n.shouldExecuteOnCPU([a]),f=a;if(h){if(d){for(var p=n.texData.get(f.dataId).values,m=new Array(s),v=0;v<m.length;v++)m[v]=a.shape[l[v]];var g=ZI(p,a.shape,a.dtype,l,m);f=n.makeTensorInfo(m,a.dtype),n.texData.get(f.dataId).values=g}else f=BE(a,l,n);c=rv.backend_util.getInnerMostAxes(c.length,s)}rv.backend_util.assertAxesAreInnerMostDims("max",c,s);var y,b=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(f.shape,c),2),k=b[0],_=b[1],w=k;if(o&&(w=rv.backend_util.expandShapeToKeepDim(k,u)),d){var x=n.texData.get(f.dataId),C=FI(x.values,rv.util.sizeFromShape(_),w,a.dtype);y=n.makeTensorInfo(w,a.dtype),n.texData.get(y.dataId).values=C}else y=function(e,t,n,r){var a=rv.util.sizeFromShape(t),i=DE({inputs:{x:e},attrs:{shape:[rv.util.sizeFromShape(e.shape)/a,a]},backend:r}),o=PE(i,e.dtype,"max",r),s=DE({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(f,_,w,n);return h&&n.disposeIntermediateTensorInfo(f),y}var cD={kernelName:rv.Max,backendName:"webgl",kernelFunc:uD},lD=SE({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:MI}),hD={kernelName:rv.Maximum,backendName:"webgl",kernelFunc:lD},dD={kernelName:rv.MaxPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;KT(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(o," and dilations '1'")}));var c=rv.backend_util.computePool2DInfo(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&rv.util.arraysEqual(c.inShape,c.outShape))return mE({inputs:{x:a},backend:n});var l=new _N(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}},fD={kernelName:rv.MaxPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=rv.backend_util.computePool3DInfo(a.shape,i,o,[1,1,1],s,c,u),h=new wN(l,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},pD=function e(t){_classCallCheck(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,";\n          wR += ").concat(t.dilationHeight,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(n*r-1," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(r," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},mD=function e(t){_classCallCheck(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.effectiveFilterDepth,r=t.effectiveFilterHeight,a=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-t.padInfo.front,", ").concat(r-1-t.padInfo.top,", ").concat(a-1-t.padInfo.left,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(n,";\n           wD += ").concat(t.dilationDepth,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t.strideDepth,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(r,";\n              wR += ").concat(t.dilationHeight,") {\n            float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(a,";\n                wC += ").concat(t.dilationWidth,") {\n              float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(n*r*a-1," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(r," * ").concat(a," +\n                  wR * ").concat(a," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},vD={kernelName:rv.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=rv.backend_util.computePool3DInfo(i.shape,o,s,[1,1,1],u,c),h=new wN(l,"max",!0),d=n.runWebGLProgram(h,[i],i.dtype),f=new mD(l),p=n.runWebGLProgram(f,[a,d],i.dtype);return n.disposeIntermediateTensorInfo(d),p}},gD={kernelName:rv.MaxPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;KT([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=rv.backend_util.computePool2DInfo(o.shape,s,u,1,c,l),d=new _N(h,"max",!0),f=n.runWebGLProgram(d,[o],o.dtype),p=new pD(h),m=n.runWebGLProgram(p,[a,f],o.dtype);return n.disposeIntermediateTensorInfo(f),m}},yD={kernelName:rv.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;rv.util.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];rv.util.assert(rv.backend_util.eitherStridesOrDilationsAreOne(o,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var h=rv.backend_util.computePool2DInfo(a.shape,i,o,l,s),d=_slicedToArray(function(e,t,n,r){var a=new _N(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new _N(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,h,c),2);return[d[0],d[1]]}},bD={kernelName:rv.Mean,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,s=r,u=a.shape.length,c=rv.util.parseAxisParam(o,a.shape),l=c,h=rv.backend_util.getAxesPermutation(l,u),d=null!=h,f=s.shouldExecuteOnCPU([a]),p=[],m=a;if(d){if(f){for(var v=s.texData.get(m.dataId).values,g=new Array(u),y=0;y<g.length;y++)g[y]=a.shape[h[y]];var b=ZI(v,a.shape,a.dtype,h,g);m=s.makeTensorInfo(g,a.dtype),s.texData.get(m.dataId).values=b}else m=BE(a,h,s);p.push(m),l=rv.backend_util.getInnerMostAxes(l.length,u)}rv.backend_util.assertAxesAreInnerMostDims("sum",l,u);var k=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(m.shape,l),2),_=k[0],w=k[1],x=_;i&&(x=rv.backend_util.expandShapeToKeepDim(_,c));for(var C=function(e,t,n,r){var a=rv.util.sizeFromShape(t),i=DE({inputs:{x:e},attrs:{shape:[rv.util.sizeFromShape(e.shape)/a,a]},backend:r}),o=PE(i,"float32","mean",r),s=DE({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(m,w,x,s),O=0,S=p;O<S.length;O++){var T=S[O];s.disposeIntermediateTensorInfo(T)}return C}},kD={kernelName:rv.Min,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=rv.util.parseAxisParam(i,a.shape),c=u,l=rv.backend_util.getAxesPermutation(c,s),h=a;null!=l&&(h=UE({inputs:{x:a},backend:n,attrs:{perm:l}}),c=rv.backend_util.getInnerMostAxes(c.length,a.shape.length)),rv.backend_util.assertAxesAreInnerMostDims("min",c,s);var d,f=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(h.shape,c),2),p=f[0],m=f[1],v=DE({inputs:{x:h},backend:n,attrs:{shape:[-1,rv.util.sizeFromShape(m)]}}),g=PE(v,v.dtype,"min",n);return d=DE(o?{inputs:{x:g},backend:n,attrs:{shape:rv.backend_util.expandShapeToKeepDim(p,u)}}:{inputs:{x:g},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),null!=l&&n.disposeIntermediateTensorInfo(h),d}},_D=SE({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:PI}),wD={kernelName:rv.Minimum,backendName:"webgl",kernelFunc:_D},xD=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=yI(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),c="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")},CD=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=yI(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=JI("rc",a),c=JI("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d="reflect"===r?0:1,f="";if(1===a){var p="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");f="\n        ".concat(i," rc = outputLoc;\n        ").concat(p,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(p,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n      ")}else{var m="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");f="\n        ".concat(i," rc = outputLoc;\n        ").concat(m,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(m,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(m,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(m,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")},OD={kernelName:rv.MirrorPad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,s=Object(rv.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CD(a.shape,i,o):new xD(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},SD=SE({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),TD={kernelName:rv.Mod,backendName:"webgl",kernelFunc:SD},ID=function(){function e(t,n,r){_classCallCheck(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),ED=SE({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),ND={kernelName:rv.RealDiv,backendName:"webgl",kernelFunc:ED},AD="return a - b;",RD=SE({opSnippet:AD,packedOpSnippet:AD,supportsComplex:!0,cpuKernelImpl:KI}),DD={kernelName:rv.Sub,backendName:"webgl",kernelFunc:RD};function jD(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=rv.util.parseAxisParam([i],a.shape),s=uD({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),u=rv.backend_util.expandShapeToKeepDim(s.shape,o),c=DE({inputs:{x:s},backend:n,attrs:{shape:u}}),l=RD({inputs:{a:a,b:c},backend:n}),h=tR({inputs:{x:l},backend:n}),d=VE({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=DE({inputs:{x:d},backend:n,attrs:{shape:u}}),p=ED({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}var FD={kernelName:rv.Softmax,backendName:"webgl",kernelFunc:jD},MD={kernelName:rv.Multinomial,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:jD({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=new ID(u.shape[0],u.shape[1],i),l=c.getCustomSetupFunc(o),h=n.runWebGLProgram(c,[u],"int32",l);return s||n.disposeIntermediateTensorInfo(u),h}},PD="return -x;",LD={kernelName:rv.Neg,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=_slicedToArray(zI(i.values,a.shape,a.dtype),2),s=o[0],u=o[1];return r.makeTensorInfo(u,a.dtype,s)}return t=Object(rv.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new uE(a.shape,PD):new iE(a.shape,PD),r.runWebGLProgram(t,[a],a.dtype)}},zD=rv.kernel_impls.nonMaxSuppressionV3Impl,BD={kernelName:rv.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(e){rv.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),h=zD(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},VD=rv.kernel_impls.nonMaxSuppressionV4Impl,WD={kernelName:rv.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(e){rv.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),h=n.readSync(i.dataId),d=VD(l,h,o,s,u,c),f=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},UD=rv.kernel_impls.nonMaxSuppressionV5Impl,HD={kernelName:rv.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(e){rv.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),h=n.readSync(i.dataId),d=UD(l,h,o,s,u,c),f=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},GD=function e(t,n,r,a){_classCallCheck(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")},KD={kernelName:rv.OneHot,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.depth,o=r.onValue,s=r.offValue,u=rv.util.sizeFromShape(a.shape),c=new GD(u,i,o,s),l=DE({inputs:{x:a},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[l],a.dtype);n.disposeIntermediateTensorInfo(l);var d=DE({inputs:{x:h},backend:n,attrs:{shape:[].concat(_toConsumableArray(a.shape),[i])}});return n.disposeIntermediateTensorInfo(h),d}};function qD(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=WN({inputs:{input:r},backend:n}),i=qD({inputs:{x:a},backend:n}),o=rA({inputs:{input:r},backend:n}),s=qD({inputs:{x:o},backend:n}),u=gE({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return dR({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var XD={kernelName:rv.ZerosLike,backendName:"webgl",kernelFunc:qD},ZD={kernelName:rv.OnesLike,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=WN({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=rA({inputs:{input:a},backend:r}),u=qD({inputs:{x:s},backend:r}),c=gE({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return dR({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}},YD={kernelName:rv.Pack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return rR({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){rv.util.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),rv.util.assert(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=oA({inputs:t.map((function(e){var t=rR({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}},QD=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=yI(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(r,"));\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(r,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")},JD=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=yI(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=JI("rc",a),c=JI("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d=[i+" rc = outputLoc;","".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],f=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",m=0,v=1===a?2:4;m<v;m++)p+="\n        ".concat(d[m],"\n        if (").concat(f,") {\n          result[").concat(m,"] = float(").concat(r,");\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(m,"] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")},$D=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue,s=Object(rv.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JD(a.shape,i,o):new QD(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)},ej={kernelName:rv.PadV2,backendName:"webgl",kernelFunc:$D},tj=SE({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),nj={kernelName:rv.Pow,backendName:"webgl",kernelFunc:tj},rj={kernelName:rv.Prod,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims,u=i.shape.length,c=[],l=rv.util.parseAxisParam(o,i.shape),h=l,d=rv.backend_util.getAxesPermutation(h,u),f=i;if(null!=d&&(f=UE({inputs:{x:i},backend:r,attrs:{perm:d}}),h=rv.backend_util.getInnerMostAxes(h.length,u),c.push(f)),rv.backend_util.assertAxesAreInnerMostDims("prod",h,u),r.shouldExecuteOnCPU([f])){var p=r.texData.get(f.dataId).values,m=BI(f.shape,f.dtype,p,h),v=m.outVals,g=m.outShape,y=m.outDtype;t=r.makeTensorInfo(g,y,v)}else{var b=_slicedToArray(rv.backend_util.computeOutAndReduceShapes(f.shape,h),2),k=b[0],_=b[1],w=rv.util.sizeFromShape(_),x=DE({inputs:{x:f},backend:r,attrs:{shape:[-1,w]}}),C=PE(x,Object(rv.sumOutType)(i.dtype),"prod",r);t=DE({inputs:{x:C},backend:r,attrs:{shape:k}}),c.push(x),c.push(C)}if(s){c.push(t);var O=rv.backend_util.expandShapeToKeepDim(t.shape,l);t=DE({inputs:{x:t},backend:r,attrs:{shape:O}})}return c.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}},aj=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=VI(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},ij={kernelName:rv.Range,backendName:"webgl",kernelFunc:aj},oj=OE({opSnippet:"return 1.0 / x;"}),sj={kernelName:rv.Reciprocal,backendName:"webgl",kernelFunc:oj},uj=OE({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),cj={kernelName:rv.Relu,backendName:"webgl",kernelFunc:uj},lj=OE({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),hj={kernelName:rv.Relu6,backendName:"webgl",kernelFunc:lj},dj=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=[];var o=_slicedToArray(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var h,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/f[0],",\n          ").concat(d[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},fj=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=_slicedToArray(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var h,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(d[0]/f[0],",\n          ").concat(d[1]/f[1],",\n          ").concat(d[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(c,".0,\n                                     ").concat(c,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")},pj={kernelName:rv.ResizeBilinear,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=_slicedToArray(r.size,2),u=s[0],c=s[1],l=Object(rv.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new fj(a.shape,u,c,i,o):new dj(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],"float32")}},mj=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=_slicedToArray(n,3),i=a[1],o=a[2],s=_slicedToArray(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],h=[r&&u>1?u-1:u,r&&c>1?c-1:c],d=l[0]/h[0],f=l[1]/h[1],p=1/d,m=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(v,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},vj={kernelName:rv.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new mj(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},gj=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=[];var o=_slicedToArray(t,4),s=o[0],u=o[1],c=o[2],l=o[3];this.outputShape=[s,n,r,l];var h,d=[a&&n>1?u-1:u,a&&r>1?c-1:c],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(d[0]/f[0],",\n          ").concat(d[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(c,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(a?"0.5":"0.0",")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")},yj={kernelName:rv.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=_slicedToArray(r.size,2),u=s[0],c=s[1],l=new gj(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],a.dtype)}},bj=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=_slicedToArray(n,3),i=a[1],o=a[2],s=_slicedToArray(t,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],h=[r&&u>1?u-1:u,r&&c>1?c-1:c],d=l[0]/h[0],f=l[1]/h[1],p=1/d,m=1/f,v=2*Math.ceil(p)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(d,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(v,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},kj={kernelName:rv.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new bj(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},_j=function e(t,n){_classCallCheck(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=yI(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")},wj=function e(t,n){_classCallCheck(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=JI("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=yI(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):""+r[e]}(a,e)}));return"getChannel(getX(".concat(r.join(","),"), vec2(").concat(r.slice(-2).join(","),"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")},xj={kernelName:rv.Reverse,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,s=rv.util.parseAxisParam(i,a.shape);if(0===o)return mE({inputs:{x:a},backend:n});var u=Object(rv.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wj(a.shape,s):new _j(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}},Cj=function e(t,n,r,a){_classCallCheck(this,e),this.variableNames=["Image"],this.outputShape=[];var i=t[1],o=t[2],s=Math.sin(n).toFixed(3),u=Math.cos(n).toFixed(3);this.outputShape=t;var c,l=_slicedToArray(rv.backend_util.getImageCenter(a,i,o),2),h=l[0],d=l[1],f=h.toFixed(3),p=d.toFixed(3);c="number"==typeof r?"float outputValue = ".concat(r.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(r.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ".concat(f,") * ").concat(u," - (float(y) - ").concat(p,") * ").concat(s,";\n          float coordYFloat = (float(x) - ").concat(f,") * ").concat(s," + (float(y) - ").concat(p,") * ").concat(u,";\n          int coordX = int(round(coordXFloat + ").concat(f,"));\n          int coordY = int(round(coordYFloat + ").concat(p,"));\n          ").concat(c,"\n          if(coordX >= 0 && coordX < ").concat(o," && coordY >= 0 && coordY < ").concat(i,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},Oj={kernelName:rv.RotateWithOffset,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=new Cj(a.shape,i,o,s);return u.runWebGLProgram(c,[a],a.dtype)}},Sj=OE({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),Tj={kernelName:rv.Round,backendName:"webgl",kernelFunc:Sj},Ij=OE({opSnippet:"return inversesqrt(x);",cpuKernelImpl:WI}),Ej={kernelName:rv.Rsqrt,backendName:"webgl",kernelFunc:Ij},Nj=function e(t,n,r,a,i,o){!(arguments.length>6&&void 0!==arguments[6])||arguments[6];_classCallCheck(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=yI(i.length),u=yI(o.length),c="";1===r?c="i":2===r&&(c="i, j");var l="";1===a?l="i":2===a&&(l="i, coords[1]"),this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(getIndices(").concat(c,"));\n              flattenedIndex += index * ").concat(n>1?"strides[j]":"strides",";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates(").concat(l,");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")},Aj={kernelName:rv.ScatterNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=rv.backend_util.calculateShapes(i,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,d=s.outputSize,f=[d/l,l];if(0===d)return n.makeTensorInfo(o,a.dtype);var p=DE({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),m=DE({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),v=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new Nj(c,u,p.shape.length,m.shape.length,h,f),y=n.runWebGLProgram(g,[m,p,v],m.dtype),b=DE({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),b}},Rj=function e(t,n,r){var a,i;if(_classCallCheck(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<n.length;c++)u.push(""+o[c]),c<t&&s.push(""+o[c]);a=s.join(),i=u.join()}var l=yI(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")},Dj={kernelName:rv.Select,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new Rj(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],Object(rv.upcastType)(a.dtype,i.dtype))}},jj=OE({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(rv.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(rv.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),Fj={kernelName:rv.Selu,backendName:"webgl",kernelFunc:jj},Mj=OE({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),Pj={kernelName:rv.Sigmoid,backendName:"webgl",kernelFunc:Mj},Lj=OE({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),zj={kernelName:rv.Sign,backendName:"webgl",kernelFunc:Lj},Bj=OE({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),Vj={kernelName:rv.Sin,backendName:"webgl",kernelFunc:Bj},Wj=OE({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),Uj={kernelName:rv.Sinh,backendName:"webgl",kernelFunc:Wj},Hj=OE({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),Gj={kernelName:rv.Softplus,backendName:"webgl",kernelFunc:Hj},Kj={kernelName:rv.SpaceToBatchND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;rv.util.assert(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,_toConsumableArray(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=[],h=$D({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),d=rv.backend_util.getReshaped(h.shape,i,s,!1),f=rv.backend_util.getPermuted(d.length,i.length,!1),p=rv.backend_util.getReshapedPermuted(h.shape,i,s,!1),m=DE({inputs:{x:h},backend:n,attrs:{shape:d}}),v=UE({inputs:{x:m},backend:n,attrs:{perm:f}}),g=DE({inputs:{x:v},backend:n,attrs:{shape:p}});return l.push(h),l.push(m),l.push(v),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},qj={kernelName:rv.SparseToDense,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=rv.backend_util.calculateShapes(i,a,s),c=u.sliceRank,l=u.numUpdates,h=u.strides,d=u.outputSize,f=new Nj(l,c,a.shape.length,i.shape.length,h,[d,1],!1),p=n.runWebGLProgram(f,[i,a,o],i.dtype),m=DE({inputs:{x:p},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(p),m}},Xj={kernelName:rv.SplitV,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=r.axis,s=rv.util.parseAxisParam(o,a.shape)[0],u=rv.backend_util.prepareSplitSize(a,i,s),c=new Array(a.shape.length).fill(0),l=a.shape.slice();return u.map((function(e){var t=_toConsumableArray(l);t[s]=e;var r=MN({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[s]+=e,r}))}},Zj=OE({opSnippet:"return sqrt(x);"}),Yj={kernelName:rv.Sqrt,backendName:"webgl",kernelFunc:Zj},Qj=OE({opSnippet:"return x * x;"}),Jj={kernelName:rv.Square,backendName:"webgl",kernelFunc:Qj},$j=SE({opSnippet:"return (a - b) * (a - b);",packedOpSnippet:"return (a - b) * (a - b);"}),eF={kernelName:rv.SquaredDifference,backendName:"webgl",kernelFunc:$j},tF={kernelName:rv.Step,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=new iE(a.shape,"if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "));return r.runWebGLProgram(i,[a],a.dtype)}},nF=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=yI(r.length),o=yI(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")},rF={kernelName:rv.StridedSlice,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,c=a.beginMask,l=a.endMask,h=a.ellipsisMask,d=a.newAxisMask,f=a.shrinkAxisMask,p=rv.slice_util.sliceInfo(i.shape,o,s,u,c,l,h,d,f),m=p.nonStrided,v=p.$begin,g=p.$strides,y=p.size,b=p.newShape,k=p.outShape,_=DE({inputs:{x:i},backend:r,attrs:{shape:b}});if(m){var w=MN({inputs:{x:_},backend:r,attrs:{begin:v,size:y}});t=DE({inputs:{x:w},backend:r,attrs:{shape:k}}),r.disposeIntermediateTensorInfo(w)}else if(k.some((function(e){return 0===e})))t=r.makeTensorInfo(k,i.dtype,[]);else if(r.shouldExecuteOnCPU([_])){var x=r.texData.get(_.dataId).values,C=Object(rv.buffer)(_.shape,_.dtype,x),O=GI(k,C,g,v);t=r.makeTensorInfo(k,_.dtype,O.values)}else{var S=new nF(v,g,k);t=r.runWebGLProgram(S,[_],_.dtype)}var T=DE({inputs:{x:t},backend:r,attrs:{shape:k}});return r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(t),T}},aF=OE({opSnippet:"return tan(x);"}),iF={kernelName:rv.Tan,backendName:"webgl",kernelFunc:aF},oF=OE({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),sF={kernelName:rv.Tanh,backendName:"webgl",kernelFunc:oF},uF=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=yI(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")};function cF(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype){var o=n.readSync(a.dataId).map((function(e){return rv.util.decodeString(e)})),s=Object(rv.buffer)(a.shape,a.dtype,o),u=qI(s,i);return n.makeTensorInfo(u.shape,u.dtype,u.values)}var c=new uF(a.shape,i);return n.runWebGLProgram(c,[a],a.dtype)}for(var lF={kernelName:rv.Tile,backendName:"webgl",kernelFunc:cF},hF={kernelName:rv.TopK,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=n.readSync(a.dataId),u=_slicedToArray(XI(s,a.shape,a.dtype,i,o),2),c=u[0],l=u[1];return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}},dF={kernelName:rv.Unique,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;KT(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=YI(o,a,i.shape,i.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}},fF={kernelName:rv.Unpack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,h=0;h<s;h++)h!==i&&(c[l++]=o.shape[h]);var d=[],f=new Array(s).fill(0),p=o.shape.slice();p[i]=1;for(var m=new Array(u),v=0;v<m.length;v++){f[i]=v;var g=MN({inputs:{x:o},backend:n,attrs:{begin:f,size:p}}),y=DE({inputs:{x:g},backend:n,attrs:{shape:c}});m[v]=y,d.push(g)}return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}},pF=function e(t,n){_classCallCheck(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")},mF=0,vF=[iD,sD,KE,qE,ZE,QE,eN,rN,aN,iN,cN,lN,dN,pN,yN,vN,kN,CN,xN,TN,IN,EN,RN,LN,zN,HN,qN,YN,$N,yE,sA,yA,bA,fA,_A,wA,kA,CA,SA,IA,RA,DA,FA,VA,WA,LA,HA,KA,XA,ZA,QA,$A,nR,aR,sR,lR,pR,vR,bR,_R,CR,OR,SR,IR,NR,RR,jR,vE,FR,aA,PR,zR,VR,_E,UR,GR,KR,YR,XR,JR,eD,nD,cD,fD,dD,vD,gD,yD,hD,bD,kD,wD,OD,TD,MD,RE,LD,BD,WD,HD,VN,KD,ZD,YD,ej,nj,CE,rj,ij,UN,ND,sj,hj,cj,jE,pj,vj,yj,kj,xj,Oj,Tj,Ej,Aj,Dj,Fj,Pj,zj,Vj,Uj,PN,FD,Gj,Kj,qj,Xj,Yj,Jj,eF,tF,rF,DD,WE,iF,sF,lF,hF,HE,dF,fF,{kernelName:rv.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],c=0,l=rv.backend_util.getAxesPermutation([c],s),h=a;null!=l&&(h=UE({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(h),c=rv.backend_util.getInnerMostAxes(1,s)[0]);var d=rv.backend_util.segment_util.computeOutShape(h.shape,c,o),f=rv.util.sizeFromShape([h.shape[c]]),p=DE({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});u.push(p);var m=DE({inputs:{x:function e(t,r,a,i,o){var s=t.shape[0],c=t.shape[1],l=rv.backend_util.segment_util.segOpComputeOptimalWindowSize(c,o),h=new pF({windowSize:l,inSize:c,batchSize:s,numSegments:o},r),d=n.compileAndRun(h,[t,a],i);if(u.push(d),d.shape[1]===o)return d;var f=aj({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=cF({inputs:{x:f},backend:n,attrs:{reps:[c/l]}});return u.push(f),u.push(p),e(d,r,p,i,o)}(p,"unsortedSegmentSum",i,Object(rv.sumOutType)(a.dtype),o)},backend:n,attrs:{shape:d}}),v=m;if(null!=l){u.push(m);var g=rv.backend_util.getUndoAxesPermutation(l);v=UE({inputs:{x:v},backend:n,attrs:{perm:g}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},XD];mF<vF.length;mF++){var gF=vF[mF];Object(rv.registerKernel)(gF)}var yF,bF=function(e,t){return"isPaused"===e?t+" is paused.":"isPlaying"===e?t+" is playing.":"isReady"===e?t+" is ready.":"webcamError"===e||"screencapError"===e?t+" error.":"hasEnded"===e?t+" has ended.":t+" is not ready."},kF=window.require,_F=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0].getContext("2d");r.canvas.width=1366,r.canvas.height=768,r.clearRect(0,0,r.canvas.width,r.canvas.height);var a="18px sans-serif";r.font=a,r.textBaseline="top";var i=parseInt(a,10);wF(t[1],r,r.canvas.width/t[2][1],r.canvas.height/t[2][0],i)},wF=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].forEach((function(e){var n=e.bbox[0]*t[2],r=e.bbox[1]*t[3],a=e.bbox[2]*t[2],i=e.bbox[3]*t[3];t[1].fillStyle="#00FFFF";var o=e.class+" "+(100*e.score).toFixed(2)+"%",s=t[1].measureText(o).width;t[1].fillRect(n<0?n+a-s:n,(r-t[4]<0?r+i:r)-t[4],s,t[4]),t[1].strokeStyle="#00FFFF",t[1].lineWidth=2,t[1].strokeRect(n,r,a,i)})),t[0].forEach((function(e){var n=e.bbox[0]*t[2],r=e.bbox[1]*t[3],a=e.bbox[2]*t[2],i=e.bbox[3]*t[3],o=e.class+" "+(100*e.score).toFixed(2)+"%",s=t[1].measureText(o).width,u=n<0?n+a-s:n,c=(r-t[4]<0?r+i:r)-t[4];t[1].fillStyle="#000000",t[1].fillText(o,u,c)}))},xF=function(e,t,n){e.style.height=t.offsetHeight.toString()+"px",n.style.height=(t.offsetHeight-4).toString()+"px"},CF=function(){function e(t,n){if(_classCallCheck(this,e),this.DataSharing=t,this.notifierService=n,this.videoStatus="",this.highestcount=[],this.isloading=!0,this.DataSharing.Title.next("Screen Capture"),kF)try{var r=kF("electron").remote.Menu;this.Menu=r}catch(a){this.notifierService.showNotification("Error on Electron.","OK","error")}else console.warn("Logic can only run on Electron."),this.notifierService.showNotification("Logic can only run on Electron.","OK","error")}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.DataSharing.ClearPredictions.subscribe((function(t){return e.highestcount=[]})),this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([])}},{key:"ngOnDestroy",value:function(){this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([]),this.highestcount=[],this.localstream&&(this.videoElement.pause(),this.localstream.getTracks()[0].stop(),this.SetVideoStatus("hasEnded"))}},{key:"ngAfterViewInit",value:function(){var e=this;this.videoElement=this.vid.nativeElement,this.canvasElement=this.canvas.nativeElement,this.subcontainerElement=this.subcontainer.nativeElement,this.DataSharing.Model.subscribe((function(t){e.model=t,e.model&&setTimeout((function(){e.isloading=!1}))})),this.videoElement.onloadedmetadata=function(){xF(e.subcontainerElement,e.videoElement,e.canvasElement),e.SetVideoStatus("isReady")},this.videoElement.onloadeddata=function(){e.model&&e.onStartDetection()},this.videoElement.onplaying=function(){e.SetVideoStatus("isPlaying"),e.detectFrame()};var t=this.canvasElement.getContext("2d");t.fillStyle="#808080aa",t.fillRect(0,0,t.canvas.width,t.canvas.height)}},{key:"ngAfterViewChecked",value:function(){xF(this.subcontainerElement,this.videoElement,this.canvasElement)}},{key:"onGetVideoSources",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!kF){e.next=13;break}return e.prev=1,e.next=4,kF("electron").desktopCapturer.getSources({types:["window","screen"]});case 4:t=e.sent,this.Menu.buildFromTemplate(t.map((function(e){return{label:e.name,click:function(){return n.SelectSource(e)}}}))).popup(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.notifierService.showNotification("Error on Electron.","OK","error");case 11:e.next=14;break;case 13:console.warn("Logic can only run on Electron."),this.notifierService.showNotification("Logic can only run on Electron.","OK","error");case 14:case"end":return e.stop()}}),e,this,[[1,8]])})))}},{key:"SelectSource",value:function(e){return ns(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.SetVideoStatus("hasEnded"),document.getElementById("screencapsources").innerText=e.name,n={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e.id}}},t.next=5,navigator.mediaDevices.getUserMedia(n);case 5:this.localstream=t.sent,this.videoElement.srcObject=this.localstream,this.videoElement.play(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),this.SetVideoStatus("screencapError"),this.notifierService.showNotification("Screen Capture error.","OK","error");case 13:case"end":return t.stop()}}),t,this,[[0,10]])})))}},{key:"onStartDetection",value:function(){this.highestcount=[],this.SetVideoStatus("isReady"),this.detectFrame();var e=this.canvasElement.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height)}},{key:"detectFrame",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{xF(this.subcontainerElement,this.videoElement,this.canvasElement),rv.tidy((function(){setTimeout((function(){return ns(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return rv.engine().startScope(),e.next=3,rv.browser.fromPixels(this.videoElement);case 3:return t=e.sent,e.next=6,this.model.detect(t);case 6:n=e.sent,_F(this.canvasElement,n,t.shape),this.DataSharing.UpdatePreditions(n,this.highestcount,this.videoStatus),rv.engine().endScope(),"isPlaying"===this.videoStatus&&requestAnimationFrame((function(){return r.detectFrame()}));case 8:case"end":return e.stop()}}),e,this)})))}),50)}))}catch(n){this.notifierService.showNotification("Error on object detection.","OK","error")}case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onPlayOrPause",value:function(){""!==this.videoStatus&&("isPlaying"!=this.videoStatus?(this.videoElement.play(),this.SetVideoStatus("isPlaying")):(this.videoElement.pause(),this.SetVideoStatus("isPaused")))}},{key:"SetVideoStatus",value:function(e){this.videoStatus=e,this.videostatusElement.nativeElement.innerHTML=bF(e,"Screen Capture")}}]),e}(),OF=((yF=function e(){var t=this;_classCallCheck(this,e),this.CurrentPredictions=new Fs([]),this.AllPredictions=new Fs([]),this.ClearPredictions=new Fs([]),this.Title=new Fs(""),this.Model=new Fs(void 0),this.UpdatePreditions=function(e,n,r){var a=e.map((function(e){return e.class})),i=_toConsumableArray(new Set(a)).map((function(e){return{count:a.filter((function(t){return t===e})).length,item:e}}));i.forEach((function(e){var t=e.count,a=e.item;if(0===n.filter((function(e){return e.item===a})).length)"hasEnded"!=r&&n.push({count:t,item:a});else{var i=-1,o=!1;n.forEach((function(e,n){var r=e.count,s=e.item;o||(o=s===a&&r<t)&&(i=n)})),o&&"hasEnded"!=r&&(n.splice(i,1),n.push({count:t,item:a}))}})),i.sort((function(e,t){return t.count-e.count})),n.sort((function(e,t){return t.count-e.count})),t.CurrentPredictions.next(i),t.AllPredictions.next(n)}}).ngInjectableDef=ve({factory:function(){return new yF},token:yF,providedIn:"root"}),yF),SF=function(){function e(t,n){_classCallCheck(this,e),this.data=t,this.snackBarRef=n}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}();function TF(){throw Error("Host already has a portal attached")}var IF=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"attach",value:function(e){return null==e&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),e.hasAttached()&&TF(),this._attachedHost=e,e.attach(this)}},{key:"detach",value:function(){var e=this._attachedHost;null==e?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,e.detach())}},{key:"isAttached",get:function(){return null!=this._attachedHost}},{key:"setAttachedHost",value:function(e){this._attachedHost=e}}]),e}(),EF=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this)).component=e,o.viewContainerRef=r,o.injector=a,o.componentFactoryResolver=i,o}return n}(IF),NF=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this)).templateRef=e,i.viewContainerRef=r,i.context=a,i}return _createClass(n,[{key:"origin",get:function(){return this.templateRef.elementRef}},{key:"attach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.context;return this.context=t,_get(_getPrototypeOf(n.prototype),"attach",this).call(this,e)}},{key:"detach",value:function(){return this.context=void 0,_get(_getPrototypeOf(n.prototype),"detach",this).call(this)}}]),n}(IF),AF=function(){function e(){_classCallCheck(this,e),this._isDisposed=!1}return _createClass(e,[{key:"hasAttached",value:function(){return!!this._attachedPortal}},{key:"attach",value:function(e){return e||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&TF(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),e instanceof EF?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof NF?(this._attachedPortal=e,this.attachTemplatePortal(e)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}},{key:"detach",value:function(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}},{key:"dispose",value:function(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}},{key:"setDisposeFn",value:function(e){this._disposeFn=e}},{key:"_invokeDisposeFn",value:function(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}]),e}(),RF=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this)).outletElement=e,o._componentFactoryResolver=r,o._appRef=a,o._defaultInjector=i,o}return _createClass(n,[{key:"attachComponentPortal",value:function(e){var t,n=this,r=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);return e.viewContainerRef?(t=e.viewContainerRef.createComponent(r,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn((function(){return t.destroy()}))):(t=r.create(e.injector||this._defaultInjector),this._appRef.attachView(t.hostView),this.setDisposeFn((function(){n._appRef.detachView(t.hostView),t.destroy()}))),this.outletElement.appendChild(this._getComponentRootNode(t)),t}},{key:"attachTemplatePortal",value:function(e){var t=this,n=e.viewContainerRef,r=n.createEmbeddedView(e.templateRef,e.context);return r.detectChanges(),r.rootNodes.forEach((function(e){return t.outletElement.appendChild(e)})),this.setDisposeFn((function(){var e=n.indexOf(r);-1!==e&&n.remove(e)})),r}},{key:"dispose",value:function(){_get(_getPrototypeOf(n.prototype),"dispose",this).call(this),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}},{key:"_getComponentRootNode",value:function(e){return e.hostView.rootNodes[0]}}]),n}(AF),DF=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this))._componentFactoryResolver=e,a._viewContainerRef=r,a._isInitialized=!1,a.attached=new ba,a}return _createClass(n,[{key:"portal",get:function(){return this._attachedPortal},set:function(e){(!this.hasAttached()||e||this._isInitialized)&&(this.hasAttached()&&_get(_getPrototypeOf(n.prototype),"detach",this).call(this),e&&_get(_getPrototypeOf(n.prototype),"attach",this).call(this,e),this._attachedPortal=e)}},{key:"attachedRef",get:function(){return this._attachedRef}},{key:"ngOnInit",value:function(){this._isInitialized=!0}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"dispose",this).call(this),this._attachedPortal=null,this._attachedRef=null}},{key:"attachComponentPortal",value:function(e){e.setAttachedHost(this);var t=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,r=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),a=t.createComponent(r,t.length,e.injector||t.injector);return _get(_getPrototypeOf(n.prototype),"setDisposeFn",this).call(this,(function(){return a.destroy()})),this._attachedPortal=e,this._attachedRef=a,this.attached.emit(a),a}},{key:"attachTemplatePortal",value:function(e){var t=this;e.setAttachedHost(this);var r=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context);return _get(_getPrototypeOf(n.prototype),"setDisposeFn",this).call(this,(function(){return t._viewContainerRef.clear()})),this._attachedPortal=e,this._attachedRef=r,this.attached.emit(r),r}}]),n}(AF),jF=function e(){_classCallCheck(this,e)},FF=function(){function e(t,n){_classCallCheck(this,e),this._parentInjector=t,this._customTokens=n}return _createClass(e,[{key:"get",value:function(e,t){var n=this._customTokens.get(e);return void 0!==n?n:this._parentInjector.get(e,t)}}]),e}();function MF(e){return function(t){return t.lift(new PF(e))}}var PF=function(){function e(t){_classCallCheck(this,e),this.notifier=t}return _createClass(e,[{key:"call",value:function(e,t){var n=new LF(e),r=U(n,this.notifier);return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n}}]),e}(),LF=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).seenValue=!1,r}return _createClass(n,[{key:"notifyNext",value:function(e,t,n,r,a){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),n}(H);function zF(e,t,n,r){return a(n)&&(r=n,n=void 0),r?zF(e,t,n).pipe(G((function(e){return c(e)?r.apply(void 0,_toConsumableArray(e)):r(e)}))):new C((function(r){!function e(t,n,r,a,i){var o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(t)){var s=t;t.addEventListener(n,r,i),o=function(){return s.removeEventListener(n,r,i)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(t)){var u=t;t.on(n,r),o=function(){return u.off(n,r)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(t)){var c=t;t.addListener(n,r),o=function(){return c.removeListener(n,r)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var l=0,h=t.length;l<h;l++)e(t[l],n,r,a,i)}a.add(o)}(e,t,(function(e){r.next(arguments.length>1?Array.prototype.slice.call(arguments):e)}),r,n)}))}var BF=function(){function e(t,n){_classCallCheck(this,e),this.compare=t,this.keySelector=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new VF(e,this.compare,this.keySelector))}}]),e}(),VF=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).keySelector=a,i.hasKey=!1,"function"==typeof r&&(i.compare=r),i}return _createClass(n,[{key:"compare",value:function(e,t){return e===t}},{key:"_next",value:function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(a){return this.destination.error(a)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(a){return this.destination.error(a)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))}}]),n}(g),WF=function(){function e(t){_classCallCheck(this,e),this.durationSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new UF(e,this.durationSelector))}}]),e}(),UF=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).durationSelector=r,a.hasValue=!1,a}return _createClass(n,[{key:"_next",value:function(e){if(this.value=e,this.hasValue=!0,!this.throttled){var t;try{t=(0,this.durationSelector)(e)}catch(r){return this.destination.error(r)}var n=U(this,t);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}},{key:"clearThrottle",value:function(){var e=this.value,t=this.hasValue,n=this.throttled;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),t&&(this.value=null,this.hasValue=!1,this.destination.next(e))}},{key:"notifyNext",value:function(e,t,n,r){this.clearThrottle()}},{key:"notifyComplete",value:function(){this.clearThrottle()}}]),n}(H);function HF(e){return!c(e)&&e-parseFloat(e)+1>=0}function GF(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}function KF(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zd;return t=function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=-1;return HF(t)?r=Number(t)<1?1:Number(t):D(t)&&(n=t),D(n)||(n=Zd),new C((function(t){var a=HF(e)?e:+e-n.now();return n.schedule(GF,a,{index:0,period:r,subscriber:t})}))}(e,n)},function(e){return e.lift(new WF(t))}}var qF,XF,ZF=((qF=function(){function e(t,n){_classCallCheck(this,e),this._ngZone=t,this._platform=n,this._scrolled=new A,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map}return _createClass(e,[{key:"register",value:function(e){var t=this;this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe((function(){return t._scrolled.next(e)})))}},{key:"deregister",value:function(e){var t=this.scrollContainers.get(e);t&&(t.unsubscribe(),this.scrollContainers.delete(e))}},{key:"scrolled",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this._platform.isBrowser?new C((function(n){e._globalSubscription||e._addGlobalListener();var r=t>0?e._scrolled.pipe(KF(t)).subscribe(n):e._scrolled.subscribe(n);return e._scrolledCount++,function(){r.unsubscribe(),e._scrolledCount--,e._scrolledCount||e._removeGlobalListener()}})):js()}},{key:"ngOnDestroy",value:function(){var e=this;this._removeGlobalListener(),this.scrollContainers.forEach((function(t,n){return e.deregister(n)})),this._scrolled.complete()}},{key:"ancestorScrolled",value:function(e,t){var n=this.getAncestorScrollContainers(e);return this.scrolled(t).pipe(Hs((function(e){return!e||n.indexOf(e)>-1})))}},{key:"getAncestorScrollContainers",value:function(e){var t=this,n=[];return this.scrollContainers.forEach((function(r,a){t._scrollableContainsElement(a,e)&&n.push(a)})),n}},{key:"_scrollableContainsElement",value:function(e,t){var n=t.nativeElement,r=e.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}},{key:"_addGlobalListener",value:function(){var e=this;this._globalSubscription=this._ngZone.runOutsideAngular((function(){return zF(window.document,"scroll").subscribe((function(){return e._scrolled.next()}))}))}},{key:"_removeGlobalListener",value:function(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}]),e}()).ngInjectableDef=ve({factory:function(){return new qF(Fe(Xa),Fe(Vd))},token:qF,providedIn:"root"}),qF),YF=function(){function e(t,n,r,a){var i=this;_classCallCheck(this,e),this.elementRef=t,this.scrollDispatcher=n,this.ngZone=r,this.dir=a,this._destroyed=new A,this._elementScrolled=new C((function(e){return i.ngZone.runOutsideAngular((function(){return zF(i.elementRef.nativeElement,"scroll").pipe(MF(i._destroyed)).subscribe(e)}))}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.scrollDispatcher.register(this)}},{key:"ngOnDestroy",value:function(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}},{key:"elementScrolled",value:function(){return this._elementScrolled}},{key:"getElementRef",value:function(){return this.elementRef}},{key:"scrollTo",value:function(e){var t=this.elementRef.nativeElement,n=this.dir&&"rtl"==this.dir.value;e.left=null==e.left?n?e.end:e.start:e.left,e.right=null==e.right?n?e.start:e.end:e.right,null!=e.bottom&&(e.top=t.scrollHeight-t.clientHeight-e.bottom),n&&Kd()!=Gd.NORMAL?(null!=e.left&&(e.right=t.scrollWidth-t.clientWidth-e.left),Kd()==Gd.INVERTED?e.left=e.right:Kd()==Gd.NEGATED&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=t.scrollWidth-t.clientWidth-e.right),this._applyScrollToOptions(e)}},{key:"_applyScrollToOptions",value:function(e){var t=this.elementRef.nativeElement;"object"==typeof document&&"scrollBehavior"in document.documentElement.style?t.scrollTo(e):(null!=e.top&&(t.scrollTop=e.top),null!=e.left&&(t.scrollLeft=e.left))}},{key:"measureScrollOffset",value:function(e){var t=this.elementRef.nativeElement;if("top"==e)return t.scrollTop;if("bottom"==e)return t.scrollHeight-t.clientHeight-t.scrollTop;var n=this.dir&&"rtl"==this.dir.value;return"start"==e?e=n?"right":"left":"end"==e&&(e=n?"left":"right"),n&&Kd()==Gd.INVERTED?"left"==e?t.scrollWidth-t.clientWidth-t.scrollLeft:t.scrollLeft:n&&Kd()==Gd.NEGATED?"left"==e?t.scrollLeft+t.scrollWidth-t.clientWidth:-t.scrollLeft:"left"==e?t.scrollLeft:t.scrollWidth-t.clientWidth-t.scrollLeft}}]),e}(),QF=function e(){_classCallCheck(this,e)},JF=((XF=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._platform=t,n.runOutsideAngular((function(){r._change=t.isBrowser?te(zF(window,"resize"),zF(window,"orientationchange")):js(),r._invalidateCache=r.change().subscribe((function(){return r._updateViewportSize()}))}))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._invalidateCache.unsubscribe()}},{key:"getViewportSize",value:function(){this._viewportSize||this._updateViewportSize();var e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}},{key:"getViewportRect",value:function(){var e=this.getViewportScrollPosition(),t=this.getViewportSize(),n=t.width,r=t.height;return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+n,height:r,width:n}}},{key:"getViewportScrollPosition",value:function(){if(!this._platform.isBrowser)return{top:0,left:0};var e=document.documentElement,t=e.getBoundingClientRect();return{top:-t.top||document.body.scrollTop||window.scrollY||e.scrollTop||0,left:-t.left||document.body.scrollLeft||window.scrollX||e.scrollLeft||0}}},{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return e>0?this._change.pipe(KF(e)):this._change}},{key:"_updateViewportSize",value:function(){this._viewportSize=this._platform.isBrowser?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0}}}]),e}()).ngInjectableDef=ve({factory:function(){return new XF(Fe(Vd),Fe(Xa))},token:XF,providedIn:"root"}),XF),$F=function(){function e(t,n){_classCallCheck(this,e),this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=n}return _createClass(e,[{key:"attach",value:function(){}},{key:"enable",value:function(){if(this._canBeEnabled()){var e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Pd(-this._previousScrollPosition.left),e.style.top=Pd(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}},{key:"disable",value:function(){if(this._isEnabled){var e=this._document.documentElement,t=e.style,n=this._document.body.style,r=t.scrollBehavior||"",a=n.scrollBehavior||"";this._isEnabled=!1,t.left=this._previousHTMLStyles.left,t.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),t.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),t.scrollBehavior=r,n.scrollBehavior=a}}},{key:"_canBeEnabled",value:function(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;var e=this._document.body,t=this._viewportRuler.getViewportSize();return e.scrollHeight>t.height||e.scrollWidth>t.width}}]),e}();function eM(){return Error("Scroll strategy has already been attached.")}var tM=function(){function e(t,n,r,a){var i=this;_classCallCheck(this,e),this._scrollDispatcher=t,this._ngZone=n,this._viewportRuler=r,this._config=a,this._scrollSubscription=null,this._detach=function(){i.disable(),i._overlayRef.hasAttached()&&i._ngZone.run((function(){return i._overlayRef.detach()}))}}return _createClass(e,[{key:"attach",value:function(e){if(this._overlayRef)throw eM();this._overlayRef=e}},{key:"enable",value:function(){var e=this;if(!this._scrollSubscription){var t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe((function(){var t=e._viewportRuler.getViewportScrollPosition().top;Math.abs(t-e._initialScrollPosition)>e._config.threshold?e._detach():e._overlayRef.updatePosition()}))):this._scrollSubscription=t.subscribe(this._detach)}}},{key:"disable",value:function(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}},{key:"detach",value:function(){this.disable(),this._overlayRef=null}}]),e}(),nM=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"enable",value:function(){}},{key:"disable",value:function(){}},{key:"attach",value:function(){}}]),e}();function rM(e,t){return t.some((function(t){return e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right}))}function aM(e,t){return t.some((function(t){return e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right}))}var iM,oM=function(){function e(t,n,r,a){_classCallCheck(this,e),this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this._config=a,this._scrollSubscription=null}return _createClass(e,[{key:"attach",value:function(e){if(this._overlayRef)throw eM();this._overlayRef=e}},{key:"enable",value:function(){var e=this;this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe((function(){if(e._overlayRef.updatePosition(),e._config&&e._config.autoClose){var t=e._overlayRef.overlayElement.getBoundingClientRect(),n=e._viewportRuler.getViewportSize(),r=n.width,a=n.height;rM(t,[{width:r,height:a,bottom:a,right:r,top:0,left:0}])&&(e.disable(),e._ngZone.run((function(){return e._overlayRef.detach()})))}})))}},{key:"disable",value:function(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}},{key:"detach",value:function(){this.disable(),this._overlayRef=null}}]),e}(),sM=((iM=function e(t,n,r,a){var i=this;_classCallCheck(this,e),this._scrollDispatcher=t,this._viewportRuler=n,this._ngZone=r,this.noop=function(){return new nM},this.close=function(e){return new tM(i._scrollDispatcher,i._ngZone,i._viewportRuler,e)},this.block=function(){return new $F(i._viewportRuler,i._document)},this.reposition=function(e){return new oM(i._scrollDispatcher,i._viewportRuler,i._ngZone,e)},this._document=a}).ngInjectableDef=ve({factory:function(){return new iM(Fe(ZF),Fe(JF),Fe(Xa),Fe(Is))},token:iM,providedIn:"root"}),iM),uM=function e(t){if(_classCallCheck(this,e),this.scrollStrategy=new nM,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t)for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];void 0!==t[a]&&(this[a]=t[a])}},cM=function e(t,n,r,a,i){_classCallCheck(this,e),this.offsetX=r,this.offsetY=a,this.panelClass=i,this.originX=t.originX,this.originY=t.originY,this.overlayX=n.overlayX,this.overlayY=n.overlayY},lM=function e(t,n){_classCallCheck(this,e),this.connectionPair=t,this.scrollableViewProperties=n};function hM(e,t){if("top"!==t&&"bottom"!==t&&"center"!==t)throw Error("ConnectedPosition: Invalid ".concat(e,' "').concat(t,'". Expected "top", "bottom" or "center".'))}function dM(e,t){if("start"!==t&&"end"!==t&&"center"!==t)throw Error("ConnectedPosition: Invalid ".concat(e,' "').concat(t,'". Expected "start", "end" or "center".'))}var fM,pM,mM=((pM=function(){function e(t){var n=this;_classCallCheck(this,e),this._attachedOverlays=[],this._keydownListener=function(e){for(var t=n._attachedOverlays,r=t.length-1;r>-1;r--)if(t[r]._keydownEventSubscriptions>0){t[r]._keydownEvents.next(e);break}},this._document=t}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._detach()}},{key:"add",value:function(e){this.remove(e),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0),this._attachedOverlays.push(e)}},{key:"remove",value:function(e){var t=this._attachedOverlays.indexOf(e);t>-1&&this._attachedOverlays.splice(t,1),0===this._attachedOverlays.length&&this._detach()}},{key:"_detach",value:function(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}]),e}()).ngInjectableDef=ve({factory:function(){return new pM(Fe(Is))},token:pM,providedIn:"root"}),pM),vM=((fM=function(){function e(t){_classCallCheck(this,e),this._document=t}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}},{key:"getContainerElement",value:function(){return this._containerElement||this._createContainer(),this._containerElement}},{key:"_createContainer",value:function(){for(var e=this._document.getElementsByClassName("cdk-overlay-container"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);var n=this._document.createElement("div");n.classList.add("cdk-overlay-container"),this._document.body.appendChild(n),this._containerElement=n}}]),e}()).ngInjectableDef=ve({factory:function(){return new fM(Fe(Is))},token:fM,providedIn:"root"}),fM),gM=function(){function e(t,n,r,a,i,o,s,u){var c=this;_classCallCheck(this,e),this._portalOutlet=t,this._host=n,this._pane=r,this._config=a,this._ngZone=i,this._keyboardDispatcher=o,this._document=s,this._location=u,this._backdropElement=null,this._backdropClick=new A,this._attachments=new A,this._detachments=new A,this._locationChanges=p.EMPTY,this._backdropClickHandler=function(e){return c._backdropClick.next(e)},this._keydownEventsObservable=new C((function(e){var t=c._keydownEvents.subscribe(e);return c._keydownEventSubscriptions++,function(){t.unsubscribe(),c._keydownEventSubscriptions--}})),this._keydownEvents=new A,this._keydownEventSubscriptions=0,a.scrollStrategy&&(this._scrollStrategy=a.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=a.positionStrategy}return _createClass(e,[{key:"overlayElement",get:function(){return this._pane}},{key:"backdropElement",get:function(){return this._backdropElement}},{key:"hostElement",get:function(){return this._host}},{key:"attach",value:function(e){var t=this,n=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(lu(1)).subscribe((function(){t.hasAttached()&&t.updatePosition()})),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe((function(){return t.dispose()}))),n}},{key:"detach",value:function(){if(this.hasAttached()){this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();var e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),e}}},{key:"dispose",value:function(){var e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,e&&this._detachments.next(),this._detachments.complete()}},{key:"hasAttached",value:function(){return this._portalOutlet.hasAttached()}},{key:"backdropClick",value:function(){return this._backdropClick.asObservable()}},{key:"attachments",value:function(){return this._attachments.asObservable()}},{key:"detachments",value:function(){return this._detachments.asObservable()}},{key:"keydownEvents",value:function(){return this._keydownEventsObservable}},{key:"getConfig",value:function(){return this._config}},{key:"updatePosition",value:function(){this._positionStrategy&&this._positionStrategy.apply()}},{key:"updatePositionStrategy",value:function(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}},{key:"updateSize",value:function(e){this._config=Object.assign({},this._config,e),this._updateElementSize()}},{key:"setDirection",value:function(e){this._config=Object.assign({},this._config,{direction:e}),this._updateElementDirection()}},{key:"addPanelClass",value:function(e){this._pane&&this._toggleClasses(this._pane,e,!0)}},{key:"removePanelClass",value:function(e){this._pane&&this._toggleClasses(this._pane,e,!1)}},{key:"getDirection",value:function(){var e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}},{key:"updateScrollStrategy",value:function(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}},{key:"_updateElementDirection",value:function(){this._host.setAttribute("dir",this.getDirection())}},{key:"_updateElementSize",value:function(){if(this._pane){var e=this._pane.style;e.width=Pd(this._config.width),e.height=Pd(this._config.height),e.minWidth=Pd(this._config.minWidth),e.minHeight=Pd(this._config.minHeight),e.maxWidth=Pd(this._config.maxWidth),e.maxHeight=Pd(this._config.maxHeight)}}},{key:"_togglePointerEvents",value:function(e){this._pane.style.pointerEvents=e?"auto":"none"}},{key:"_attachBackdrop",value:function(){var e=this;this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular((function(){requestAnimationFrame((function(){e._backdropElement&&e._backdropElement.classList.add("cdk-overlay-backdrop-showing")}))})):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}},{key:"_updateStackingOrder",value:function(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}},{key:"detachBackdrop",value:function(){var e,t=this,n=this._backdropElement;if(n){var r=function r(){n&&(n.removeEventListener("click",t._backdropClickHandler),n.removeEventListener("transitionend",r),n.parentNode&&n.parentNode.removeChild(n)),t._backdropElement==n&&(t._backdropElement=null),t._config.backdropClass&&t._toggleClasses(n,t._config.backdropClass,!1),clearTimeout(e)};n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular((function(){n.addEventListener("transitionend",r)})),n.style.pointerEvents="none",e=this._ngZone.runOutsideAngular((function(){return setTimeout(r,500)}))}}},{key:"_toggleClasses",value:function(e,t,n){var r=e.classList;Md(t).forEach((function(e){e&&(n?r.add(e):r.remove(e))}))}},{key:"_detachContentWhenStable",value:function(){var e=this;this._ngZone.runOutsideAngular((function(){var t=e._ngZone.onStable.asObservable().pipe(MF(te(e._attachments,e._detachments))).subscribe((function(){e._pane&&e._host&&0!==e._pane.children.length||(e._pane&&e._config.panelClass&&e._toggleClasses(e._pane,e._config.panelClass,!1),e._host&&e._host.parentElement&&(e._previousHostParent=e._host.parentElement,e._previousHostParent.removeChild(e._host)),t.unsubscribe())}))}))}},{key:"_disposeScrollStrategy",value:function(){var e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}}]),e}(),yM=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this._viewportRuler=n,this._document=r,this._platform=a,this._overlayContainer=i,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new A,this._resizeSubscription=p.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(t)}return _createClass(e,[{key:"positions",get:function(){return this._preferredPositions}},{key:"attach",value:function(e){var t=this;if(this._overlayRef&&e!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),e.hostElement.classList.add("cdk-overlay-connected-position-bounding-box"),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe((function(){t._isInitialRender=!0,t.apply()}))}},{key:"apply",value:function(){if(!this._isDisposed&&this._platform.isBrowser)if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)this.reapplyLastPosition();else{this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();var e,t,n=this._originRect,r=this._overlayRect,a=this._viewportRect,i=[],o=_createForOfIteratorHelper(this._preferredPositions);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=this._getOriginPoint(n,s),c=this._getOverlayPoint(u,r,s),l=this._getOverlayFit(c,r,a,s);if(l.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(s,u);this._canFitWithFlexibleDimensions(l,c,a)?i.push({position:s,origin:u,overlayRect:r,boundingBoxRect:this._calculateBoundingBoxRect(u,s)}):(!e||e.overlayFit.visibleArea<l.visibleArea)&&(e={overlayFit:l,overlayPoint:c,originPoint:u,position:s,overlayRect:r})}}catch(g){o.e(g)}finally{o.f()}if(i.length){var h,d=null,f=-1,p=_createForOfIteratorHelper(i);try{for(p.s();!(h=p.n()).done;){var m=h.value,v=m.boundingBoxRect.width*m.boundingBoxRect.height*(m.position.weight||1);v>f&&(f=v,d=m)}}catch(g){p.e(g)}finally{p.f()}return this._isPushed=!1,void this._applyPosition(d.position,d.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(e.position,e.originPoint);this._applyPosition(e.position,e.originPoint)}}},{key:"detach",value:function(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}},{key:"dispose",value:function(){this._isDisposed||(this._boundingBox&&bM(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove("cdk-overlay-connected-position-bounding-box"),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}},{key:"reapplyLastPosition",value:function(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();var e=this._lastPosition||this._preferredPositions[0],t=this._getOriginPoint(this._originRect,e);this._applyPosition(e,t)}}},{key:"withScrollableContainers",value:function(e){return this._scrollables=e,this}},{key:"withPositions",value:function(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}},{key:"withViewportMargin",value:function(e){return this._viewportMargin=e,this}},{key:"withFlexibleDimensions",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._hasFlexibleDimensions=e,this}},{key:"withGrowAfterOpen",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._growAfterOpen=e,this}},{key:"withPush",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._canPush=e,this}},{key:"withLockedPosition",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._positionLocked=e,this}},{key:"setOrigin",value:function(e){return this._origin=e,this}},{key:"withDefaultOffsetX",value:function(e){return this._offsetX=e,this}},{key:"withDefaultOffsetY",value:function(e){return this._offsetY=e,this}},{key:"withTransformOriginOn",value:function(e){return this._transformOriginSelector=e,this}},{key:"_getOriginPoint",value:function(e,t){var n;if("center"==t.originX)n=e.left+e.width/2;else{var r=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;n="start"==t.originX?r:a}return{x:n,y:"center"==t.originY?e.top+e.height/2:"top"==t.originY?e.top:e.bottom}}},{key:"_getOverlayPoint",value:function(e,t,n){var r,a;return r="center"==n.overlayX?-t.width/2:"start"===n.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,a="center"==n.overlayY?-t.height/2:"top"==n.overlayY?0:-t.height,{x:e.x+r,y:e.y+a}}},{key:"_getOverlayFit",value:function(e,t,n,r){var a=e.x,i=e.y,o=this._getOffset(r,"x"),s=this._getOffset(r,"y");o&&(a+=o),s&&(i+=s);var u=0-i,c=i+t.height-n.height,l=this._subtractOverflows(t.width,0-a,a+t.width-n.width),h=this._subtractOverflows(t.height,u,c),d=l*h;return{visibleArea:d,isCompletelyWithinViewport:t.width*t.height===d,fitsInViewportVertically:h===t.height,fitsInViewportHorizontally:l==t.width}}},{key:"_canFitWithFlexibleDimensions",value:function(e,t,n){if(this._hasFlexibleDimensions){var r=n.bottom-t.y,a=n.right-t.x,i=this._overlayRef.getConfig().minHeight,o=this._overlayRef.getConfig().minWidth,s=e.fitsInViewportHorizontally||null!=o&&o<=a;return(e.fitsInViewportVertically||null!=i&&i<=r)&&s}return!1}},{key:"_pushOverlayOnScreen",value:function(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};var r,a,i=this._viewportRect,o=Math.max(e.x+t.width-i.right,0),s=Math.max(e.y+t.height-i.bottom,0),u=Math.max(i.top-n.top-e.y,0),c=Math.max(i.left-n.left-e.x,0);return r=t.width<=i.width?c||-o:e.x<this._viewportMargin?i.left-n.left-e.x:0,a=t.height<=i.height?u||-s:e.y<this._viewportMargin?i.top-n.top-e.y:0,this._previousPushAmount={x:r,y:a},{x:e.x+r,y:e.y+a}}},{key:"_applyPosition",value:function(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){var n=this._getScrollVisibility(),r=new lM(e,n);this._positionChanges.next(r)}this._isInitialRender=!1}},{key:"_setTransformOrigin",value:function(e){if(this._transformOriginSelector){var t,n=this._boundingBox.querySelectorAll(this._transformOriginSelector),r=e.overlayY;t="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(var a=0;a<n.length;a++)n[a].style.transformOrigin="".concat(t," ").concat(r)}}},{key:"_calculateBoundingBoxRect",value:function(e,t){var n,r,a,i,o,s,u=this._viewportRect,c=this._isRtl();if("top"===t.overlayY)r=e.y,n=u.height-r+this._viewportMargin;else if("bottom"===t.overlayY)a=u.height-e.y+2*this._viewportMargin,n=u.height-a+this._viewportMargin;else{var l=Math.min(u.bottom-e.y+u.top,e.y),h=this._lastBoundingBoxSize.height;n=2*l,r=e.y-l,n>h&&!this._isInitialRender&&!this._growAfterOpen&&(r=e.y-h/2)}if("end"===t.overlayX&&!c||"start"===t.overlayX&&c)s=u.width-e.x+this._viewportMargin,i=e.x-this._viewportMargin;else if("start"===t.overlayX&&!c||"end"===t.overlayX&&c)o=e.x,i=u.right-e.x;else{var d=Math.min(u.right-e.x+u.left,e.x),f=this._lastBoundingBoxSize.width;i=2*d,o=e.x-d,i>f&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.x-f/2)}return{top:r,left:o,bottom:a,right:s,width:i,height:n}}},{key:"_setBoundingBoxStyles",value:function(e,t){var n=this._calculateBoundingBoxRect(e,t);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));var r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right="",r.width=r.height="100%";else{var a=this._overlayRef.getConfig().maxHeight,i=this._overlayRef.getConfig().maxWidth;r.height=Pd(n.height),r.top=Pd(n.top),r.bottom=Pd(n.bottom),r.width=Pd(n.width),r.left=Pd(n.left),r.right=Pd(n.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",a&&(r.maxHeight=Pd(a)),i&&(r.maxWidth=Pd(i))}this._lastBoundingBoxSize=n,bM(this._boundingBox.style,r)}},{key:"_resetBoundingBoxStyles",value:function(){bM(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}},{key:"_resetOverlayElementStyles",value:function(){bM(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}},{key:"_setOverlayElementStyles",value:function(e,t){var n={};if(this._hasExactPosition()){var r=this._viewportRuler.getViewportScrollPosition();bM(n,this._getExactOverlayY(t,e,r)),bM(n,this._getExactOverlayX(t,e,r))}else n.position="static";var a="",i=this._getOffset(t,"x"),o=this._getOffset(t,"y");i&&(a+="translateX(".concat(i,"px) ")),o&&(a+="translateY(".concat(o,"px)")),n.transform=a.trim(),this._hasFlexibleDimensions&&this._overlayRef.getConfig().maxHeight&&(n.maxHeight=""),this._hasFlexibleDimensions&&this._overlayRef.getConfig().maxWidth&&(n.maxWidth=""),bM(this._pane.style,n)}},{key:"_getExactOverlayY",value:function(e,t,n){var r={top:null,bottom:null},a=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,n));var i=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return a.y-=i,"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(a.y+this._overlayRect.height)+"px":r.top=Pd(a.y),r}},{key:"_getExactOverlayX",value:function(e,t,n){var r={left:null,right:null},a=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,n)),"right"===(this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left")?r.right=this._document.documentElement.clientWidth-(a.x+this._overlayRect.width)+"px":r.left=Pd(a.x),r}},{key:"_getScrollVisibility",value:function(){var e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map((function(e){return e.getElementRef().nativeElement.getBoundingClientRect()}));return{isOriginClipped:aM(e,n),isOriginOutsideView:rM(e,n),isOverlayClipped:aM(t,n),isOverlayOutsideView:rM(t,n)}}},{key:"_subtractOverflows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){return e-Math.max(t,0)}),e)}},{key:"_getNarrowedViewportRect",value:function(){var e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}},{key:"_isRtl",value:function(){return"rtl"===this._overlayRef.getDirection()}},{key:"_hasExactPosition",value:function(){return!this._hasFlexibleDimensions||this._isPushed}},{key:"_getOffset",value:function(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}},{key:"_validatePositions",value:function(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach((function(e){dM("originX",e.originX),hM("originY",e.originY),dM("overlayX",e.overlayX),hM("overlayY",e.overlayY)}))}},{key:"_addPanelClasses",value:function(e){var t=this;this._pane&&Md(e).forEach((function(e){""!==e&&-1===t._appliedPanelClasses.indexOf(e)&&(t._appliedPanelClasses.push(e),t._pane.classList.add(e))}))}},{key:"_clearPanelClasses",value:function(){var e=this;this._pane&&(this._appliedPanelClasses.forEach((function(t){e._pane.classList.remove(t)})),this._appliedPanelClasses=[])}},{key:"_getOriginRect",value:function(){var e=this._origin;if(e instanceof nn)return e.nativeElement.getBoundingClientRect();if(e instanceof HTMLElement)return e.getBoundingClientRect();var t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}}]),e}();function bM(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var kM,_M=function(){function e(t,n,r,a,i,o,s){_classCallCheck(this,e),this._preferredPositions=[],this._positionStrategy=new yM(r,a,i,o,s).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,n)}return _createClass(e,[{key:"_isRtl",get:function(){return"rtl"===this._overlayRef.getDirection()}},{key:"onPositionChange",get:function(){return this._positionStrategy.positionChanges}},{key:"positions",get:function(){return this._preferredPositions}},{key:"attach",value:function(e){this._overlayRef=e,this._positionStrategy.attach(e),this._direction&&(e.setDirection(this._direction),this._direction=null)}},{key:"dispose",value:function(){this._positionStrategy.dispose()}},{key:"detach",value:function(){this._positionStrategy.detach()}},{key:"apply",value:function(){this._positionStrategy.apply()}},{key:"recalculateLastPosition",value:function(){this._positionStrategy.reapplyLastPosition()}},{key:"withScrollableContainers",value:function(e){this._positionStrategy.withScrollableContainers(e)}},{key:"withFallbackPosition",value:function(e,t,n,r){var a=new cM(e,t,n,r);return this._preferredPositions.push(a),this._positionStrategy.withPositions(this._preferredPositions),this}},{key:"withDirection",value:function(e){return this._overlayRef?this._overlayRef.setDirection(e):this._direction=e,this}},{key:"withOffsetX",value:function(e){return this._positionStrategy.withDefaultOffsetX(e),this}},{key:"withOffsetY",value:function(e){return this._positionStrategy.withDefaultOffsetY(e),this}},{key:"withLockedPosition",value:function(e){return this._positionStrategy.withLockedPosition(e),this}},{key:"withPositions",value:function(e){return this._preferredPositions=e.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}},{key:"setOrigin",value:function(e){return this._positionStrategy.setOrigin(e),this}}]),e}(),wM=function(){function e(){_classCallCheck(this,e),this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}return _createClass(e,[{key:"attach",value:function(e){var t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add("cdk-global-overlay-wrapper"),this._isDisposed=!1}},{key:"top",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}},{key:"left",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._rightOffset="",this._leftOffset=e,this._justifyContent="flex-start",this}},{key:"bottom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}},{key:"right",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._leftOffset="",this._rightOffset=e,this._justifyContent="flex-end",this}},{key:"width",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}},{key:"height",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}},{key:"centerHorizontally",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.left(e),this._justifyContent="center",this}},{key:"centerVertically",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.top(e),this._alignItems="center",this}},{key:"apply",value:function(){if(this._overlayRef&&this._overlayRef.hasAttached()){var e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig();e.position=this._cssPosition,e.marginLeft="100%"===n.width?"0":this._leftOffset,e.marginTop="100%"===n.height?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=this._rightOffset,"100%"===n.width?t.justifyContent="flex-start":"center"===this._justifyContent?t.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?t.justifyContent="flex-end":"flex-end"===this._justifyContent&&(t.justifyContent="flex-start"):t.justifyContent=this._justifyContent,t.alignItems="100%"===n.height?"flex-start":this._alignItems}}},{key:"dispose",value:function(){if(!this._isDisposed&&this._overlayRef){var e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove("cdk-global-overlay-wrapper"),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}}]),e}(),xM=((kM=function(){function e(t,n,r,a){_classCallCheck(this,e),this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=a}return _createClass(e,[{key:"global",value:function(){return new wM}},{key:"connectedTo",value:function(e,t,n){return new _M(t,n,e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}},{key:"flexibleConnectedTo",value:function(e){return new yM(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}]),e}()).ngInjectableDef=ve({factory:function(){return new kM(Fe(JF),Fe(Is),Fe(Vd),Fe(vM))},token:kM,providedIn:"root"}),kM),CM=0,OM=function(){function e(t,n,r,a,i,o,s,u,c,l){_classCallCheck(this,e),this.scrollStrategies=t,this._overlayContainer=n,this._componentFactoryResolver=r,this._positionBuilder=a,this._keyboardDispatcher=i,this._injector=o,this._ngZone=s,this._document=u,this._directionality=c,this._location=l}return _createClass(e,[{key:"create",value:function(e){var t=this._createHostElement(),n=this._createPaneElement(t),r=this._createPortalOutlet(n),a=new uM(e);return a.direction=a.direction||this._directionality.value,new gM(r,t,n,a,this._ngZone,this._keyboardDispatcher,this._document,this._location)}},{key:"position",value:function(){return this._positionBuilder}},{key:"_createPaneElement",value:function(e){var t=this._document.createElement("div");return t.id="cdk-overlay-"+CM++,t.classList.add("cdk-overlay-pane"),e.appendChild(t),t}},{key:"_createHostElement",value:function(){var e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}},{key:"_createPortalOutlet",value:function(e){return this._appRef||(this._appRef=this._injector.get(di)),new RF(e,this._componentFactoryResolver,this._appRef,this._injector)}}]),e}(),SM=new Ie("cdk-connected-overlay-scroll-strategy");function TM(e){return function(){return e.scrollStrategies.reposition()}}var IM,EM,NM=function e(){_classCallCheck(this,e)},AM=function(){function e(t){_classCallCheck(this,e),this.total=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new RM(e,this.total))}}]),e}(),RM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).total=r,a.count=0,a}return _createClass(n,[{key:"_next",value:function(e){++this.count>this.total&&this.destination.next(e)}}]),n}(g),DM=function e(){_classCallCheck(this,e)},jM=new Set,FM=((EM=function(){function e(t){_classCallCheck(this,e),this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):MM}return _createClass(e,[{key:"matchMedia",value:function(e){return this._platform.WEBKIT&&function(e){if(!jM.has(e))try{IM||((IM=document.createElement("style")).setAttribute("type","text/css"),document.head.appendChild(IM)),IM.sheet&&(IM.sheet.insertRule("@media ".concat(e," {.fx-query-test{ }}"),0),jM.add(e))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}]),e}()).ngInjectableDef=ve({factory:function(){return new EM(Fe(Vd))},token:EM,providedIn:"root"}),EM);function MM(e){return{matches:"all"===e||""===e,media:e,addListener:function(){},removeListener:function(){}}}var PM,LM=((PM=function(){function e(t,n){_classCallCheck(this,e),this._mediaMatcher=t,this._zone=n,this._queries=new Map,this._destroySubject=new A}return _createClass(e,[{key:"ngOnDestroy",value:function(){this._destroySubject.next(),this._destroySubject.complete()}},{key:"isMatched",value:function(e){var t=this;return zM(Md(e)).some((function(e){return t._registerQuery(e).mql.matches}))}},{key:"observe",value:function(e){var t=this,n=zs(zM(Md(e)).map((function(e){return t._registerQuery(e).observable})));return(n=bu(n.pipe(lu(1)),n.pipe((function(e){return e.lift(new AM(1))}),Yd(0)))).pipe(G((function(e){var t={matches:!1,breakpoints:{}};return e.forEach((function(e){t.matches=t.matches||e.matches,t.breakpoints[e.query]=e.matches})),t})))}},{key:"_registerQuery",value:function(e){var t=this;if(this._queries.has(e))return this._queries.get(e);var n=this._mediaMatcher.matchMedia(e),r={observable:new C((function(e){var r=function(n){return t._zone.run((function(){return e.next(n)}))};return n.addListener(r),function(){n.removeListener(r)}})).pipe(ku(n),G((function(t){return{query:e,matches:t.matches}})),MF(this._destroySubject)),mql:n};return this._queries.set(e,r),r}}]),e}()).ngInjectableDef=ve({factory:function(){return new PM(Fe(FM),Fe(Xa))},token:PM,providedIn:"root"}),PM);function zM(e){return e.map((function(e){return e.split(",")})).reduce((function(e,t){return e.concat(t)})).map((function(e){return e.trim()}))}var BM,VM,WM=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._overlayRef=n,this._afterDismissed=new A,this._afterOpened=new A,this._onAction=new A,this._dismissedByAction=!1,this.containerInstance=t,this.onAction().subscribe((function(){return r.dismiss()})),t._onExit.subscribe((function(){return r._finishDismiss()}))}return _createClass(e,[{key:"dismiss",value:function(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}},{key:"dismissWithAction",value:function(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete())}},{key:"closeWithAction",value:function(){this.dismissWithAction()}},{key:"_dismissAfter",value:function(e){var t=this;this._durationTimeoutId=setTimeout((function(){return t.dismiss()}),e)}},{key:"_open",value:function(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}},{key:"_finishDismiss",value:function(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}},{key:"afterDismissed",value:function(){return this._afterDismissed.asObservable()}},{key:"afterOpened",value:function(){return this.containerInstance._onEnter}},{key:"onAction",value:function(){return this._onAction.asObservable()}}]),e}(),UM=new Ie("MatSnackBarData"),HM=function e(){_classCallCheck(this,e),this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"},GM=function(){function e(t,n){_classCallCheck(this,e),this.snackBarRef=t,this.data=n}return _createClass(e,[{key:"action",value:function(){this.snackBarRef.dismissWithAction()}},{key:"hasAction",get:function(){return!!this.data.action}}]),e}(),KM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this))._ngZone=e,o._elementRef=r,o._changeDetectorRef=a,o.snackBarConfig=i,o._destroyed=!1,o._onExit=new A,o._onEnter=new A,o._animationState="void",o._role="assertive"!==i.politeness||i.announcementMessage?"off"===i.politeness?null:"status":"alert",o}return _createClass(n,[{key:"attachComponentPortal",value:function(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(e)}},{key:"attachTemplatePortal",value:function(e){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(e)}},{key:"onAnimationEnd",value:function(e){var t=e.fromState,n=e.toState;if(("void"===n&&"void"!==t||"hidden"===n)&&this._completeExit(),"visible"===n){var r=this._onEnter;this._ngZone.run((function(){r.next(),r.complete()}))}}},{key:"enter",value:function(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges())}},{key:"exit",value:function(){return this._animationState="hidden",this._onExit}},{key:"ngOnDestroy",value:function(){this._destroyed=!0,this._completeExit()}},{key:"_completeExit",value:function(){var e=this;this._ngZone.onMicrotaskEmpty.asObservable().pipe(lu(1)).subscribe((function(){e._onExit.next(),e._onExit.complete()}))}},{key:"_applySnackBarClasses",value:function(){var e=this._elementRef.nativeElement,t=this.snackBarConfig.panelClass;t&&(Array.isArray(t)?t.forEach((function(t){return e.classList.add(t)})):e.classList.add(t)),"center"===this.snackBarConfig.horizontalPosition&&e.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&e.classList.add("mat-snack-bar-top")}},{key:"_assertNotAttached",value:function(){if(this._portalOutlet.hasAttached())throw Error("Attempting to attach snack bar content after content is already attached")}}]),n}(AF),qM=function e(){_classCallCheck(this,e)},XM=new Ie("mat-snack-bar-default-options",{providedIn:"root",factory:function(){return new HM}}),ZM=((VM=function(){function e(t,n,r,a,i,o){_classCallCheck(this,e),this._overlay=t,this._live=n,this._injector=r,this._breakpointObserver=a,this._parentSnackBar=i,this._defaultConfig=o,this._snackBarRefAtThisLevel=null}return _createClass(e,[{key:"_openedSnackBarRef",get:function(){var e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel},set:function(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}},{key:"openFromComponent",value:function(e,t){return this._attach(e,t)}},{key:"openFromTemplate",value:function(e,t){return this._attach(e,t)}},{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=Object.assign({},this._defaultConfig,n);return r.data={message:e,action:t},r.announcementMessage||(r.announcementMessage=e),this.openFromComponent(GM,r)}},{key:"dismiss",value:function(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}},{key:"ngOnDestroy",value:function(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}},{key:"_attachSnackBarContainer",value:function(e,t){var n=new FF(t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,new WeakMap([[HM,t]])),r=new EF(KM,t.viewContainerRef,n),a=e.attach(r);return a.instance.snackBarConfig=t,a.instance}},{key:"_attach",value:function(e,t){var n=Object.assign({},new HM,this._defaultConfig,t),r=this._createOverlay(n),a=this._attachSnackBarContainer(r,n),i=new WM(a,r);if(e instanceof Sn){var o=new NF(e,null,{$implicit:n.data,snackBarRef:i});i.instance=a.attachTemplatePortal(o)}else{var s=this._createInjector(n,i),u=new EF(e,void 0,s),c=a.attachComponentPortal(u);i.instance=c.instance}return this._breakpointObserver.observe("(max-width: 599.99px) and (orientation: portrait)").pipe(MF(r.detachments())).subscribe((function(e){var t=r.overlayElement.classList;e.matches?t.add("mat-snack-bar-handset"):t.remove("mat-snack-bar-handset")})),this._animateSnackBar(i,n),this._openedSnackBarRef=i,this._openedSnackBarRef}},{key:"_animateSnackBar",value:function(e,t){var n=this;e.afterDismissed().subscribe((function(){n._openedSnackBarRef==e&&(n._openedSnackBarRef=null),t.announcementMessage&&n._live.clear()})),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe((function(){e.containerInstance.enter()})),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),t.duration&&t.duration>0&&e.afterOpened().subscribe((function(){return e._dismissAfter(t.duration)})),t.announcementMessage&&this._live.announce(t.announcementMessage,t.politeness)}},{key:"_createOverlay",value:function(e){var t=new uM;t.direction=e.direction;var n=this._overlay.position().global(),r="rtl"===e.direction,a="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!r||"end"===e.horizontalPosition&&r,i=!a&&"center"!==e.horizontalPosition;return a?n.left("0"):i?n.right("0"):n.centerHorizontally(),"top"===e.verticalPosition?n.top("0"):n.bottom("0"),t.positionStrategy=n,this._overlay.create(t)}},{key:"_createInjector",value:function(e,t){return new FF(e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,new WeakMap([[WM,t],[UM,e.data]]))}}]),e}()).ngInjectableDef=ve({factory:function(){return new VM(Fe(OM),Fe(df),Fe(Ee),Fe(LM),Fe(VM,12),Fe(XM))},token:VM,providedIn:qM}),VM),YM=((BM=function(){function e(t){_classCallCheck(this,e),this.snackBar=t}return _createClass(e,[{key:"showNotification",value:function(e,t,n){this.snackBar.openFromComponent(SF,{data:{message:e,buttonText:t,type:n},duration:5e3,horizontalPosition:"center",verticalPosition:"top",panelClass:n})}}]),e}()).ngInjectableDef=ve({factory:function(){return new BM(Fe(ZM))},token:BM,providedIn:"root"}),BM),QM=Hn({encapsulation:0,styles:[[""]],data:{}});function JM(e){return Xi(0,[Pi(671088640,1,{vid:0}),Pi(671088640,2,{canvas:0}),Pi(671088640,3,{subcontainer:0}),Pi(671088640,4,{videostatusElement:0}),(e()(),Ri(4,0,null,null,14,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],[[null,"mousedown"]],(function(e,t,n){var r=!0;return"mousedown"===t&&(r=!1!==n.stopPropagation()&&r),r}),Ym,Zm)),Jr(5,49152,null,0,Id,[[2,qm]],null,null),(e()(),Ri(6,0,null,0,12,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Jr(7,16384,null,0,Od,[],null,null),(e()(),Ri(8,0,[[3,0],["subcontainer",1]],null,4,"div",[["class","subcontainer"]],null,null,null,null,null)),(e()(),Ri(9,0,[[1,0],["vid",1]],null,1,"video",[["class","video mat-card-image"],["id","videoid_screencap"],["mat-card-image",""]],null,null,null,null,null)),Jr(10,16384,null,0,Td,[],null,null),(e()(),Ri(11,0,[[2,0],["canvas",1]],null,1,"canvas",[["class","mat-card-image"],["mat-card-image",""]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onPlayOrPause()&&r),r}),null,null)),Jr(12,16384,null,0,Td,[],null,null),(e()(),Ri(13,0,null,null,4,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),Jr(14,16384,null,0,Sd,[],null,null),(e()(),Ri(15,0,null,null,2,"button",[["color","primary"],["id","screencapsources"],["mat-raised-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onGetVideoSources()&&r),r}),tv,ev)),Jr(16,180224,null,0,Jm,[nn,pf,[2,qm]],{disabled:[0,"disabled"],color:[1,"color"]},null),(e()(),Gi(-1,0,["Choose Video Source"])),(e()(),Ri(18,0,[[4,0],["videostatus",1]],null,0,"div",[],null,null,null,null,null))],(function(e,t){e(t,16,0,t.component.isloading,"primary")}),(function(e,t){e(t,4,0,"NoopAnimations"===zr(t,5)._animationMode),e(t,13,0,"end"===zr(t,14).align),e(t,15,0,zr(t,16).disabled||null,"NoopAnimations"===zr(t,16)._animationMode)}))}var $M=Ir("app-screencap",CF,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"app-screencap",[],null,null,null,JM,QM)),Jr(1,12828672,null,0,CF,[OF,YM],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),eP=yf((function e(t){_classCallCheck(this,e),this._elementRef=t}),"primary"),tP=new Ie("mat-progress-bar-location",{providedIn:"root",factory:function(){var e=Me(Is),t=e?e.location:null;return{getPathname:function(){return t?t.pathname+t.search:""}}}}),nP=0,rP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;_classCallCheck(this,n),(o=t.call(this,e))._elementRef=e,o._ngZone=r,o._animationMode=a,o._isNoopAnimation=!1,o._value=0,o._bufferValue=0,o.animationEnd=new ba,o._animationEndSubscription=p.EMPTY,o.mode="determinate",o.progressbarId="mat-progress-bar-"+nP++;var s=i?i.getPathname().split("#")[0]:"";return o._rectangleFillValue="url('".concat(s,"#").concat(o.progressbarId,"')"),o._isNoopAnimation="NoopAnimations"===a,o}return _createClass(n,[{key:"value",get:function(){return this._value},set:function(e){this._value=aP(e||0),this._isNoopAnimation&&this._emitAnimationEnd()}},{key:"bufferValue",get:function(){return this._bufferValue},set:function(e){this._bufferValue=aP(e||0)}},{key:"_primaryTransform",value:function(){return{transform:"scaleX(".concat(this.value/100,")")}}},{key:"_bufferTransform",value:function(){if("buffer"===this.mode)return{transform:"scaleX(".concat(this.bufferValue/100,")")}}},{key:"ngAfterViewInit",value:function(){var e=this;this._isNoopAnimation||this._ngZone.runOutsideAngular((function(){var t=e._primaryValueBar.nativeElement;e._animationEndSubscription=zF(t,"transitionend").pipe(Hs((function(e){return e.target===t}))).subscribe((function(){return e._ngZone.run((function(){return e._emitAnimationEnd()}))}))}))}},{key:"ngOnDestroy",value:function(){this._animationEndSubscription.unsubscribe()}},{key:"_emitAnimationEnd",value:function(){"determinate"!==this.mode&&"buffer"!==this.mode||this.animationEnd.next({value:this.value})}}]),n}(eP);function aP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return Math.max(t,Math.min(n,e))}var iP=function e(){_classCallCheck(this,e)},oP=Hn({encapsulation:2,styles:[".mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-background{display:none}}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:'';display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2s infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2s infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after{animation:none;transition:none}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.70173,.49582);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.30244,.38135,.55,.95635);transform:translateX(83.67142%)}100%{transform:translateX(200.61106%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(.08)}36.65%{animation-timing-function:cubic-bezier(.33473,.12482,.78584,1);transform:scaleX(.08)}69.15%{animation-timing-function:cubic-bezier(.06,.11,.6,1);transform:scaleX(.66148)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:translateX(37.65191%)}48.35%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:translateX(84.38617%)}100%{transform:translateX(160.27778%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:scaleX(.08)}19.15%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:scaleX(.4571)}44.15%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:scaleX(.72796)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}"],data:{}});function sP(e){return Xi(2,[Pi(671088640,1,{_primaryValueBar:0}),(e()(),Ri(1,0,null,null,4,":svg:svg",[["class","mat-progress-bar-background mat-progress-bar-element"],["focusable","false"],["height","4"],["width","100%"]],null,null,null,null,null)),(e()(),Ri(2,0,null,null,2,":svg:defs",[],null,null,null,null,null)),(e()(),Ri(3,0,null,null,1,":svg:pattern",[["height","4"],["patternUnits","userSpaceOnUse"],["width","8"],["x","4"],["y","0"]],[[8,"id",0]],null,null,null,null)),(e()(),Ri(4,0,null,null,0,":svg:circle",[["cx","2"],["cy","2"],["r","2"]],null,null,null,null,null)),(e()(),Ri(5,0,null,null,0,":svg:rect",[["height","100%"],["width","100%"]],[[1,"fill",0]],null,null,null,null)),(e()(),Ri(6,0,null,null,2,"div",[["class","mat-progress-bar-buffer mat-progress-bar-element"]],null,null,null,null,null)),$r(512,null,ws,xs,[nn,wn,sn]),Jr(8,278528,null,0,Cs,[ws],{ngStyle:[0,"ngStyle"]},null),(e()(),Ri(9,0,[[1,0],["primaryValueBar",1]],null,2,"div",[["class","mat-progress-bar-primary mat-progress-bar-fill mat-progress-bar-element"]],null,null,null,null,null)),$r(512,null,ws,xs,[nn,wn,sn]),Jr(11,278528,null,0,Cs,[ws],{ngStyle:[0,"ngStyle"]},null),(e()(),Ri(12,0,null,null,0,"div",[["class","mat-progress-bar-secondary mat-progress-bar-fill mat-progress-bar-element"]],null,null,null,null,null))],(function(e,t){var n=t.component;e(t,8,0,n._bufferTransform()),e(t,11,0,n._primaryTransform())}),(function(e,t){var n=t.component;e(t,3,0,n.progressbarId),e(t,5,0,n._rectangleFillValue)}))}var uP=function(){function e(t,n){_classCallCheck(this,e),this.DataSharing=t,this.notifierService=n,this.videoStatus="",this.highestcount=[],this.isloading=!0,this.detectionInterval=10,this.DataSharing.Title.next("Video File")}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.DataSharing.ClearPredictions.subscribe((function(t){return e.highestcount=[]})),this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([])}},{key:"ngOnDestroy",value:function(){this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([]),this.highestcount=[],this.videoElement.pause(),this.SetVideoStatus("hasEnded")}},{key:"ngAfterViewInit",value:function(){var e=this;this.canvasElement=this.canvas.nativeElement,this.subcontainerElement=this.subcontainer.nativeElement,this.SetVideoStatus(""),this.DataSharing.Model.subscribe((function(t){e.model=t,e.videoElement=e.vid.nativeElement,e.model&&setTimeout((function(){e.isloading=!1}),0)})),this.videoElement.onloadedmetadata=function(){xF(e.subcontainerElement,e.videoElement,e.canvasElement),e.SetVideoStatus("isReady")},this.videoElement.onloadeddata=function(){e.model&&e.onStartDetection()},this.videoElement.onplaying=function(){e.SetVideoStatus("isPlaying"),e.detectFrame()},this.videoElement.onended=function(){e.SetVideoStatus("hasEnded")};var t=this.canvasElement.getContext("2d");t.fillStyle="#808080aa",t.fillRect(0,0,t.canvas.width,t.canvas.height)}},{key:"ngAfterViewChecked",value:function(){xF(this.subcontainerElement,this.videoElement,this.canvasElement)}},{key:"onStartDetection",value:function(){this.highestcount=[],this.SetVideoStatus("isReady"),this.detectFrame(),this.videopathElement.nativeElement.innerHTML="<b>Video path: </b> <i>"+this.filePath+"</i>",document.getElementById("progressbar").style.display="none";var e=document.getElementById("btnforsrc"),t=this.filePath.split("\\");e.innerText=t[t.length-1]}},{key:"detectFrame",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{rv.tidy((function(){setTimeout((function(){return ns(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return rv.engine().startScope(),e.next=3,rv.browser.fromPixels(this.videoElement);case 3:return t=e.sent,e.next=6,this.model.detect(t);case 6:n=e.sent,_F(this.canvasElement,n,t.shape),this.DataSharing.UpdatePreditions(n,this.highestcount,this.videoStatus),rv.engine().endScope(),"isPlaying"===this.videoStatus&&requestAnimationFrame((function(){return r.detectFrame()}));case 8:case"end":return e.stop()}}),e,this)})))}),t.detectionInterval)}))}catch(n){this.notifierService.showNotification("Error on object detection.","OK","error")}case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onPlayOrPause",value:function(){""!==this.videoStatus&&("isPlaying"!=this.videoStatus?(this.videoElement.play(),this.SetVideoStatus("isPlaying")):(this.videoElement.pause(),this.SetVideoStatus("isPaused")))}},{key:"onVideoLoad",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!kF){e.next=19;break}return e.prev=1,this.SetVideoStatus("isPaused"),this.videoElement.pause(),t=kF("electron").remote,n=t.dialog,r=t.getCurrentWindow(),a={title:"Select video file",filters:[{name:"Movies",extensions:["mkv","mp4","ogv","webm","mov"]}]},e.next=7,n.showOpenDialog(r,a);case 7:if(this.filePath=e.sent.filePaths[0],this.filePath){e.next=10;break}return e.abrupt("return");case 10:(i=this.canvasElement.getContext("2d")).clearRect(0,0,i.canvas.width,i.canvas.height),this.SetVideoStatus("hasEnded"),this.videostatusElement.nativeElement.innerHTML="Video is loading...",document.getElementById("progressbar").style.display="block",setTimeout((function(){var e=kF("fs").readFileSync(o.filePath),t=URL.createObjectURL(new Blob([e]));o.videoElement.src=t,o.videoElement.play(),o.detectionInterval=e.length/12e4,o.detectionInterval=o.detectionInterval>300?300:o.detectionInterval,console.log({detectionInterval:o.detectionInterval})}),0),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),this.videostatusElement.nativeElement.innerHTML="Error on loading video.",document.getElementById("progressbar").style.display="none",this.notifierService.showNotification("Error on Electron.","OK","error");case 17:e.next=20;break;case 19:console.warn("Logic can only run on Electron."),this.notifierService.showNotification("Logic can only run on Electron.","OK","error");case 20:case"end":return e.stop()}}),e,this,[[1,14]])})))}},{key:"SetVideoStatus",value:function(e){this.videoStatus=e,this.videostatusElement.nativeElement.innerHTML=bF(e,"Video")}}]),e}(),cP=Hn({encapsulation:0,styles:[[""]],data:{}});function lP(e){return Xi(0,[Pi(671088640,1,{vid:0}),Pi(671088640,2,{canvas:0}),Pi(671088640,3,{subcontainer:0}),Pi(671088640,4,{videostatusElement:0}),Pi(671088640,5,{videopathElement:0}),(e()(),Ri(5,0,null,null,1,"mat-progress-bar",[["aria-valuemax","100"],["aria-valuemin","0"],["class","mat-progress-bar"],["color","primary"],["id","progressbar"],["mode","indeterminate"],["role","progressbar"],["style","display: none;"]],[[1,"aria-valuenow",0],[1,"mode",0],[2,"_mat-animation-noopable",null]],null,null,sP,oP)),Jr(6,4374528,null,0,rP,[nn,Xa,[2,qm],[2,tP]],{color:[0,"color"],mode:[1,"mode"]},null),(e()(),Ri(7,0,null,null,15,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],[[null,"mousedown"]],(function(e,t,n){var r=!0;return"mousedown"===t&&(r=!1!==n.stopPropagation()&&r),r}),Ym,Zm)),Jr(8,49152,null,0,Id,[[2,qm]],null,null),(e()(),Ri(9,0,null,0,13,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Jr(10,16384,null,0,Od,[],null,null),(e()(),Ri(11,0,[[3,0],["subcontainer",1]],null,4,"div",[["class","subcontainer"]],null,null,null,null,null)),(e()(),Ri(12,0,[[1,0],["vid",1]],null,1,"video",[["class","video mat-card-image"],["controls",""],["crossorigin","anonymous"],["mat-card-image",""],["muted",""],["playsinline",""]],null,null,null,null,null)),Jr(13,16384,null,0,Td,[],null,null),(e()(),Ri(14,0,[[2,0],["canvas",1]],null,1,"canvas",[["class","mat-card-image"],["mat-card-image",""]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onPlayOrPause()&&r),r}),null,null)),Jr(15,16384,null,0,Td,[],null,null),(e()(),Ri(16,0,[[5,0],["videopath",1]],null,0,"div",[],null,null,null,null,null)),(e()(),Ri(17,0,null,null,4,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),Jr(18,16384,null,0,Sd,[],null,null),(e()(),Ri(19,0,null,null,2,"button",[["color","primary"],["id","btnforsrc"],["mat-raised-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onVideoLoad()&&r),r}),tv,ev)),Jr(20,180224,null,0,Jm,[nn,pf,[2,qm]],{disabled:[0,"disabled"],color:[1,"color"]},null),(e()(),Gi(-1,0,[" Choose Video File "])),(e()(),Ri(22,0,[[4,0],["videostatus",1]],null,0,"div",[],null,null,null,null,null))],(function(e,t){var n=t.component;e(t,6,0,"primary","indeterminate"),e(t,20,0,n.isloading,"primary")}),(function(e,t){e(t,5,0,"indeterminate"===zr(t,6).mode||"query"===zr(t,6).mode?null:zr(t,6).value,zr(t,6).mode,zr(t,6)._isNoopAnimation),e(t,7,0,"NoopAnimations"===zr(t,8)._animationMode),e(t,17,0,"end"===zr(t,18).align),e(t,19,0,zr(t,20).disabled||null,"NoopAnimations"===zr(t,20)._animationMode)}))}var hP=Ir("app-video",uP,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"app-video",[],null,null,null,lP,cP)),Jr(1,12828672,null,0,uP,[OF,YM],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),dP=function(){function e(t,n){_classCallCheck(this,e),this.DataSharing=t,this.notifierService=n,this.highestcount=[],this.isloading=!0,this.DataSharing.Title.next("Image File")}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){var e=this;this.DataSharing.Model.subscribe((function(t){e.model=t,e.model&&setTimeout((function(){e.isloading=!1}))}))}},{key:"ngOnDestroy",value:function(){this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([]),this.highestcount=[]}},{key:"onStartDetection",value:function(e,t){var n=this,r=this.imag.nativeElement;this.highestcount=[];var a=new Image;a.src=e,a.crossOrigin="anonymous",a.onload=function(){return ns(n,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,o,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.imagestatusElement.nativeElement.innerHTML="<b>Image path:</b> <i>"+t+"</i>",document.getElementById("progressbar").style.display="none",n=document.getElementById("btnforsrc"),i=t.split("\\"),n.innerText=i[i.length-1],o=this.canvas.nativeElement,(s=o.getContext("2d")).canvas.width=1200,s.canvas.height=a.height/a.width*1200,e.next=8,this.model.detect(a);case 8:u=e.sent,this.DataSharing.UpdatePreditions(u,this.highestcount,null),s.clearRect(0,0,s.canvas.width,s.canvas.height),s.drawImage(a,0,0,s.canvas.width,s.canvas.height),c="18px sans-serif",s.font=c,s.textBaseline="top",l=parseInt(c,10),wF(u,s,s.canvas.width/a.width,s.canvas.height/a.height,l),o.style.height=(o.offsetHeight+1).toString()+"px",r.src=o.toDataURL(),o.remove();case 14:case"end":return e.stop()}}),e,this)})))}}},{key:"onImageLoad",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!kF){e.next=17;break}return e.prev=1,t=kF("electron").remote,n=t.dialog,r=t.getCurrentWindow(),a={title:"Select image file",filters:[{name:"Images",extensions:["jpg","png","jpeg","webp"]}]},e.next=6,n.showOpenDialog(r,a);case 6:if(i=e.sent.filePaths[0]){e.next=9;break}return e.abrupt("return");case 9:this.imagestatusElement.nativeElement.innerHTML="Image is loading...",document.getElementById("progressbar").style.display="block",kF("fs").readFile(i,(function(e,t){if(e)throw e;var n=URL.createObjectURL(new Blob([t]));o.model&&o.onStartDetection(n,i)})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),this.imagestatusElement.nativeElement.innerHTML="Error on loading image.",document.getElementById("progressbar").style.display="none",this.notifierService.showNotification("Error on loading image.","OK","error");case 15:e.next=18;break;case 17:console.warn("Logic can only run on Electron."),this.notifierService.showNotification("Logic can only run on Electron.","OK","error");case 18:case"end":return e.stop()}}),e,this,[[1,12]])})))}}]),e}(),fP=Hn({encapsulation:0,styles:[[".mat-card-image[_ngcontent-%COMP%]{cursor:pointer}"]],data:{}});function pP(e){return Xi(0,[Pi(671088640,1,{imag:0}),Pi(671088640,2,{canvas:0}),Pi(671088640,3,{imagestatusElement:0}),(e()(),Ri(3,0,null,null,1,"mat-progress-bar",[["aria-valuemax","100"],["aria-valuemin","0"],["class","mat-progress-bar"],["color","primary"],["id","progressbar"],["mode","indeterminate"],["role","progressbar"],["style","display: none;"]],[[1,"aria-valuenow",0],[1,"mode",0],[2,"_mat-animation-noopable",null]],null,null,sP,oP)),Jr(4,4374528,null,0,rP,[nn,Xa,[2,qm],[2,tP]],{color:[0,"color"],mode:[1,"mode"]},null),(e()(),Ri(5,0,null,null,11,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],[[null,"mousedown"]],(function(e,t,n){var r=!0;return"mousedown"===t&&(r=!1!==n.stopPropagation()&&r),r}),Ym,Zm)),Jr(6,49152,null,0,Id,[[2,qm]],null,null),(e()(),Ri(7,0,null,0,9,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Jr(8,16384,null,0,Od,[],null,null),(e()(),Ri(9,0,[[1,0],["imag",1]],null,1,"img",[["class","mat-card-image"],["mat-card-image",""]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onImageLoad()&&r),r}),null,null)),Jr(10,16384,null,0,Td,[],null,null),(e()(),Ri(11,0,[[3,0],["imagestatus",1]],null,0,"div",[],null,null,null,null,null)),(e()(),Ri(12,0,null,null,4,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),Jr(13,16384,null,0,Sd,[],null,null),(e()(),Ri(14,0,null,null,2,"button",[["color","primary"],["id","btnforsrc"],["mat-raised-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onImageLoad()&&r),r}),tv,ev)),Jr(15,180224,null,0,Jm,[nn,pf,[2,qm]],{disabled:[0,"disabled"],color:[1,"color"]},null),(e()(),Gi(-1,0,[" Choose Image File "])),(e()(),Ri(17,0,[[2,0],["canvas",1]],null,0,"canvas",[["style","display: none;"]],null,null,null,null,null))],(function(e,t){var n=t.component;e(t,4,0,"primary","indeterminate"),e(t,15,0,n.isloading,"primary")}),(function(e,t){e(t,3,0,"indeterminate"===zr(t,4).mode||"query"===zr(t,4).mode?null:zr(t,4).value,zr(t,4).mode,zr(t,4)._isNoopAnimation),e(t,5,0,"NoopAnimations"===zr(t,6)._animationMode),e(t,12,0,"end"===zr(t,13).align),e(t,14,0,zr(t,15).disabled||null,"NoopAnimations"===zr(t,15)._animationMode)}))}var mP=Ir("app-image",dP,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"app-image",[],null,null,null,pP,fP)),Jr(1,4440064,null,0,dP,[OF,YM],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),vP=function(){function e(t,n){_classCallCheck(this,e),this.DataSharing=t,this.notifierService=n,this.videoStatus="",this.highestcount=[],this.DataSharing.Title.next("Webcam")}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.DataSharing.ClearPredictions.subscribe((function(t){return e.highestcount=[]})),this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([])}},{key:"ngOnDestroy",value:function(){this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([]),this.highestcount=[],this.localstream&&(this.videoElement.pause(),this.localstream.getTracks()[0].stop(),this.SetVideoStatus("hasEnded"))}},{key:"ngAfterViewInit",value:function(){var e=this;this.videoElement=this.vid.nativeElement,this.canvasElement=this.canvas.nativeElement,this.subcontainerElement=this.subcontainer.nativeElement,this.SetVideoStatus(""),this.subcontainerElement.style.height=this.videoElement.offsetHeight.toString()+"px",this.onEnableCamera();var t=this.canvasElement.getContext("2d");t.fillStyle="#808080aa",t.fillRect(0,0,t.canvas.width,t.canvas.height),this.DataSharing.Model.subscribe((function(t){e.model=t,e.model&&"isReady"===e.videoStatus&&e.onStartDetection()})),this.videoElement.onloadedmetadata=function(){xF(e.subcontainerElement,e.videoElement,e.canvasElement),e.SetVideoStatus("isReady"),document.getElementById("progressbar").style.display="none"},this.videoElement.onloadeddata=function(){e.model&&e.onStartDetection()},this.videoElement.onplaying=function(){e.SetVideoStatus("isPlaying"),e.detectFrame()}}},{key:"ngAfterViewChecked",value:function(){xF(this.subcontainerElement,this.videoElement,this.canvasElement)}},{key:"onEnableCamera",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={audio:!1,video:{facingMode:"environment"}},e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia(t);case 4:this.localstream=e.sent,this.videoElement.srcObject=this.localstream,this.videoElement.play(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.SetVideoStatus("webcamError"),document.getElementById("progressbar").style.display="none",this.notifierService.showNotification("Webcam error.","OK","error");case 12:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"onStartDetection",value:function(){this.highestcount=[],this.SetVideoStatus("isPlaying"),this.detectFrame();var e=this.canvasElement.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height)}},{key:"detectFrame",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{rv.tidy((function(){setTimeout((function(){return ns(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return rv.engine().startScope(),e.next=3,rv.browser.fromPixels(this.videoElement);case 3:if(t=e.sent,!this.model||!t){e.next=9;break}return e.next=7,this.model.detect(t);case 7:n=e.sent,_F(this.canvasElement,n,t.shape),this.DataSharing.UpdatePreditions(n,this.highestcount,this.videoStatus),rv.engine().endScope(),"isPlaying"===this.videoStatus&&requestAnimationFrame((function(){return r.detectFrame()}));case 9:case"end":return e.stop()}}),e,this)})))}),50)}))}catch(n){this.notifierService.showNotification("Error on object detection.","OK","error")}case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onPlayOrPause",value:function(){""!==this.videoStatus&&("isPlaying"!=this.videoStatus?(this.videoElement.play(),this.SetVideoStatus("isPlaying")):(this.videoElement.pause(),this.SetVideoStatus("isPaused")))}},{key:"SetVideoStatus",value:function(e){this.videoStatus=e,this.videostatusElement.nativeElement.innerHTML=bF(e,"Webcam")}}]),e}(),gP=Hn({encapsulation:0,styles:[[""]],data:{}});function yP(e){return Xi(0,[Pi(671088640,1,{vid:0}),Pi(671088640,2,{canvas:0}),Pi(671088640,3,{subcontainer:0}),Pi(671088640,4,{videostatusElement:0}),(e()(),Ri(4,0,null,null,1,"mat-progress-bar",[["aria-valuemax","100"],["aria-valuemin","0"],["class","mat-progress-bar"],["color","primary"],["id","progressbar"],["mode","indeterminate"],["role","progressbar"]],[[1,"aria-valuenow",0],[1,"mode",0],[2,"_mat-animation-noopable",null]],null,null,sP,oP)),Jr(5,4374528,null,0,rP,[nn,Xa,[2,qm],[2,tP]],{color:[0,"color"],mode:[1,"mode"]},null),(e()(),Ri(6,0,null,null,9,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],[[null,"mousedown"]],(function(e,t,n){var r=!0;return"mousedown"===t&&(r=!1!==n.stopPropagation()&&r),r}),Ym,Zm)),Jr(7,49152,null,0,Id,[[2,qm]],null,null),(e()(),Ri(8,0,null,0,7,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Jr(9,16384,null,0,Od,[],null,null),(e()(),Ri(10,0,[[3,0],["subcontainer",1]],null,4,"div",[["class","subcontainer"]],null,null,null,null,null)),(e()(),Ri(11,0,[[1,0],["vid",1]],null,1,"video",[["autoPlay",""],["class","video mat-card-image"],["crossorigin","anonymous"],["mat-card-image",""],["muted",""],["playsinline",""]],null,null,null,null,null)),Jr(12,16384,null,0,Td,[],null,null),(e()(),Ri(13,0,[[2,0],["canvas",1]],null,1,"canvas",[["class","mat-card-image"],["mat-card-image",""]],null,[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onPlayOrPause()&&r),r}),null,null)),Jr(14,16384,null,0,Td,[],null,null),(e()(),Ri(15,0,[[4,0],["videostatus",1]],null,0,"div",[],null,null,null,null,null))],(function(e,t){e(t,5,0,"primary","indeterminate")}),(function(e,t){e(t,4,0,"indeterminate"===zr(t,5).mode||"query"===zr(t,5).mode?null:zr(t,5).value,zr(t,5).mode,zr(t,5)._isNoopAnimation),e(t,6,0,"NoopAnimations"===zr(t,7)._animationMode)}))}var bP=Ir("app-webcam",vP,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"app-webcam",[],null,null,null,yP,gP)),Jr(1,12828672,null,0,vP,[OF,YM],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),kP=Hn({encapsulation:2,styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}@media (-ms-high-contrast:active){.mat-snack-bar-container{border:solid 1px}}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}"],data:{animation:[{type:7,name:"state",definitions:[{type:0,name:"void, hidden",styles:{type:6,styles:{transform:"scale(0.8)",opacity:0},offset:null},options:void 0},{type:0,name:"visible",styles:{type:6,styles:{transform:"scale(1)",opacity:1},offset:null},options:void 0},{type:1,expr:"* => visible",animation:{type:4,styles:null,timings:"150ms cubic-bezier(0, 0, 0.2, 1)"},options:null},{type:1,expr:"* => void, * => hidden",animation:{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"75ms cubic-bezier(0.4, 0.0, 1, 1)"},options:null}],options:{}}]}});function _P(e){return Xi(0,[(e()(),Ai(0,null,null,0))],null,null)}function wP(e){return Xi(0,[Pi(402653184,1,{_portalOutlet:0}),(e()(),Ai(16777216,null,null,1,null,_P)),Jr(2,212992,[[1,4]],0,DF,[Jt,In],{portal:[0,"portal"]},null)],(function(e,t){e(t,2,0,"")}),null)}var xP=Ir("snack-bar-container",KM,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"snack-bar-container",[["class","mat-snack-bar-container"]],[[1,"role",0],[40,"@state",0]],[["component","@state.done"]],(function(e,t,n){var r=!0;return"component:@state.done"===t&&(r=!1!==zr(e,1).onAnimationEnd(n)&&r),r}),wP,kP)),Jr(1,180224,null,0,KM,[Xa,nn,Ot,HM],null,null)],null,(function(e,t){e(t,0,0,zr(t,1)._role,zr(t,1)._animationState)}))}),{},{},[]),CP=Hn({encapsulation:2,styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}"],data:{}});function OP(e){return Xi(0,[(e()(),Ri(0,0,null,null,3,"div",[["class","mat-simple-snackbar-action"]],null,null,null,null,null)),(e()(),Ri(1,0,null,null,2,"button",[["mat-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.action()&&r),r}),tv,ev)),Jr(2,180224,null,0,Jm,[nn,pf,[2,qm]],null,null),(e()(),Gi(3,0,["",""]))],null,(function(e,t){var n=t.component;e(t,1,0,zr(t,2).disabled||null,"NoopAnimations"===zr(t,2)._animationMode),e(t,3,0,n.data.action)}))}function SP(e){return Xi(2,[(e()(),Ri(0,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),Gi(1,null,["",""])),(e()(),Ai(16777216,null,null,1,null,OP)),Jr(3,16384,null,0,ys,[In,Sn],{ngIf:[0,"ngIf"]},null)],(function(e,t){e(t,3,0,t.component.hasAction)}),(function(e,t){e(t,1,0,t.component.data.message)}))}var TP=Ir("simple-snack-bar",GM,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"simple-snack-bar",[["class","mat-simple-snackbar"]],null,null,null,SP,CP)),Jr(1,49152,null,0,GM,[WM,UM],null,null)],null,null)}),{},{},[]),IP=Hn({encapsulation:0,styles:[[".content-style[_ngcontent-%COMP%]{border:1px solid #fff;border-radius:4px;padding:10px;margin-top:10px;margin-bottom:10px}"]],data:{}});function EP(e){return Xi(0,[(t=0,n=Ss,r=[],ea(-1,t|=16,null,0,n,n,r)),(e()(),Ri(1,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),Gi(2,null,[" ","\n"])),Hi(128,3,new Array(2)),(e()(),Ri(4,0,null,null,1,"div",[["class","content-style"]],null,null,null,null,null)),(e()(),Gi(5,null,[" ","\n"])),(e()(),Ri(6,0,null,null,3,"div",[["style","text-align: center;"]],null,null,null,null,null)),(e()(),Ri(7,0,null,null,2,"button",[["mat-flat-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.snackBarRef.dismiss()&&r),r}),tv,ev)),Jr(8,180224,null,0,Jm,[nn,pf,[2,qm]],null,null),(e()(),Gi(9,0,["",""]))],null,(function(e,t){var n=t.component,r=function(e,t,n,r){if(Wt.isWrapped(r)){r=Wt.unwrap(r);var a=e.def.nodes[2].bindingIndex+0,i=Wt.unwrap(e.oldValues[a]);e.oldValues[a]=new Wt(i)}return r}(t,0,0,e(t,3,0,zr(t,0),n.data.type));e(t,2,0,r),e(t,5,0,n.data.message),e(t,7,0,zr(t,8).disabled||null,"NoopAnimations"===zr(t,8)._animationMode),e(t,9,0,n.data.buttonText)}));var t,n,r}var NP=Ir("app-notifier",SF,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"app-notifier",[],null,null,null,EP,IP)),Jr(1,114688,null,0,SF,[UM,WM],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]);function AP(e){throw Error("A drawer was already declared for 'position=\"".concat(e,"\"'"))}var RP=new Ie("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),DP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i,o){return _classCallCheck(this,n),t.call(this,e,r,a,i,o)}return n}(function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i,o){var s;return _classCallCheck(this,n),(s=t.call(this,a,i,o))._changeDetectorRef=e,s._container=r,s}return _createClass(n,[{key:"ngAfterContentInit",value:function(){var e=this;this._container._contentMarginChanges.subscribe((function(){e._changeDetectorRef.markForCheck()}))}}]),n}(YF)),jP=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments))._fixedInViewport=!1,e._fixedTopGap=0,e._fixedBottomGap=0,e}return _createClass(n,[{key:"fixedInViewport",get:function(){return this._fixedInViewport},set:function(e){this._fixedInViewport=jd(e)}},{key:"fixedTopGap",get:function(){return this._fixedTopGap},set:function(e){this._fixedTopGap=Fd(e)}},{key:"fixedBottomGap",get:function(){return this._fixedBottomGap},set:function(e){this._fixedBottomGap=Fd(e)}}]),n}(function(){function e(t,n,r,a,i,o){var s=this;_classCallCheck(this,e),this._elementRef=t,this._focusTrapFactory=n,this._focusMonitor=r,this._platform=a,this._ngZone=i,this._doc=o,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._autoFocus=!0,this._animationStarted=new A,this._animationEnd=new A,this._animationState="void",this.openedChange=new ba(!0),this._destroyed=new A,this.onPositionChanged=new ba,this._modeChanged=new A,this._opened=!1,this.openedChange.subscribe((function(e){e?(s._doc&&(s._elementFocusedBeforeDrawerWasOpened=s._doc.activeElement),s._isFocusTrapEnabled&&s._focusTrap&&s._trapFocus()):s._restoreFocus()})),this._ngZone.runOutsideAngular((function(){zF(s._elementRef.nativeElement,"keydown").pipe(Hs((function(e){return 27===e.keyCode&&!s.disableClose&&!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?n.some((function(t){return e[t]})):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}(e)})),MF(s._destroyed)).subscribe((function(e){return s._ngZone.run((function(){s.close(),e.stopPropagation(),e.preventDefault()}))}))})),this._animationEnd.pipe(function(e,t){return function(t){return t.lift(new BF(e,void 0))}}((function(e,t){return e.fromState===t.fromState&&e.toState===t.toState}))).subscribe((function(e){var t=e.fromState,n=e.toState;(0===n.indexOf("open")&&"void"===t||"void"===n&&0===t.indexOf("open"))&&s.openedChange.emit(s._opened)}))}return _createClass(e,[{key:"position",get:function(){return this._position},set:function(e){(e="end"===e?"end":"start")!=this._position&&(this._position=e,this.onPositionChanged.emit())}},{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}},{key:"disableClose",get:function(){return this._disableClose},set:function(e){this._disableClose=jd(e)}},{key:"autoFocus",get:function(){return this._autoFocus},set:function(e){this._autoFocus=jd(e)}},{key:"_openedStream",get:function(){return this.openedChange.pipe(Hs((function(e){return e})),G((function(){})))}},{key:"openedStart",get:function(){return this._animationStarted.pipe(Hs((function(e){return e.fromState!==e.toState&&0===e.toState.indexOf("open")})),G((function(){})))}},{key:"_closedStream",get:function(){return this.openedChange.pipe(Hs((function(e){return!e})),G((function(){})))}},{key:"closedStart",get:function(){return this._animationStarted.pipe(Hs((function(e){return e.fromState!==e.toState&&"void"===e.toState})),G((function(){})))}},{key:"_isFocusTrapEnabled",get:function(){return this.opened&&"side"!==this.mode}},{key:"_trapFocus",value:function(){var e=this;this.autoFocus&&this._focusTrap.focusInitialElementWhenReady().then((function(t){t||"function"!=typeof e._elementRef.nativeElement.focus||e._elementRef.nativeElement.focus()}))}},{key:"_restoreFocus",value:function(){if(this.autoFocus){var e=this._doc&&this._doc.activeElement;e&&this._elementRef.nativeElement.contains(e)&&(this._elementFocusedBeforeDrawerWasOpened instanceof HTMLElement?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur()),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null}}},{key:"ngAfterContentInit",value:function(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}},{key:"ngAfterContentChecked",value:function(){this._platform.isBrowser&&(this._enableAnimations=!0)}},{key:"ngOnDestroy",value:function(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}},{key:"opened",get:function(){return this._opened},set:function(e){this.toggle(jd(e))}},{key:"open",value:function(e){return this.toggle(!0,e)}},{key:"close",value:function(){return this.toggle(!1)}},{key:"toggle",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.opened,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"program";return this._opened=t,t?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=n):(this._animationState="void",this._restoreFocus()),this._updateFocusTrapState(),new Promise((function(t){e.openedChange.pipe(lu(1)).subscribe((function(e){return t(e?"open":"close")}))}))}},{key:"_width",get:function(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}},{key:"_updateFocusTrapState",value:function(){this._focusTrap&&(this._focusTrap.enabled=this._isFocusTrapEnabled)}},{key:"_animationStartListener",value:function(e){this._animationStarted.next(e)}},{key:"_animationDoneListener",value:function(e){this._animationEnd.next(e)}}]),e}()),FP=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(function(){function e(t,n,r,a,i){var o=this,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6?arguments[6]:void 0;_classCallCheck(this,e),this._dir=t,this._element=n,this._ngZone=r,this._changeDetectorRef=a,this._animationMode=u,this.backdropClick=new ba,this._destroyed=new A,this._doCheckSubject=new A,this._contentMargins={left:null,right:null},this._contentMarginChanges=new A,t&&t.change.pipe(MF(this._destroyed)).subscribe((function(){o._validateDrawers(),o.updateContentMargins()})),i.change().pipe(MF(this._destroyed)).subscribe((function(){return o.updateContentMargins()})),this._autosize=s}return _createClass(e,[{key:"start",get:function(){return this._start}},{key:"end",get:function(){return this._end}},{key:"autosize",get:function(){return this._autosize},set:function(e){this._autosize=jd(e)}},{key:"hasBackdrop",get:function(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride},set:function(e){this._backdropOverride=null==e?null:jd(e)}},{key:"scrollable",get:function(){return this._userContent||this._content}},{key:"ngAfterContentInit",value:function(){var e=this;this._drawers.changes.pipe(ku(null)).subscribe((function(){e._validateDrawers(),e._drawers.forEach((function(t){e._watchDrawerToggle(t),e._watchDrawerPosition(t),e._watchDrawerMode(t)})),(!e._drawers.length||e._isDrawerOpen(e._start)||e._isDrawerOpen(e._end))&&e.updateContentMargins(),e._changeDetectorRef.markForCheck()})),this._doCheckSubject.pipe(Yd(10),MF(this._destroyed)).subscribe((function(){return e.updateContentMargins()}))}},{key:"ngOnDestroy",value:function(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._destroyed.next(),this._destroyed.complete()}},{key:"open",value:function(){this._drawers.forEach((function(e){return e.open()}))}},{key:"close",value:function(){this._drawers.forEach((function(e){return e.close()}))}},{key:"updateContentMargins",value:function(){var e=this,t=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._width;else if("push"==this._left.mode){var r=this._left._width;t+=r,n-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._width;else if("push"==this._right.mode){var a=this._right._width;n+=a,t-=a}n=n||null,(t=t||null)===this._contentMargins.left&&n===this._contentMargins.right||(this._contentMargins={left:t,right:n},this._ngZone.run((function(){return e._contentMarginChanges.next(e._contentMargins)})))}},{key:"ngDoCheck",value:function(){var e=this;this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular((function(){return e._doCheckSubject.next()}))}},{key:"_watchDrawerToggle",value:function(e){var t=this;e._animationStarted.pipe(Hs((function(e){return e.fromState!==e.toState})),MF(this._drawers.changes)).subscribe((function(e){"open-instant"!==e.toState&&"NoopAnimations"!==t._animationMode&&t._element.nativeElement.classList.add("mat-drawer-transition"),t.updateContentMargins(),t._changeDetectorRef.markForCheck()})),"side"!==e.mode&&e.openedChange.pipe(MF(this._drawers.changes)).subscribe((function(){return t._setContainerClass(e.opened)}))}},{key:"_watchDrawerPosition",value:function(e){var t=this;e&&e.onPositionChanged.pipe(MF(this._drawers.changes)).subscribe((function(){t._ngZone.onMicrotaskEmpty.asObservable().pipe(lu(1)).subscribe((function(){t._validateDrawers()}))}))}},{key:"_watchDrawerMode",value:function(e){var t=this;e&&e._modeChanged.pipe(MF(te(this._drawers.changes,this._destroyed))).subscribe((function(){t.updateContentMargins(),t._changeDetectorRef.markForCheck()}))}},{key:"_setContainerClass",value:function(e){var t=this._element.nativeElement.classList,n="mat-drawer-container-has-open";e?t.add(n):t.remove(n)}},{key:"_validateDrawers",value:function(){var e=this;this._start=this._end=null,this._drawers.forEach((function(t){"end"==t.position?(null!=e._end&&AP("end"),e._end=t):(null!=e._start&&AP("start"),e._start=t)})),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}},{key:"_isPushed",value:function(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}},{key:"_onBackdropClicked",value:function(){this.backdropClick.emit(),this._closeModalDrawer()}},{key:"_closeModalDrawer",value:function(){var e=this;[this._start,this._end].filter((function(t){return t&&!t.disableClose&&e._canHaveBackdrop(t)})).forEach((function(e){return e.close()}))}},{key:"_isShowingBackdrop",value:function(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}},{key:"_canHaveBackdrop",value:function(e){return"side"!==e.mode||!!this._backdropOverride}},{key:"_isDrawerOpen",value:function(e){return null!=e&&e.opened}}]),e}()),MP=function e(){_classCallCheck(this,e)},PP=Hn({encapsulation:2,styles:[],data:{}});function LP(e){return Xi(2,[Wi(null,0)],null,null)}var zP=Hn({encapsulation:2,styles:[],data:{animation:[{type:7,name:"transform",definitions:[{type:0,name:"open, open-instant",styles:{type:6,styles:{transform:"none",visibility:"visible"},offset:null},options:void 0},{type:0,name:"void",styles:{type:6,styles:{"box-shadow":"none",visibility:"hidden"},offset:null},options:void 0},{type:1,expr:"void => open-instant",animation:{type:4,styles:null,timings:"0ms"},options:null},{type:1,expr:"void <=> open, open-instant => void",animation:{type:4,styles:null,timings:"400ms cubic-bezier(0.25, 0.8, 0.25, 1)"},options:null}],options:{}}]}});function BP(e){return Xi(2,[(e()(),Ri(0,0,null,null,1,"div",[["class","mat-drawer-inner-container"]],null,null,null,null,null)),Wi(null,0)],null,null)}var VP=Hn({encapsulation:2,styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:background-color,visibility}@media (-ms-high-contrast:active){.mat-drawer-backdrop{opacity:.5}}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%,0,0)}@media (-ms-high-contrast:active){.mat-drawer,[dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}}@media (-ms-high-contrast:active){.mat-drawer.mat-drawer-end,[dir=rtl] .mat-drawer{border-left:solid 1px currentColor;border-right:none}}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%,0,0)}[dir=rtl] .mat-drawer{transform:translate3d(100%,0,0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%,0,0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}"],data:{}});function WP(e){return Xi(0,[(e()(),Ri(0,0,null,null,0,"div",[["class","mat-drawer-backdrop"]],[[2,"mat-drawer-shown",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component._onBackdropClicked()&&r),r}),null,null))],null,(function(e,t){e(t,0,0,t.component._isShowingBackdrop())}))}function UP(e){return Xi(0,[(e()(),Ri(0,0,null,null,3,"mat-sidenav-content",[["cdkScrollable",""],["class","mat-drawer-content mat-sidenav-content"]],[[4,"margin-left","px"],[4,"margin-right","px"]],null,null,LP,PP)),Jr(1,212992,null,0,YF,[nn,ZF,Xa,[2,Ad]],null,null),Jr(2,1294336,null,0,DP,[Ot,FP,nn,ZF,Xa],null,null),Wi(0,2)],(function(e,t){e(t,1,0),e(t,2,0)}),(function(e,t){e(t,0,0,zr(t,2)._container._contentMargins.left,zr(t,2)._container._contentMargins.right)}))}function HP(e){return Xi(2,[Pi(671088640,1,{_userContent:0}),(e()(),Ai(16777216,null,null,1,null,WP)),Jr(2,16384,null,0,ys,[In,Sn],{ngIf:[0,"ngIf"]},null),Wi(null,0),Wi(null,1),(e()(),Ai(16777216,null,null,1,null,UP)),Jr(6,16384,null,0,ys,[In,Sn],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,2,0,n.hasBackdrop),e(t,6,0,!n._content)}),null)}var GP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e))._platform=r,i._document=a,i}return _createClass(n,[{key:"ngAfterViewInit",value:function(){var e=this;Qe()&&this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe((function(){return e._checkToolbarMixedModes()})))}},{key:"_checkToolbarMixedModes",value:function(){var e=this;this._toolbarRows.length&&Array.from(this._elementRef.nativeElement.childNodes).filter((function(e){return!(e.classList&&e.classList.contains("mat-toolbar-row"))})).filter((function(t){return t.nodeType!==(e._document?e._document.COMMENT_NODE:8)})).some((function(e){return!(!e.textContent||!e.textContent.trim())}))&&function(){throw Error("MatToolbar: Attempting to combine different toolbar modes. Either specify multiple `<mat-toolbar-row>` elements explicitly or just place content inside of a `<mat-toolbar>` for a single row.")}()}}]),n}(yf((function e(t){_classCallCheck(this,e),this._elementRef=t}))),KP=function e(){_classCallCheck(this,e)},qP=Hn({encapsulation:2,styles:["@media (-ms-high-contrast:active){.mat-toolbar{outline:solid 1px}}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}.mat-toolbar-multiple-rows{min-height:64px}.mat-toolbar-row,.mat-toolbar-single-row{height:64px}@media (max-width:599px){.mat-toolbar-multiple-rows{min-height:56px}.mat-toolbar-row,.mat-toolbar-single-row{height:56px}}"],data:{}});function XP(e){return Xi(2,[Wi(null,0),Wi(null,1)],null,null)}var ZP=bf((function e(){_classCallCheck(this,e)})),YP=bf((function e(){_classCallCheck(this,e)})),QP=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments))._stateChanges=new A,e}return _createClass(n,[{key:"ngOnChanges",value:function(){this._stateChanges.next()}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}}]),n}(ZP),JP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._elementRef=e,r._stateChanges=new A,"action-list"===r._getListType()&&e.nativeElement.classList.add("mat-action-list"),r}return _createClass(n,[{key:"_getListType",value:function(){var e=this._elementRef.nativeElement.nodeName.toLowerCase();return"mat-list"===e?"list":"mat-action-list"===e?"action-list":null}},{key:"ngOnChanges",value:function(){this._stateChanges.next()}},{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}}]),n}(ZP),$P=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;_classCallCheck(this,n),(o=t.call(this))._element=e,o._isInteractiveList=!1,o._destroyed=new A,o._isInteractiveList=!!(a||i&&"action-list"===i._getListType()),o._list=a||i;var s=o._getHostElement();return"button"!==s.nodeName.toLowerCase()||s.hasAttribute("type")||s.setAttribute("type","button"),o._list&&o._list._stateChanges.pipe(MF(o._destroyed)).subscribe((function(){r.markForCheck()})),o}return _createClass(n,[{key:"ngAfterContentInit",value:function(){var e,t;t=this._element,(e=this._lines).changes.pipe(ku(e)).subscribe((function(e){var n=e.length;kf(t,"mat-2-line",!1),kf(t,"mat-3-line",!1),kf(t,"mat-multi-line",!1),2===n||3===n?kf(t,"mat-".concat(n,"-line"),!0):n>3&&kf(t,"mat-multi-line",!0)}))}},{key:"ngOnDestroy",value:function(){this._destroyed.next(),this._destroyed.complete()}},{key:"_isRippleDisabled",value:function(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}},{key:"_getHostElement",value:function(){return this._element.nativeElement}}]),n}(YP),eL=function e(){_classCallCheck(this,e)},tL=function e(){_classCallCheck(this,e)},nL=Hn({encapsulation:2,styles:[".mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:400;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:400;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:0}mat-action-list button{background:0 0;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:0}@media (-ms-high-contrast:active){.mat-selection-list:focus{outline-style:dotted}.mat-list-option:focus,.mat-list-option:hover,.mat-nav-list .mat-list-item:focus,.mat-nav-list .mat-list-item:hover,mat-action-list .mat-list-item:focus,mat-action-list .mat-list-item:hover{outline:dotted 1px}}@media (hover:none){.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover{background:0 0}}"],data:{}});function rL(e){return Xi(2,[Wi(null,0)],null,null)}var aL=Hn({encapsulation:2,styles:[],data:{}});function iL(e){return Xi(2,[(e()(),Ri(0,0,null,null,6,"div",[["class","mat-list-item-content"]],null,null,null,null,null)),(e()(),Ri(1,0,null,null,1,"div",[["class","mat-list-item-ripple mat-ripple"],["mat-ripple",""]],[[2,"mat-ripple-unbounded",null]],null,null,null,null)),Jr(2,212992,null,0,If,[nn,Xa,Vd,[2,Tf],[2,qm]],{disabled:[0,"disabled"],trigger:[1,"trigger"]},null),Wi(null,0),(e()(),Ri(4,0,null,null,1,"div",[["class","mat-list-text"]],null,null,null,null,null)),Wi(null,1),Wi(null,2)],(function(e,t){var n=t.component;e(t,2,0,n._isRippleDisabled(),n._getHostElement())}),(function(e,t){e(t,1,0,zr(t,2).unbounded)}))}var oL=function(){function e(t,n,r){_classCallCheck(this,e),this.DataSharing=t,this.notifierService=n,this.httpClient=r,this.title="",this.isMouseDown=!1,this.fullPanelWidth=0}return _createClass(e,[{key:"ngOnInit",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.DataSharing.Title.subscribe((function(e){return n.title=e})),e.prev=1,"assets/",e.next=5,this.httpClient.get("assets/pluralmap.csv",{responseType:"text"}).toPromise();case 5:t=e.sent,this.luralmapkvp=function(e){var t=e.split("\n");t=t.filter((function(e){return e.trim().length>0&&e.indexOf(",")>-1}));var n={};return t.forEach((function(e){var t=e.split(",");n[t[0].trim()]=t[1].trim()})),n}(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.notifierService.showNotification("Error on pluralmap.csv.","OK","error");case 12:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"ngAfterViewInit",value:function(){return ns(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.DataSharing.CurrentPredictions.subscribe((function(e){t.currentPredictions&&e&&(t.currentPredictions.nativeElement.innerHTML="",e.forEach((function(e){var n=document.createElement("div");n.innerHTML=t.GetCountLabels(e.count,e.item),t.currentPredictions.nativeElement.appendChild(n)})))})),this.DataSharing.AllPredictions.subscribe((function(e){t.allPredictions&&e&&(t.allPredictions.nativeElement.innerHTML="",e.forEach((function(e){var n=document.createElement("div");n.innerHTML=t.GetCountLabels(e.count,e.item),t.allPredictions.nativeElement.appendChild(n)})))}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"GetCountLabels",value:function(e,t){var n=this.luralmapkvp[t];return 1!==e&&n||(n=t),"".concat(e," ").concat(n)}},{key:"onClearHighestPredictions",value:function(){this.DataSharing.ClearPredictions.next([]),this.DataSharing.CurrentPredictions.next([]),this.DataSharing.AllPredictions.next([])}},{key:"onMouseDown",value:function(e){this.isMouseDown=!0,this.fullPanelWidth=this.rightpane.nativeElement.offsetWidth+this.middlepane.nativeElement.offsetWidth}},{key:"onMouseMove",value:function(e){var t=e.clientX-150;this.isMouseDown&&(this.rightpane.nativeElement.style.width=100-t/this.fullPanelWidth*100+"%",this.middlepane.nativeElement.style.width=t/this.fullPanelWidth*100+"%")}}]),e}(),sL=function e(){_classCallCheck(this,e)},uL=function e(){_classCallCheck(this,e)},cL=function(){function e(t){var n=this;_classCallCheck(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach((function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),a=r.toLowerCase(),i=e.slice(t+1).trim();n.maybeSetNormalizedName(r,a),n.headers.has(a)?n.headers.get(a).push(i):n.headers.set(a,[i])}}))}:function(){n.headers=new Map,Object.keys(t).forEach((function(e){var r=t[e],a=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(a,r),n.maybeSetNormalizedName(e,a))}))}:this.headers=new Map}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach((function(e){return t.applyUpdate(e)})),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach((function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))}))}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,_toConsumableArray(n)),this.headers.set(t,r);break;case"d":var a=e.value;if(a){var i=this.headers.get(t);if(!i)return;0===(i=i.filter((function(e){return-1===a.indexOf(e)}))).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,i)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach((function(n){return e(t.normalizedNames.get(n),t.headers.get(n))}))}}]),e}(),lL=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encodeKey",value:function(e){return hL(e)}},{key:"encodeValue",value:function(e){return hL(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function hL(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var dL=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new lL,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.split("&").forEach((function(e){var r=e.indexOf("="),a=_slicedToArray(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),i=a[0],o=a[1],s=n.get(i)||[];s.push(o),n.set(i,s)})),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach((function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])}))):this.map=null}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map((function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map((function(t){return n+"="+e.encoder.encodeValue(t)})).join("&")})).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([t]),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach((function(t){return e.map.set(t,e.cloneFrom.map.get(t))})),this.updates.forEach((function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(t.value),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],a=r.indexOf(t.value);-1!==a&&r.splice(a,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}})),this.cloneFrom=this.updates=null)}}]),e}();function fL(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function pL(e){return"undefined"!=typeof Blob&&e instanceof Blob}function mL(e){return"undefined"!=typeof FormData&&e instanceof FormData}var vL=function(){function e(t,n,r,a){var i;if(_classCallCheck(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||a?(this.body=void 0!==r?r:null,i=a):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new cL),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new dL,this.urlWithParams=n}return _createClass(e,[{key:"serializeBody",value:function(){return null===this.body?null:fL(this.body)||pL(this.body)||mL(this.body)||"string"==typeof this.body?this.body:this.body instanceof dL?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||mL(this.body)?null:pL(this.body)?this.body.type||null:fL(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof dL?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.method||this.method,r=t.url||this.url,a=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,u=t.headers||this.headers,c=t.params||this.params;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((function(e,n){return e.set(n,t.setHeaders[n])}),u)),t.setParams&&(c=Object.keys(t.setParams).reduce((function(e,n){return e.set(n,t.setParams[n])}),c)),new e(n,r,i,{params:c,headers:u,reportProgress:s,responseType:a,withCredentials:o})}}]),e}(),gL=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}(),yL=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_classCallCheck(this,e),this.headers=t.headers||new cL,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300},bL=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,n),(e=t.call(this,r)).type=gL.ResponseHeader,e}return _createClass(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(yL),kL=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,n),(e=t.call(this,r)).type=gL.Response,e.body=void 0!==r.body?r.body:null,e}return _createClass(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(yL),_L=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for "+(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return n}(yL);function wL(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var xL=function(){function e(t){_classCallCheck(this,e),this.handler=t}return _createClass(e,[{key:"request",value:function(e,t){var n,r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof vL)n=e;else{var i=void 0;i=a.headers instanceof cL?a.headers:new cL(a.headers);var o=void 0;a.params&&(o=a.params instanceof dL?a.params:new dL({fromObject:a.params})),n=new vL(e,t,void 0!==a.body?a.body:null,{headers:i,params:o,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials})}var s=js(n).pipe(Cu((function(e){return r.handler.handle(e)})));if(e instanceof vL||"events"===a.observe)return s;var u=s.pipe(Hs((function(e){return e instanceof kL})));switch(a.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(G((function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body})));case"blob":return u.pipe(G((function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body})));case"text":return u.pipe(G((function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body})));case"json":default:return u.pipe(G((function(e){return e.body})))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(a.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new dL).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,wL(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,wL(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,wL(n,t))}}]),e}(),CL=function(){function e(t,n){_classCallCheck(this,e),this.next=t,this.interceptor=n}return _createClass(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),OL=new Ie("HTTP_INTERCEPTORS"),SL=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}(),TL=/^\)\]\}',?\n/,IL=function e(){_classCallCheck(this,e)},EL=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}(),NL=function(){function e(t){_classCallCheck(this,e),this.xhrFactory=t}return _createClass(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new C((function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach((function(e,t){return r.setRequestHeader(e,t.join(","))})),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var a=e.detectContentTypeHeader();null!==a&&r.setRequestHeader("Content-Type",a)}if(e.responseType){var i=e.responseType.toLowerCase();r.responseType="json"!==i?i:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",a=new cL(r.getAllResponseHeaders()),i=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new bL({headers:a,status:t,statusText:n,url:i})},c=function(){var t=u(),a=t.headers,i=t.status,o=t.statusText,s=t.url,c=null;204!==i&&(c=void 0===r.response?r.responseText:r.response),0===i&&(i=c?200:0);var l=i>=200&&i<300;if("json"===e.responseType&&"string"==typeof c){var h=c;c=c.replace(TL,"");try{c=""!==c?JSON.parse(c):null}catch(d){c=h,l&&(l=!1,c={error:d,text:c})}}l?(n.next(new kL({body:c,headers:a,status:i,statusText:o,url:s||void 0})),n.complete()):n.error(new _L({error:c,headers:a,status:i,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,a=new _L({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(a)},h=!1,d=function(t){h||(n.next(u()),h=!0);var a={type:gL.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(a.total=t.total),"text"===e.responseType&&r.responseText&&(a.partialText=r.responseText),n.next(a)},f=function(e){var t={type:gL.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),e.reportProgress&&(r.addEventListener("progress",d),null!==o&&r.upload&&r.upload.addEventListener("progress",f)),r.send(o),n.next({type:gL.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("load",c),e.reportProgress&&(r.removeEventListener("progress",d),null!==o&&r.upload&&r.upload.removeEventListener("progress",f)),r.abort()}}))}}]),e}(),AL=new Ie("XSRF_COOKIE_NAME"),RL=new Ie("XSRF_HEADER_NAME"),DL=function e(){_classCallCheck(this,e)},jL=function(){function e(t,n,r){_classCallCheck(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return _createClass(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=gs(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}(),FL=function(){function e(t,n){_classCallCheck(this,e),this.tokenService=t,this.headerName=n}return _createClass(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}(),ML=function(){function e(t,n){_classCallCheck(this,e),this.backend=t,this.injector=n,this.chain=null}return _createClass(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(OL,[]);this.chain=t.reduceRight((function(e,t){return new CL(e,t)}),this.backend)}return this.chain.handle(e)}}]),e}(),PL=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:FL,useClass:SL}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:AL,useValue:t.cookieName}:[],t.headerName?{provide:RL,useValue:t.headerName}:[]]}}}]),e}(),LL=function e(){_classCallCheck(this,e)},zL=Hn({encapsulation:0,styles:[[".sidenav[_ngcontent-%COMP%]{width:150px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit;height:30px}.sidenav[_ngcontent-%COMP%]   .mat-nav-list[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:30px}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;z-index:1;height:30px}table[_ngcontent-%COMP%]{box-sizing:border-box;width:100%;border:1px solid red}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{box-sizing:border-box;vertical-align:top;border:.5px solid #00f}"]],data:{}});function BL(e){return Xi(0,[(e()(),Ri(0,0,null,null,5,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Jr(1,16384,null,0,Od,[],null,null),(e()(),Ri(2,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),Ri(3,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),Gi(-1,null,["Highest Count"])),(e()(),Ri(5,0,[[2,0],["all",1]],null,0,"div",[],null,null,null,null,null))],null,null)}function VL(e){return Xi(0,[(e()(),Ri(0,0,null,null,4,"mat-card-actions",[["class","mat-card-actions"]],[[2,"mat-card-actions-align-end",null]],null,null,null,null)),Jr(1,16384,null,0,Sd,[],null,null),(e()(),Ri(2,0,null,null,2,"button",[["color","accent"],["mat-raised-button",""]],[[1,"disabled",0],[2,"_mat-animation-noopable",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.onClearHighestPredictions()&&r),r}),tv,ev)),Jr(3,180224,null,0,Jm,[nn,pf,[2,qm]],{color:[0,"color"]},null),(e()(),Gi(-1,0,["Clear"]))],(function(e,t){e(t,3,0,"accent")}),(function(e,t){e(t,0,0,"end"===zr(t,1).align),e(t,2,0,zr(t,3).disabled||null,"NoopAnimations"===zr(t,3)._animationMode)}))}function WL(e){return Xi(0,[Pi(671088640,1,{currentPredictions:0}),Pi(671088640,2,{allPredictions:0}),Pi(671088640,3,{middlepane:0}),Pi(671088640,4,{rightpane:0}),(e()(),Ri(4,0,null,null,68,"mat-sidenav-container",[["class","sidenav-container mat-drawer-container mat-sidenav-container"]],[[2,"mat-drawer-container-explicit-backdrop",null]],null,null,HP,VP)),Jr(5,1490944,null,2,FP,[[2,Ad],nn,Xa,Ot,JF,RP,[2,qm]],null,null),Pi(603979776,5,{_drawers:1}),Pi(603979776,6,{_content:0}),(e()(),Ri(8,0,null,0,35,"mat-sidenav",[["class","sidenav mat-drawer mat-sidenav"],["fixedInViewport",""],["tabIndex","-1"]],[[1,"role",0],[1,"align",0],[2,"mat-drawer-end",null],[2,"mat-drawer-over",null],[2,"mat-drawer-push",null],[2,"mat-drawer-side",null],[2,"mat-drawer-opened",null],[2,"mat-sidenav-fixed",null],[4,"top","px"],[4,"bottom","px"],[40,"@transform",0]],[["component","@transform.start"],["component","@transform.done"]],(function(e,t,n){var r=!0;return"component:@transform.start"===t&&(r=!1!==zr(e,9)._animationStartListener(n)&&r),"component:@transform.done"===t&&(r=!1!==zr(e,9)._animationDoneListener(n)&&r),r}),BP,zP)),Jr(9,3325952,[[5,4],["drawer",4]],0,jP,[nn,cf,pf,Vd,Xa,[2,Is]],{mode:[0,"mode"],opened:[1,"opened"],fixedInViewport:[2,"fixedInViewport"]},null),(e()(),Ri(10,0,null,0,3,"mat-toolbar",[["class","mat-toolbar"]],[[2,"mat-toolbar-multiple-rows",null],[2,"mat-toolbar-single-row",null]],null,null,XP,qP)),Jr(11,4243456,null,1,GP,[nn,Vd,Is],null,null),Pi(603979776,7,{_toolbarRows:1}),(e()(),Gi(-1,0,["Selection"])),(e()(),Ri(14,0,null,0,29,"mat-nav-list",[["class","mat-nav-list mat-list-base"],["role","navigation"]],null,null,null,rL,nL)),Jr(15,704512,null,0,QP,[],null,null),(e()(),Ri(16,0,null,0,6,"a",[["class","mat-list-item"],["mat-list-item",""],["routerLink","screencap"]],[[1,"target",0],[8,"href",4],[2,"mat-list-item-avatar",null],[2,"mat-list-item-with-avatar",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==zr(e,17).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r}),iL,aL)),Jr(17,671744,null,0,Xh,[qh,Ll,ss],{routerLink:[0,"routerLink"]},null),Jr(18,1228800,null,3,$P,[nn,Ot,[2,QP],[2,JP]],null,null),Pi(603979776,8,{_lines:1}),Pi(603979776,9,{_avatar:0}),Pi(603979776,10,{_icon:0}),(e()(),Gi(-1,2,["Screen Capture"])),(e()(),Ri(23,0,null,0,6,"a",[["class","mat-list-item"],["mat-list-item",""],["routerLink","video"]],[[1,"target",0],[8,"href",4],[2,"mat-list-item-avatar",null],[2,"mat-list-item-with-avatar",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==zr(e,24).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r}),iL,aL)),Jr(24,671744,null,0,Xh,[qh,Ll,ss],{routerLink:[0,"routerLink"]},null),Jr(25,1228800,null,3,$P,[nn,Ot,[2,QP],[2,JP]],null,null),Pi(603979776,11,{_lines:1}),Pi(603979776,12,{_avatar:0}),Pi(603979776,13,{_icon:0}),(e()(),Gi(-1,2,["Video File"])),(e()(),Ri(30,0,null,0,6,"a",[["class","mat-list-item"],["mat-list-item",""],["routerLink","image"]],[[1,"target",0],[8,"href",4],[2,"mat-list-item-avatar",null],[2,"mat-list-item-with-avatar",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==zr(e,31).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r}),iL,aL)),Jr(31,671744,null,0,Xh,[qh,Ll,ss],{routerLink:[0,"routerLink"]},null),Jr(32,1228800,null,3,$P,[nn,Ot,[2,QP],[2,JP]],null,null),Pi(603979776,14,{_lines:1}),Pi(603979776,15,{_avatar:0}),Pi(603979776,16,{_icon:0}),(e()(),Gi(-1,2,["Image File"])),(e()(),Ri(37,0,null,0,6,"a",[["class","mat-list-item"],["mat-list-item",""],["routerLink","webcam"]],[[1,"target",0],[8,"href",4],[2,"mat-list-item-avatar",null],[2,"mat-list-item-with-avatar",null]],[[null,"click"]],(function(e,t,n){var r=!0;return"click"===t&&(r=!1!==zr(e,38).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&r),r}),iL,aL)),Jr(38,671744,null,0,Xh,[qh,Ll,ss],{routerLink:[0,"routerLink"]},null),Jr(39,1228800,null,3,$P,[nn,Ot,[2,QP],[2,JP]],null,null),Pi(603979776,17,{_lines:1}),Pi(603979776,18,{_avatar:0}),Pi(603979776,19,{_icon:0}),(e()(),Gi(-1,2,["Webcam"])),(e()(),Ri(44,0,null,1,28,"mat-sidenav-content",[["class","mat-drawer-content mat-sidenav-content"]],[[4,"margin-left","px"],[4,"margin-right","px"]],[[null,"mouseup"],[null,"mousemove"]],(function(e,t,n){var r=!0,a=e.component;return"mouseup"===t&&(r=0!=(a.isMouseDown=!1)&&r),"mousemove"===t&&(r=!1!==a.onMouseMove(n)&&r),r}),LP,PP)),Jr(45,1294336,[[6,4]],0,DP,[Ot,FP,nn,ZF,Xa],null,null),(e()(),Ri(46,0,null,0,4,"mat-toolbar",[["class","mat-toolbar"],["color","primary"]],[[2,"mat-toolbar-multiple-rows",null],[2,"mat-toolbar-single-row",null]],null,null,XP,qP)),Jr(47,4243456,null,1,GP,[nn,Vd,Is],{color:[0,"color"]},null),Pi(603979776,20,{_toolbarRows:1}),(e()(),Ri(49,0,null,0,1,"span",[],null,null,null,null,null)),(e()(),Gi(50,null,["",""])),(e()(),Ri(51,0,null,0,21,"table",[["cellpadding","0"],["cellspacing","0"]],null,null,null,null,null)),(e()(),Ri(52,0,null,null,20,"tr",[],null,null,null,null,null)),(e()(),Ri(53,0,[[3,0],["middlepane",1]],null,3,"td",[["style","width:80%;"]],null,null,null,null,null)),(e()(),Ri(54,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),Ri(55,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),Jr(56,212992,null,0,Jh,[Qh,In,Jt,[8,null],Ot],null,null),(e()(),Ri(57,0,null,null,0,"td",[["style","width:5px;min-width:5px;cursor:ew-resize;"]],null,[[null,"mousedown"]],(function(e,t,n){var r=!0;return"mousedown"===t&&(r=!1!==e.component.onMouseDown(n)&&r),r}),null,null)),(e()(),Ri(58,0,[[4,0],["rightpane",1]],null,14,"td",[],null,null,null,null,null)),(e()(),Ri(59,0,null,null,13,"div",[],null,null,null,null,null)),(e()(),Ri(60,0,null,null,12,"mat-card",[["class","example-card mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,Ym,Zm)),Jr(61,49152,null,0,Id,[[2,qm]],null,null),(e()(),Ri(62,0,null,0,5,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Jr(63,16384,null,0,Od,[],null,null),(e()(),Ri(64,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),Ri(65,0,null,null,1,"b",[],null,null,null,null,null)),(e()(),Gi(-1,null,["Current Predictions"])),(e()(),Ri(67,0,[[1,0],["current",1]],null,0,"div",[],null,null,null,null,null)),(e()(),Ri(68,0,null,0,0,"br",[],null,null,null,null,null)),(e()(),Ai(16777216,null,0,1,null,BL)),Jr(70,16384,null,0,ys,[In,Sn],{ngIf:[0,"ngIf"]},null),(e()(),Ai(16777216,null,0,1,null,VL)),Jr(72,16384,null,0,ys,[In,Sn],{ngIf:[0,"ngIf"]},null)],(function(e,t){var n=t.component;e(t,5,0),e(t,9,0,"side",!0,""),e(t,17,0,"screencap"),e(t,24,0,"video"),e(t,31,0,"image"),e(t,38,0,"webcam"),e(t,45,0),e(t,47,0,"primary"),e(t,56,0),e(t,70,0,"Image File"!=n.title),e(t,72,0,"Image File"!=n.title)}),(function(e,t){var n=t.component;e(t,4,0,zr(t,5)._backdropOverride),e(t,8,1,["navigation",null,"end"===zr(t,9).position,"over"===zr(t,9).mode,"push"===zr(t,9).mode,"side"===zr(t,9).mode,zr(t,9).opened,zr(t,9).fixedInViewport,zr(t,9).fixedInViewport?zr(t,9).fixedTopGap:null,zr(t,9).fixedInViewport?zr(t,9).fixedBottomGap:null,zr(t,9)._animationState]),e(t,10,0,zr(t,11)._toolbarRows.length>0,0===zr(t,11)._toolbarRows.length),e(t,16,0,zr(t,17).target,zr(t,17).href,zr(t,18)._avatar||zr(t,18)._icon,zr(t,18)._avatar||zr(t,18)._icon),e(t,23,0,zr(t,24).target,zr(t,24).href,zr(t,25)._avatar||zr(t,25)._icon,zr(t,25)._avatar||zr(t,25)._icon),e(t,30,0,zr(t,31).target,zr(t,31).href,zr(t,32)._avatar||zr(t,32)._icon,zr(t,32)._avatar||zr(t,32)._icon),e(t,37,0,zr(t,38).target,zr(t,38).href,zr(t,39)._avatar||zr(t,39)._icon,zr(t,39)._avatar||zr(t,39)._icon),e(t,44,0,zr(t,45)._container._contentMargins.left,zr(t,45)._container._contentMargins.right),e(t,46,0,zr(t,47)._toolbarRows.length>0,0===zr(t,47)._toolbarRows.length),e(t,50,0,n.title),e(t,60,0,"NoopAnimations"===zr(t,61)._animationMode)}))}var UL=Hn({encapsulation:0,styles:[["div[_ngcontent-%COMP%]{position:relative;height:100%}div[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]],data:{}});function HL(e){return Xi(0,[(e()(),Ri(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),Ri(1,0,null,null,1,"mat-progress-bar",[["aria-valuemax","100"],["aria-valuemin","0"],["class","mat-progress-bar"],["color","accent"],["mode","indeterminate"],["role","progressbar"]],[[1,"aria-valuenow",0],[1,"mode",0],[2,"_mat-animation-noopable",null]],null,null,sP,oP)),Jr(2,4374528,null,0,rP,[nn,Xa,[2,qm],[2,tP]],{color:[0,"color"],mode:[1,"mode"]},null),(e()(),Ri(3,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),Gi(-1,null,["Model is Loading..."]))],(function(e,t){e(t,2,0,"accent","indeterminate")}),(function(e,t){e(t,1,0,"indeterminate"===zr(t,2).mode||"query"===zr(t,2).mode?null:zr(t,2).value,zr(t,2).mode,zr(t,2)._isNoopAnimation)}))}function GL(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"app-nav",[],null,null,null,WL,zL)),Jr(1,4308992,null,0,oL,[OF,YM,xL],null,null)],(function(e,t){e(t,1,0)}),null)}function KL(e){return Xi(0,[(e()(),Ai(16777216,null,null,1,null,HL)),Jr(1,16384,null,0,ys,[In,Sn],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(e()(),Ai(0,[["main",2]],null,0,null,GL))],(function(e,t){e(t,1,0,!t.component.isModelLoaded,zr(t,2))}),null)}var qL,XL=Ir("app-root",as,(function(e){return Xi(0,[(e()(),Ri(0,0,null,null,1,"app-root",[],null,null,null,KL,UL)),Jr(1,114688,null,0,as,[OF,YM],null,null)],(function(e,t){e(t,1,0)}),null)}),{},{},[]),ZL=((qL=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"create",value:function(e){return"undefined"==typeof MutationObserver?null:new MutationObserver(e)}}]),e}()).ngInjectableDef=ve({factory:function(){return new qL},token:qL,providedIn:"root"}),qL),YL=function e(){_classCallCheck(this,e)},QL=new Ie("mat-menu-scroll-strategy");function JL(e){return function(){return e.scrollStrategies.reposition()}}var $L=function e(){_classCallCheck(this,e)},ez=function e(){_classCallCheck(this,e)},tz=function e(){_classCallCheck(this,e)},nz=function e(){_classCallCheck(this,e)},rz=function e(){_classCallCheck(this,e)},az=function e(){_classCallCheck(this,e)},iz=function e(){_classCallCheck(this,e)},oz=function e(){_classCallCheck(this,e)},sz=function e(){_classCallCheck(this,e)},uz=new es(ts,[as],(function(e){return function(e){for(var t={},n=[],r=!1,a=0;a<e.length;a++){var i=e[a];i.token===Tt&&!0===i.value&&(r=!0),1073741824&i.flags&&n.push(i.token),i.index=a,t[Un(i.token)]=i}return{factory:null,providersByKey:t,providers:e,modules:n,isRoot:r}}([_r(512,Jt,$t,[[8,[Cd,$M,hP,mP,bP,xP,TP,NP,XL]],[3,Jt],ze]),_r(5120,Aa,Ii,[[3,Aa]]),_r(4608,ms,vs,[Aa,[2,ps]]),_r(5120,pa,Ei,[Xa]),_r(5120,Ca,Oa,[]),_r(5120,_n,Si,[]),_r(5120,wn,Ti,[]),_r(4608,_c,wc,[Is]),_r(6144,kt,null,[_c]),_r(4608,pc,vc,[]),_r(5120,Uu,(function(e,t,n,r,a,i,o,s){return[new dc(e,t,n),new kc(r),new gc(a,i,o,s)]}),[Is,Xa,Ia,Is,Is,pc,Na,[2,mc]]),_r(4608,Hu,Hu,[Uu,Xa]),_r(135680,qu,qu,[Is]),_r(4608,Ju,Ju,[Hu,qu,Ca]),_r(5120,rp,Hm,[]),_r(5120,Gp,Gm,[]),_r(4608,ym,Um,[Is,rp,Gp]),_r(5120,an,Km,[Ju,ym,Xa]),_r(6144,Ku,null,[qu]),_r(4608,ni,ni,[Xa]),_r(5120,Ll,md,[qh]),_r(4608,nd,nd,[]),_r(6144,ed,null,[nd]),_r(135680,rd,rd,[qh,pi,za,Et,ed]),_r(4608,td,td,[]),_r(5120,ad,ld,[qh,Es,id]),_r(5120,bd,yd,[vd]),_r(5120,Ea,(function(e){return[e]}),[bd]),_r(4608,ZL,ZL,[]),_r(4608,OM,OM,[sM,vM,Jt,xM,mM,Et,Xa,Is,Ad,[2,cs]]),_r(5120,SM,TM,[OM]),_r(5120,QL,JL,[OM]),_r(4608,Af,Mm,[an,Is]),_r(4608,DL,jL,[Is,Ia,AL]),_r(4608,FL,FL,[DL,RL]),_r(5120,OL,(function(e){return[e]}),[FL]),_r(4608,EL,EL,[]),_r(6144,IL,null,[EL]),_r(4608,NL,NL,[IL]),_r(6144,uL,null,[NL]),_r(4608,sL,ML,[uL,Et]),_r(4608,xL,xL,[sL]),_r(1073742336,Ts,Ts,[]),_r(1024,Xe,Nc,[]),_r(1024,oi,(function(){return[ud()]}),[]),_r(512,vd,vd,[Et]),_r(1024,wa,(function(e,t){return[(n=e,Bu("probe",Wu),Bu("coreTokens",Object.assign({},Vu,(n||[]).reduce((function(e,t){return e[t.name]=t.token,e}),{}))),function(){return Wu}),gd(t)];var n}),[[2,oi],vd]),_r(512,xa,xa,[[2,wa]]),_r(131584,di,di,[Xa,Na,Et,Xe,Jt,xa]),_r(1073742336,Ni,Ni,[di]),_r(1073742336,Ac,Ac,[[3,Ac]]),_r(1024,od,dd,[[3,qh]]),_r(512,vl,gl,[]),_r(512,Qh,Qh,[]),_r(256,id,{},[]),_r(1024,ss,hd,[is,[2,us],id]),_r(512,cs,cs,[ss,is]),_r(512,za,za,[]),_r(512,pi,gi,[za,[2,mi]]),_r(1024,Bh,(function(){return[[{path:"screencap",component:CF},{path:"video",component:uP},{path:"image",component:dP},{path:"webcam",component:vP},{path:"**",redirectTo:"/image",pathMatch:"full"},{path:"",redirectTo:"/image",pathMatch:"full"}]]}),[]),_r(1024,qh,pd,[di,vl,Qh,cs,Et,pi,za,Bh,id,[2,Wh],[2,Lh]]),_r(1073742336,cd,cd,[[2,od],[2,qh]]),_r(1073742336,tz,tz,[]),_r(1073742336,Rd,Rd,[]),_r(1073742336,gf,gf,[[2,vf],[2,mc]]),_r(1073742336,Wd,Wd,[]),_r(1073742336,Ef,Ef,[]),_r(1073742336,$m,$m,[]),_r(1073742336,YL,YL,[]),_r(1073742336,nz,nz,[]),_r(1073742336,rz,rz,[]),_r(1073742336,KP,KP,[]),_r(1073742336,QF,QF,[]),_r(1073742336,MP,MP,[]),_r(1073742336,az,az,[]),_r(1073742336,iz,iz,[]),_r(1073742336,_f,_f,[]),_r(1073742336,Nf,Nf,[]),_r(1073742336,tL,tL,[]),_r(1073742336,eL,eL,[]),_r(1073742336,oz,oz,[]),_r(1073742336,Ed,Ed,[]),_r(1073742336,jF,jF,[]),_r(1073742336,NM,NM,[]),_r(1073742336,$L,$L,[]),_r(1073742336,ez,ez,[]),_r(1073742336,DM,DM,[]),_r(1073742336,Xm,Xm,[]),_r(1073742336,iP,iP,[]),_r(1073742336,qM,qM,[]),_r(1073742336,sz,sz,[]),_r(1073742336,PL,PL,[]),_r(1073742336,LL,LL,[]),_r(1073742336,ts,ts,[]),_r(256,Tt,!0,[]),_r(256,qm,"BrowserAnimations",[]),_r(256,AL,"XSRF-TOKEN",[]),_r(256,RL,"X-XSRF-TOKEN",[])])}));(function(){if(Ye)throw new Error("Cannot enable prod mode after platform setup.");Ze=!1})(),Ec().bootstrapModuleFactory(uz).catch((function(e){return console.error(e)}))},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"},zvA9:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("auKK"),a=n("wFtI"),i=n("dsKV"),o=n("o/e8"),s=n("Um8L"),u=n("VO80"),c=Object(u.b)({greater_:function(e,t){var n,u=Object(o.a)(e,"a","greater"),c=Object(o.a)(t,"b","greater");return u=(n=_slicedToArray(Object(i.makeTypesMatch)(u,c),2))[0],c=n[1],Object(s.a)(u.shape,c.shape),r.a.runKernel(a.nb,{a:u,b:c})}})}},[[0,0]]]);